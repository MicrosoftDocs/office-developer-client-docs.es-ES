---
title: Obtener acceso a orígenes de datos externos
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
keywords:
- data connection classes [infopath 2007],secondary data sources [InfoPath 2007],data [InfoPath 2007], secondary,DataSource class [InfoPath 2007],accessing external data sources [InfoPath 2007],DataSourceCollection class [InfoPath 2007],DataConnectionCollection class [InfoPath 2007],DataConnection class [InfoPath 2007],InfoPath 2007, accessing external data,data [InfoPath 2007], external sources
localization_priority: Normal
ms.assetid: db7c2521-a1ad-4802-b398-79575d3d310a
description: Al trabajar con una plantilla de formulario de InfoPath, puede escribir código para obtener acceso a los orígenes de datos secundarios y manipular los datos que contienen.
ms.openlocfilehash: f6957c561231eef0e3e4df6deb09ae89f85afcc5
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33408316"
---
# <a name="access-external-data-sources"></a><span data-ttu-id="851d8-104">Obtener acceso a orígenes de datos externos</span><span class="sxs-lookup"><span data-stu-id="851d8-104">Access External Data Sources</span></span>

<span data-ttu-id="851d8-105">Al trabajar con una plantilla de formulario de InfoPath, puede escribir código para obtener acceso a los orígenes de datos secundarios y manipular los datos que contienen.</span><span class="sxs-lookup"><span data-stu-id="851d8-105">When working with an InfoPath form template, you can write code to access the form's secondary data sources and manipulate the data that they contain.</span></span> 
  
<span data-ttu-id="851d8-p101">Cada origen de datos secundario está representado mediante un objeto del que se crea una instancia utilizando la clase [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) y que corresponde a datos almacenados obtenidos de algún origen de datos externos, como una base de datos o una consulta de servicio Web. Estos orígenes de datos se denominan secundarios porque cuando el usuario guarda un formulario de InfoPath, sólo guarda los datos del origen de datos principal (o primario), no los de los orígenes de datos secundarios. La conexión a un origen de datos se representa mediante un objeto del que se crea una instancia utilizando una de las clases de "adaptador de datos", como la clase [WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx) , que representa una conexión de datos a un servicio Web XML.</span><span class="sxs-lookup"><span data-stu-id="851d8-p101">Each secondary data source is represented by an object instantiated using the [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) class, and corresponds to stored data, obtained from some external source of data, such as a database or a Web Service query. These data sources are referred to as secondary because when the user saves an InfoPath form, the user is saving the data only in the main (or primary) data source, not the data in the secondary data sources. The connection to a data source is represented by an object instantiated using one of the "data connection" classes, such as the [WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx) class, which represents a data connection to an XML Web Service.</span></span> 
  
<span data-ttu-id="851d8-109">El objeto del que se crea una instancia [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) representa el almacenamiento de datos XML que devuelve una conexión de datos (de una base de datos o a una consulta de servicio web) y la clase de "conexión de datos" representa la propia conexión de datos (como se define y denomina usando el comando **Conexiones de datos** de la ficha **Datos**).</span><span class="sxs-lookup"><span data-stu-id="851d8-109">The instantiated [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) object represents the storage of XML data returned by a data connection (from a database or Web Service query), and the "data connection" class represents the data connection itself (as defined and named using the **Data Connections** command on the **Data** tab).</span></span> 
  
<span data-ttu-id="851d8-110">El modelo de objetos de InfoPath admite el acceso a los orígenes de datos secundarios de un formulario mediante la utilización de la clase [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) en asociación con la clase [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) .</span><span class="sxs-lookup"><span data-stu-id="851d8-110">The InfoPath object model supports access to a form's secondary data sources through the use of the [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) class in association with the [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) class.</span></span> 
  
<span data-ttu-id="851d8-111">El modelo de objetos de InfoPath también proporciona un conjunto de clases de conexión de datos que contienen información sobre las conexiones de datos que utiliza el formulario.</span><span class="sxs-lookup"><span data-stu-id="851d8-111">The InfoPath object model also provides a set of data connection classes, containing information about the data connections used by the form.</span></span>
  
> [!NOTE]
> <span data-ttu-id="851d8-112">[!NOTA] En Microsoft InfoPath 2003, una conexión de datos se denomina adaptador de datos.</span><span class="sxs-lookup"><span data-stu-id="851d8-112">In Microsoft InfoPath 2003, a data connection is referred to as a data adapter.</span></span> 
  
<span data-ttu-id="851d8-p102">Los adaptadores de datos pueden ser de dos tipos: conexiones de consultas, que se utilizan para obtener datos que después se almacenan en un origen de datos secundario y conexiones de envío que se utilizan para enviar datos, por ejemplo a una base de datos o a un servicio web. Los datos enviados se copian de orígenes de datos principales o secundarios.</span><span class="sxs-lookup"><span data-stu-id="851d8-p102">Data connections are of two kinds: Query connections are used to obtain the data that is then stored in a secondary data source. Submit connections are used to submit data, to a database or Web service, for example. The submitted data is copied from the main or secondary data sources.</span></span> 
  
## <a name="overview-of-the-datasourcecollection-class"></a><span data-ttu-id="851d8-116">Información general sobre la clase DataSourceCollection</span><span class="sxs-lookup"><span data-stu-id="851d8-116">Overview of the DataSourceCollection Class</span></span>

<span data-ttu-id="851d8-117">La clase [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) proporciona las siguientes propiedades y métodos que los programadores de formularios pueden utilizar para administrar las instancias de [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) que contenga el formulario.</span><span class="sxs-lookup"><span data-stu-id="851d8-117">The [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) class provides the following properties and methods, which form developers can use to manage the [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) object instances that the form contains.</span></span> 
  
|<span data-ttu-id="851d8-118">**Nombre**</span><span class="sxs-lookup"><span data-stu-id="851d8-118">**Name**</span></span>|<span data-ttu-id="851d8-119">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="851d8-119">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="851d8-120">Propiedad [Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Count.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-120">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="851d8-121">Devuelve el número de instancias de objetos **DataSource** contenidas en la colección.</span><span class="sxs-lookup"><span data-stu-id="851d8-121">Returns a count of the number of **DataSource** object instances contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="851d8-122">[GetEnumerator (método)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.GetEnumerator.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-122">[GetEnumerator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.GetEnumerator.aspx) method</span></span>  <br/> |<span data-ttu-id="851d8-123">Devuelve un **IEnumerator** que se puede utilizar para recorrer en iteración la colección.</span><span class="sxs-lookup"><span data-stu-id="851d8-123">Returns an **IEnumerator** that can be used to iterate through the collection.</span></span>  <br/> |
|<span data-ttu-id="851d8-124">[Propiedad Item[Int32]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-124">[Item[Int32]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="851d8-125">Devuelve una referencia al objeto **DataSource** especificado de la colección por su valor de índice.</span><span class="sxs-lookup"><span data-stu-id="851d8-125">Returns a reference to the specified **DataSource** object by index value.</span></span>  <br/> |
|<span data-ttu-id="851d8-126">[Propiedad Item[String]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-126">[Item[String]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="851d8-127">Devuelve una referencia al objeto **DataSource** especificado por nombre.</span><span class="sxs-lookup"><span data-stu-id="851d8-127">Returns a reference to the specified **DataSource** object by name.</span></span>  <br/> |
   
## <a name="overview-of-the-datasource-class"></a><span data-ttu-id="851d8-128">Información general sobre la clase DataSource</span><span class="sxs-lookup"><span data-stu-id="851d8-128">Overview of the DataSource Class</span></span>

<span data-ttu-id="851d8-129">La clase [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) proporciona el método y las propiedades siguientes que los programadores de formularios pueden utilizar para interactuar con un origen de datos secundario de InfoPath.</span><span class="sxs-lookup"><span data-stu-id="851d8-129">The [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) class provides the following method and properties, which form developers can use to interact with an InfoPath secondary data source.</span></span> 
  
|<span data-ttu-id="851d8-130">**Nombre**</span><span class="sxs-lookup"><span data-stu-id="851d8-130">**Name**</span></span>|<span data-ttu-id="851d8-131">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="851d8-131">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="851d8-132">[CreateNavigator (método)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.CreateNavigator.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-132">[CreateNavigator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.CreateNavigator.aspx) method</span></span>  <br/> |<span data-ttu-id="851d8-133">Devuelve un [objeto XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) para obtener acceso al origen de datos y editarlo.</span><span class="sxs-lookup"><span data-stu-id="851d8-133">Returns an [XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) object for accessing and editing the data source</span></span>  <br/> |
|<span data-ttu-id="851d8-134">[QueryConnection (propiedad)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.QueryConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-134">[QueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.QueryConnection.aspx) property</span></span>  <br/> |<span data-ttu-id="851d8-135">Obtiene una referencia al objeto de conexión de datos asociado.</span><span class="sxs-lookup"><span data-stu-id="851d8-135">Gets a reference to the associated data connection object.</span></span>  <br/> <span data-ttu-id="851d8-136">Para ejecutar la consulta en la conexión de datos e insertar los datos devueltos como XML en el nodo XML asociado al **objeto DataSource,** use el método [Execute](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnection.Execute.aspx) del objeto de conexión de datos asociado.</span><span class="sxs-lookup"><span data-stu-id="851d8-136">To execute the query on the data connection and insert the returned data as XML into the XML node associated with the **DataSource** object, use the [Execute](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnection.Execute.aspx) method of the associated data connection object.</span></span>  <br/> |
|<span data-ttu-id="851d8-137">Propiedad [Name](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.Name.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-137">[Name](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.Name.aspx) property</span></span>  <br/> |<span data-ttu-id="851d8-138">Obtiene el nombre del objeto **DataSource**.</span><span class="sxs-lookup"><span data-stu-id="851d8-138">Gets the name of the **DataSource** object.</span></span>  <br/> |
|<span data-ttu-id="851d8-139">[ReadOnly (propiedad)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.ReadOnly.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-139">[ReadOnly](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.ReadOnly.aspx) property</span></span>  <br/> |<span data-ttu-id="851d8-140">Obtiene un valor que indica si el origen de datos está en un estado de sólo lectura.</span><span class="sxs-lookup"><span data-stu-id="851d8-140">Gets a value that indicates whether the data source is in a read-only state</span></span>  <br/> |
|<span data-ttu-id="851d8-141">[GetNamedNodeProperty (método)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.GetNamedNodeProperty.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-141">[GetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.GetNamedNodeProperty.aspx) method</span></span>  <br/> |<span data-ttu-id="851d8-142">Obtiene el valor de una propiedad con nombre para el nodo XML especificado, que debe ser un nodo **nonattribute** en el origen de datos principal.</span><span class="sxs-lookup"><span data-stu-id="851d8-142">Gets the value of a named property for the specified XML node, which must be a **nonattribute** node in the main data source.</span></span>  <br/> |
|<span data-ttu-id="851d8-143">[SetNamedNodeProperty (método)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.SetNamedNodeProperty.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-143">[SetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.SetNamedNodeProperty.aspx) method</span></span>  <br/> |<span data-ttu-id="851d8-144">Establece el valor de una propiedad con nombre para el nodo XML especificado, que deberá ser un nodo **nonattribute** en el origen de datos principal.</span><span class="sxs-lookup"><span data-stu-id="851d8-144">Sets the value of a named property for the specified XML node, which must be a **nonattribute** node in the main data source.</span></span>  <br/> |
   
## <a name="overview-of-the-data-connection-classes"></a><span data-ttu-id="851d8-145">Información general sobre las clases de conexión de datos</span><span class="sxs-lookup"><span data-stu-id="851d8-145">Overview of the Data Connection Classes</span></span>

<span data-ttu-id="851d8-p103">Las clases para obtener acceso a conexiones de datos ofrecen distintas propiedades y métodos que recuperan y envían datos a través de conexiones a orígenes de datos externos. La conexión de datos que se asocie a un objeto **DataSource** dependerá del tipo de conexión de datos externos que se utilice. InfoPath implementa las siguientes clases para obtener acceso a conexiones de datos.</span><span class="sxs-lookup"><span data-stu-id="851d8-p103">The classes for accessing data connections provide different properties and methods that retrieve and submit data through connections to external data sources; the data connection that is associated with a **DataSource** object is dependent on the type of external data connection. InfoPath implements the following classes for accessing data connections.</span></span> 
  
|<span data-ttu-id="851d8-148">**Nombre**</span><span class="sxs-lookup"><span data-stu-id="851d8-148">**Name**</span></span>|<span data-ttu-id="851d8-149">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="851d8-149">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="851d8-150">[Clase AdoQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-150">[AdoQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="851d8-151">Consulta un origen de datos ADO/OLEDB (sólo en Microsoft Access y Microsoft SQL Server).</span><span class="sxs-lookup"><span data-stu-id="851d8-151">Queries an ADO/OLEDB data source; limited to Microsoft Access and Microsoft SQL Server.</span></span>  <br/> |
|<span data-ttu-id="851d8-152">[Clase AdoSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoSubmitConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-152">[AdoSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="851d8-153">Envía un origen de datos ADO/OLEDB (sólo en Microsoft Access y Microsoft SQL Server).</span><span class="sxs-lookup"><span data-stu-id="851d8-153">Submits to an ADO/OLEDB data source; limited to Microsoft Access and Microsoft SQL Server.</span></span>  <br/> |
|<span data-ttu-id="851d8-154">[Clase SharePointListRWQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SharePointListRWQueryConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-154">[SharePointListRWQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SharePointListRWQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="851d8-155">Consulta una biblioteca de documentos o lista de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="851d8-155">Queries a SharePoint list or document library.</span></span>  <br/> |
|[<span data-ttu-id="851d8-156">SharePointListRWSubmitConnection</span><span class="sxs-lookup"><span data-stu-id="851d8-156">SharePointListRWSubmitConnection</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SharePointListRWSubmitConnection.aspx) <br/> |<span data-ttu-id="851d8-157">Se conecta a una biblioteca de documentos o una lista de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="851d8-157">Submits to a SharePoint list or document library.</span></span>  <br/> |
|<span data-ttu-id="851d8-158">[Clase WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-158">[WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="851d8-159">Se conecta a un servicio Web XML.</span><span class="sxs-lookup"><span data-stu-id="851d8-159">Connects to an XML Web service.</span></span>  <br/> |
|<span data-ttu-id="851d8-160">[Clase FileQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileQueryConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-160">[FileQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="851d8-161">Consulta un archivo XML.</span><span class="sxs-lookup"><span data-stu-id="851d8-161">Queries an XML file.</span></span>  <br/> |
|<span data-ttu-id="851d8-162">[Clase FileSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileSubmitConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-162">[FileSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="851d8-163">Envía un archivo XML.</span><span class="sxs-lookup"><span data-stu-id="851d8-163">Submits to an XML file.</span></span>  <br/> |
|<span data-ttu-id="851d8-164">[Clase EmailSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.EmailSubmitConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-164">[EmailSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.EmailSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="851d8-165">Envía un formulario como datos adjuntos en el correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="851d8-165">Submits a form as an attachment in email.</span></span>  <br/> |
|<span data-ttu-id="851d8-166">[Clase BdcQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcQueryConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-166">[BdcQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="851d8-167">Consulta una lista externa en un servidor que ejecuta SharePoint Foundation 2010 o SharePoint Server 2010.</span><span class="sxs-lookup"><span data-stu-id="851d8-167">Queries an external list on a server running SharePoint Foundation 2010 or SharePoint Server 2010.</span></span>  <br/> |
|<span data-ttu-id="851d8-168">[Clase BdcSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcSubmitConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="851d8-168">[BdcSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="851d8-169">Se envía a una lista externa en un servidor que ejecuta SharePoint Foundation 2010 o SharePoint Server 2010.</span><span class="sxs-lookup"><span data-stu-id="851d8-169">Submits to an external list on a server running SharePoint Foundation 2010 or SharePoint Server 2010.</span></span>  <br/> |
   
## <a name="using-the-datasourcecollection-and-the-datasource-classes"></a><span data-ttu-id="851d8-170">Uso de las clases DataSourceCollection DataSource</span><span class="sxs-lookup"><span data-stu-id="851d8-170">Using the DataSourceCollection and the DataSource Classes</span></span>

<span data-ttu-id="851d8-p104">Se tiene acceso al objeto **DataSourceCollection** que representa la colección de orígenes de datos asociada con una plantilla de formulario a través de la propiedad [DataSources](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataSources.aspx) de la clase [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) . Por ejemplo, si se crea un origen de datos secundario denominado Empleados que recupera datos de la tabla Empleados de la base de datos Neptuno, puede usar el objeto **DataSourceCollection** para establecer una referencia al objeto **DataSource** que representa los datos recuperados.</span><span class="sxs-lookup"><span data-stu-id="851d8-p104">The **DataSourceCollection** object that represents the collection of data sources associated with a form template is accessed through the [DataSources](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataSources.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class. For example, if you create a secondary data source named Employees that retrieves data from the Employees table in the Northwind database, you can use the **DataSourceCollection** object to set a reference to a **DataSource** object that represents the retrieved data.</span></span> 
  
<span data-ttu-id="851d8-p105">En el ejemplo de código siguiente, el nombre del origen de datos secundarios se pasa a la propiedad descriptor de acceso de la clase **DataSourceCollection**, que devuelve una referencia al objeto **DataSource** que representa los datos de la tabla Empleados recuperados. En nodo XML que almacena los datos recuperados del origen de datos secundario se muestra en un cuadro de diálogo usando el método **CreateNavigator** de la clase **DataSource** para tener acceso a la propiedad **InnerXml** de la clase **XPathNavigator**.</span><span class="sxs-lookup"><span data-stu-id="851d8-p105">In the following code sample, the name of the secondary data source is passed to the accessor property of the **DataSourceCollection** class, which returns a reference to the **DataSource** object that represents the retrieved Employees table data. The XML node that stores the retrieved data from the secondary data source is displayed in a message box using the **CreateNavigator** method of the **DataSource** class to access the **InnerXml** property of the **XPathNavigator** class.</span></span> 
  
```cs
// Instantiate a variable to access the specified data source
// from the DataSourceCollection of the form.
DataSource myDataSource = 
   this.DataSources["Employees"];
// Display the XML data from the secondary data source.
MessageBox.Show("Data source data: " +
   myDataSource.CreateNavigator().InnerXml.ToString());
```

```vb
' Instantiate a variable to access the specified data source
' from the DataSourceCollection of the form.
Dim myDataSource As DataSource = _
   Me.DataSources("Employees")
' Display the XML data from the secondary data source.
MessageBox.Show("Data source data: " &amp; _
   myDataSource.CreateNavigator().InnerXml.ToString())
```

<span data-ttu-id="851d8-175">Para manipular los datos contenidos en un origen de datos secundario, utilice el método **CreateNavigator** de la clase **DataSource** para devolver una referencia a un objeto **XPathNavigator** situado en el nodo en el que se almacenan los datos secundarios.</span><span class="sxs-lookup"><span data-stu-id="851d8-175">To manipulate the data that is contained in a secondary data source, use the **CreateNavigator** method of the **DataSource** class to return a reference to an **XPathNavigator** object positioned at the node where the secondary data is stored.</span></span> <span data-ttu-id="851d8-176">Puede usar las propiedades o los métodos de la clase **XPathNavigator** para manipular los datos.</span><span class="sxs-lookup"><span data-stu-id="851d8-176">You can use the properties or methods of the **XPathNavigator** class to manipulate the data.</span></span> <span data-ttu-id="851d8-177">Para obtener más información, [vea Trabajar con las clases XPathNavigator y XPathNodeIterator](how-to-work-with-the-xpathnavigator-and-xpathnodeiterator-classes.md).</span><span class="sxs-lookup"><span data-stu-id="851d8-177">For more information, see [Work with the XPathNavigator and XPathNodeIterator Classes](how-to-work-with-the-xpathnavigator-and-xpathnodeiterator-classes.md).</span></span>
  
## <a name="using-the-dataconnectioncollection-and-the-dataconnection-classes"></a><span data-ttu-id="851d8-178">Uso de las clases DataSourceCollection y DataConnection</span><span class="sxs-lookup"><span data-stu-id="851d8-178">Using the DataConnectionCollection and the DataConnection Classes</span></span>

<span data-ttu-id="851d8-p107">El objeto [DataConnectionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnectionCollection.aspx) que representa las conexiones de datos asociadas con una plantilla de formulario a través de la propiedad [DataConnections](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataConnections.aspx) de la clase **XmlForm**. Por ejemplo, si crea un origen de datos secundario llamado Empleados que recupera datos de la tabla Empleados de la base de datos Neptuno, puede usar el objeto **DataConnectionCollection** asociado a la plantilla de formulario para establecer una referencia a la **DataConnection** que representa la conexión con la base de datos.</span><span class="sxs-lookup"><span data-stu-id="851d8-p107">The [DataConnectionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnectionCollection.aspx) object that represents the collection of data connections associated with a form template is accessed through the [DataConnections](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataConnections.aspx) property of the **XmlForm** class. For example, if you create a secondary data source named Employees that retrieves data from the Employees table in the Northwind database, you can use the **DataConnectionCollection** object associated with the form template to set a reference to the **DataConnection** that represents the connection to the database.</span></span> 
  
<span data-ttu-id="851d8-p108">En el siguiente ejemplo de código, el nombre del origen de datos secundario se pasa a la propiedad descriptor de acceso de la clase **DataConnectionCollection**, que en este caso devuelve una referencia al objeto **ADOQueryConnection** que representa la conexión a la base de datos Neptuno. Para que esto funcione correctamente, debe convertir explícitamente el objeto devuelto en tipo **ADOQueryConnection**. La propiedad [Connection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.Connection.aspx) de la interfaz **ADOAdapterObject** se utiliza para mostrar la cadena de conexión ADO en un cuadro de mensaje.</span><span class="sxs-lookup"><span data-stu-id="851d8-p108">In the following code sample, the name of the secondary data source is passed to the accessor property of the **DataConnectionCollection** class, which, in this case, returns a reference to the **ADOQueryConnection** object that represents the connection to the Northwind database. For this to work properly, you must explicitly cast the object being returned to the **ADOQueryConnection** type. The [Connection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.Connection.aspx) property of the **ADOAdapterObject** interface is used to display the ADO connection string in a message box.</span></span> 
  
```cs
// Instantiate a variable to access the specified data connection
// from the DataConnectionCollection of the form. 
// You must cast to the specific data connection type
// (ADOQueryConnection) before you can access the data connection.
ADOQueryConnection myADOConnection = 
   (ADOQueryConnection)this.DataConnections["Employees"];
// Display the connection information for the data connection.
MessageBox.Show("Connection string: " + myADOConnection.Connection);
```

```vb
' Instantiate a variable to access the specified data connection
' from the DataConnectionCollection of the form. 
' You must cast to the specific data connection type
' (ADOQueryConnection) before you can access the data connection.
Dim myADOConnection As ADOQueryConnection = _
   DirectCast(Me.DataConnections("Employees"), ADOQueryConnection)
' Display the connection information for the data connection.
MessageBox.Show("Connection string: " &amp; myADOConnection.Connection)
```

## <a name="see-also"></a><span data-ttu-id="851d8-184">Vea también</span><span class="sxs-lookup"><span data-stu-id="851d8-184">See also</span></span>



[<span data-ttu-id="851d8-185">Crear plantillas de formulario de InfoPath que funcionan con InfoPath Forms Services</span><span class="sxs-lookup"><span data-stu-id="851d8-185">Creating InfoPath Form Templates That Work With InfoPath Forms Services</span></span>](creating-infopath-form-templates-that-work-with-infopath-forms-services.md)

