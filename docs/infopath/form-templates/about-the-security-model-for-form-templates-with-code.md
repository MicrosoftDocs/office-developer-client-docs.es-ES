---
title: Acerca del modelo de seguridad de las plantillas de formulario con código
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- infopath 2007, security,code access security [InfoPath 2007],security [InfoPath 2007], security model for managed code,security [InfoPath 2007], levels,CAS [InfoPath 2007],InfoPath 2003-compatible form templates, security,permissions [InfoPath 2007]
localization_priority: Normal
ms.assetid: 5e1c1c72-f98d-4871-9c57-82c315277aa1
description: Las plantillas de formulario con código administrado de InfoPath admiten los mismos niveles de seguridad que las secuencias de comandos que se ejecutan en las plantillas de formulario no administradas; también admiten funciones de seguridad adicionales para el acceso al código que se aplican al código administrado que se ejecuta en common language runtime (CLR) de .NET Framework.
ms.openlocfilehash: cfeb2117232d041cef43d282ff5aab482609f512
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19815854"
---
# <a name="about-the-security-model-for-form-templates-with-code"></a><span data-ttu-id="2e2ed-104">Acerca del modelo de seguridad de las plantillas de formulario con código</span><span class="sxs-lookup"><span data-stu-id="2e2ed-104">About the Security Model for Form Templates with Code</span></span>

<span data-ttu-id="2e2ed-105">Las plantillas de formulario con código administrado de InfoPath admiten los mismos niveles de seguridad que las secuencias de comandos que se ejecutan en las plantillas de formulario no administradas; también admiten funciones de seguridad adicionales para el acceso al código que se aplican al código administrado que se ejecuta en common language runtime (CLR) de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-105">InfoPath managed code form templates support the same security levels as script running in unmanaged form templates, and they also support additional code access security features that apply to managed code running under the common language runtime (CLR) of the .NET Framework.</span></span>
  
## <a name="infopath-managed-object-model-security-levels"></a><span data-ttu-id="2e2ed-106">Niveles de seguridad del modelo de objetos administrado de InfoPath</span><span class="sxs-lookup"><span data-stu-id="2e2ed-106">InfoPath Managed Object Model Security Levels</span></span>

<span data-ttu-id="2e2ed-107">En la tabla siguiente, se describe la relación entre los niveles de seguridad para los miembros del modelo de objetos de secuencia de comandos y el conjunto de permisos correspondiente que se pide para cada nivel cuando el miembro del modelo de objetos se usa en una plantilla de formulario de código administrado.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-107">The following table describes the relationship between the security levels for script object model members and the corresponding permission set that is demanded for each level when the object model member is used in a managed code form template.</span></span>
  
|<span data-ttu-id="2e2ed-108">**Nivel de seguridad del modelo de objetos**</span><span class="sxs-lookup"><span data-stu-id="2e2ed-108">**Object Model Security Level**</span></span>|<span data-ttu-id="2e2ed-109">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="2e2ed-109">**Description**</span></span>|<span data-ttu-id="2e2ed-110">**Conjunto de permisos exigido**</span><span class="sxs-lookup"><span data-stu-id="2e2ed-110">**Permission Set Demanded**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="2e2ed-111">0</span><span class="sxs-lookup"><span data-stu-id="2e2ed-111">0</span></span>  <br/> |<span data-ttu-id="2e2ed-112">Se puede tener acceso sin restricciones.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-112">Can be accessed without restrictions.</span></span>  <br/> |<span data-ttu-id="2e2ed-113">Ninguna</span><span class="sxs-lookup"><span data-stu-id="2e2ed-113">None</span></span>  <br/> |
|<span data-ttu-id="2e2ed-114">2</span><span class="sxs-lookup"><span data-stu-id="2e2ed-114">2</span></span>  <br/> |<span data-ttu-id="2e2ed-115">Sólo pueden tener acceso los formularios que se ejecuten en el mismo dominio que el formulario abierto actualmente o los formularios a los que se haya concedido permisos entre dominios.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-115">Can be accessed only by forms running in the same domain as the currently open form, or by forms that have been granted cross-domain permissions.</span></span>  <br/> |<span data-ttu-id="2e2ed-116">Ninguna</span><span class="sxs-lookup"><span data-stu-id="2e2ed-116">None</span></span>  <br/> |
|<span data-ttu-id="2e2ed-117">3</span><span class="sxs-lookup"><span data-stu-id="2e2ed-117">3</span></span>  <br/> |<span data-ttu-id="2e2ed-118">Sólo pueden obtener acceso los formularios de plena confianza.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-118">Can be accessed only by fully trusted forms.</span></span>  <br/> |<span data-ttu-id="2e2ed-119">Plena confianza</span><span class="sxs-lookup"><span data-stu-id="2e2ed-119">FullTrust</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="2e2ed-120">El servidor COM de InfoPath actual no utiliza el nivel de seguridad "1", que se reserva para su uso futuro.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-120">The security level "1" is not used by the current InfoPath COM server and is reserved for future use.</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="2e2ed-121">[!IMPORTANTE] Aunque los niveles 0 y 2 del modelo de objetos no exigen ningún conjunto de permisos, porque contienen código administrado, se comportan tal como se definió para el nivel de seguridad de acceso al dominio que se describe en la sección siguiente.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-121">Even though object model levels 0 and 2 do not demand any permission set, because they contain managed code, they behave as defined for the Domain domain access security level that is described in the following section.</span></span> 
  
<span data-ttu-id="2e2ed-122">El nivel de seguridad de cada miembro del modelo de objetos que expone el ensamblado de interoperabilidad Microsoft.Office.InfoPath y Microsoft.Office.Interop.InfoPath.SemiTrust se especifica en la sección Comentarios del tema que documenta ese miembro del espacio de nombres [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) y [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) .</span><span class="sxs-lookup"><span data-stu-id="2e2ed-122">The security level of each object model member exposed by the Microsoft.Office.InfoPath and Microsoft.Office.Interop.InfoPath.SemiTrust assemblies is specified in the Remarks section of the topic that documents that member in the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) and [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) namespaces.</span></span> 
  
## <a name="infopath-domain-access-security-levels"></a><span data-ttu-id="2e2ed-123">Niveles de seguridad para el acceso al dominio de InfoPath</span><span class="sxs-lookup"><span data-stu-id="2e2ed-123">InfoPath Domain Access Security Levels</span></span>

<span data-ttu-id="2e2ed-p101">En combinación con los niveles de seguridad del modelo de objetos cuyo cumplimiento exige el servidor COM que expone la aplicación InfoPath, ésta define tres niveles de seguridad cuya aplicación depende de la ubicación de la plantilla de formulario, de cómo se haya implementado y de las opciones que se hayan configurado en el modo de diseño. Estos tres niveles de seguridad se definen en la tabla siguiente:</span><span class="sxs-lookup"><span data-stu-id="2e2ed-p101">In conjunction with the object model security levels that are enforced by the COM server exposed by the InfoPath application, InfoPath defines three security levels that are applied depending on where the form template is located, how the form is deployed, and settings configured in design mode. These three security levels are defined in the following table.</span></span>
  
|<span data-ttu-id="2e2ed-126">**Nivel de seguridad de acceso al dominio**</span><span class="sxs-lookup"><span data-stu-id="2e2ed-126">**Domain Access Security Level**</span></span>|<span data-ttu-id="2e2ed-127">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="2e2ed-127">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="2e2ed-128">Restringido</span><span class="sxs-lookup"><span data-stu-id="2e2ed-128">Restricted</span></span>  <br/> |<span data-ttu-id="2e2ed-129">No se permite ninguna comunicación fuera de la plantilla de formulario.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-129">Does not permit any communication outside of the form template.</span></span> <span data-ttu-id="2e2ed-130">Este nivel de seguridad está concebido para impedir que los formularios dañinos transmitan datos desde su PC a un atacante malintencionado.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-130">This security level is intended to prevent harmful forms from transmitting any data from your computer to a malicious attacker.</span></span> <span data-ttu-id="2e2ed-131">Cuando se ejecuta en este modo de seguridad, las características siguientes no funcionarán: panel de tareas personalizado, las conexiones de datos (excepto el envío de correo electrónico), los controles ActiveX, código de formulario de código administrado, funciones y flujo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-131">When running in this security mode, the following features will not work: Custom Task Pane, Data Connections (except email submit), ActiveX controls, managed code form code, Roles, and Workflow.</span></span> <span data-ttu-id="2e2ed-132">Administra el formulario con código plantillas no se pueden ejecutar en el dominio restringido.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-132">Managed code form templates cannot run in the Restricted domain.</span></span> <span data-ttu-id="2e2ed-133">Cuando se establece una plantilla de formulario de código administrado a la configuración de **determinar automáticamente el nivel de seguridad** en la categoría **seguridad y confianza** del cuadro de diálogo **Opciones de formulario** , la plantilla de formulario siempre requiere al menos el acceso de seguridad de dominio nivel para ejecutar el código.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-133">When a managed code form template is set to the **Automatically determine security level** setting in the **Security and Trust** category of the **Form Options** dialog box, the form template will always require at least the Domain security access level to run code.</span></span>  <br/><br/><span data-ttu-id="2e2ed-134">**Importante**: el ensamblado de código administrado creado para una plantilla de formulario de código administrado no se carga y se ejecutarán cuando un formulario se abre desde un dominio restringido, por ejemplo, desde un formulario de InfoPath enviado como datos adjuntos de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-134">**IMPORTANT**: The managed code assembly created for a managed code form template will not load and run when a form is opened from a Restricted domain, for example, from an InfoPath form sent as an email attachment.</span></span> <span data-ttu-id="2e2ed-135">Cualquier plantilla de formulario que desea implementar como datos adjuntos de correo electrónico debe omitir las características enumeradas anteriormente, y si la plantilla de formulario contiene código de formulario, código de formulario debe estar implementado en JScript o VBScript y sólo debe utilizar a miembros del modelo de objeto con un nivel de seguridad de 0 (cero) .</span><span class="sxs-lookup"><span data-stu-id="2e2ed-135">Any form template you wish to deploy as an email attachment must omit the features listed above, and if the form template contains form code, form code must be implemented in JScript or VBScript, and must only utilize object model members with a security level of 0 (zero).</span></span>           |
|<span data-ttu-id="2e2ed-136">Dominio</span><span class="sxs-lookup"><span data-stu-id="2e2ed-136">Domain</span></span>  <br/> |<span data-ttu-id="2e2ed-p104">Restringe un formulario basándose en su ubicación en una de las zonas de seguridad que define Microsoft Internet Explorer. Por ejemplo, si el formulario está ubicado en la zona Intranet local, se puede comunicar con otros datos dentro de su propio dominio pero no le está permitido recuperar datos de otros dominios. La ubicación en una zona de seguridad de Microsoft Internet Explorer también determina si se permite la ejecución de controles ActiveX marcados como no seguros para las secuencias de comandos.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-p104">Restricts a form based on its location in one of the security zones defined by Microsoft Internet Explorer. For example, if the form is located in the Local Intranet zone, it is allowed to communicate with other data inside its own domain but it is not permitted to retrieve data from other domains. The location in a Microsoft Internet Explorer security zone also determines whether ActiveX controls that are marked as unsafe for scripting will be allowed to run.</span></span>  <br/> |
|<span data-ttu-id="2e2ed-140">Plena confianza</span><span class="sxs-lookup"><span data-stu-id="2e2ed-140">Full Trust</span></span>  <br/> |<span data-ttu-id="2e2ed-p105">Permite ejecutar un formulario de plena confianza en el equipo en el que se va a utilizar. Este nivel de seguridad sólo se puede utilizar al trabajar con formularios firmados digitalmente con una firma que proceda de un emisor raíz que haya sido registrado como de confianza en el equipo, o bien creando un programa que instale el formulario y establezca el valor "sí" en el atributo **requireFullTrust** del elemento **xDocumentClass** en el archivo de definición del formulario (.xsf). Con esta configuración, el formulario puede obtener acceso a las llamadas al modelo de objetos que requieren el nivel de seguridad 3, como las propiedades y los métodos que tienen acceso al sistema de archivos; asímismo se pueden deshabilitar determinadas preguntas relacionadas con la seguridad que aparecen durante la ejecución en un nivel más restrictivo.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-p105">Allows you to run a form with full trust on the computer where the form will be used. This security level can only be used when working with a form that is digitally signed with a signature that matches a trusted root publisher on your computer, or by creating an installation program that installs the form and sets the **requireFullTrust** attribute of the **xDocumentClass** element to "yes" in the form definition file (.xsf). By using this setting, your form can access object model calls that require object model security level 3, such as properties and methods that access the file system, and you can disable certain security prompts that appear when running at a more restrictive security level.  </span></span><br/> |
   
<span data-ttu-id="2e2ed-144">De manera predeterminada, los formularios de InfoPath están configurados para seleccionar automáticamente el nivel de seguridad Restringido o Dominio según las funciones que utilice la plantilla de formulario y la forma y la ubicación en que se implemente la misma.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-144">By default, an InfoPath form is configured to select automatically either the Restricted or Domain security level depending on the features that are being used in the form template, and where and how the form template is deployed.</span></span> <span data-ttu-id="2e2ed-145">Por ejemplo, una plantilla de formulario implementada como datos adjuntos de correo electrónico se configura automáticamente el nivel de seguridad restringido.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-145">For example, a form template deployed as an email attachment is automatically configured to the Restricted security level.</span></span> <span data-ttu-id="2e2ed-146">La configuración de seguridad es lo más restrictiva posible, empezando por Restringido, para garantizar un nivel de protección mayor para el usuario y sus datos.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-146">The security setting is always as restrictive as possible, starting at Restricted, to ensure a greater level of protection for you and your data.</span></span> <span data-ttu-id="2e2ed-147">Cuando una plantilla de formulario que contiene código administrado se configura para seleccionar automáticamente el nivel de seguridad, siempre requerirá al menos el nivel de seguridad de acceso al dominio para ejecutar el código.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-147">When a form template that contains managed code is set to automatically select the security level, the form template will always require at least the Domain security access level before code can run.</span></span> <span data-ttu-id="2e2ed-148">Puede invalidar manualmente esta configuración en tiempo de diseño para seleccionar un nivel de seguridad más apropiado para el formulario mediante el siguiente procedimiento.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-148">You can manually override this setting at design time to select a level of security that is more appropriate for the form by using the following procedure.</span></span> 
  
### <a name="specify-a-forms-security-level"></a><span data-ttu-id="2e2ed-149">Especificar el nivel de seguridad de un formulario</span><span class="sxs-lookup"><span data-stu-id="2e2ed-149">Specify a form's security level</span></span>

1. <span data-ttu-id="2e2ed-150">Abra el formulario en el diseñador de formularios de InfoPath, haga clic en la pestaña **Archivo**, haga clic en **Información** y, a continuación, haga clic en **Opciones de formulario**.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-150">Open the form in the InfoPath form designer, click the **File** tab, click **Info**, and then click **Form Options**.</span></span>
    
2. <span data-ttu-id="2e2ed-151">En el cuadro de diálogo **Opciones de formulario**, haga clic en la categoría **Seguridad y confianza**.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-151">In the **Form Options** dialog box, click the **Security and Trust** category.</span></span> 
    
3. <span data-ttu-id="2e2ed-152">Desactive la casilla de verificación **Determina automáticamente el nivel de seguridad (recomendado)**.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-152">Clear the **Automatically determine security level (recommended)** check box.</span></span> 
    
4. <span data-ttu-id="2e2ed-153">Seleccione el nivel de seguridad deseado.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-153">Select the desired security level.</span></span>
    
> [!NOTE] 
> - <span data-ttu-id="2e2ed-154">Si selecciona el nivel de seguridad **Restringido** para una plantilla de formulario con código administrado, el código que está detrás del formulario no se cargará ni se ejecutará, con independencia de los miembros del modelo de objetos que utilice.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-154">If you the select the **Restricted** security level for a managed code form template, the code behind the form will not load and run regardless of which object model members are used in the form code.</span></span> <span data-ttu-id="2e2ed-155">Este nivel de seguridad está diseñado principalmente para los formularios de InfoPath que se implementan mediante correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-155">This security level is primarily designed for InfoPath forms that are deployed using email.</span></span>     
> - <span data-ttu-id="2e2ed-156">Si selecciona el nivel de seguridad **Plena confianza**, necesita firmar digitalmente el formulario o instalar y registrarlo.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-156">If you select the **Full Trust** security level, you need to digitally sign or install and register the form.</span></span> <span data-ttu-id="2e2ed-157">Para obtener más información, vea [Implementar plantillas de formulario de InfoPath con código](how-to-deploy-infopath-form-templates-with-code.md).</span><span class="sxs-lookup"><span data-stu-id="2e2ed-157">For more information, see [Deploy InfoPath Form Templates with Code](how-to-deploy-infopath-form-templates-with-code.md).</span></span>
    
<span data-ttu-id="2e2ed-p109">La tabla siguiente resume el modelo de seguridad de InfoPath. La primera columna contiene la lista de niveles requeridos o especificados para los formularios. La segunda y tercera columnas especifican si el formulario tiene un identificador URN o URL para su ubicación. Las columnas siguientes especifican lo que está permitido ejecutar. Para obtener más información sobre escenarios de implementación y conjuntos de permisos para las plantillas de formulario con código administrado, consulte la sección "Funciones de seguridad para el acceso al código de Common Language Runtime" de este tema.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-p109">The following table summarizes the InfoPath security model. The first column lists the level specified for or required by the form. The second and third columns specify whether the form has a URN or URL identifier for its location. The remaining columns specify what is allowed to run. For more information on deployment scenarios and permission sets for managed code form templates, see the "Common Language Runtime Code Access Security Features" section later in this topic.</span></span>
  
|<span data-ttu-id="2e2ed-163">**Nivel que requiere el formulario**</span><span class="sxs-lookup"><span data-stu-id="2e2ed-163">**Level Required by form**</span></span>|<span data-ttu-id="2e2ed-164">**Tiene un identificador URN**</span><span class="sxs-lookup"><span data-stu-id="2e2ed-164">**Has URN Identifier**</span></span>|<span data-ttu-id="2e2ed-165">**Tiene un identificador URL**</span><span class="sxs-lookup"><span data-stu-id="2e2ed-165">**Has URL Identifier**</span></span>|<span data-ttu-id="2e2ed-166">**ActiveX marcado como no seguro para scripting**</span><span class="sxs-lookup"><span data-stu-id="2e2ed-166">**ActiveX marked unsafe for scripting**</span></span>|<span data-ttu-id="2e2ed-167">**Acceso entre dominios**</span><span class="sxs-lookup"><span data-stu-id="2e2ed-167">**Cross-Domain Access**</span></span>|<span data-ttu-id="2e2ed-168">**Código administrado**</span><span class="sxs-lookup"><span data-stu-id="2e2ed-168">**Managed code**</span></span>|<span data-ttu-id="2e2ed-169">**Seguridad del modelo de objetos**</span><span class="sxs-lookup"><span data-stu-id="2e2ed-169">**Object Model Security**</span></span>|
|:-----|:-----|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="2e2ed-170">Restringido</span><span class="sxs-lookup"><span data-stu-id="2e2ed-170">Restricted</span></span>  <br/> ||<span data-ttu-id="2e2ed-171">X</span><span class="sxs-lookup"><span data-stu-id="2e2ed-171">X</span></span>  <br/> |<span data-ttu-id="2e2ed-172">Sin ActiveX</span><span class="sxs-lookup"><span data-stu-id="2e2ed-172">No ActiveX at all</span></span>  <br/> |<span data-ttu-id="2e2ed-173">Error</span><span class="sxs-lookup"><span data-stu-id="2e2ed-173">Fail</span></span>  <br/> |<span data-ttu-id="2e2ed-174">El formulario se carga, pero no se ejecuta el código administrado</span><span class="sxs-lookup"><span data-stu-id="2e2ed-174">Form loads, but managed code won't run</span></span>  <br/> |<span data-ttu-id="2e2ed-175">0</span><span class="sxs-lookup"><span data-stu-id="2e2ed-175">0</span></span>  <br/> |
|<span data-ttu-id="2e2ed-176">Dominio (zona de Internet Explorer **Sitios restringidos**)</span><span class="sxs-lookup"><span data-stu-id="2e2ed-176">Domain (Internet Explorer **Restricted sites** zone)</span></span>  <br/> |<span data-ttu-id="2e2ed-177">No se ejecutará</span><span class="sxs-lookup"><span data-stu-id="2e2ed-177">Won't run at all</span></span>  <br/> |<span data-ttu-id="2e2ed-178">No se ejecutará</span><span class="sxs-lookup"><span data-stu-id="2e2ed-178">Won't run at all</span></span>  <br/> |<span data-ttu-id="2e2ed-179">No se ejecutará</span><span class="sxs-lookup"><span data-stu-id="2e2ed-179">Won't run at all</span></span>  <br/> |<span data-ttu-id="2e2ed-180">No se ejecutará</span><span class="sxs-lookup"><span data-stu-id="2e2ed-180">Won't run at all</span></span>  <br/> |<span data-ttu-id="2e2ed-181">No se ejecutará</span><span class="sxs-lookup"><span data-stu-id="2e2ed-181">Won't run at all</span></span>  <br/> |<span data-ttu-id="2e2ed-182">No se ejecutará</span><span class="sxs-lookup"><span data-stu-id="2e2ed-182">Won't run at all</span></span>  <br/> |
|<span data-ttu-id="2e2ed-183">Dominio (zona de Internet Explorer **Internet**)</span><span class="sxs-lookup"><span data-stu-id="2e2ed-183">Domain (Internet Explorer **Internet** zone)</span></span>  <br/> |<span data-ttu-id="2e2ed-184">X</span><span class="sxs-lookup"><span data-stu-id="2e2ed-184">X</span></span>  <br/> ||<span data-ttu-id="2e2ed-185">Error</span><span class="sxs-lookup"><span data-stu-id="2e2ed-185">Fail</span></span>  <br/> |<span data-ttu-id="2e2ed-186">Error</span><span class="sxs-lookup"><span data-stu-id="2e2ed-186">Fail</span></span>  <br/> |<span data-ttu-id="2e2ed-187">No se ejecutará</span><span class="sxs-lookup"><span data-stu-id="2e2ed-187">Won't run at all</span></span>  <br/> |<span data-ttu-id="2e2ed-188">0</span><span class="sxs-lookup"><span data-stu-id="2e2ed-188">0</span></span>  <br/> |
|<span data-ttu-id="2e2ed-189">Dominio (zona de Internet Explorer **Intranet local**)</span><span class="sxs-lookup"><span data-stu-id="2e2ed-189">Domain (Internet Explorer **Local intranet** zone)</span></span>  <br/> |<span data-ttu-id="2e2ed-190">X</span><span class="sxs-lookup"><span data-stu-id="2e2ed-190">X</span></span>  <br/> ||<span data-ttu-id="2e2ed-191">Error</span><span class="sxs-lookup"><span data-stu-id="2e2ed-191">Fail</span></span>  <br/> |<span data-ttu-id="2e2ed-192">Preguntar</span><span class="sxs-lookup"><span data-stu-id="2e2ed-192">Prompt</span></span>  <br/> |<span data-ttu-id="2e2ed-193">El código administrado se ejecuta con permisos de **Intranet local**.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-193">Managed code runs with **Local intranet** permissions.</span></span>  <br/> |<span data-ttu-id="2e2ed-194">2</span><span class="sxs-lookup"><span data-stu-id="2e2ed-194">2</span></span>  <br/> |
|<span data-ttu-id="2e2ed-195">Dominio (zona de **Sitios de confianza** de Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="2e2ed-195">Domain (Internet Explorer **Trusted sites** zone)</span></span>  <br/> |<span data-ttu-id="2e2ed-196">X</span><span class="sxs-lookup"><span data-stu-id="2e2ed-196">X</span></span>  <br/> ||<span data-ttu-id="2e2ed-197">Preguntar</span><span class="sxs-lookup"><span data-stu-id="2e2ed-197">Prompt</span></span>  <br/> |<span data-ttu-id="2e2ed-198">Aceptar</span><span class="sxs-lookup"><span data-stu-id="2e2ed-198">OK</span></span>  <br/> |<span data-ttu-id="2e2ed-p110">El código administrado se ejecuta con permisos de **Internet**. Está permitido el acceso entre dominios. Tenga en cuenta que aunque el formulario se encuentre en la zona **Sitios de confianza**, se aplican los permisos de la zona **Internet**.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-p110">Managed code runs with **Internet** permissions. Cross-domain access is allowed. Note that even though the form is in the **Trusted sites** zone, **Internet** zone permissions are applied.  </span></span><br/> |<span data-ttu-id="2e2ed-202">2</span><span class="sxs-lookup"><span data-stu-id="2e2ed-202">2</span></span>  <br/> |
|<span data-ttu-id="2e2ed-203">Dominio (zona de **Equipo local** de Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="2e2ed-203">Domain (Internet Explorer **Local computer** zone)</span></span>  <br/> |<span data-ttu-id="2e2ed-204">X</span><span class="sxs-lookup"><span data-stu-id="2e2ed-204">X</span></span>  <br/> |<span data-ttu-id="2e2ed-205">X</span><span class="sxs-lookup"><span data-stu-id="2e2ed-205">X</span></span>  <br/> |<span data-ttu-id="2e2ed-206">Preguntar</span><span class="sxs-lookup"><span data-stu-id="2e2ed-206">Prompt</span></span>  <br/> |<span data-ttu-id="2e2ed-207">Error</span><span class="sxs-lookup"><span data-stu-id="2e2ed-207">Fail</span></span>  <br/> |<span data-ttu-id="2e2ed-208">El código administrado se ejecuta con permisos de **Intranet local**.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-208">Managed code runs with **Local intranet** permissions.</span></span>  <br/> |<span data-ttu-id="2e2ed-209">2</span><span class="sxs-lookup"><span data-stu-id="2e2ed-209">2</span></span>  <br/> |
|<span data-ttu-id="2e2ed-210">Plena confianza</span><span class="sxs-lookup"><span data-stu-id="2e2ed-210">Full Trust</span></span>  <br/> |<span data-ttu-id="2e2ed-211">X</span><span class="sxs-lookup"><span data-stu-id="2e2ed-211">X</span></span>  <br/> |<span data-ttu-id="2e2ed-212">X</span><span class="sxs-lookup"><span data-stu-id="2e2ed-212">X</span></span>  <br/> |<span data-ttu-id="2e2ed-213">Aceptar</span><span class="sxs-lookup"><span data-stu-id="2e2ed-213">OK</span></span>  <br/> |<span data-ttu-id="2e2ed-214">Aceptar</span><span class="sxs-lookup"><span data-stu-id="2e2ed-214">OK</span></span>  <br/> |<span data-ttu-id="2e2ed-215">Plena confianza</span><span class="sxs-lookup"><span data-stu-id="2e2ed-215">Full Trust</span></span>  <br/> |<span data-ttu-id="2e2ed-216">3</span><span class="sxs-lookup"><span data-stu-id="2e2ed-216">3</span></span>  <br/> |
   
> [!IMPORTANT]
> <span data-ttu-id="2e2ed-p111">[!IMPORTANTE] Las descripciones anteriores de las columnas "ActiveX marcado como no seguro para las secuencias de comandos" y "Acceso entre dominios" suponen que la configuración de seguridad es la predeterminada para Microsoft Internet Explorer. Si un usuario modifica la configuración de seguridad, el comportamiento de InfoPath variará en consecuencia. Por ejemplo, si en la zona **Intranet local**, **Tener acceso a origen de datos entre dominios** está **Habilitado**, no se pedirá a los usuarios que permitan el acceso entre dominios tal como se describe en la tabla.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-p111">The descriptions above in the "ActiveX marked unsafe for scripting" and "Cross-Domain Access" columns assume the default security settings for Microsoft Internet Explorer. If a user changes their security settings, InfoPath will behave accordingly. For example, if in the **Local intranet** zone, **Access data sources across domains** is set to **Enable**, then users will not be prompted to allow cross-domain access as described in the table.</span></span> 
  
## <a name="common-language-runtime-code-access-security-features"></a><span data-ttu-id="2e2ed-220">Funciones de seguridad para el acceso al código de Common Language Runtime</span><span class="sxs-lookup"><span data-stu-id="2e2ed-220">Common Language Runtime Code Access Security Features</span></span>

<span data-ttu-id="2e2ed-221">Al compilar una plantilla de formulario con código administrado de InfoPath, se crea un ensamblado privado que contiene la implementación de la lógica del código de formulario.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-221">When an InfoPath managed code form template is compiled, a private managed code assembly is created that contains the implementation of the form code logic.</span></span>
  
<span data-ttu-id="2e2ed-p112">De manera predeterminada en .NET Framework, un ensamblado de código administrado tiene permisos de plena confianza cuando se ejecuta en un equipo local y no los tiene cuando se ejecuta en la Intranet. Para ofrecer un control más fino en la directiva de seguridad y la opción de ejecutar plantillas de formulario con código administrado de InfoPath como plantillas de plena confianza desde la Intranet, InfoPath implementa la siguiente arquitectura de seguridad.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-p112">In the .NET Framework, by default, a managed code assembly has Full Trust permissions when running on the local machine, and is not granted Full Trust permissions when running on the Intranet. To provide more fine-grained control over security policy, and to provide the option to run InfoPath managed code form templates as fully trusted forms from the Intranet, InfoPath implements the following security architecture.</span></span>
  
- <span data-ttu-id="2e2ed-224">La aplicación InfoPath hospeda Common Language Runtime (CLR) de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-224">The InfoPath application hosts the .NET Framework common language runtime (CLR).</span></span>
    
- <span data-ttu-id="2e2ed-225">Dentro del CLR que hospeda InfoPath, cada plantilla de formulario con código administrado se ejecuta en un dominio de aplicación separado, que es un entorno que proporciona aislamiento, descargas y límites de seguridad para la ejecución de código administrado.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-225">Within the CLR hosted by InfoPath, each managed code form template runs in a separate application domain, which is an environment that provides isolation, unloading, and security boundaries for executing managed code.</span></span>
    
- <span data-ttu-id="2e2ed-226">InfoPath establece, en el dominio de la aplicación, una directiva de seguridad predeterminada que depende del nivel de confianza asociado a la plantilla de formulario y la dirección URL de su ubicación.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-226">InfoPath sets a default security policy on the application domain depending on the level of trust associated with the form template and the URL of its location.</span></span>
    
- <span data-ttu-id="2e2ed-p113">De manera predeterminada, una plantilla de código administrado que se ejecuta en un equipo local (el grupo de código de la zona Mi equipo) obtiene un nivel de permisos menor que plena confianza (permisos de la zona Intranet local). Para tener permisos de plena confianza, el formulario se debe registrar o estar firmado digitalmente con un certificado de confianza.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-p113">By default, a managed code form template running on the local computer (the My Computer Zone code group) gets a lower level of permissions than Full Trust (Local Intranet Zone permissions). To have Full Trust permissions, the form must be registered or digitally signed with a trusted certificate.</span></span>
    
<span data-ttu-id="2e2ed-p114">La directiva de seguridad predeterminada que se establece para el dominio de la aplicación de una plantilla de formulario con código administrado garantiza que se cumplan los niveles de seguridad para el acceso al dominio de InfoPath, además de cualquier otra restricción de seguridad adicional de .NET. Para ofrecer más flexibilidad, el sistema de seguridad de InfoPath reconoce un grupo de código de seguridad para el acceso al código de .NET denominado "Plantillas de formulario de InfoPath". Si este grupo de código está presente en el equipo de un usuario, su configuración de seguridad, así como las de los grupos de código secundarios que pueda ver dentro del mismo, se aplica al dominio de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-p114">The default security policy set for the application domain of a managed code form template ensures that the InfoPath domain access security levels as well as any additional .NET security restrictions are enforced. To provide additional flexibility, the InfoPath security system recognizes a .NET code access security code group named "InfoPath Form Templates". If this code group is present on a user's computer, its security configuration, and those of any child code groups within it will be applied to the application domain.</span></span>
  
> [!IMPORTANT] 
> - <span data-ttu-id="2e2ed-p115">El grupo de código Plantillas de formulario de InfoPath se aplica sólo al propio ensamblado de código de formulario de código administrado. En consecuencia, si concede el permiso de plena confianza establecido en el código de formulario de código administrado de InfoPath, pero no ha instalado y registrado (o firmado digitalmente) la propia plantilla de formulario (que convierte toda la plantilla de formulario en un elemento de plena confianza), seguirán produciendo error las llamadas en el código de formulario para miembros de modelo de objeto de nivel de seguridad 3.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-p115">The InfoPath Form Templates code group applies only to the managed code form code assembly itself. As a result, if you grant the Full Trust permission set to InfoPath managed code form code, but you have not installed and registered (or digitally signed) the form template itself (which makes the entire form template fully trusted), calls in the form code to security level 3 object model members will still fail.</span></span>   
> - <span data-ttu-id="2e2ed-234">Si hace referencia o carga explícitamente (Assembly.Load) un ensamblado que está configurado con un permiso restringido establecido con prueba de Hash, Nombre seguro o Editor para determinar su condición de miembro en un proyecto de plantilla de formulario, el ensamblado será no obstante cargado y ejecutado por la plantilla de formulario.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-234">If you reference or explicitly load (Assembly.Load) an assembly that is configured with a restricted permission set using Hash, Strong Name, or Publisher evidence to determine its membership condition in a form template project, the assembly will nonetheless be loaded and executed by the form template.</span></span>
    
<span data-ttu-id="2e2ed-235">Para obtener información sobre cómo crear y configurar el grupo de código de las plantillas de formulario de InfoPath, vea [Configurar opciones de seguridad para las plantillas de formulario con código](how-to-configure-security-settings-for-form-templates-with-code.md).</span><span class="sxs-lookup"><span data-stu-id="2e2ed-235">For information on how to create and configure the InfoPath Form Templates code group, see [Configure Security Settings for Form Templates with Code](how-to-configure-security-settings-for-form-templates-with-code.md).</span></span>
  
<span data-ttu-id="2e2ed-236">En la tabla siguiente se resumen los escenarios de implementación y los conjuntos de permisos que se aplican a la plantillas de formulario con código administrado.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-236">The following table summarizes the deployment scenarios and permission sets that apply to managed code form templates.</span></span>
  
|<span data-ttu-id="2e2ed-237">**Escenario de implementación**</span><span class="sxs-lookup"><span data-stu-id="2e2ed-237">**Deployment Scenario**</span></span>|<span data-ttu-id="2e2ed-238">**Conjunto de permisos**</span><span class="sxs-lookup"><span data-stu-id="2e2ed-238">**Permission Set**</span></span>|<span data-ttu-id="2e2ed-239">**Notas**</span><span class="sxs-lookup"><span data-stu-id="2e2ed-239">**Notes**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="2e2ed-240">La plantilla de formulario está publicada en el equipo local y el programador está utilizando Visual Studio para escribir y depurar el código del formulario.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-240">The form template is published on the local computer, and the developer is using Visual Studio to write and debug form code.</span></span>  <br/> |<span data-ttu-id="2e2ed-241">Conjunto de permisos Intranet local.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-241">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="2e2ed-242">Ensamblados instalados en la Caché de ensamblados global (GAC) y marcada con el atributo **AllowPartiallyTrustedCallersAttribute** tienen el conjunto de permisos de plena confianza.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-242">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span>  <br/> |<span data-ttu-id="2e2ed-243">De forma predeterminada, las plantillas de formulario que se ejecuta desde el equipo local no se conceden el conjunto de permisos plena confianza.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-243">By default, form templates running from the local computer are not granted the Full Trust permission set.</span></span> <span data-ttu-id="2e2ed-244">Mientras que los miembros que requieren permisos de plena confianza del modelo de desarrollo de plantillas de formulario que usan las características y las llamadas al objeto, puede utilizar el procedimiento descrito en [obtener una vista previa y depurar plantillas de formulario que requieren plena confianza](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span><span class="sxs-lookup"><span data-stu-id="2e2ed-244">While developing form templates that use features and calls to object model members that require Full Trust permissions, you can use the procedure described in [Preview and Debug Form Templates that Require Full Trust](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span></span>  <br/> |
|<span data-ttu-id="2e2ed-245">La plantilla de formulario se publica en el equipo local y hace referencia a un ensamblado personalizado que solicita el conjunto de permisos Plena confianza en el equipo local.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-245">The form template is published on the local computer and references a custom assembly that requests the Full Trust permission set on the local computer.</span></span>  <br/> |<span data-ttu-id="2e2ed-246">Conjunto de permisos Intranet local.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-246">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="2e2ed-p117">Ensamblados instalados en la Caché de ensamblados global (GAC) y marcada con el atributo **AllowPartiallyTrustedCallersAttribute** tienen el conjunto de permisos de plena confianza. El ensamblado personalizado tiene el conjunto de permisos de Intranet local.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-p117">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set. The custom assembly is granted the Local Intranet permission set.  </span></span><br/> |<span data-ttu-id="2e2ed-p118">Para hacer referencia a ensamblados externos y utilizarlos en el código de una plantilla de formulario, el programador debe utilizar el grupo de código Plantillas de formulario de InfoPath si desea conceder el conjunto de permisos Plena confianza (o el que corresponda) al ensamblado externo al que se hace referencia en el código de la plantilla de formulario. InfoPath no confía en ningún ensamblado externo que no esté instalado en la Caché de ensamblados global (GAC). El programador debe conceder explícitamente los permisos necesarios al ensamblado usando el grupo de código Plantillas de formulario de InfoPath, incluso si el ensamblado ya es de confianza según los permisos que se le han concedido en el grupo de código de la zona Mi equipo.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-p118">To reference external assemblies for use in the form template's code, the developer must use the InfoPath Form Templates code group to grant Full Trust (or the appropriate permission set) to the external assembly referenced in the form template's code. InfoPath does not make any assumptions about external assemblies other than those installed in the Global Assembly Cache (GAC). The developer must explicitly grant the assembly the necessary permissions using the InfoPath Form Templates code group even if the assembly is already trusted though permissions granted in the My_Computer_Zone code group.</span></span>  <br/> |
|<span data-ttu-id="2e2ed-252">La plantilla de formulario se publica en una ubicación compartida de la intranet local, como un recurso compartido de archivos, una biblioteca de formularios de SharePoint o un servidor Web.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-252">The form template is published on a shared location in the local intranet, such as a file share, SharePoint Form library, or a Web server.</span></span>  <br/> |<span data-ttu-id="2e2ed-253">Conjunto de permisos Intranet local.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-253">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="2e2ed-254">Ensamblados instalados en la Caché de ensamblados global (GAC) y marcada con el atributo **AllowPartiallyTrustedCallersAttribute** tienen el conjunto de permisos de plena confianza.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-254">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span>  <br/> ||
|<span data-ttu-id="2e2ed-255">La plantilla de formulario se publica en una ubicación compartida de la intranet local, como un recurso compartido de archivos, una biblioteca de formularios de SharePoint o un servidor web que esté designado como sitio de confianza en Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-255">The form template is published on a shared location in the local intranet, such as a file share, SharePoint Form library, or a Web server that is designated as a Trusted site in Internet Explorer.</span></span>  <br/> |<span data-ttu-id="2e2ed-256">Conjunto de permisos Internet.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-256">Internet permission set.</span></span>  <br/> <span data-ttu-id="2e2ed-257">Se concede el conjunto de permisos Plena confianza a los ensamblados firmados por Microsoft y ECMA.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-257">Assemblies signed by Microsoft and ECMA are granted the Full Trust permission set.</span></span>  <br/> |<span data-ttu-id="2e2ed-p119">La seguridad para el acceso al código CLR sólo concede el conjunto de permisos Internet a los sitios designados como de confianza en Internet Explorer. InfoPath respeta esta directiva. Observe que éste no es el caso de las plantillas de formulario de InfoPath que utilizan secuencias de comandos en el código del formulario, ya que éstas reciben un nivel de permisos superior al publicarse en la zona Sitios de confianza.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-p119">CLR code access security grants only the Internet permission set to sites that are designated as Trusted sites in Internet Explorer. InfoPath respects this policy. Note that this is unlike an InfoPath form template that uses script for form code, which receives a higher level of permissions when published in a Trusted sites zone.</span></span>  <br/> |
|<span data-ttu-id="2e2ed-261">La plantilla de formulario se descarga o copia desde una ubicación de Internet.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-261">The form template is downloaded or copied from an Internet location.</span></span>  <br/> |<span data-ttu-id="2e2ed-p120">De manera predeterminada, ninguno. El ensamblado de código administrado de la plantilla de formulario no se carga ni se ejecuta.</span><span class="sxs-lookup"><span data-stu-id="2e2ed-p120">By default, none. The managed code assembly for the form template is not loaded and does not run.</span></span>  <br/> ||
   
## <a name="see-also"></a><span data-ttu-id="2e2ed-264">Vea también</span><span class="sxs-lookup"><span data-stu-id="2e2ed-264">See also</span></span>

- [<span data-ttu-id="2e2ed-265">Configurar las opciones de seguridad de las plantillas de formulario con código</span><span class="sxs-lookup"><span data-stu-id="2e2ed-265">Configure Security Settings for Form Templates with Code</span></span>](how-to-configure-security-settings-for-form-templates-with-code.md)
- [<span data-ttu-id="2e2ed-266">Obtener una vista previa y depurar plantillas de formulario con código que requieren plena confianza</span><span class="sxs-lookup"><span data-stu-id="2e2ed-266">Preview and Debug Form Templates that Require Full Trust</span></span>](how-to-preview-and-debug-form-templates-that-require-full-trust.md)

