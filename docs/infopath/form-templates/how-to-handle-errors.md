---
title: Controlar los errores
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- errors [infopath 2007], handling,FormErrorCollection [InfoPath 2007],InfoPath 2007, error handling,FormError [InfoPath 2007],error handling [InfoPath 2007]
localization_priority: Normal
ms.assetid: 132cb698-d9a5-4767-b3d1-5dd1343a1ff4
description: Al crear aplicaciones personalizadas, los programadores deben con frecuencia controlar errores, lo que supone escribir código de programación para comprobar los errores generados por la aplicación o para crear y generar errores personalizados. El modelo de objetos de InfoPath proporcionado por el espacio de nombres Microsoft.Office.InfoPath admite el control de errores mediante el uso de la clase FormError en asociación con la clase FormErrorCollection .
ms.openlocfilehash: 3bfad103c31d0b5364d1c75acfbb2f590f7658bb
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19815886"
---
# <a name="handle-errors"></a><span data-ttu-id="cab56-105">Controlar los errores</span><span class="sxs-lookup"><span data-stu-id="cab56-105">Handle Errors</span></span>

<span data-ttu-id="cab56-p102">Al crear aplicaciones personalizadas, los programadores deben con frecuencia controlar errores, lo que supone escribir código de programación para comprobar los errores generados por la aplicación o para crear y generar errores personalizados. El modelo de objetos de InfoPath proporcionado por el espacio de nombres [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) admite el control de errores mediante el uso de la clase [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) en asociación con la clase [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) .</span><span class="sxs-lookup"><span data-stu-id="cab56-p102">When creating custom applications, developers must often perform error handling that involves writing programming code to check for errors raised by the application or to create and raise custom errors. The InfoPath object model provided by the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace supports error handling through the use of the [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) class in association with the [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) class.</span></span> 
  
<span data-ttu-id="cab56-108">En InfoPath, los errores se pueden producir por las razones siguientes:</span><span class="sxs-lookup"><span data-stu-id="cab56-108">In InfoPath, errors can occur for the following reasons:</span></span>
  
- <span data-ttu-id="cab56-109">Cuando los datos escritos en un formulario dan error en la validación del esquema XML.</span><span class="sxs-lookup"><span data-stu-id="cab56-109">When data entered into a form fails XML schema validation.</span></span>
    
- <span data-ttu-id="cab56-110">Cuando se produce un error en una restricción de validación personalizada.</span><span class="sxs-lookup"><span data-stu-id="cab56-110">When a custom validation constraint fails.</span></span>
    
- <span data-ttu-id="cab56-111">Cuando se genera un error o cuando se crea un error con el método [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) del objeto de evento [XmlValidatingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.aspx) .</span><span class="sxs-lookup"><span data-stu-id="cab56-111">When an error is generated by the [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) method of the [XmlValidatingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.aspx) event object.</span></span> 
    
- <span data-ttu-id="cab56-112">Cuando se crea un error definido por el usuario usando el método [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) de la clase [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) .</span><span class="sxs-lookup"><span data-stu-id="cab56-112">When a user-defined error is created using the [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) method of the [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) class.</span></span> 
    
## <a name="overview-of-the-formerrorcollection-class"></a><span data-ttu-id="cab56-113">Información general sobre la clase FormErrorCollection</span><span class="sxs-lookup"><span data-stu-id="cab56-113">Overview of the FormErrorCollection Class</span></span>

<span data-ttu-id="cab56-114">La clase [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) proporciona los siguientes métodos y propiedades que los desarrolladores de formularios pueden utilizar para administrar los objetos [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) que contiene.</span><span class="sxs-lookup"><span data-stu-id="cab56-114">The [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) class provides the following methods and properties, which form developers can use to manage the [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) objects that the collection contains.</span></span> 
  
|<span data-ttu-id="cab56-115">**Nombre**</span><span class="sxs-lookup"><span data-stu-id="cab56-115">**Name**</span></span>|<span data-ttu-id="cab56-116">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="cab56-116">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="cab56-117">Método [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) (+ 3 sobrecargas)</span><span class="sxs-lookup"><span data-stu-id="cab56-117">[Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) method (+3 overloads)</span></span>  <br/> |<span data-ttu-id="cab56-118">Crea un objeto **FormError** y lo añade a la colección.</span><span class="sxs-lookup"><span data-stu-id="cab56-118">Creates a **FormError** object and adds it to the collection.</span></span>  <br/> |
|<span data-ttu-id="cab56-119">Método [Delete](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Delete.aspx) (+ 1 sobrecarga)</span><span class="sxs-lookup"><span data-stu-id="cab56-119">[Delete](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Delete.aspx) method (+1 overload)</span></span>  <br/> |<span data-ttu-id="cab56-120">Elimina el error definido por el usuario especificado de la colección.</span><span class="sxs-lookup"><span data-stu-id="cab56-120">Deletes the specified user-defined error from the collection.</span></span>  <br/> |
|<span data-ttu-id="cab56-121">Método [DeleteAll](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.DeleteAll.aspx)</span><span class="sxs-lookup"><span data-stu-id="cab56-121">[DeleteAll](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.DeleteAll.aspx) method</span></span>  <br/> |<span data-ttu-id="cab56-122">Elimina todos los objetos **FormError** contenidos en la colección.</span><span class="sxs-lookup"><span data-stu-id="cab56-122">Deletes all **FormError** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="cab56-123">[GetErrors](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.GetErrors.aspx) (+ 1 sobrecarga)</span><span class="sxs-lookup"><span data-stu-id="cab56-123">[GetErrors](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.GetErrors.aspx) (+1 overload)</span></span>  <br/> |<span data-ttu-id="cab56-124">Devuelve todos los objetos **FormError** del nombre o tipo especificado de la colección.</span><span class="sxs-lookup"><span data-stu-id="cab56-124">Returns all **FormError** objects of the specified name or type from the collection.</span></span>  <br/> |
|<span data-ttu-id="cab56-125">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Count.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="cab56-125">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="cab56-126">Obtiene el número de objetos **FormError** contenidos en la colección.</span><span class="sxs-lookup"><span data-stu-id="cab56-126">Gets a count of the number of **FormError** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="cab56-127">[Elemento](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Item.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="cab56-127">[Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="cab56-128">Obtiene una referencia a un objeto **FormError** basada en el número de índice especificado.</span><span class="sxs-lookup"><span data-stu-id="cab56-128">Gets a reference to an **FormError** object based on the specified index number.</span></span>  <br/> |
   
## <a name="overview-of-the-formerror-class"></a><span data-ttu-id="cab56-129">Información general sobre la clase FormError</span><span class="sxs-lookup"><span data-stu-id="cab56-129">Overview of the FormError Class</span></span>

<span data-ttu-id="cab56-130">La clase [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) proporciona las siguientes propiedades que los programadores de formularios pueden utilizar para tener acceso a la información sobre el error que se ha producido.</span><span class="sxs-lookup"><span data-stu-id="cab56-130">The [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) class provides the following properties, which form developers can use to access information about the error that was raised.</span></span> 
  
|<span data-ttu-id="cab56-131">**Nombre**</span><span class="sxs-lookup"><span data-stu-id="cab56-131">**Name**</span></span>|<span data-ttu-id="cab56-132">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="cab56-132">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="cab56-133">[DetailedMessage](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.DetailedMessage.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="cab56-133">[DetailedMessage](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.DetailedMessage.aspx) property</span></span>  <br/> |<span data-ttu-id="cab56-134">Obtiene o establece el mensaje de error detallado del objeto **FormError**.</span><span class="sxs-lookup"><span data-stu-id="cab56-134">Gets or sets the detailed error message of the **FormError** object.</span></span>  <br/> |
|<span data-ttu-id="cab56-135">[ErrorCode (](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.ErrorCode.aspx) propiedad)</span><span class="sxs-lookup"><span data-stu-id="cab56-135">[ErrorCode](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.ErrorCode.aspx) property</span></span>  <br/> |<span data-ttu-id="cab56-136">Obtiene o establece el código de error del objeto **FormError**.</span><span class="sxs-lookup"><span data-stu-id="cab56-136">Gets or sets the error code of the **FormError** object.</span></span>  <br/> |
|<span data-ttu-id="cab56-137">[Sitio](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.Site.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="cab56-137">[Site](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.Site.aspx) property</span></span>  <br/> |<span data-ttu-id="cab56-138">Obtiene un objeto **XPathNavigator** que está situado en el nodo asociado con el objeto **FormError**.</span><span class="sxs-lookup"><span data-stu-id="cab56-138">Gets an **XPathNavigator** object that is positioned at the node associated with the **FormError** object.</span></span>  <br/> |
|<span data-ttu-id="cab56-139">[Mensaje](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.Message.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="cab56-139">[Message](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.Message.aspx) property</span></span>  <br/> |<span data-ttu-id="cab56-140">Obtiene o establece el mensaje de error corto del objeto **FormError**.</span><span class="sxs-lookup"><span data-stu-id="cab56-140">Gets or sets the short error message of the **FormError** object.</span></span>  <br/> |
|<span data-ttu-id="cab56-141">[FormErrorType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.FormErrorType.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="cab56-141">[FormErrorType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.FormErrorType.aspx) property</span></span>  <br/> |<span data-ttu-id="cab56-142">Obtiene el tipo del objeto **FormError**.</span><span class="sxs-lookup"><span data-stu-id="cab56-142">Gets the type of the **FormError** object.</span></span>  <br/> |
   
## <a name="using-the-formerrorcollection-and-formerror-classes"></a><span data-ttu-id="cab56-143">Uso de las clases FormErrorCollection y FormError</span><span class="sxs-lookup"><span data-stu-id="cab56-143">Using the FormErrorCollection and FormError Classes</span></span>

<span data-ttu-id="cab56-p103">Se puede tener acceso al objeto **FormErrorCollection** asociado con un formulario mediante la propiedad [Errors](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Errors.aspx) del objeto [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) . El objeto **FormErrorCollection** está asociado a un documento XML subyacente del formulario de forma que cuando se produce un error se puede tener acceso y controlar (el error y los que se produzcan después) dentro del documento XML. En el ejemplo siguiente, se muestra el uso de un bucle para comprobar los errores que pueden existir en el documento XML subyacente del formulario. Si se producen errores, la función recorre cada uno de ellos y, con la propiedad **Message** del objeto **FormError**, muestra un cuadro de mensaje al usuario.</span><span class="sxs-lookup"><span data-stu-id="cab56-p103">The **FormErrorCollection** object associated with a form is accessed through the [Errors](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Errors.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) object. The **FormErrorCollection** object is associated with a form's underlying XML document so that when an error occurs, it and any additional errors can be accessed and managed within the current XML document. The following example demonstrates how a loop can be used to check the errors that may exist in a form's underlying XML document. If there are errors, the function loops through each of them, and, using the **Message** property of the **FormError** object, displays a message box to the user.</span></span> 
  
```cs
public void CheckErrors(XPathNavigator xmlNode)
{
   foreach(FormError err in this.Errors)
   {
      if(xmlNode.InnerXml == err.Site.InnerXml)
         MessageBox.Show("The following error has occured: "
             + err.Message);
   }
}
```

```vb
Public Sub CheckErrors(ByVal xmlNode As XPathNavigator)
   Dim err As FormError
   For Each err In Me.Errors
      If xmlNode.InnerXml = err.Site.InnerXml Then
         MessageBox.Show("The following error has occured: " _
             &amp; err.Message)
   End If
End Sub
```

<span data-ttu-id="cab56-p104">Se puede llamar a la función anterior desde uno de los controladores de eventos de validación de datos del formulario. Por ejemplo, cuando se utiliza en el controlador de eventos del evento [Changed](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.Changed.aspx) de un campo del formulario, la llamada a la función transmitiría el argumento del nodo XML usando la propiedad [Site](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.Site.aspx) del objeto de evento [XmlEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.aspx) como se muestra a continuación.</span><span class="sxs-lookup"><span data-stu-id="cab56-p104">The preceding function could be called from one of the form's data validation event handlers. For example, when used in the event handler for the [Changed](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.Changed.aspx) event of a field in the form, the call to the function would pass the XML node argument using the [Site](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.Site.aspx) property of the [XmlEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.aspx) event object as follows.</span></span> 
  
```cs
CheckErrors(e.Site);
```

```vb
CheckErrors(e.Site)
```

<span data-ttu-id="cab56-p105">Además de controlar los errores generados por InfoPath, los programadores de formularios generan errores personalizados, utilizando el método [ReportError(XPathNavigator, Boolean, String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) del objeto de evento [XmlValidatingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.aspx) , o bien utilizando el método [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) de la clase [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) . Para obtener información sobre el uso de los métodos [ReportError(XPathNavigator, Boolean, String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) o [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) , haga clic en los vínculos de los métodos que figuran al principio de este tema.</span><span class="sxs-lookup"><span data-stu-id="cab56-p105">In addition to handling errors generated by InfoPath, form developers can also generate custom errors by using the [ReportError(XPathNavigator, Boolean, String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) method of the [XmlValidatingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.aspx) event object, or by using the [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) method of the [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) class. For information about using the [ReportError(XPathNavigator, Boolean, String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) or [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) methods, click the links for those methods at the beginning of this topic.</span></span> 
  
## <a name="handling-managed-code-exceptions"></a><span data-ttu-id="cab56-152">Controlar las excepciones de código administrado</span><span class="sxs-lookup"><span data-stu-id="cab56-152">Handling Managed-Code Exceptions</span></span>

<span data-ttu-id="cab56-153">Puede utilizar el control de las excepciones try-catch para controlar aquéllas que se produzcan en una plantilla de formulario con código administrado, tal como se muestra en el siguiente ejemplo de código.</span><span class="sxs-lookup"><span data-stu-id="cab56-153">You can use try-catch exception handling to handle exceptions raised in managed-code form template as shown in the following code example.</span></span>
  
```cs
FileQueryConnection queryXMLFile = 
   (FileQueryConnection)this.DataConnections["form1"];
// Perform the query.
try
{
   queryXMLFile.Execute();
}
catch (Exception ex)
{
   MessageBox.Show("Failed to query." + System.Environment.NewLine 
      + ex.Message);
}
```

```vb
Dim queryXMLFile As FileQueryConnection = _
   DirectCast(Me.DataConnections("form1"), FileQueryConnection)
' Perform the query.
Try
   queryXMLFile.Execute();
Catch ex As Exception
   MessageBox.Show("Failed to query." &amp; System.Environment.NewLine 
      &amp; ex.Message)
End Try
```

<span data-ttu-id="cab56-p106">Si no utiliza el control de las excepciones try-catch en el código del formulario, InfoPath mostrará información sobre las excepciones no controladas en el cuadro de diálogo de errores de InfoPath mientras se depuran y se obtiene una vista previa. Además, de manera predeterminada, estas excepciones no se muestran en el cuadro de diálogo de errores de InfoPath en tiempo de ejecución al implementar una plantilla de formulario con código administrado. Para mostrar información sobre las excepciones no controladas en tiempo de ejecución, utilice este procedimiento.</span><span class="sxs-lookup"><span data-stu-id="cab56-p106">If you do not use try-catch exception handling in your form code, InfoPath will display information about unhandled exceptions in the InfoPath error dialog box while debugging and previewing. Additionally, by default, unhandled exceptions are not displayed in the InfoPath error dialog box at run time when you deploy your managed-code form template. To display information about unhandled exceptions at run time, use the following procedure.</span></span>
  
### <a name="enable-notifications-for-unhandled-managed-code-exceptions-at-run-time"></a><span data-ttu-id="cab56-157">Habilitación de las notificaciones sobre excepciones de código administrado no controladas en tiempo de ejecución</span><span class="sxs-lookup"><span data-stu-id="cab56-157">Enable notifications for unhandled managed-code exceptions at run time</span></span>

1. <span data-ttu-id="cab56-158">Abra el diseñador de InfoPath y a continuación haga clic en la pestaña **Archivo**.</span><span class="sxs-lookup"><span data-stu-id="cab56-158">Open the InfoPath designer, and then click the **File** tab.</span></span> 
    
2. <span data-ttu-id="cab56-159">Haga clic en **Opciones** y a continuación haga clic en **Opciones de InfoPath** bajo la categoría **General**.</span><span class="sxs-lookup"><span data-stu-id="cab56-159">Click **Options**, and then click **InfoPath Options** under the **General** category.</span></span> 
    
3. <span data-ttu-id="cab56-160">En la ficha **Avanzadas**, active la casilla de verificación **Mostrar una notificación para los errores de código de Visual Basic o C#**.</span><span class="sxs-lookup"><span data-stu-id="cab56-160">On the **Advanced** tab, select the **Show a notification for Visual Basic and C# code errors** check box.</span></span> 
    

