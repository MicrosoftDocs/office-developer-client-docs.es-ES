---
title: Trabajar con derechos de información de configuración de administración
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- information rights management [infopath 2007],InfoPath 2007, Information Rights Management,IRM [InfoPath 2007]
localization_priority: Normal
ms.assetid: 4ad91898-b23e-4410-8839-a65259e53d37
description: 'Existen dos tipos de configuración de Information Rights Management (IRM) disponibles en Microsoft InfoPath: una para proteger el acceso a las plantillas de formulario de InfoPath y otra para controlar el acceso y las acciones en los datos que contengan los formularios completados.'
ms.openlocfilehash: 4e6fdac6a0b2b5cd6a29de948cc9dbbd01a407d8
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19815906"
---
# <a name="work-with-information-rights-management-settings"></a><span data-ttu-id="29fba-104">Trabajar con derechos de información de configuración de administración</span><span class="sxs-lookup"><span data-stu-id="29fba-104">Work with Information Rights Management Settings</span></span>

<span data-ttu-id="29fba-105">Existen dos tipos de configuración de Information Rights Management (IRM) disponibles en Microsoft InfoPath: una para proteger el acceso a las plantillas de formulario de InfoPath y otra para controlar el acceso y las acciones en los datos que contengan los formularios completados.</span><span class="sxs-lookup"><span data-stu-id="29fba-105">There are two types of Information Rights Management (IRM) settings available in Microsoft InfoPath: one for protecting access to InfoPath form templates, and one for controlling access to and actions on form data contained in completed forms.</span></span>
  
> [!NOTE]
> <span data-ttu-id="29fba-p101">[!NOTA] La restricción de permisos solo está disponible con plantillas de formulario compatibles con el editor de InfoPath. Las plantillas de formulario compatibles con exploradores no admiten IRM.</span><span class="sxs-lookup"><span data-stu-id="29fba-p101">Restricting permission is only available to form templates compatible with the InfoPath editor. Browser-compatible form templates do not support IRM.</span></span> 
  
## <a name="adding-the-manage-credentials-command-to-the-quick-access-toolbar"></a><span data-ttu-id="29fba-108">Agregar el comando Administrar credenciales a la Barra de herramientas de acceso rápido</span><span class="sxs-lookup"><span data-stu-id="29fba-108">Adding the Manage Credentials Command to the Quick Access Toolbar</span></span>

<span data-ttu-id="29fba-p102">El comando **Administrar credenciales** usado para trabajar con configuraciones de IRM al diseñar una plantilla de formulario no está disponible de forma predeterminada. Siga los siguientes pasos para agregarlo a la **Barra de herramientas de acceso rápido**.</span><span class="sxs-lookup"><span data-stu-id="29fba-p102">The **Manage Credentials** command used to work with IRM settings when designing a form template is not available by default. Use the following steps to add it to the **Quick Access Toolbar**.</span></span>
  
### <a name="add-the-manage-credentials-command-to-the-quick-access-toolbar"></a><span data-ttu-id="29fba-111">Para agregar el comando Administrar credenciales a la Barra de herramientas de acceso rápido</span><span class="sxs-lookup"><span data-stu-id="29fba-111">Add the Manage Credentials Command to the Quick Access Toolbar</span></span>

1.  <span data-ttu-id="29fba-112">Haga clic en la flecha del extremo derecho de la **Barra de herramientas de acceso rápido** para desplegar el menú **Personalizar barra de herramientas de acceso rápido** y, a continuación, haga clic en **Más comandos**.</span><span class="sxs-lookup"><span data-stu-id="29fba-112">Click the arrow on the right end of the **Quick Access Toolbar** to pull down the **Customize Quick Access Toolbar** menu, and then click **More Commands**.</span></span>
    
2. <span data-ttu-id="29fba-113">En la lista **Comandos disponibles en**, seleccione **Todos los comandos**.</span><span class="sxs-lookup"><span data-stu-id="29fba-113">In the **Choose commands from** list, select **All Commands**.</span></span>
    
3. <span data-ttu-id="29fba-114">Desplace hacia abajo la lista hasta **Administrar credenciales** y, a continuación, haga clic en **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="29fba-114">Scroll down the list to **Manage Credentials**, and then click **Add**.</span></span>
    
4. <span data-ttu-id="29fba-115">Haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="29fba-115">Click **OK**.</span></span>
    
<span data-ttu-id="29fba-116">Para obtener más información acerca de cómo usar el comando **Administrar credenciales** y el cuadro de diálogo **Permisos** de InfoPath, vea el tema sobre "Creación de una plantilla de formulario con permisos restringidos" en la ayuda de InfoPath.</span><span class="sxs-lookup"><span data-stu-id="29fba-116">For more information about using **Manage Credentials** command and the **Permission** dialog box in InfoPath, see the "Create a Form Template with Restricted Permission" topic in InfoPath help.</span></span> 
  
## <a name="the-irm-object-model"></a><span data-ttu-id="29fba-117">El modelo de objetos de IRM</span><span class="sxs-lookup"><span data-stu-id="29fba-117">The IRM Object Model</span></span>

<span data-ttu-id="29fba-p103">Use la clase [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.aspx) para tener acceso a [UserPermissionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.aspx) y a la configuración de permisos de IRM que se pueden aplicar a un formulario. Para tener acceso al objeto **Permission** asociado a la plantilla de formulario, utilice la propiedad [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Permission.aspx) de la clase [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) . El objeto devuelto **Permission** ofrece acceso a la colección de objetos [UserPermission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.aspx) asociados a la plantilla de formulario y a cada instancia de creada con esa plantilla.</span><span class="sxs-lookup"><span data-stu-id="29fba-p103">Use the [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.aspx) class to access the [UserPermissionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.aspx) and IRM permission settings that can be applied to a form. To access the **Permission** object associated with a form template, use the [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Permission.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class. The returned **Permission** object provides access to the collection of [UserPermission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.aspx) objects associated with the form template and each form instance created with that template.</span></span> 
  
<span data-ttu-id="29fba-p104">El objeto **Permission** y sus propiedades y métodos están disponibles tanto si los permisos están restringidos en la plantilla del formulario activo como si no lo están. Use la propiedad [Enabled](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.Enabled.aspx) para determinar si un formulario tiene permisos restringidos.</span><span class="sxs-lookup"><span data-stu-id="29fba-p104">The **Permission** object and its properties and methods are available whether permissions are restricted on the active form template or not. Use the [Enabled](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.Enabled.aspx) property to determine whether a form has restricted permissions.</span></span> 
  
<span data-ttu-id="29fba-123">Los permisos de un formulario se pueden habilitar de una de las formas siguientes usando las propiedades y los métodos de la clase Permission:</span><span class="sxs-lookup"><span data-stu-id="29fba-123">Permissions on a form are enabled in one of the following ways by using properties and methods of the Permission class:</span></span>
  
<span data-ttu-id="29fba-124">La propiedad **Enabled** se establece en **true**.</span><span class="sxs-lookup"><span data-stu-id="29fba-124">The **Enabled** property is set to **true**.</span></span>
  
<span data-ttu-id="29fba-125">Se establece la propiedad [DocumentAuthor](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.DocumentAuthor.aspx) .</span><span class="sxs-lookup"><span data-stu-id="29fba-125">The [DocumentAuthor](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.DocumentAuthor.aspx) property is set.</span></span> 
  
<span data-ttu-id="29fba-126">Se establece la propiedad [RequestPermissionUrl](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.RequestPermissionUrl.aspx) .</span><span class="sxs-lookup"><span data-stu-id="29fba-126">The [RequestPermissionUrl](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.RequestPermissionUrl.aspx) property is set.</span></span> 
  
<span data-ttu-id="29fba-127">Se establece la propiedad [StoreLicenses](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.StoreLicenses.aspx) en **true** o **false**.</span><span class="sxs-lookup"><span data-stu-id="29fba-127">The [StoreLicenses](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.StoreLicenses.aspx) property is set to **true** or **false**.</span></span>
  
<span data-ttu-id="29fba-128">Se llama al método [ApplyPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.ApplyPolicy.aspx) .</span><span class="sxs-lookup"><span data-stu-id="29fba-128">The [ApplyPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.ApplyPolicy.aspx) method is called.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="29fba-129">[!NOTA] Si el cliente de Windows Rights Management no está instalado en el equipo de un usuario, al usar la clase **Permission** se produce una excepción.</span><span class="sxs-lookup"><span data-stu-id="29fba-129">If the Windows Rights Management client is not installed on a user's computer, using the **Permission** class raises an exception.</span></span> 
  
<span data-ttu-id="29fba-130">Para trabajar mediante programación con la configuración de IRM de usuarios individuales en formularios, use las clases **UserPermissionCollection** y **UserPermission**.</span><span class="sxs-lookup"><span data-stu-id="29fba-130">To work programmatically with IRM settings of individual users in forms, use the **UserPermissionCollection** and **UserPermission** classes.</span></span> 
  
<span data-ttu-id="29fba-p105">Un objeto **UserPermission** asocia un conjunto de permisos del formulario actual a un único usuario y una fecha de caducidad opcional. Use el método [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Add.aspx) de la clase **UserPermissionCollection** para añadir y conceder a un usuario un conjunto de permisos para el formulario. Use el método [Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Remove.aspx) de la clase **UserPermissionCollection** para quitar a un usuario y sus permisos. Si bien ciertos permisos concedidos mediante la interfaz de usuario se aplican a todos los usuarios, por ejemplo, los de impresión y fecha de caducidad, puede usar las clases **UserPermission** y **UserPermissionCollection** para asignarlos a usuarios individuales con una fecha de caducidad para cada uno de ellos. El modelo de objetos permite a los programadores enumerar la configuración de los permisos en un formulario y proporcionar la funcionalidad que permita a otros usuarios del formulario agregar permisos sin tener que utilizar el panel de tareas **Permiso de formulario** del cuadro de diálogo **Permiso**.</span><span class="sxs-lookup"><span data-stu-id="29fba-p105">A **UserPermission** object associates a set of permissions for the current form with a single user and an optional expiration date. Use the [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Add.aspx) method of the **UserPermissionCollection** class to add and grant a user a set of permissions on the current form. Use the [Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Remove.aspx) method of the **UserPermissionCollection** class to remove a user and the user's permissions. While some permissions granted through the user interface apply to all users, such as printing and expiration date, you can use the **UserPermission** and **UserPermissionCollection** classes to assign them on a per-user basis with per-user expiration dates. The object model allows developers to enumerate permission settings in a form and to provide functionality that allows form users to add permissions to the form without having to use the **Form Permission** task pane or the **Permission** dialog box.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="29fba-p106">[!NOTA] Los permisos no se pueden aplicar cuando un formulario está en el modo de vista previa. Por ello, todas las propiedades de la clase **Permission** son de sólo lectura cuando se está en la vista previa de un formulario. En el modo de vista previa, la propiedad **Enabled** devolverá siempre **false**; si el código trata de cambiar este valor, se produce una excepción **System.Runtime.InteropServices.COMException** y se devuelve un mensaje de error que dice "La propiedad o el método no está disponible en el modo de vista previa". De la misma manera, los métodos asociados a las clases **UserPermission** y **UserPermissionCollection** devolverán este mensaje de error si se usan en el modo de vista previa.</span><span class="sxs-lookup"><span data-stu-id="29fba-p106">Permissions cannot be applied when a form is in preview mode. For this reason, all of the properties of the **Permission** class are read-only when a form is being previewed. In preview mode, the **Enabled** property will always return **false**, and if code attempts to change this setting, a **System.Runtime.InteropServices.COMException** is raised and the error "The property/method is not available in preview mode" is returned. Similarly, the methods associated with the **UserPermission** and **UserPermissionCollection** classes will also return this error message when used in preview mode.</span></span> 
  
### <a name="overview-of-the-permission-class"></a><span data-ttu-id="29fba-140">Información general sobre la clase Permission</span><span class="sxs-lookup"><span data-stu-id="29fba-140">Overview of the Permission Class</span></span>

<span data-ttu-id="29fba-141">La clase **UserPermissionCollection** proporciona las siguientes propiedades y un método:</span><span class="sxs-lookup"><span data-stu-id="29fba-141">The **UserPermissionCollection** class provides the following properties and one method.</span></span> 
  
|<span data-ttu-id="29fba-142">**Nombre**</span><span class="sxs-lookup"><span data-stu-id="29fba-142">**Name**</span></span>|<span data-ttu-id="29fba-143">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="29fba-143">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="29fba-144">[ApplyPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.ApplyPolicy.aspx) (método)</span><span class="sxs-lookup"><span data-stu-id="29fba-144">[ApplyPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.ApplyPolicy.aspx) method</span></span>  <br/> |<span data-ttu-id="29fba-145">Aplica una directiva al formulario utilizando un archivo de plantilla de directiva.</span><span class="sxs-lookup"><span data-stu-id="29fba-145">Applies a policy to the form using a policy template file.</span></span>  <br/> |
|<span data-ttu-id="29fba-146">[DocumentAuthor](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.DocumentAuthor.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="29fba-146">[DocumentAuthor](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.DocumentAuthor.aspx) property</span></span>  <br/> |<span data-ttu-id="29fba-147">Obtiene o establece al autor del formulario actual como una dirección de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="29fba-147">Gets or sets the author of the current form as an email address.</span></span>  <br/> |
|<span data-ttu-id="29fba-148">[Enabled](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.Enabled.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="29fba-148">[Enabled](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.Enabled.aspx) property</span></span>  <br/> |<span data-ttu-id="29fba-149">Obtiene o establece si la configuración del permiso representada por el objeto **Permission** está habilitada para el formulario actual.</span><span class="sxs-lookup"><span data-stu-id="29fba-149">Gets or sets whether the permission settings represented by the **Permission** object are enabled for the current form.</span></span>  <br/> |
|<span data-ttu-id="29fba-150">[PermissionFromPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PermissionFromPolicy.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="29fba-150">[PermissionFromPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PermissionFromPolicy.aspx) property</span></span>  <br/> |<span data-ttu-id="29fba-151">Obtiene o establece si se ha aplicado una directiva de permisos al formulario actual.</span><span class="sxs-lookup"><span data-stu-id="29fba-151">Gets or sets whether a permission policy has been applied to the current form.</span></span>  <br/> |
|<span data-ttu-id="29fba-152">[PolicyDescription](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PolicyDescription.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="29fba-152">[PolicyDescription](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PolicyDescription.aspx) property</span></span>  <br/> |<span data-ttu-id="29fba-153">Obtiene una descripción de la directiva que se aplicó al formulario.</span><span class="sxs-lookup"><span data-stu-id="29fba-153">Gets a description of the policy that was applied to the current form.</span></span>  <br/> |
|<span data-ttu-id="29fba-154">[PolicyName](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PolicyName.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="29fba-154">[PolicyName](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PolicyName.aspx) property</span></span>  <br/> |<span data-ttu-id="29fba-155">Obtiene el nombre de la directiva que se aplicó al formulario.</span><span class="sxs-lookup"><span data-stu-id="29fba-155">Gets the name of the policy that was applied to the current form.</span></span>  <br/> |
|<span data-ttu-id="29fba-156">[RequestPermissionUrl](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.RequestPermissionUrl.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="29fba-156">[RequestPermissionUrl](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.RequestPermissionUrl.aspx) property</span></span>  <br/> |<span data-ttu-id="29fba-157">Obtiene o establece el archivo, la dirección URL o dirección de correo electrónico de contacto para los usuarios que necesitan permisos adicionales en el formulario actual.</span><span class="sxs-lookup"><span data-stu-id="29fba-157">Gets or sets the file, URL, or email address to contact for users who need additional permissions on the current form.</span></span>  <br/> |
|<span data-ttu-id="29fba-158">[StoreLicenses](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.StoreLicenses.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="29fba-158">[StoreLicenses](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.StoreLicenses.aspx) property</span></span>  <br/> |<span data-ttu-id="29fba-159">Obtiene o establece si la licencia del usuario para ver el formulario actual se debe almacenar en caché para permitir su visualización sin conexión cuando el usuario no se pueda conectar a un servidor de administración de derechos.</span><span class="sxs-lookup"><span data-stu-id="29fba-159">Gets or sets whether the user's license to view the current form should be cached to allow offline viewing when the user cannot connect to a rights management server.</span></span>  <br/> |
|<span data-ttu-id="29fba-160">[Objetos UserPermissions](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.UserPermissions.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="29fba-160">[UserPermissions](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.UserPermissions.aspx) property</span></span>  <br/> |<span data-ttu-id="29fba-161">Obtiene un objeto **UserPermissionCollection** para el formulario actual.</span><span class="sxs-lookup"><span data-stu-id="29fba-161">Gets a **UserPermissionCollection** object for the current form.</span></span>  <br/> |
   
### <a name="overview-of-the-userpermissioncollection-class"></a><span data-ttu-id="29fba-162">Información general sobre la clase UserPermissionCollection</span><span class="sxs-lookup"><span data-stu-id="29fba-162">Overview of the UserPermissionCollection Class</span></span>

<span data-ttu-id="29fba-163">La clase **UserPermissionCollection** proporciona las siguientes propiedades y métodos:</span><span class="sxs-lookup"><span data-stu-id="29fba-163">The **UserPermissionCollection** class provides the following properties and methods.</span></span> 
  
|<span data-ttu-id="29fba-164">**Nombre**</span><span class="sxs-lookup"><span data-stu-id="29fba-164">**Name**</span></span>|<span data-ttu-id="29fba-165">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="29fba-165">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="29fba-166">Método [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Add.aspx) (+ 3 sobrecargas)</span><span class="sxs-lookup"><span data-stu-id="29fba-166">[Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Add.aspx) method (+3 overloads)</span></span>  <br/> |<span data-ttu-id="29fba-167">Añada un nuevo usuario al formulario y opcionalmente especifica los permisos y una fecha de caducidad.</span><span class="sxs-lookup"><span data-stu-id="29fba-167">Adds a new user to the current form, optionally specifying permissions and an expiration date.</span></span>  <br/> |
|<span data-ttu-id="29fba-168">Método [Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Remove.aspx)</span><span class="sxs-lookup"><span data-stu-id="29fba-168">[Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Remove.aspx) method</span></span>  <br/> |<span data-ttu-id="29fba-169">Quita el objeto **UserPermission** con **UserId** especificado de la colección.</span><span class="sxs-lookup"><span data-stu-id="29fba-169">Removes the **UserPermission** object with the specified **UserId** from the collection.</span></span>  <br/> |
|<span data-ttu-id="29fba-170">[RemoveAll](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.RemoveAll.aspx) (método)</span><span class="sxs-lookup"><span data-stu-id="29fba-170">[RemoveAll](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.RemoveAll.aspx) method</span></span>  <br/> |<span data-ttu-id="29fba-171">Quita todos los objetos **UserPermission** de la colección.</span><span class="sxs-lookup"><span data-stu-id="29fba-171">Removes all **UserPermission** objects from the collection.</span></span>  <br/> |
|<span data-ttu-id="29fba-172">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Count.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="29fba-172">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="29fba-173">Obtiene el número de objetos **UserPermission** de la colección.</span><span class="sxs-lookup"><span data-stu-id="29fba-173">Gets the number of **UserPermission** objects in the collection.</span></span>  <br/> |
|<span data-ttu-id="29fba-174">Propiedad [Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Item.aspx) (+ 1 sobrecarga)</span><span class="sxs-lookup"><span data-stu-id="29fba-174">[Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Item.aspx) property (+1 overload)</span></span>  <br/> |<span data-ttu-id="29fba-175">Obtiene un objeto **UserPermission** .</span><span class="sxs-lookup"><span data-stu-id="29fba-175">Gets a **UserPermission** object.</span></span>  <br/> |
   
### <a name="overview-of-the-userpermission-class"></a><span data-ttu-id="29fba-176">Información general sobre la clase UserPermission</span><span class="sxs-lookup"><span data-stu-id="29fba-176">Overview of the UserPermission Class</span></span>

<span data-ttu-id="29fba-177">La clase **UserPermission** proporciona las siguientes propiedades y un método:</span><span class="sxs-lookup"><span data-stu-id="29fba-177">The **UserPermission** class provides the following properties and one method.</span></span> 
  
|<span data-ttu-id="29fba-178">**Nombre**</span><span class="sxs-lookup"><span data-stu-id="29fba-178">**Name**</span></span>|<span data-ttu-id="29fba-179">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="29fba-179">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="29fba-180">Método [Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.Remove.aspx)</span><span class="sxs-lookup"><span data-stu-id="29fba-180">[Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.Remove.aspx) method</span></span>  <br/> |<span data-ttu-id="29fba-181">Quita el objeto **UserPermission** actual de los permisos del formulario.</span><span class="sxs-lookup"><span data-stu-id="29fba-181">Removes the current **UserPermission** object from the form's permissions.</span></span>  <br/> |
|<span data-ttu-id="29fba-182">[ExpirationDate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.ExpirationDate.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="29fba-182">[ExpirationDate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.ExpirationDate.aspx) property</span></span>  <br/> |<span data-ttu-id="29fba-183">Obtiene o establece la fecha de caducidad opcional de los permisos en el formulario actual asignados al usuario asociado con una instancia de la clase **UserPermission** .</span><span class="sxs-lookup"><span data-stu-id="29fba-183">Gets or sets the optional expiration date for the permissions on the current form assigned to the user associated with an instance of the **UserPermission** class.</span></span>  <br/> |
|<span data-ttu-id="29fba-184">[Permiso](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.Permission.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="29fba-184">[Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.Permission.aspx) property</span></span>  <br/> |<span data-ttu-id="29fba-185">Obtiene o establece un valor que representa los permisos sobre el formulario actual asignados al usuario asociado con una instancia de la clase **UserPermission** .</span><span class="sxs-lookup"><span data-stu-id="29fba-185">Gets or sets a value representing the permissions on the current form assigned to the user associated with an instance of the **UserPermission** class.</span></span>  <br/> |
|<span data-ttu-id="29fba-186">[UserId](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.UserId.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="29fba-186">[UserId](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.UserId.aspx) property</span></span>  <br/> |<span data-ttu-id="29fba-187">Obtiene la dirección de correo electrónico del usuario cuyos permisos en el formulario actual se determinan mediante el objeto **UserPermission** especificado.</span><span class="sxs-lookup"><span data-stu-id="29fba-187">Gets the email address of the user whose permissions on the current form are determined by the specified **UserPermission** object.</span></span>  <br/> |
   
### <a name="the-permissiontype-enumeration"></a><span data-ttu-id="29fba-188">Enumeración PermissionType</span><span class="sxs-lookup"><span data-stu-id="29fba-188">The PermissionType Enumeration</span></span>

<span data-ttu-id="29fba-189">Los permisos de un usuario se establecen o leen utilizando los valores de enumeración [PermissionType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.PermissionType.aspx) .</span><span class="sxs-lookup"><span data-stu-id="29fba-189">A user's permissions are set or read using [PermissionType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.PermissionType.aspx) enumeration values.</span></span> 
  
|<span data-ttu-id="29fba-190">**Nombre**</span><span class="sxs-lookup"><span data-stu-id="29fba-190">**Name**</span></span>|<span data-ttu-id="29fba-191">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="29fba-191">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="29fba-192">**PermissionType.Change**</span><span class="sxs-lookup"><span data-stu-id="29fba-192">**PermissionType.Change**</span></span> <br/> |<span data-ttu-id="29fba-193">Permite a los usuarios ver, editar, copiar y guardar, pero no imprimir un formulario.</span><span class="sxs-lookup"><span data-stu-id="29fba-193">Allows users to view, edit, copy, and save, but not print a form.</span></span> <span data-ttu-id="29fba-194">Equivalente a la **lectura**, los permisos **Editar**, **Guardar**y **extraer** combinan.</span><span class="sxs-lookup"><span data-stu-id="29fba-194">Equivalent to the **Read**, **Edit**, **Save**, and **Extract** permissions combined.</span></span>  <br/> |
|<span data-ttu-id="29fba-195">**PermissionType.Edit**</span><span class="sxs-lookup"><span data-stu-id="29fba-195">**PermissionType.Edit**</span></span> <br/> |<span data-ttu-id="29fba-196">Permite al usuario editar el formulario.</span><span class="sxs-lookup"><span data-stu-id="29fba-196">Allows the user to edit the form.</span></span>  <br/> |
|<span data-ttu-id="29fba-197">**PermissionType.Extract**</span><span class="sxs-lookup"><span data-stu-id="29fba-197">**PermissionType.Extract**</span></span> <br/> |<span data-ttu-id="29fba-198">Permite que a un usuario con el permiso de **lectura** para copiar contenido en el formulario.</span><span class="sxs-lookup"><span data-stu-id="29fba-198">Allows a user with the **Read** permission to copy content in the form.</span></span>  <br/> |
|<span data-ttu-id="29fba-199">**PermissionType.FullControl**</span><span class="sxs-lookup"><span data-stu-id="29fba-199">**PermissionType.FullControl**</span></span> <br/> |<span data-ttu-id="29fba-200">Permite al usuario agregar, cambiar y quitar permisos de los demás usuarios de un formulario.</span><span class="sxs-lookup"><span data-stu-id="29fba-200">Allows the user to add, change, and remove permissions for other users of a form.</span></span>  <br/> |
|<span data-ttu-id="29fba-201">**PermissionType.ObjectModel**</span><span class="sxs-lookup"><span data-stu-id="29fba-201">**PermissionType.ObjectModel**</span></span> <br/> |<span data-ttu-id="29fba-202">Permite que un usuario tener acceso al documento de formulario mediante programación a través de su modelo de objetos.</span><span class="sxs-lookup"><span data-stu-id="29fba-202">Allows a user to access the form document programmatically through its object model.</span></span> <span data-ttu-id="29fba-203">Los usuarios sin el permiso **ObjectModel** no pueden usar el modelo de objetos para determinar sus propios permisos.</span><span class="sxs-lookup"><span data-stu-id="29fba-203">Users without the **ObjectModel** permission cannot use the object model to determine their own permissions.</span></span>  <br/> |
|<span data-ttu-id="29fba-204">**PermissionType.Print**</span><span class="sxs-lookup"><span data-stu-id="29fba-204">**PermissionType.Print**</span></span> <br/> |<span data-ttu-id="29fba-205">Permite al usuario imprimir el formulario.</span><span class="sxs-lookup"><span data-stu-id="29fba-205">Allows the user to print the form.</span></span>  <br/> |
|<span data-ttu-id="29fba-206">**PermissionType.Read**</span><span class="sxs-lookup"><span data-stu-id="29fba-206">**PermissionType.Read**</span></span> <br/> |<span data-ttu-id="29fba-207">Permite al usuario leer (vista) el formulario.</span><span class="sxs-lookup"><span data-stu-id="29fba-207">Allows the user to read (view) the form.</span></span> <span data-ttu-id="29fba-208">(Los permisos de **lectura** y **la vista** son equivalentes).</span><span class="sxs-lookup"><span data-stu-id="29fba-208">(The **Read** and **View** permissions are equivalent.)</span></span>  <br/> |
|<span data-ttu-id="29fba-209">**PermissionType.Save**</span><span class="sxs-lookup"><span data-stu-id="29fba-209">**PermissionType.Save**</span></span> <br/> |<span data-ttu-id="29fba-210">Permite al usuario guardar el formulario.</span><span class="sxs-lookup"><span data-stu-id="29fba-210">Allows the user to save the form.</span></span>  <br/> |
|<span data-ttu-id="29fba-211">**PermissionType.View**</span><span class="sxs-lookup"><span data-stu-id="29fba-211">**PermissionType.View**</span></span> <br/> |<span data-ttu-id="29fba-212">Permite al usuario ver (lectura) del formulario.</span><span class="sxs-lookup"><span data-stu-id="29fba-212">Allows the user to view (read) the form.</span></span> <span data-ttu-id="29fba-213">(Los permisos de **lectura** y **la vista** son equivalentes).</span><span class="sxs-lookup"><span data-stu-id="29fba-213">(The **Read** and **View** permissions are equivalent.)</span></span>  <br/> |
   
### <a name="example"></a><span data-ttu-id="29fba-214">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="29fba-214">Example</span></span>

<span data-ttu-id="29fba-215">En el ejemplo siguiente, si se hace clic en el control **Botón**, se obtiene la colección **UserPermissionsCollection** del formulario, se agrega un usuario al que se asigna el nivel de acceso de cambio y se establece una fecha de caducidad de dos días a partir de la fecha.</span><span class="sxs-lookup"><span data-stu-id="29fba-215">In the following example, clicking the **Button** control gets the **UserPermissionsCollection** for the current form, adds and assigns a user to the Change access level, and sets an expiration date of two days from the current date.</span></span> 
  
```cs
public void CTRL1_Clicked(object sender, ClickedEventArgs e)
{
   string strExpirationDate = DateTime.Today.AddDays(2).ToString();
   DateTime dtExpirationDate = DateTime.Parse(strExpirationDate);
   this.Permission.UserPermissions.Add("someone@example.com", 
      PermissionType.Change, dtExpirationDate);
}
```

```vb
Public Sub CTRL1_Clicked(ByVal sender As Object, _
   ByVal e As ClickedEventArgs)
   Dim strExpirationDate As String = _
      DateTime.Today.AddDays(2).ToString()
   dtExpirationDate As DateTime = DateTime.Parse(strExpirationDate)
   Me.Permission.UserPermissions.Add("someone@example.com", _
      PermissionType.Change, dtExpirationDate)
End Sub
```


