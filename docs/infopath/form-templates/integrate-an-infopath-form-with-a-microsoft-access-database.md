---
title: Integrar un formulario de InfoPath con una base de datos de Microsoft Access
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 5ec9a9c0-b348-4a31-b377-e95db2f92455
description: Microsoft InfoPath admite el uso de una base de datos Microsoft Access 2010 como origen de datos principal de un formulario o como origen de datos secundario de un formulario o control. En este artículo se explica cómo usar una base de datos Access 2010 como origen de datos.
ms.openlocfilehash: dbc39e0d0908214904d77b8955f3d231f0bfb20b
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/23/2019
ms.locfileid: "32303517"
---
# <a name="integrate-an-infopath-form-with-a-microsoft-access-database"></a><span data-ttu-id="a5490-104">Integrar un formulario de InfoPath con una base de datos de Microsoft Access</span><span class="sxs-lookup"><span data-stu-id="a5490-104">Integrate an InfoPath Form with a Microsoft Access Database</span></span>

<span data-ttu-id="a5490-p102">Microsoft InfoPath admite el uso de una base de datos Microsoft Access 2010 como origen de datos principal de un formulario o como origen de datos secundario de un formulario o control. En este artículo se explica cómo usar una base de datos Access 2010 como origen de datos.</span><span class="sxs-lookup"><span data-stu-id="a5490-p102">Microsoft InfoPath supports using a Microsoft Access 2010 database as the primary data source for a form, or as a secondary data source for a form or control. This article explains how to use an Access 2010 database as a data source.</span></span>
  
## <a name="using-a-microsoft-access-database-as-a-data-source"></a><span data-ttu-id="a5490-107">Usar una base de datos de Microsoft Access como origen de datos</span><span class="sxs-lookup"><span data-stu-id="a5490-107">Using a Microsoft Access Database as a Data Source</span></span>

### <a name="setting-up-a-microsoft-access-database-as-a-forms-primary-data-source"></a><span data-ttu-id="a5490-108">Configurar una base de datos de Microsoft Access como origen de datos principal de un formulario</span><span class="sxs-lookup"><span data-stu-id="a5490-108">Setting Up a Microsoft Access Database as a Form's Primary Data Source</span></span>

<span data-ttu-id="a5490-p103">Las conexiones de las bases de datos se establecen en InfoPath mediante el **Asistente para la conexión de datos**. Este asistente se abre seleccionando **Base de datos** en la sección **Plantillas de formulario avanzadas** de la pestaña **Nuevo** del Microsoft Office Backstage y, a continuación, haciendo clic en **Diseñar este formulario**.</span><span class="sxs-lookup"><span data-stu-id="a5490-p103">Database connections are established in InfoPath by using the **Data Connection Wizard**. This wizard is opened by selecting **Database** in the **Advanced Form Templates** section on the **New** tab of the Microsoft Office Backstage, and then clicking pressing **Design This Form**.</span></span>
  
<span data-ttu-id="a5490-111">Al hacer clic en **Seleccionar base de datos**, puede elegir un origen de datos existente o conectarse directamente con un archivo de bases de datos específico.</span><span class="sxs-lookup"><span data-stu-id="a5490-111">By clicking **Select Database**, you can choose an existing data source or connect directly to a specific database file.</span></span>
  
<span data-ttu-id="a5490-p104">Una vez que selecciona la base de datos, el asistente le pedirá que seleccione una tabla de la base de datos para usarla como origen de datos del formulario. A medida que agregue tablas, se establecerán las relaciones entre ellas y el asistente mostrará las tablas y sus relaciones jerárquicas en la lista **Estructura del origen de datos**. Si activa la casilla de verificación **Mostrar las columnas de la tabla**, el asistente mostrará los nombres de los campos de cada tabla en la lista Estructura del origen de datos. Puede usar las casillas de verificación junto a cada nombre de campo para especificar si un campo está incluido en la instrucción SQL construida por el asistente.</span><span class="sxs-lookup"><span data-stu-id="a5490-p104">After you select a database, the wizard prompts you to select a table from the database to use as the data source for the form. As you add tables, their relationships to each other are established, and the wizard displays the tables and their hierarchical relationships in the **Data source structure** list. If you select the **Show table columns** check box, the wizard displays the field names of each table in the Data source structure list; you use the check boxes next to each field name to specify whether a field is included in the SQL statement that the wizard constructs.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="a5490-115">Los datos principales de cada tabla siempre están seleccionados y no se pueden quitar.</span><span class="sxs-lookup"><span data-stu-id="a5490-115">Primary key fields from each table are always selected and cannot be removed.</span></span> 
  
<span data-ttu-id="a5490-p105">Cuando se han especificado las tablas, relaciones y campos mediante el **Asistente para la conexión de datos**, puede hacer clic en **Editar SQL** para ver la instrucción SQL que se usará para establecer el origen de datos del formulario. En el cuadro de diálogo **Editar SQL**, puede hacer clic en **Probar la instrucción SQL** para comprobar si InfoPath podrá crear el origen de datos por medio de la información proporcionada. También puede usar el cuadro de diálogo **Editar SQL** para modificar la instrucción SQL para crear consultas más complejas.</span><span class="sxs-lookup"><span data-stu-id="a5490-p105">When the tables, relationships, and fields have been specified using the **Data Connection Wizard**, you can click **Edit SQL** to view the SQL statement that will be used to establish the data source for the form. In the **Edit SQL** dialog box, you can click **Test SQL Statement** to verify that InfoPath will be able to create the data source from the information provided. You can also use the **Edit SQL** dialog box to modify the SQL statement to create more complex queries.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="a5490-p106">[!NOTA] Las instrucciones SQL que usa InfoPath son consultas de forma de datos. Las consultas de forma de datos permiten la creación de relaciones jerárquicas entre dos o más entidades lógicas de una consulta. Es posible usar instrucciones JOIN de SQL, pero no se recomienda, ya que al hacerlo, se deshabilita el envío del formulario. Para obtener más información acerca de las consultas de forma de datos, vea la documentación en Microsoft Developer Network (MSDN).</span><span class="sxs-lookup"><span data-stu-id="a5490-p106">The SQL statements used by InfoPath are data shaping queries. Data shaping queries allow the building of hierarchical relationships between two or more logical entities in a query. It is possible to use SQL JOIN statements, but this is not recommended, because doing so will disable form submission. For more information on data shaping queries, see the documentation on the Microsoft Developer Network (MSDN).</span></span> 
  
<span data-ttu-id="a5490-p107">La última página del **Asistente para la conexión de datos** muestra información de resumen sobre el origen de datos, incluyendo el nombre y la ubicación del archivo de origen de datos, el nombre de la tabla primaria principal, la cantidad de tablas usadas y el estado del envío. El estado del envío le informará si la instrucción SQL generada permitirá el envío satisfactorio de datos al origen de datos.</span><span class="sxs-lookup"><span data-stu-id="a5490-p107">The last page of the **Data Connection Wizard** displays summary information about the data source, including the name and file location of the data source, the name of the primary parent table, the number of tables used, and the submit status. The submit status tells you whether the generated SQL statement will allow for successful submission of data to the data source.</span></span> 
  
### <a name="setting-up-a-microsoft-access-database-as-a-secondary-data-source"></a><span data-ttu-id="a5490-125">Configurar una base de datos de Microsoft Access como origen de datos secundario</span><span class="sxs-lookup"><span data-stu-id="a5490-125">Setting up a Microsoft Access Database as a Secondary Data Source</span></span>

<span data-ttu-id="a5490-p108">Los orígenes de datos secundarios se pueden usar para proporcionar las entradas de un cuadro de lista o de un cuadro de lista desplegable, o se puede escribir código para agregar datos procedentes de un origen de datos secundario a un formulario. Para trabajar con orígenes de datos secundarios en un formulario, haga clic en **Conexiones de datos** en la pestaña **Datos** al diseñar un formulario.</span><span class="sxs-lookup"><span data-stu-id="a5490-p108">Secondary data sources can be used to provide the entries for a list box or drop-down list box, or you can write code to add data from a secondary data source to your form. To work with secondary data sources in your form, click **Data Connections** on the **Data** tab when designing a form.</span></span> 
  
<span data-ttu-id="a5490-p109">Cuando inicia el **Asistente para la conexión de datos**, se le pedirá que seleccione si desea recibir datos para usar en el formulario o enviar datos del formulario. Elija **Recibir datos** y, a continuación, haga clic en **Siguiente**. Para crear un origen de datos secundario desde una base de datos, seleccione **Base de datos (Microsoft SQL Server o Microsoft Office Access únicamente)**. En la siguiente página del asistente, haga clic en **Seleccionar base de datos** para elegir un origen de datos existente o para conectarse directamente con un archivo de base de datos específico.</span><span class="sxs-lookup"><span data-stu-id="a5490-p109">When you start the **Data Connection Wizard**, you are prompted to select whether to receive data to use in the form, or to submit data in the form. Choose **Receive data**, and then click **Next**. To create a secondary data source from a database, select **Database (Microsoft SQL Server or Microsoft Office Access only)**. On the next page of the wizard, click **Select Database** to choose an existing data source or connect directly to a specific database file.</span></span> 
  
<span data-ttu-id="a5490-p110">Una vez seleccionada una base de datos, el asistente le pide que seleccione una tabla o consulta de la base de datos para usarla como origen de datos del formulario. Para comenzar, debe seleccionar una tabla o consulta, pero podrá seleccionar tablas adicionales más tarde si desea incluirlas. Una vez seleccionada una tabla o consulta, el asistente le permite seleccionar los campos que desea usar en la lista **Estructura del origen de datos**. De forma predeterminada, todos los campos de la tabla están seleccionados, pero puede quitar los campos que no sean necesarios para el formulario. También puede controlar cómo se ordenan los registros devueltos por la tabla y si se permiten varios registros. Para hacerlo, haga clic en **Modificar tabla** y, a continuación, seleccione hasta tres criterios de ordenación en el cuadro de diálogo **Criterio de ordenación**. Cuando quede satisfecho, haga clic en **Finalizar**.</span><span class="sxs-lookup"><span data-stu-id="a5490-p110">After you select a database, the wizard prompts you to select a table or query from the database to use as the data source for the form. You must select one table or query to begin with, but you can select additional tables later if you want to include them. After you've selected a table or query, the wizard allows you to select the fields you want to use in the **Data source structure** list. By default, all the fields of the table are selected, but you can remove fields if they aren't necessary for your form. You can also control how the records returned from the table are sorted, and whether multiple records are allowed. To do so, click **Modify Table**, and then select up to three sorting criteria in the **Sort Order** dialog box. When you're satisfied, click **Finish**.</span></span>
  
> [!NOTE]
> <span data-ttu-id="a5490-139">[!NOTA] Los datos principales de cada tabla siempre están seleccionados y no se pueden quitar.</span><span class="sxs-lookup"><span data-stu-id="a5490-139">Primary key fields from each table are always selected and cannot be removed.</span></span> 
  
<span data-ttu-id="a5490-p111">InfoPath también le permite recuperar datos de varias tablas o consultas al mismo tiempo. Cuando se recuperan datos de varias tablas o consultas, debe poder establecer una relación entre todas las tablas o consultas implicadas con la tabla o consulta original seleccionada en el **Asistente para la conexión de datos**. Por ejemplo, si estuviera recuperando datos de la tabla Clientes de la base de datos Neptuno, podría agregar la tabla Pedidos para recuperar datos de todos los pedidos de ese cliente y podría agregar la tabla Detalles del pedido para recuperar los detalles de cada pedido.</span><span class="sxs-lookup"><span data-stu-id="a5490-p111">InfoPath also enables you to retrieve data from multiple tables or queries at the same time. When you retrieve data from multiple tables or queries, you must be able to establish a relationship between all of the tables or queries involved with the original table or query you selected in the **Data Connection Wizard**. For example, if you were retrieving data from the Customers table of the Northwind database, you could add the Orders table to retrieve data about all the orders for that customer, and you could add the Order Details table to retrieve the details of each order.</span></span>
  
<span data-ttu-id="a5490-p112">Para agregar una tabla adicional al origen de datos, seleccione la tabla a la que desea agregar una tabla secundaria de la lista **Estructura del origen de datos** y, a continuación, haga clic en **Agregar tabla**. Seleccione la tabla o consulta que desea agregar y, a continuación, haga clic en **Siguiente**. InfoPath le pedirá que seleccione la relación o relaciones que desea usar. Si los campos en las dos tablas tienen el mismo nombre, InfoPath agregará automáticamente esos campos como una relación, pero si no es así o si desea usar una relación personalizada, puede hacer clic en **Agregar relación** para especificar qué campos de la tabla primaria corresponden a campos de la tabla secundaria. También puede quitar relaciones existentes haciendo clic en **Quitar relación** en el cuadro de diálogo **Editar relación**.</span><span class="sxs-lookup"><span data-stu-id="a5490-p112">To add an additional table to the data source, select the table you want to add a child table to in the **Data source structure** list, and then click **Add Table**. Select the table or query you want to add, and then click **Next**. InfoPath prompts you to select the relationship or relationships you want to use. If fields in the two tables have the same name, InfoPath automatically adds those fields as a relationship, but if not, or if you want to use a custom relationship, you can click **Add Relationship** to specify which fields in the parent table correspond to fields in the child table. You can also remove existing relationships by clicking **Remove Relationship** in the **Edit Relationship** dialog box.</span></span> 
  
<span data-ttu-id="a5490-p113">Cuando quede satisfecho con las relaciones, haga clic en **Finalizar**. Tal como se hizo con la tabla principal, podrá especificar qué campos debe devolver la tabla secundaria. Sin embargo, no podrá usar el botón **Modificar tabla** para editar el orden en que se devolverán los registros.</span><span class="sxs-lookup"><span data-stu-id="a5490-p113">When you're satisfied with the relationships, click **Finish**. As with the main table, you can specify which fields are returned from the child table. You cannot, however, use the **Modify Table** button to edit the order in which the records are returned.</span></span> 
  
<span data-ttu-id="a5490-p114">Cuando haya especificado las tablas, relaciones y campos, puede hacer clic en **Editar SQL** para ver la instrucción de consulta SQL que se usará para establecer el origen de datos del formulario. En el cuadro de diálogo **Editar SQL**, puede hacer clic en **Probar la instrucción SQL** para comprobar si InfoPath podrá crear el origen de datos por medio de la información proporcionada. También puede usar el cuadro de diálogo **Editar SQL** para modificar la instrucción SQL para crear consultas más complejas.</span><span class="sxs-lookup"><span data-stu-id="a5490-p114">When the tables, relationships, and fields have been specified, you can click **Edit SQL** to view the SQL query statement that will be used to establish the data source for the form. In the **Edit SQL** dialog box, you can click **Test SQL Statement** to verify that InfoPath will be able to create the data source from the information provided. You can also use the **Edit SQL** dialog box to modify the SQL statement to create more complex queries.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="a5490-p115">[!NOTA] Las instrucciones SQL que usa InfoPath son consultas de forma de datos. Las consultas de forma de datos permiten la creación de relaciones jerárquicas entre dos o más entidades lógicas de una consulta. Es posible usar instrucciones JOIN de SQL, pero no se recomienda, ya que al hacerlo, se deshabilita el envío del formulario. Para obtener más información acerca de las consultas de forma de datos, vea la documentación en Microsoft Developer Network (MSDN).</span><span class="sxs-lookup"><span data-stu-id="a5490-p115">The SQL statements used by InfoPath are data shaping queries. Data shaping queries allow the building of hierarchical relationships between two or more logical entities in a query. It is possible to use SQL JOIN statements, but this is not recommended, because doing so will disable form submission. For more information on data shaping queries, see the documentation on the Microsoft Developer Network (MSDN).</span></span> 
  
## <a name="enabling-form-submission"></a><span data-ttu-id="a5490-158">Habilitar el envío del formulario</span><span class="sxs-lookup"><span data-stu-id="a5490-158">Enabling Form Submission</span></span>

<span data-ttu-id="a5490-p116">Además de recibir datos desde una base de datos de Access, InfoPath puede enviar datos nuevos o cambiados de vuelta a la base de datos. Cuando se usa el comando **Enviar** de la pestaña **Inicio** o el Microsoft Office Backstage para enviar los cambios a la base de datos, InfoPath usa objetos de datos de ActiveX (ADO) para actualizar los registros de la base de datos. Se habilitará el envío del formulario cuando se cumplan todas las siguientes condiciones:</span><span class="sxs-lookup"><span data-stu-id="a5490-p116">In addition to receiving data from an Access database, InfoPath can submit new or changed data back to the database. When you use the **Submit** command on the **Home** tab or the Microsoft Office Backstage to submit changes to the database, InfoPath uses ActiveX Data Objects (ADO) to update the records in the database. Form submission is enabled when all of the following conditions are met:</span></span> 
  
- <span data-ttu-id="a5490-162">Debe haber una columna base para cada columna que se use en la consulta del formulario.</span><span class="sxs-lookup"><span data-stu-id="a5490-162">There must be a base column for every column that is used in the form's query.</span></span>
    
- <span data-ttu-id="a5490-163">La columna de una tabla no debe aparecer varias veces en toda la consulta.</span><span class="sxs-lookup"><span data-stu-id="a5490-163">A table column may not appear multiple times in the entire query.</span></span>
    
- <span data-ttu-id="a5490-164">Una clave principal, restricción única o índice único deben estar disponibles para cada tabla de una cláusula SELECT usada en la consulta del formulario.</span><span class="sxs-lookup"><span data-stu-id="a5490-164">A primary key, unique constraint, or unique index must be available for every table in a SELECT clause that is used in the form's query.</span></span>
    
- <span data-ttu-id="a5490-165">Una tabla no se puede incluir varias veces en la consulta del formulario.</span><span class="sxs-lookup"><span data-stu-id="a5490-165">A table cannot be included multiple times in the form's query.</span></span>
    
- <span data-ttu-id="a5490-166">Las relaciones entre las tablas primarias y secundarias deben incluir todas las columnas principales de la tabla primaria.</span><span class="sxs-lookup"><span data-stu-id="a5490-166">Relationships between parent and child tables must include all primary key columns from the parent table.</span></span>
    
- <span data-ttu-id="a5490-167">Solo puede haber una tabla base para todas las columnas de una cláusula SELECT que se usa en la consulta del formulario.</span><span class="sxs-lookup"><span data-stu-id="a5490-167">There can only be one base table for all columns in a SELECT clause that is used in the form's query.</span></span>
    
<span data-ttu-id="a5490-p117">Existen algunas circunstancias bajo las cuales InfoPath no puede enviar cambios del formulario a una base de datos. Por ejemplo, si crea un formulario que extrae datos de una consulta en lugar de una tabla o si personaliza la instrucción SQL usada por InfoPath para incluir una instrucción JOIN, InfoPath no podrá enviar los cambios. Otra circunstancia que impide que InfoPath envíe cambios se produce si se agregan al formulario tablas que tienen una relación de varios a uno con su tabla primaria. En situaciones en las que InfoPath no puede enviar cambios a la base de datos, el campo **Enviar estado** de la última página del **Asistente para la conexión de datos** mostrará la razón de la limitación.</span><span class="sxs-lookup"><span data-stu-id="a5490-p117">There are some circumstances under which InfoPath cannot submit form changes to a database. For example, if you create a form that draws data from a query instead of a table, or if you customize the SQL statement that is used by InfoPath to include a JOIN statement, InfoPath will be unable to submit changes. Another circumstance that would prevent InfoPath from submitting changes is if you were to add tables to the form that have a many-to-one relationship with their parent table. In situations where InfoPath will be unable to submit changes to the database, the **Submit status** field on the last page of the **Data Connection Wizard** will display the reason for the limitation.</span></span> 
  

