---
title: Controlar los errores con el modelo de objetos de InfoPath 2003
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- infopath 2003-compatible form templates, handling errors,InfoPath 2003-compatible form templates, error handling,form templates [InfoPath 2007], error handling,error handling [InfoPath 2007], InfoPath 2003-compatible form templates
localization_priority: Normal
ms.assetid: eeb05205-d6f4-4931-b9a9-55a663bb1a25
description: Al crear aplicaciones personalizadas, los programadores deben con frecuencia controlar errores, lo que supone escribir código de programación para comprobar los errores generados por la aplicación o para crear y generar errores personalizados. El modelo de objetos compatible con InfoPath 2003 admite el control de errores mediante el uso del objeto ErrorObject en asociación con la colección ErrorsCollection .
ms.openlocfilehash: 577e531d8943dc8fc3884cd81f68b11ca285c5d3
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19815890"
---
# <a name="handle-errors-using-the-infopath-2003-object-model"></a><span data-ttu-id="404db-105">Controlar los errores con el modelo de objetos de InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="404db-105">Handle Errors Using the InfoPath 2003 Object Model</span></span>

<span data-ttu-id="404db-p102">Al crear aplicaciones personalizadas, los programadores deben con frecuencia controlar errores, lo que supone escribir código de programación para comprobar los errores generados por la aplicación o para crear y generar errores personalizados. El modelo de objetos compatible con InfoPath 2003 admite el control de errores mediante el uso del objeto [ErrorObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorObject.aspx) en asociación con la colección [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) .</span><span class="sxs-lookup"><span data-stu-id="404db-p102">When creating custom applications, developers must often perform error handling that involves writing programming code to check for errors raised by the application or to create and raise custom errors. The InfoPath 2003-compatible object model supports error handling through the use of the [ErrorObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorObject.aspx) object in association with the [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) collection.</span></span> 
  
<span data-ttu-id="404db-108">En InfoPath, se pueden producir errores cuando al escribir datos en un formulario se genera un error en la validación del esquema XML, cuando se produce un error en una restricción de validación personalizada, cuando el método [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReportError.aspx) del objeto [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) genera un error o cuando se crea un error con el método [Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) de la colección [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) .</span><span class="sxs-lookup"><span data-stu-id="404db-108">In InfoPath, errors can occur when data entered into a form fails XML schema validation, when a custom validation constraint fails, when an error is generated by the [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReportError.aspx) method of the [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) object, or when an error is created using the [Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) method of the [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) collection.</span></span> 
  
## <a name="overview-of-the-errorscollection-collection"></a><span data-ttu-id="404db-109">Información general sobre la colección ErrorsCollection</span><span class="sxs-lookup"><span data-stu-id="404db-109">Overview of the ErrorsCollection Collection</span></span>

<span data-ttu-id="404db-110">La colección **ErrorsCollection** proporciona los siguientes métodos y propiedades que los programadores de formularios pueden utilizar para administrar los objetos **ErrorObject** que contiene.</span><span class="sxs-lookup"><span data-stu-id="404db-110">The **ErrorsCollection** collection provides the following methods and properties, which form developers can use to manage the **ErrorObject** objects that the collection contains.</span></span> 
  
|<span data-ttu-id="404db-111">**Nombre**</span><span class="sxs-lookup"><span data-stu-id="404db-111">**Name**</span></span>|<span data-ttu-id="404db-112">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="404db-112">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="404db-113">Método [Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx)</span><span class="sxs-lookup"><span data-stu-id="404db-113">[Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) method</span></span>  <br/> |<span data-ttu-id="404db-114">Crea un objeto **ErrorObject** y lo agrega a la colección.</span><span class="sxs-lookup"><span data-stu-id="404db-114">Creates an **ErrorObject** object and adds it to the collection.</span></span>  <br/> |
|<span data-ttu-id="404db-115">Método [Delete](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Delete.aspx)</span><span class="sxs-lookup"><span data-stu-id="404db-115">[Delete](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Delete.aspx) method</span></span>  <br/> |<span data-ttu-id="404db-116">Elimina todos los objetos **ErrorObject** asociados al nodo XML especificado y al nombre de la condición, excepto los errores personalizados agregados mediante el método **ReportError**.</span><span class="sxs-lookup"><span data-stu-id="404db-116">Deletes all **ErrorObject** objects associated with the specified XML node and condition name, except for custom errors added using the **ReportError** method.</span></span>  <br/> |
|<span data-ttu-id="404db-117">Método [DeleteAll](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.DeleteAll.aspx)</span><span class="sxs-lookup"><span data-stu-id="404db-117">[DeleteAll](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.DeleteAll.aspx) method</span></span>  <br/> |<span data-ttu-id="404db-118">Elimina todos los objetos **ErrorObject** contenidos en la colección.</span><span class="sxs-lookup"><span data-stu-id="404db-118">Deletes all **ErrorObject** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="404db-119">[Count](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Count.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="404db-119">[Count](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="404db-120">Obtiene el número de objetos **ErrorObject** contenidos en la colección.</span><span class="sxs-lookup"><span data-stu-id="404db-120">Gets a count of the number of **ErrorObject** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="404db-121">[Elemento](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Item.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="404db-121">[Item](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="404db-122">Obtiene una referencia a un objeto **ErrorObject** basada en el número de índice especificado.</span><span class="sxs-lookup"><span data-stu-id="404db-122">Gets a reference to an **ErrorObject** object based on the specified index number.</span></span>  <br/> |
   
## <a name="overview-of-the-errorobject-object"></a><span data-ttu-id="404db-123">Información general sobre el objeto ErrorObject</span><span class="sxs-lookup"><span data-stu-id="404db-123">Overview of the ErrorObject Object</span></span>

<span data-ttu-id="404db-124">El objeto **ErrorObject** proporciona las siguientes propiedades que pueden usar los programadores de formularios para tener acceso a la información sobre el error que se produjo.</span><span class="sxs-lookup"><span data-stu-id="404db-124">The **ErrorObject** object provides the following properties, which form developers can use to access information about the error that was raised.</span></span> 
  
|<span data-ttu-id="404db-125">**Nombre**</span><span class="sxs-lookup"><span data-stu-id="404db-125">**Name**</span></span>|<span data-ttu-id="404db-126">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="404db-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="404db-127">[ConditionName](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ConditionName.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="404db-127">[ConditionName](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ConditionName.aspx) property</span></span>  <br/> |<span data-ttu-id="404db-128">Obtiene el nombre de la condición de error o devuelve el valor **null**, en función del tipo de objeto **ErrorObject**.</span><span class="sxs-lookup"><span data-stu-id="404db-128">Gets the name of the error condition, or returns **null**, depending on the type of **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="404db-129">[DetailedErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.DetailedErrorMessage.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="404db-129">[DetailedErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.DetailedErrorMessage.aspx) property</span></span>  <br/> |<span data-ttu-id="404db-130">Obtiene o establece el mensaje de error detallado del objeto **ErrorObject**.</span><span class="sxs-lookup"><span data-stu-id="404db-130">Gets or sets the detailed error message of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="404db-131">[ErrorCode (](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorCode.aspx) propiedad)</span><span class="sxs-lookup"><span data-stu-id="404db-131">[ErrorCode](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorCode.aspx) property</span></span>  <br/> |<span data-ttu-id="404db-132">Obtiene o establece el código de error del objeto **ErrorObject**.</span><span class="sxs-lookup"><span data-stu-id="404db-132">Gets or sets the error code of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="404db-133">[Node](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.Node.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="404db-133">[Node](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.Node.aspx) property</span></span>  <br/> |<span data-ttu-id="404db-134">Obtiene una referencia al nodo XML asociado al objeto **ErrorObject**.</span><span class="sxs-lookup"><span data-stu-id="404db-134">Gets a reference to the XML node associated with the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="404db-135">[ShortErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ShortErrorMessage.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="404db-135">[ShortErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ShortErrorMessage.aspx) property</span></span>  <br/> |<span data-ttu-id="404db-136">Obtiene o establece el mensaje de error breve del objeto **ErrorObject**.</span><span class="sxs-lookup"><span data-stu-id="404db-136">Gets or sets the short error message of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="404db-137">[ErrorType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorType.aspx) (propiedad)</span><span class="sxs-lookup"><span data-stu-id="404db-137">[ErrorType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorType.aspx) property</span></span>  <br/> |<span data-ttu-id="404db-138">Obtiene el tipo del objeto **ErrorObject**.</span><span class="sxs-lookup"><span data-stu-id="404db-138">Gets the type of the **ErrorObject** object.</span></span>  <br/> |
   
## <a name="using-the-errorscollection-and-errorobject"></a><span data-ttu-id="404db-139">Uso de ErrorsCollection y ErrorObject</span><span class="sxs-lookup"><span data-stu-id="404db-139">Using the ErrorsCollection and ErrorObject</span></span>

<span data-ttu-id="404db-p103">A la colección **ErrorsCollection** se tiene acceso a través de la propiedad [Errors](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument.Errors.aspx) del objeto [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) . La colección **ErrorsCollection** está asociada al documento XML subyacente de un formulario, de modo que cuando se produce un error, se produce dentro del documento XML. En el siguiente ejemplo se muestra cómo usar un bucle **foreach** de Visual C# para comprobar si existen errores en el documento subyacente de un formulario. En caso afirmativo, la función recorre en bucle todos ellos y, utilizando la propiedad **ShortErrorMessage** del objeto **ErrorObject**, muestra un cuadro de mensaje al usuario.</span><span class="sxs-lookup"><span data-stu-id="404db-p103">The **ErrorsCollection** collection is accessed through the [Errors](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument.Errors.aspx) property of the [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) object. The **ErrorsCollection** collection is associated with a form's underlying XML document so that when an error occurs, it occurs within the XML document. The following example demonstrates how a Visual C# **foreach** loop can be used to check the errors that may exist in a form's underlying XML document. If there are errors, the function loops through each of them, and, using the **ShortErrorMessage** property of the **ErrorObject** object, displays a message box to the user.</span></span> 
  
```cs
public void CheckErrors(IXMLDOMNode xmlNode)
{
   foreach(ErrorObject err in thisXDocument.Errors)
   {
      if(xmlNode==err.Node)
         thisXDocument.UI.Alert("The following error has occured: "
             + err.ShortErrorMessage + ".");
   }
}
```

<span data-ttu-id="404db-p104">A la función anterior se puede llamar desde uno de los controladores de eventos de validación de datos del formulario. Por ejemplo, cuando se utiliza en el evento [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) de un campo del formulario, la llamada a la función transmitiría el argumento del nodo XML usando la propiedad [Site](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.Site.aspx) del objeto [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) como se muestra a continuación.</span><span class="sxs-lookup"><span data-stu-id="404db-p104">The preceding function could be called from one of the form's data validation event handlers. For example, when used in the [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) event handler for a field in the form, the call to the function would pass the XML node argument using the [Site](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.Site.aspx) property of the [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) object as follows.</span></span> 
  
```cs
CheckErrors(e.Site);
```

<span data-ttu-id="404db-p105">Además de controlar los errores generados por InfoPath, los programadores de formularios producen errores personalizados, utilizando el método **ReportError** del objeto **DataDOMEventObject**, o bien utilizando el método **Add** de la colección **ErrorsCollection**. Para obtener información sobre el uso de los métodos **ReportError** o **Add**, haga clic en los métodos, que figuran al principio de este tema.</span><span class="sxs-lookup"><span data-stu-id="404db-p105">In addition to handling errors generated by InfoPath, form developers can also generate custom errors by using the **ReportError** method of the **DataDOMEventObject** object, or by using the **Add** method of the **ErrorsCollection** collection. For information about using the **ReportError** or **Add** methods, click the methods at the beginning of this topic.</span></span> 
  
## <a name="handling-managed-code-exceptions"></a><span data-ttu-id="404db-148">Controlar las excepciones de código administrado</span><span class="sxs-lookup"><span data-stu-id="404db-148">Handling Managed-Code Exceptions</span></span>

<span data-ttu-id="404db-149">Puede utilizar el control de las excepciones try-catch para controlar aquéllas que se produzcan en una plantilla de formulario con código administrado, tal como se muestra en el siguiente ejemplo de código.</span><span class="sxs-lookup"><span data-stu-id="404db-149">You can use try-catch exception handling to handle exceptions raised in managed-code form template as shown in the following code example.</span></span>
  
```cs
DataAdapters dataAdapters;
dataAdapters = thisXDocument.DataAdapters; 
XMLFileAdapterObject queryXMLFile = 
   (XMLFileAdapterObject)dataAdapters["form1"];
// Perform the query.
try
{
   queryXMLFile.Query();
}
catch (Exception ex)
{
   thisXDocument.UI.Alert("Failed to query.\n\n" + ex.Message);
}
// Perform the submit.
try
{
   queryXMLFile.Submit();
}
catch (Exception ex)
{
   thisXDocument.UI.Alert("Failed to submit.\n\n" + ex.Message);
}
```

<span data-ttu-id="404db-150">Si no utiliza el control de las excepciones try-catch en el código del formulario, InfoPath mostrará información sobre las excepciones no controladas en el cuadro de diálogo de errores de InfoPath mientras se depura y se obtiene una vista previa.</span><span class="sxs-lookup"><span data-stu-id="404db-150">If you do not use try-catch exception handling in your form code, InfoPath will display information about unhandled exceptions in the InfoPath error dialog box while debugging and previewing.</span></span> 
  

