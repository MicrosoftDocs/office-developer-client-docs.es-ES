---
title: Responder a eventos de formulario mediante el modelo de objetos de InfoPath 2003
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- form templates [infopath 2007], responding to events,InfoPath 2003-compatible form templates, responding to form events
localization_priority: Normal
ms.assetid: 59e9c1ed-32a8-4bcd-bdfc-9aa568a34d2a
description: Es posible escribir código para responder a diversos eventos que pueden ocurrir cuando un usuario rellena un formulario. Para trabajar con eventos en InfoPath, se deben crear controladores de eventos en el diseñador de InfoPath.
ms.openlocfilehash: b7347f882df991e64bdf4e76c471b1220a84dc58
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33433496"
---
# <a name="respond-to-form-events-using-the-infopath-2003-object-model"></a><span data-ttu-id="cd81d-105">Responder a eventos de formulario mediante el modelo de objetos de InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="cd81d-105">Respond to Form Events Using the InfoPath 2003 Object Model</span></span>

<span data-ttu-id="cd81d-p102">Es posible escribir código para responder a diversos eventos que pueden ocurrir cuando un usuario rellena un formulario. Para trabajar con eventos en InfoPath, se deben crear controladores de eventos en el diseñador de InfoPath.</span><span class="sxs-lookup"><span data-stu-id="cd81d-p102">You can write code to respond to various events that can occur as a user fills out a form. To work with events in InfoPath, you create event handlers in the InfoPath designer.</span></span>
  
<span data-ttu-id="cd81d-p103">Los controladores de eventos de InfoPath se deben crear en el diseñador de InfoPath, ya que, al usar el modelo de objetos compatible con InfoPath 2003, InfoPath agrega automáticamente la declaración correcta y aplica un atributo ([InfoPathEventHandlerAttribute](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.aspx) ) al archivo de código del formulario (FormCode.cs o FormCode.vb) para identificar y recibir el controlador de eventos. Una vez creado un controlador de eventos, no se debe modificar su declaración ni su atributo en el archivo de código del formulario.</span><span class="sxs-lookup"><span data-stu-id="cd81d-p103">InfoPath event handlers should be created in the InfoPath designer because, when using the InfoPath 2003-compatible object model, InfoPath automatically adds the correct declaration and applies an attribute ([InfoPathEventHandlerAttribute](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.aspx) ) in a form's code file (FormCode.cs or FormCode.vb) to identify and sink the event handler. After you have created an event handler, you should not alter its declaration and attribute in the form's code file.</span></span> 
  
<span data-ttu-id="cd81d-110">Para obtener información acerca de cómo crear los controladores de eventos de InfoPath, vea Agregar un controlador de eventos mediante el modelo de objetos de [InfoPath 2003](how-to-add-an-event-handler-using-the-infopath-2003-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="cd81d-110">For information about creating the InfoPath event handlers, see [Add an Event Handler Using the InfoPath 2003 Object Model](how-to-add-an-event-handler-using-the-infopath-2003-object-model.md).</span></span>
  
## <a name="overview-of-the-event-objects"></a><span data-ttu-id="cd81d-111">Información general sobre los objetos de eventos</span><span class="sxs-lookup"><span data-stu-id="cd81d-111">Overview of the Event Objects</span></span>

<span data-ttu-id="cd81d-p104">El modelo de objetos compatible con InfoPath 2003 implementa nueve objetos de eventos que se exponen en el espacio de nombres [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) . En la siguiente tabla se muestran todos los objetos de eventos de InfoPath, los controladores de eventos a los que están asociados y la descripción de la funcionalidad que aportan.</span><span class="sxs-lookup"><span data-stu-id="cd81d-p104">The InfoPath 2003-compatible object model implements nine event objects that are exposed in the [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) namespace. The following table lists each of the InfoPath event objects, the event handlers they are associated with, and a description of the functionality they provide.</span></span> 
  
|<span data-ttu-id="cd81d-114">**Nombre**</span><span class="sxs-lookup"><span data-stu-id="cd81d-114">**Name**</span></span>|<span data-ttu-id="cd81d-115">**Controladores de eventos**</span><span class="sxs-lookup"><span data-stu-id="cd81d-115">**Event handlers**</span></span>|<span data-ttu-id="cd81d-116">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="cd81d-116">**Description**</span></span>|
|:-----|:-----|:-----|
|[<span data-ttu-id="cd81d-117">DataDOMEvent</span><span class="sxs-lookup"><span data-stu-id="cd81d-117">DataDOMEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.aspx) <br/> |[<span data-ttu-id="cd81d-118">OnBeforeChange</span><span class="sxs-lookup"><span data-stu-id="cd81d-118">OnBeforeChange</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnBeforeChange.aspx) <br/> <span data-ttu-id="cd81d-119">[OnValidate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnValidate.aspx) , [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx)</span><span class="sxs-lookup"><span data-stu-id="cd81d-119">[OnValidate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnValidate.aspx) , [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx)</span></span> <br/> |<span data-ttu-id="cd81d-p105">Devuelve una referencia al documento XML subyacente de un formulario, el estado de retorno y otras propiedades que contienen información sobre el nodo XML durante un cambio de Modelo de objetos de documento (DOM) XML. También incluye un método para generar un error.</span><span class="sxs-lookup"><span data-stu-id="cd81d-p105">Returns a reference to a form's underlying XML document, the return status, and other properties that contain information about the XML node during an XML Document Object Model (DOM) change. Also includes a method for raising an error.</span></span>  <br/> |
|[<span data-ttu-id="cd81d-122">DocActionEvent</span><span class="sxs-lookup"><span data-stu-id="cd81d-122">DocActionEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DocActionEvent.aspx) <br/> |[<span data-ttu-id="cd81d-123">OnClick</span><span class="sxs-lookup"><span data-stu-id="cd81d-123">OnClick</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._ButtonEventSink_Event.OnClick.aspx) <br/> |<span data-ttu-id="cd81d-124">Devuelve una referencia al documento XML subyacente de un formulario, el estado de retorno y el nodo XML de origen cuando se hace clic en un botón del área del formulario.</span><span class="sxs-lookup"><span data-stu-id="cd81d-124">Returns a reference to a form's underlying XML document, the return status, and the source XML node during a button click in the form area.</span></span>  <br/> |
|[<span data-ttu-id="cd81d-125">DocContextChangeEvent</span><span class="sxs-lookup"><span data-stu-id="cd81d-125">DocContextChangeEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DocContextChangeEvent.aspx) <br/> |[<span data-ttu-id="cd81d-126">OnContextChange</span><span class="sxs-lookup"><span data-stu-id="cd81d-126">OnContextChange</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnContextChange.aspx) <br/> |<span data-ttu-id="cd81d-127">Devuelve información sobre el nodo del Modelo de objetos de documento XML (DOM) que es el contexto actual del documento XML subyacente del formulario.</span><span class="sxs-lookup"><span data-stu-id="cd81d-127">Returns information about the XML Document Object Model (DOM) node that is the current context of the form's underlying XML document.</span></span>  <br/> |
|[<span data-ttu-id="cd81d-128">DocEvent</span><span class="sxs-lookup"><span data-stu-id="cd81d-128">DocEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DocEvent.aspx) <br/> |<span data-ttu-id="cd81d-129">[OnSwitchView](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnSwitchView.aspx) , [OnAfterImport](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnAfterImport.aspx)</span><span class="sxs-lookup"><span data-stu-id="cd81d-129">[OnSwitchView](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnSwitchView.aspx) , [OnAfterImport](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnAfterImport.aspx)</span></span> <br/> |<span data-ttu-id="cd81d-130">Devuelve una referencia al documento XML subyacente de un formulario al realizar una operación de cambio de vista o combinación de formularios.</span><span class="sxs-lookup"><span data-stu-id="cd81d-130">Returns a reference to a form's underlying XML document during a switch view or form merge operation.</span></span>  <br/> |
|[<span data-ttu-id="cd81d-131">DocReturnEvent</span><span class="sxs-lookup"><span data-stu-id="cd81d-131">DocReturnEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DocReturnEvent.aspx) <br/> |<span data-ttu-id="cd81d-132">[OnLoad](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnLoad.aspx) , [OnSubmitRequest](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnSubmitRequest.aspx)</span><span class="sxs-lookup"><span data-stu-id="cd81d-132">[OnLoad](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnLoad.aspx) , [OnSubmitRequest](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnSubmitRequest.aspx)</span></span> <br/> |<span data-ttu-id="cd81d-133">Devuelve una referencia al documento XML subyacente de un formulario y el estado de retorno durante la carga o el envío de un formulario.</span><span class="sxs-lookup"><span data-stu-id="cd81d-133">Returns a reference to a form's underlying XML document and the return status during the loading or submission of a form.</span></span>  <br/> |
|[<span data-ttu-id="cd81d-134">MergeEvent</span><span class="sxs-lookup"><span data-stu-id="cd81d-134">MergeEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.MergeEvent.aspx) <br/> |[<span data-ttu-id="cd81d-135">OnMergeRequest</span><span class="sxs-lookup"><span data-stu-id="cd81d-135">OnMergeRequest</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnMergeRequest.aspx) <br/> |<span data-ttu-id="cd81d-136">Devuelve las propiedades y los métodos que se pueden utilizar durante un evento **OnMergeRequest** para interaccionar mediante programación con un documento XML subyacente del formulario y determinar las propiedades de combinación, como el número de archivos que se combinan.</span><span class="sxs-lookup"><span data-stu-id="cd81d-136">Returns properties and methods that can be used during an **OnMergeRequest** event to programmatically interact with a form's underlying XML document and to determine merge properties such as the number of files being merged.</span></span>  <br/> |
|[<span data-ttu-id="cd81d-137">SaveEvent</span><span class="sxs-lookup"><span data-stu-id="cd81d-137">SaveEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SaveEvent.aspx) <br/> |[<span data-ttu-id="cd81d-138">OnSaveRequest</span><span class="sxs-lookup"><span data-stu-id="cd81d-138">OnSaveRequest</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnSaveRequest.aspx) <br/> |<span data-ttu-id="cd81d-139">Devuelve propiedades y métodos que se pueden usar durante la operación para guardar desde el controlador de eventos **OnSaveRequest** para interaccionar mediante programación con un documento XML subyacente del formulario, determinar las propiedades de guardado y realizar la operación de guardado.</span><span class="sxs-lookup"><span data-stu-id="cd81d-139">Returns a number of properties and methods that can be used during a save operation from the **OnSaveRequest** event handler to programmatically interact with a form's underlying XML document, determine save properties, and perform the save operation.</span></span>  <br/> |
|[<span data-ttu-id="cd81d-140">SignEvent</span><span class="sxs-lookup"><span data-stu-id="cd81d-140">SignEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignEvent.aspx) <br/> |[<span data-ttu-id="cd81d-141">OnSign</span><span class="sxs-lookup"><span data-stu-id="cd81d-141">OnSign</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnSign.aspx) <br/> |<span data-ttu-id="cd81d-142">Se utiliza para agregar datos adicionales a la firma digital.</span><span class="sxs-lookup"><span data-stu-id="cd81d-142">Used to add additional data to the digital signature.</span></span>  <br/> |
|[<span data-ttu-id="cd81d-143">VersionUpgradeEvent</span><span class="sxs-lookup"><span data-stu-id="cd81d-143">VersionUpgradeEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.VersionUpgradeEvent.aspx) <br/> |[<span data-ttu-id="cd81d-144">OnVersionUpgrade</span><span class="sxs-lookup"><span data-stu-id="cd81d-144">OnVersionUpgrade</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnVersionUpgrade.aspx) <br/> |<span data-ttu-id="cd81d-145">Devuelve una referencia al documento XML subyacente de un formulario, el estado de retorno así como los números de versión del documento y la solución durante la operación de actualización de versiones.</span><span class="sxs-lookup"><span data-stu-id="cd81d-145">Returns a reference to a form's underlying XML document, the return status, and the document and solution version numbers during the version upgrade operation.</span></span>  <br/> |
   
## <a name="using-the-event-objects"></a><span data-ttu-id="cd81d-146">Utilizar objetos de eventos</span><span class="sxs-lookup"><span data-stu-id="cd81d-146">Using the Event Objects</span></span>

<span data-ttu-id="cd81d-p106">Al crear un controlador de eventos, InfoPath crea la declaración de éste en el archivo de código de formulario del proyecto (FormCode.cs o FormCode.vb). En la declaración del controlador de eventos, InfoPath utiliza **e** como nombre del parámetro que se transmite al controlador de eventos. Este parámetro contiene el objeto de eventos que está asociado al controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="cd81d-p106">When you create an event handler, InfoPath creates the event handler's declaration in the project's form code file (FormCode.cs or FormCode.vb). In the declaration of the event handler, InfoPath uses **e** as the name of the parameter that is passed to the event handler. This parameter contains the event object that is associated with the event handler.</span></span> 
  
<span data-ttu-id="cd81d-150">Por ejemplo, si se crea un controlador de eventos para el evento **OnLoad** en el modo de diseño (haciendo clic en **Evento Al cargar (OnLoad)** en la ficha **Programador**), InfoPath agrega la declaración del controlador de eventos que recibe el objeto **DocReturnEvent** al archivo de código de formulario y, después, abre el Editor de código para que pueda agregar el código a la siguiente declaración del controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="cd81d-150">For example, when you create an event handler for the **OnLoad** event in design mode (by clicking **On Load Event** on the **Developer** tab), InfoPath adds the declaration for the event handler that receives the **DocReturnEvent** object to the form code file, and then opens the Code Editor so that you can add your code to the following event handler declaration.</span></span> 
  
```cs
// The following function handler is created by Microsoft Office 
// InfoPath. Do not modify the type or number of arguments.
[InfoPathEventHandler(EventType=InfoPathEventType.OnLoad)]
public void FormEvents_OnLoad(DocReturnEvent e)
{
   // Write your code here.
}
```

```vb
' The following function handler is created by Microsoft Office 
' InfoPath. Do not modify the type or number of arguments.
<InfoPathEventHandler(EventType:=InfoPathEventType.OnLoad)> _
Public Sub FormEvents_OnLoad(ByVal e As DocReturnEvent)
   ' Write your code here.
End Sub
```

<span data-ttu-id="cd81d-p107">Al escribir código para un controlador de eventos, puede utilizar las propiedades y los métodos implementados por el objeto de eventos que se transmite mediante el parámetro **e**. Por ejemplo, en el controlador de eventos **OnBeforeChange** que se muestra a continuación, la propiedad [NewValue](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.NewValue.aspx) del objeto de eventos **DataDOMEvent** se utiliza para comprobar el valor del campo que se acaba de cambiar. Si está en blanco, la propiedad [ReturnMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReturnMessage.aspx) del objeto de eventos **DataDOMEvent** se utiliza para mostrar un error al usuario en un cuadro de diálogo y la propiedad [ReturnStatus](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReturnStatus.aspx) se establece en **false**, para indicar que los cambios que ha realizado el usuario no se deberían aceptar.</span><span class="sxs-lookup"><span data-stu-id="cd81d-p107">When writing code for an event handler, you can use the properties and methods implemented by the event object that is passed through the **e** parameter. For example, in the following **OnBeforeChange** event handler, the [NewValue](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.NewValue.aspx) property of the **DataDOMEvent** event object is used to check the value of the field that was just changed. If it is blank, the [ReturnMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReturnMessage.aspx) property of the **DataDOMEvent** event object is used to display an error to the user in a dialog box, and the [ReturnStatus](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReturnStatus.aspx) property is set to **false**, indicating that the changes the user made should not be accepted.</span></span>
  
```cs
[InfoPathEventHandler(MatchPath="/my:myFields/my:field1", 
    EventType=InfoPathEventType.OnBeforeChange)]
public void field1_OnBeforeChange(DataDOMEvent e)
{
   // Determine whether there is a new value.
   if ((string)e.NewValue == "")
   {
      // The value is blank, so display an error message and roll
      // back the changes.
      e.ReturnMessage = "You must supply a value for this field.";
      e.ReturnStatus = false;
      return;
   }
}
```

```vb
<InfoPathEventHandler(MatchPath:="/my:myFields/my:field1", _ EventType:=InfoPathEventType.OnBeforeChange)> _
Public Sub field1_OnBeforeChange(ByVal e As DataDOMEvent)
   ' Determine whether there is a new value.
   If (e.NewValue = "") Then
      ' The value is blank, so display an error message and roll back
      ' the changes.
      e.ReturnMessage = "You must supply a value for this field."
      e.ReturnStatus = False
      Return
   End If
End Sub
```

> [!NOTE]
> <span data-ttu-id="cd81d-p108">[!NOTA] Cada uno de los objetos de eventos de InfoPath del modelo de objetos compatibles con InfoPath 2003 implementa propiedades y métodos diferentes. Para obtener más información sobre un objeto de eventos concreto, haga clic en él en la tabla de objetos de eventos anterior.</span><span class="sxs-lookup"><span data-stu-id="cd81d-p108">Each of the InfoPath event objects in the InfoPath 2003-compatible object model implements different properties and methods. For more information about a particular event object, click the appropriate object in the Event Objects table shown earlier.</span></span> 
  

