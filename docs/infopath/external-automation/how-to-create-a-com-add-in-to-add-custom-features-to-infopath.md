---
title: Crear un complemento COM para agregar características personalizadas a InfoPath
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- InfoPath 2007, creación de complementos com, InfoPath 2007, agregar características personalizadas, complementos de COM [InfoPath 2007]
localization_priority: Normal
ms.assetid: af0b0bc9-20ef-4503-8b3b-8f2a97b671a2
description: Microsoft InfoPath admite complementos COM para ampliar la experiencia de usuario de edición de formularios. Aunque la compatibilidad con complementos COM en primer lugar se agregan en InfoPath, otras aplicaciones de Office, como Microsoft Office Word y Microsoft Office Excel, han admitido complementos COM desde Office 2000.
ms.openlocfilehash: 4c70dfb71cf7b15a0978b4567ffac02a8ba524c3
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19815767"
---
# <a name="create-a-com-add-in-to-add-custom-features-to-infopath"></a><span data-ttu-id="60deb-105">Crear un complemento COM para agregar características personalizadas a InfoPath</span><span class="sxs-lookup"><span data-stu-id="60deb-105">Create a COM Add-in to Add Custom Features to InfoPath</span></span>

<span data-ttu-id="60deb-106">Microsoft InfoPath admite complementos COM para ampliar la experiencia de usuario de edición de formularios.</span><span class="sxs-lookup"><span data-stu-id="60deb-106">Microsoft InfoPath supports COM Add-ins for extending the form editing user experience.</span></span> <span data-ttu-id="60deb-107">Aunque la compatibilidad con complementos COM en primer lugar se agregan en InfoPath, otras aplicaciones de Office, como Microsoft Office Word y Microsoft Office Excel, han admitido complementos COM desde Office 2000.</span><span class="sxs-lookup"><span data-stu-id="60deb-107">Although support for COM Add-ins was first added in InfoPath, other Office applications such as Microsoft Office Word and Microsoft Office Excel have supported COM add-ins since Office 2000.</span></span>
  
<span data-ttu-id="60deb-108">Add-compatibilidad con COM en InfoPath está disponible para el entorno de edición de formularios.</span><span class="sxs-lookup"><span data-stu-id="60deb-108">COM Add-in support in InfoPath is available for the form editing environment.</span></span> <span data-ttu-id="60deb-109">No se puede extender el entorno de diseño de formulario mediante el uso de complementos COM.</span><span class="sxs-lookup"><span data-stu-id="60deb-109">The form design environment cannot be extended by using COM Add-ins.</span></span>
  
## <a name="the-idtextensibility2-interface"></a><span data-ttu-id="60deb-110">La interfaz IDTExtensibility2</span><span class="sxs-lookup"><span data-stu-id="60deb-110">The IDTExtensibility2 Interface</span></span>

<span data-ttu-id="60deb-111">El entorno de edición proporciona compatibilidad para la interfaz **IDTExtensibility2** , que debe ser implementada por los programadores de complementos COM. **IDTExtensibility2** de InfoPath es un objeto de doble interfaz que proporciona cinco métodos que actúan como eventos en el entorno de edición.</span><span class="sxs-lookup"><span data-stu-id="60deb-111">The InfoPath editing environment provides support for the **IDTExtensibility2** interface, which must be implemented by developers of COM Add-ins. **IDTExtensibility2** is a dual-interface object that provides five methods which act as events within the editing environment.</span></span> <span data-ttu-id="60deb-112">Estos métodos permiten el complemento COM responder a inicio y cierre las condiciones del entorno, que aparecen en la siguiente tabla.</span><span class="sxs-lookup"><span data-stu-id="60deb-112">These methods allow the COM add-in to respond to environment startup and shutdown conditions, listed in the following table.</span></span> 
  
|<span data-ttu-id="60deb-113">**Interfaz**</span><span class="sxs-lookup"><span data-stu-id="60deb-113">**Interface**</span></span>|<span data-ttu-id="60deb-114">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="60deb-114">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="60deb-115">**OnAddInsUpdate (ByVal custom() como Variant)**</span><span class="sxs-lookup"><span data-stu-id="60deb-115">**OnAddInsUpdate (ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="60deb-116">Se produce cuando un complemento se carga o descarga en el entorno.</span><span class="sxs-lookup"><span data-stu-id="60deb-116">Occurs when an add-in is loaded or unloaded in the environment.</span></span>  <br/> |
|<span data-ttu-id="60deb-117">**OnBeginShutdown (ByVal custom() como Variant)**</span><span class="sxs-lookup"><span data-stu-id="60deb-117">**OnBeginShutdown (ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="60deb-118">Se produce cuando se cierra el entorno.</span><span class="sxs-lookup"><span data-stu-id="60deb-118">Occurs when the environment is being shut down.</span></span>  <br/> |
|<span data-ttu-id="60deb-119">**OnConnection (ByVal Application As Object, ByVal ConnectMode As ext_ConnectMode, ByVal AddInInst As Object, ByVal custom() As Variant)**</span><span class="sxs-lookup"><span data-stu-id="60deb-119">**OnConnection(ByVal Application As Object, ByVal ConnectMode As ext_ConnectMode, ByVal AddInInst As Object, ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="60deb-120">Se produce cuando un complemento se carga en el entorno.</span><span class="sxs-lookup"><span data-stu-id="60deb-120">Occurs when an add-in is loaded in the environment.</span></span>  <br/> |
|<span data-ttu-id="60deb-121">**OnDisconnection (ByVal RemoveMode As ext_DisconnectMode, ByVal custom() As Variant)**</span><span class="sxs-lookup"><span data-stu-id="60deb-121">**OnDisconnection (ByVal RemoveMode As ext_DisconnectMode, ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="60deb-122">Se produce cuando un complemento se descarga desde el entorno.</span><span class="sxs-lookup"><span data-stu-id="60deb-122">Occurs when an add-in is unloaded from the environment.</span></span>  <br/> |
|<span data-ttu-id="60deb-123">**OnStartupComplete (ByVal custom() como Variant)**</span><span class="sxs-lookup"><span data-stu-id="60deb-123">**OnStartupComplete (ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="60deb-124">Se produce cuando el entorno ha terminado de iniciarse.</span><span class="sxs-lookup"><span data-stu-id="60deb-124">Occurs when the environment has completed starting.</span></span>  <br/> |
   
## <a name="registering-com-add-ins"></a><span data-ttu-id="60deb-125">Registrar complementos COM</span><span class="sxs-lookup"><span data-stu-id="60deb-125">Registering COM Add-ins</span></span>

<span data-ttu-id="60deb-126">Todas las aplicaciones de Office, incluida InfoPath, utilizan el registro para complementos de lista en la colección de complementos COM, para almacenar el estado de conexión y para almacenar la información de carga de demanda o arranque.</span><span class="sxs-lookup"><span data-stu-id="60deb-126">All Office applications, including InfoPath, use the registry to list add-ins in the COM Add-Ins collection, to store the connect state, and to store the boot or demand load information.</span></span> <span data-ttu-id="60deb-127">Para InfoPath complementos COM, el nombre de cada complemento aparece bajo la siguiente clave:</span><span class="sxs-lookup"><span data-stu-id="60deb-127">For InfoPath COM Add-ins, the name of each add-in appears under the following key:</span></span>
  
`HKEY_CURRENT_USER\Software\Microsoft\Office\InfoPath\AddIns\`
  
<span data-ttu-id="60deb-128">Para los complementos COM instalan para su uso por todos los usuarios del equipo cliente, la clave del registro se encuentra en el subárbol del registro HKLM:</span><span class="sxs-lookup"><span data-stu-id="60deb-128">For COM Add-ins installed for use by every user of the client computer, the registry key is located in the HKLM registry hive:</span></span>
  
`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\InfoPath\AddIns\`
  
<span data-ttu-id="60deb-129">Nombre de la clave del registro corresponde a **ProgIdAttribute** del complemento y contiene los siguientes valores.</span><span class="sxs-lookup"><span data-stu-id="60deb-129">The registry key name corresponds to the **ProgIdAttribute** of the add-in, and contains the following values.</span></span> 
  
|<span data-ttu-id="60deb-130">**Nombre**</span><span class="sxs-lookup"><span data-stu-id="60deb-130">**Name**</span></span>|<span data-ttu-id="60deb-131">**Tipo**</span><span class="sxs-lookup"><span data-stu-id="60deb-131">**Type**</span></span>|<span data-ttu-id="60deb-132">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="60deb-132">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="60deb-133">**FriendlyName**</span><span class="sxs-lookup"><span data-stu-id="60deb-133">**FriendlyName**</span></span> <br/> |<span data-ttu-id="60deb-134">**String**</span><span class="sxs-lookup"><span data-stu-id="60deb-134">**String**</span></span> <br/> |<span data-ttu-id="60deb-135">El nombre que se muestra en el cuadro de diálogo **complementos COM** y aparecen en la página **complementos** del **Centro de confianza**.</span><span class="sxs-lookup"><span data-stu-id="60deb-135">The name that is displayed in the **COM Add-ins** dialog box and listed in the **Add-ins** page of the **Trust Center**.</span></span>  <br/> |
|<span data-ttu-id="60deb-136">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="60deb-136">**Description**</span></span> <br/> |<span data-ttu-id="60deb-137">**String**</span><span class="sxs-lookup"><span data-stu-id="60deb-137">**String**</span></span> <br/> |<span data-ttu-id="60deb-138">La cadena que se muestra cuando el complemento está seleccionado en el **Centro de confianza**.</span><span class="sxs-lookup"><span data-stu-id="60deb-138">The string that is displayed when the add-in is selected in the **Trust Center**.</span></span>  <br/> |
|<span data-ttu-id="60deb-139">**LoadBehavior**</span><span class="sxs-lookup"><span data-stu-id="60deb-139">**LoadBehavior**</span></span> <br/> |<span data-ttu-id="60deb-140">**DWORD**</span><span class="sxs-lookup"><span data-stu-id="60deb-140">**DWORD**</span></span> <br/> |<span data-ttu-id="60deb-141">Especifica el modo en que COM Add-in está cargado.</span><span class="sxs-lookup"><span data-stu-id="60deb-141">Specifies the way the COM Add-in is loaded.</span></span> <span data-ttu-id="60deb-142">El valor puede ser una combinación de 0, 1, 2, 8 y 16.</span><span class="sxs-lookup"><span data-stu-id="60deb-142">The value can be a combination of 0, 1, 2, 8, and 16.</span></span> <span data-ttu-id="60deb-143">Consulte la tabla siguiente para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="60deb-143">See the table below for more information.</span></span>  <br/> |
   
<span data-ttu-id="60deb-144">El valor **DWORD** de **LoadBehavior** debe contener un valor que describe cómo se carga COM Add-in en el entorno de edición.</span><span class="sxs-lookup"><span data-stu-id="60deb-144">The **DWORD** value for **LoadBehavior** should contain a value describing how the COM Add-in loads in the editing environment.</span></span> <span data-ttu-id="60deb-145">El valor puede ser desde la tabla siguiente, o una combinación de valores de la tabla.</span><span class="sxs-lookup"><span data-stu-id="60deb-145">The value can be from the table below, or a combination of values from the table.</span></span> <span data-ttu-id="60deb-146">Por ejemplo, un COM Add-in creado en Visual Studio 2005 tendrá un **LoadBehavior** de "3" cargar al inicio de la aplicación y estar conectado.</span><span class="sxs-lookup"><span data-stu-id="60deb-146">For example, a COM Add-in created in Visual Studio 2005 will have a **LoadBehavior** of "3" loaded at application startup and be connected.</span></span> 
  
|<span data-ttu-id="60deb-147">**Valor**</span><span class="sxs-lookup"><span data-stu-id="60deb-147">**Value**</span></span>|<span data-ttu-id="60deb-148">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="60deb-148">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="60deb-149">0</span><span class="sxs-lookup"><span data-stu-id="60deb-149">0</span></span>  <br/> |<span data-ttu-id="60deb-150">Desconectado.</span><span class="sxs-lookup"><span data-stu-id="60deb-150">Disconnected.</span></span> <span data-ttu-id="60deb-151">El complemento se muestra como inactivo en el cuadro de diálogo **complemento COM** .</span><span class="sxs-lookup"><span data-stu-id="60deb-151">The add-in shows as Inactive in the **COM Add-in** dialog box.</span></span>  <br/> |
|<span data-ttu-id="60deb-152">1</span><span class="sxs-lookup"><span data-stu-id="60deb-152">1</span></span>  <br/> |<span data-ttu-id="60deb-153">Conectado.</span><span class="sxs-lookup"><span data-stu-id="60deb-153">Connected.</span></span> <span data-ttu-id="60deb-154">El complemento se muestra como activo en el cuadro de diálogo **complemento COM** .</span><span class="sxs-lookup"><span data-stu-id="60deb-154">The add-in shows as Active in the **COM Add-in** dialog box.</span></span>  <br/> |
|<span data-ttu-id="60deb-155">2</span><span class="sxs-lookup"><span data-stu-id="60deb-155">2</span></span>  <br/> |<span data-ttu-id="60deb-156">Cargar al inicio.</span><span class="sxs-lookup"><span data-stu-id="60deb-156">Load at Startup.</span></span> <span data-ttu-id="60deb-157">El complemento está cargado y conectado cuando se inicia la aplicación host.</span><span class="sxs-lookup"><span data-stu-id="60deb-157">The add-in is loaded and connected when the host application starts.</span></span>  <br/> |
|<span data-ttu-id="60deb-158">8</span><span class="sxs-lookup"><span data-stu-id="60deb-158">8</span></span>  <br/> |<span data-ttu-id="60deb-159">Cargar a petición.</span><span class="sxs-lookup"><span data-stu-id="60deb-159">Load on Demand.</span></span> <span data-ttu-id="60deb-160">El complemento está cargado y conectado cuando la aplicación host lo requiere, por ejemplo, cuando un usuario hace clic en un botón que utiliza funcionalidad en el complemento.</span><span class="sxs-lookup"><span data-stu-id="60deb-160">The add-in is loaded and connected when the host application requires it, for example when a user clicks a button that uses functionality in the add-in.</span></span>  <br/> |
|<span data-ttu-id="60deb-161">16</span><span class="sxs-lookup"><span data-stu-id="60deb-161">16</span></span>  <br/> |<span data-ttu-id="60deb-162">Conectar por primera vez.</span><span class="sxs-lookup"><span data-stu-id="60deb-162">Connect first time.</span></span> <span data-ttu-id="60deb-163">El complemento se carga y conecta la primera vez que el usuario ejecuta la aplicación host después de registrar el complemento.</span><span class="sxs-lookup"><span data-stu-id="60deb-163">The add-in will be loaded and connected the first time the user runs the host application after registering the add-in.</span></span>  <br/> |
   
## <a name="creating-a-managed-com-add-in-with-visual-studio-2005-or-visual-studio-2008"></a><span data-ttu-id="60deb-164">Creación de un complemento COM administrado con Visual Studio 2005 o Visual Studio 2008</span><span class="sxs-lookup"><span data-stu-id="60deb-164">Creating a Managed COM Add-in with Visual Studio 2005 or Visual Studio 2008</span></span>

<span data-ttu-id="60deb-165">Para crear un complemento COM complemento mediante Microsoft Visual Studio 2005 o Visual Studio 2008, cree un proyecto de complemento compartido de la siguiente forma:</span><span class="sxs-lookup"><span data-stu-id="60deb-165">To create a managed COM add-in using Microsoft Visual Studio 2005 or Visual Studio 2008, create a Shared Add-In project as follows:</span></span> 
  
1. <span data-ttu-id="60deb-166">Inicie Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="60deb-166">Start Visual Studio.</span></span>
    
2. <span data-ttu-id="60deb-167">En el menú **Archivo**, haga clic en **Nuevo proyecto**.</span><span class="sxs-lookup"><span data-stu-id="60deb-167">On the **File** menu, click **New Project**.</span></span>
    
3. <span data-ttu-id="60deb-168">En el panel **Tipos de proyecto** del cuadro de diálogo **Nuevo proyecto** , haga clic en la carpeta de **Otros tipos de proyectos** y, a continuación, haga clic en **extensibilidad**.</span><span class="sxs-lookup"><span data-stu-id="60deb-168">In the **Project Types** pane of the **New Project** dialog box, click the **Other Projects Types** folder, and then click **Extensibility**.</span></span>
    
4. <span data-ttu-id="60deb-169">En el panel **plantillas** , haga clic en **Complemento compartido**.</span><span class="sxs-lookup"><span data-stu-id="60deb-169">In the **Templates** pane, click **Shared Add-In**.</span></span>
    
5. <span data-ttu-id="60deb-170">En el cuadro **nombre** , escriba un nombre para el proyecto.</span><span class="sxs-lookup"><span data-stu-id="60deb-170">In the **Name** box, type a name for the project.</span></span> 
    
6. <span data-ttu-id="60deb-171">En el cuadro **ubicación** , escriba una ruta de acceso de carpeta o haga clic en **Examinar** y seleccione una ruta de acceso de la carpeta y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="60deb-171">In the **Location** box, type a folder path or click **Browse** and select a folder path, and then click **OK**.</span></span> <span data-ttu-id="60deb-172">Aparecerá el **Shared Asistente para complementos** .</span><span class="sxs-lookup"><span data-stu-id="60deb-172">The **Shared Add-in Wizard** appears.</span></span> 
    
7. <span data-ttu-id="60deb-173">Haga clic en **siguiente** en el **Asistente para agregar compartidos**.</span><span class="sxs-lookup"><span data-stu-id="60deb-173">Click **Next** in the **Shared Add-in Wizard**.</span></span> <span data-ttu-id="60deb-174">Aparecerá la página **Seleccione un lenguaje de programación** .</span><span class="sxs-lookup"><span data-stu-id="60deb-174">The **Select a Programming Language** page appears.</span></span> 
    
8. <span data-ttu-id="60deb-175">Haga clic en **crear un complemento utilizando Visual Basic**y, a continuación, haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="60deb-175">Click **Create an Add-in using Visual Basic**, then click **Next**.</span></span> <span data-ttu-id="60deb-176">Aparecerá la página **Seleccione una aplicación Host** .</span><span class="sxs-lookup"><span data-stu-id="60deb-176">The **Select An Application Host** page appears.</span></span> 
    
9. <span data-ttu-id="60deb-177">Desactive las casillas junto a cada aplicación exceptuando **Microsoft InfoPath**y, a continuación, haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="60deb-177">Uncheck the boxes next to each application except **Microsoft InfoPath**, and then click **Next**.</span></span> <span data-ttu-id="60deb-178">Aparece la página **Especifique un nombre y una descripción** .</span><span class="sxs-lookup"><span data-stu-id="60deb-178">The **Enter a Name and Description** page appears.</span></span> 
    
10. <span data-ttu-id="60deb-179">En el cuadro **¿Qué es el nombre de su complemento** , escriba el nombre de su COM Add-in.</span><span class="sxs-lookup"><span data-stu-id="60deb-179">In the **What is the name of your Add-In** box, type the name of your COM Add-in.</span></span> 
    
11. <span data-ttu-id="60deb-180">En el cuadro **¿Qué es la descripción de su complemento** , escriba la descripción para su COM Add-in y haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="60deb-180">In the **What is the description of your Add-In** box, type the description for your COM Add-in, and click **Next**.</span></span> <span data-ttu-id="60deb-181">Aparecerá la página **Elija las opciones del complemento** .</span><span class="sxs-lookup"><span data-stu-id="60deb-181">The **Choose Add-In Options** page appears.</span></span> 
    
12. <span data-ttu-id="60deb-182">Comprobar los cuadros de **Mi complemento debe estar disponible para todos los usuarios del equipo en el que se instaló, no sólo para la persona que lo instala** y **me gustaría que mi complemento se cargue cuando lo haga la aplicación host** .</span><span class="sxs-lookup"><span data-stu-id="60deb-182">Check the **I would like my Add-in to load when the host application loads** and **My Add-in should be available to all users of the computer it was installed on, not just the person who installs it** boxes.</span></span> 
    
13. <span data-ttu-id="60deb-183">Haga clic en **siguiente** para revisar la página de **Resumen** y, a continuación, haga clic en **Finalizar**.</span><span class="sxs-lookup"><span data-stu-id="60deb-183">Click **Next** to review the **Summary** page, then click **Finish**.</span></span>
    
<span data-ttu-id="60deb-184">Una vez creado el proyecto por Visual Studio, verá dos proyectos en la ventana Explorador de soluciones.</span><span class="sxs-lookup"><span data-stu-id="60deb-184">After the project is created by Visual Studio, you will see two projects in the Solution Explorer window.</span></span> <span data-ttu-id="60deb-185">El primer proyecto es el proyecto para el COM Add-in; el segundo proyecto es un proyecto de instalación para la implementación de COM Add-in.</span><span class="sxs-lookup"><span data-stu-id="60deb-185">The first project is the project for the COM Add-in; the second project is a setup project for deploying the COM Add-in.</span></span> <span data-ttu-id="60deb-186">El **Shared Asistente para complementos** sólo inserta una referencia a la **Biblioteca de objetos de Microsoft Office 14.0**, por lo que es necesario insertar una referencia a la biblioteca de objetos de InfoPath mediante los pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="60deb-186">The **Shared Add-in Wizard** only inserts a reference to the **Microsoft Office 14.0 Object Library**, so it is necessary to insert a reference to the InfoPath object library using the following steps:</span></span>
  
1. <span data-ttu-id="60deb-187">Haga doble clic en **Mi proyecto** para mostrar las propiedades del proyecto de complemento.</span><span class="sxs-lookup"><span data-stu-id="60deb-187">Double-click **My Project** to display the add-in project properties.</span></span> <span data-ttu-id="60deb-188">Haga clic en la ficha **referencias** para que se muestren las referencias agregadas automáticamente al proyecto.</span><span class="sxs-lookup"><span data-stu-id="60deb-188">Click the **References** tab to display the references automatically added to the project.</span></span> 
    
2. <span data-ttu-id="60deb-189">Haga clic en el botón **Agregar** para mostrar el cuadro de diálogo **Agregar referencia** .</span><span class="sxs-lookup"><span data-stu-id="60deb-189">Click the **Add** button to display the **Add Reference** dialog box.</span></span> 
    
3. <span data-ttu-id="60deb-190">En la ficha **COM** , haga doble clic en la **Biblioteca de tipos Microsoft.InfoPath 2.0**y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="60deb-190">On the **COM** tab, double-click **Microsoft.InfoPath 2.0 Type Library**, and click **OK**.</span></span>
    
4. <span data-ttu-id="60deb-191">Agregar una referencia a la **Biblioteca de tipos de Microsoft InfoPath 3.0** , también agrega referencias a tres ensamblados que se deben quitar: **ADODB**, **MSHTML**y **MSXML2**.</span><span class="sxs-lookup"><span data-stu-id="60deb-191">Adding a reference to the **Microsoft InfoPath 3.0 Type Library** also adds references to three assemblies that must be removed: **ADODB**, **MSHTML**, and **MSXML2**.</span></span> <span data-ttu-id="60deb-192">En **El Explorador de soluciones** , en **referencias**, haga clic en cada una de estas referencias y, a continuación, haga clic en **Quitar**.</span><span class="sxs-lookup"><span data-stu-id="60deb-192">In **Solution Explorer** under **References**, right-click each of these references, and then click **Remove**.</span></span>
    
## <a name="viewing-the-registry-settings"></a><span data-ttu-id="60deb-193">Visualización de la configuración del registro</span><span class="sxs-lookup"><span data-stu-id="60deb-193">Viewing the Registry Settings</span></span>

<span data-ttu-id="60deb-194">Para ver la configuración del registro que se creará cuando se instala COM Add-in, siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="60deb-194">To view the registry settings that will be created when the COM Add-in is installed, follow these steps:</span></span>
  
1. <span data-ttu-id="60deb-195">Haga clic en el nodo raíz del proyecto del programa de instalación en el **Explorador de soluciones**, haga clic en **Ver**, a continuación, el **Editor**, a continuación, haga clic en **el registro**.</span><span class="sxs-lookup"><span data-stu-id="60deb-195">Right-click the root node of the setup project in the **Solution Explorer**, click **View**, then **Editor**, then click **Registry**.</span></span>
    
2. <span data-ttu-id="60deb-196">En el panel izquierdo, haga clic en el signo más para ** ** ** **expandir **HKEY_LOCAL_MACHINE**********.</span><span class="sxs-lookup"><span data-stu-id="60deb-196">In the left-hand pane, click the plus to expand **HKEY_LOCAL_MACHINE**, **Software**, **Microsoft**, **InfoPath**, then **AddIns**.</span></span>
    
3. <span data-ttu-id="60deb-197">Haga clic en el nombre correspondiente al **ProgID**de compartida complemento del proyecto.</span><span class="sxs-lookup"><span data-stu-id="60deb-197">Click the name corresponding to your shared add-in project's **ProgID**.</span></span>
    
<span data-ttu-id="60deb-198">Para cambiar alguna de estas propiedades, haga clic en la propiedad, haga clic en **Ventana Propiedades**y cambie el cuadro **valor** en la **Ventana Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="60deb-198">To change any of these properties, right-click the property, click **Properties Window**, and change the **Value** box in the **Properties Window**.</span></span>
  
## <a name="compiling-and-distributing-the-shared-add-in"></a><span data-ttu-id="60deb-199">Compilar y distribuir el complemento compartido</span><span class="sxs-lookup"><span data-stu-id="60deb-199">Compiling and Distributing the Shared Add-In</span></span>

<span data-ttu-id="60deb-200">Para compilar el administradas COM Add-in para realizar pruebas en el equipo en el que se desarrolló el proyecto de complemento compartido, haga clic en el nodo raíz del proyecto complemento compartido en el Explorador de soluciones y haga clic en generar.</span><span class="sxs-lookup"><span data-stu-id="60deb-200">To compile the managed COM Add-in for testing on the computer on which the Shared Add-In project was developed, right-click the root node of the Shared Add-In project in the Solution Explorer and click Build.</span></span> <span data-ttu-id="60deb-201">Si el proyecto se compila sin errores, puede iniciar el entorno de edición de InfoPath y empezar a usar el administradas COM Add-in.</span><span class="sxs-lookup"><span data-stu-id="60deb-201">If the project builds with no errors, you can start the InfoPath editing environment and begin using the managed COM Add-in.</span></span> <span data-ttu-id="60deb-202">Si tiene una instancia de InfoPath ejecutándose, ciérrela antes de generar el proyecto.</span><span class="sxs-lookup"><span data-stu-id="60deb-202">If you have an instance of InfoPath running, close it before building the project.</span></span> <span data-ttu-id="60deb-203">También puede ser necesario abrir el cuadro de diálogo Complementos COM para comprobar que está registrado COM Add-in.</span><span class="sxs-lookup"><span data-stu-id="60deb-203">It may also be necessary to open the COM Add-ins dialog box to verify that the COM Add-in is registered.</span></span> <span data-ttu-id="60deb-204">Para abrir el cuadro de diálogo Complementos COM, siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="60deb-204">To open the COM Add-ins dialog box, follow these steps:</span></span>
  
1. <span data-ttu-id="60deb-205">Abra el entorno de edición de InfoPath.</span><span class="sxs-lookup"><span data-stu-id="60deb-205">Open the InfoPath editing environment.</span></span> <span data-ttu-id="60deb-206">La forma más sencilla de hacer esto es abrir una plantilla de formulario existente, que se va a crear un nuevo formulario basado en esa plantilla de formulario.</span><span class="sxs-lookup"><span data-stu-id="60deb-206">The easiest way to do this is to open an existing form template, which will create a new form based on that form template.</span></span>
    
2. <span data-ttu-id="60deb-207">En el menú **Herramientas** , haga clic en **Centro de confianza** .</span><span class="sxs-lookup"><span data-stu-id="60deb-207">Click **Trust Center** on the **Tools** menu.</span></span> 
    
3. <span data-ttu-id="60deb-208">Haga clic en la categoría **complementos** en el lado izquierdo.</span><span class="sxs-lookup"><span data-stu-id="60deb-208">Click the **Add-ins** category on the left.</span></span> 
    
4. <span data-ttu-id="60deb-209">En la sección **Administrar** cerca de la parte inferior del cuadro de diálogo **Centro de confianza** , seleccione **complementos COM** en la lista y haga clic en el botón **Ir** .</span><span class="sxs-lookup"><span data-stu-id="60deb-209">In the **Manage** section near the bottom of the **Trust Center** dialog box, select **COM Add-ins** from the list and click the **Go** button.</span></span> 
    
5. <span data-ttu-id="60deb-210">En el cuadro de diálogo **complementos COM** , verá el nombre de su complemento creadas recientemente y debe haber una casilla de verificación situada junto a él.</span><span class="sxs-lookup"><span data-stu-id="60deb-210">In the **COM Add-ins** dialog box, you will see the name of your recently-built add-in and there should be a check box next to it.</span></span> <span data-ttu-id="60deb-211">Si no hay ninguna casilla de verificación situada junto a él, COM Add-in no se pudo cargar debido a un error, que se enumerarán en la sección **Comportamiento de carga** del cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="60deb-211">If there is no check box next to it, the COM Add-in failed to load due to an error, which will be listed in the **Load Behavior** section of the dialog box.</span></span> 
    
<span data-ttu-id="60deb-212">Para compilar el complemento COM administrado para su uso en un equipo distinto del equipo en el que se desarrolló el proyecto de complemento compartido, debe seguir pasos adicionales para proteger el código.</span><span class="sxs-lookup"><span data-stu-id="60deb-212">To compile the managed COM add-in for use on a computer other than the computer on which the Shared Add-In project was developed, you must follow additional steps to secure your code.</span></span> <span data-ttu-id="60deb-213">Para obtener información acerca de cómo proteger proyectos de complemento compartido para su uso en otros equipos, vea los tres artículos siguientes:</span><span class="sxs-lookup"><span data-stu-id="60deb-213">For information on securing Shared Add-In projects for use on other computers, see the following three articles:</span></span>
  
- [<span data-ttu-id="60deb-214">Implementación de complementos COM administrados en Office XP</span><span class="sxs-lookup"><span data-stu-id="60deb-214">Deployment of Managed COM Add-Ins in Office XP</span></span>](http://go.microsoft.com/fwlink/?LinkID=73473)
  
- [<span data-ttu-id="60deb-215">Uso de la solución de compatibilidad (shim) de complemento COM para implementar administrado complementos COM de Office XP</span><span class="sxs-lookup"><span data-stu-id="60deb-215">Using the COM Add-in Shim Solution to Deploy Managed COM Add-ins in Office XP</span></span>](http://go.microsoft.com/fwlink/?LinkID=73474)
  
- [<span data-ttu-id="60deb-216">Aislar las extensiones de Office con el Asistente de compatibilidad (shim) de COM</span><span class="sxs-lookup"><span data-stu-id="60deb-216">Isolating Office Extensions with the COM Shim Wizard</span></span>](http://go.microsoft.com/fwlink/?LinkID=73475)
  
> [!IMPORTANT]
> <span data-ttu-id="60deb-217">Si no se aísla COM Add-in puede provocar pérdidas de memoria e inestabilidad en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="60deb-217">Not isolating the COM Add-in may cause memory leaks and application instability.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="60deb-218">Si .NET Framework u otros ensamblados requeridos del proyecto del programa de instalación aún no están instalados en los equipos de destino, es posible que el archivo .msi no se instale correctamente.</span><span class="sxs-lookup"><span data-stu-id="60deb-218">If the .NET Framework or other required assemblies from the setup project are not already installed on target computers, the .msi file may not install properly.</span></span> <span data-ttu-id="60deb-219">Además, no se puede distribuir el archivo .msi y, a continuación, intente instalar el archivo .msi.</span><span class="sxs-lookup"><span data-stu-id="60deb-219">Also, you cannot distribute the .msi file and then attempt to install the .msi file.</span></span> <span data-ttu-id="60deb-220">También debe distribuir los archivos de compatibilidad con otras en la misma carpeta que el archivo .msi original generado por Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="60deb-220">You must also distribute the other support files in the same folder as the original .msi file generated by Visual Studio.</span></span> 
  
## <a name="coding-in-the-com-add-in"></a><span data-ttu-id="60deb-221">Codificación en el complemento COM</span><span class="sxs-lookup"><span data-stu-id="60deb-221">Coding in the COM Add-in</span></span>

<span data-ttu-id="60deb-222">Eventos de aplicación que se producen en el entorno de edición de formularios de InfoPath se pueden capturar por un COM Add-in.</span><span class="sxs-lookup"><span data-stu-id="60deb-222">Application events that occur in the InfoPath form editing environment can be captured by a COM Add-in.</span></span> <span data-ttu-id="60deb-223">Los siguientes eventos del objeto [ApplicationEvents](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ApplicationEvents.aspx) pueden usarse por COM Add-in para responder a las acciones del usuario:</span><span class="sxs-lookup"><span data-stu-id="60deb-223">The following events of the [ApplicationEvents](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ApplicationEvents.aspx) object can be used by the COM Add-in to respond to user actions:</span></span> 
  
|<span data-ttu-id="60deb-224">**Evento**</span><span class="sxs-lookup"><span data-stu-id="60deb-224">**Event**</span></span>|<span data-ttu-id="60deb-225">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="60deb-225">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="60deb-226">[NewXDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.NewXDocument.aspx) (Evento)</span><span class="sxs-lookup"><span data-stu-id="60deb-226">[NewXDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.NewXDocument.aspx) Event</span></span>  <br/> |<span data-ttu-id="60deb-227">Se produce cuando se crea un nuevo formulario.</span><span class="sxs-lookup"><span data-stu-id="60deb-227">Occurs when a new form is created.</span></span>  <br/> |
|<span data-ttu-id="60deb-228">[Salga de](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.Quit.aspx) (Evento)</span><span class="sxs-lookup"><span data-stu-id="60deb-228">[Quit](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.Quit.aspx) Event</span></span>  <br/> |<span data-ttu-id="60deb-229">Se produce cuando el usuario sale de InfoPath.</span><span class="sxs-lookup"><span data-stu-id="60deb-229">Occurs when the user quits InfoPath.</span></span>  <br/> |
|<span data-ttu-id="60deb-230">[WindowActivate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowActivate.aspx) (Evento)</span><span class="sxs-lookup"><span data-stu-id="60deb-230">[WindowActivate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowActivate.aspx) Event</span></span>  <br/> |<span data-ttu-id="60deb-231">Este evento se produce cuando se activa cualquier ventana de documento.</span><span class="sxs-lookup"><span data-stu-id="60deb-231">Occurs when any document window is activated.</span></span>  <br/> |
|<span data-ttu-id="60deb-232">[WindowDeactivate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowDeactivate.aspx) (Evento)</span><span class="sxs-lookup"><span data-stu-id="60deb-232">[WindowDeactivate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowDeactivate.aspx) Event</span></span>  <br/> |<span data-ttu-id="60deb-233">Este evento se produce cuando se desactiva cualquier ventana de documento.</span><span class="sxs-lookup"><span data-stu-id="60deb-233">Occurs when any document window is deactivated.</span></span>  <br/> |
|<span data-ttu-id="60deb-234">[WindowSize](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowSize.aspx) (Evento)</span><span class="sxs-lookup"><span data-stu-id="60deb-234">[WindowSize](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowSize.aspx) Event</span></span>  <br/> |<span data-ttu-id="60deb-235">Se produce cuando se mueve una ventana de documento o se cambia su tamaño.</span><span class="sxs-lookup"><span data-stu-id="60deb-235">Occurs when any document window is resized or moved.</span></span>  <br/> |
|<span data-ttu-id="60deb-236">[XDocumentBeforeClose](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforeClose.aspx) (Evento)</span><span class="sxs-lookup"><span data-stu-id="60deb-236">[XDocumentBeforeClose](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforeClose.aspx) Event</span></span>  <br/> |<span data-ttu-id="60deb-237">Tiene lugar inmediatamente antes de que se cierre un documento.</span><span class="sxs-lookup"><span data-stu-id="60deb-237">Occurs immediately before any open document closes.</span></span>  <br/> |
|<span data-ttu-id="60deb-238">[XDocumentBeforePrint](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforePrint.aspx) (Evento)</span><span class="sxs-lookup"><span data-stu-id="60deb-238">[XDocumentBeforePrint](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforePrint.aspx) Event</span></span>  <br/> |<span data-ttu-id="60deb-239">Se produce inmediatamente antes de que se imprima un documento abierto.</span><span class="sxs-lookup"><span data-stu-id="60deb-239">Occurs immediately before any open document is printed.</span></span>  <br/> |
|<span data-ttu-id="60deb-240">[XDocumentBeforeSave](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforeSave.aspx) (Evento)</span><span class="sxs-lookup"><span data-stu-id="60deb-240">[XDocumentBeforeSave](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforeSave.aspx) Event</span></span>  <br/> |<span data-ttu-id="60deb-241">Se produce inmediatamente antes de que se guarde un documento abierto.</span><span class="sxs-lookup"><span data-stu-id="60deb-241">Occurs immediately before any open document is saved.</span></span>  <br/> |
|<span data-ttu-id="60deb-242">[XDocumentChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentChange.aspx) (Evento)</span><span class="sxs-lookup"><span data-stu-id="60deb-242">[XDocumentChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentChange.aspx) Event</span></span>  <br/> |<span data-ttu-id="60deb-243">Se produce cuando se crea un nuevo formulario, cuando se abre un formulario existente o cuando otro formulario se convierte en el formulario activo.</span><span class="sxs-lookup"><span data-stu-id="60deb-243">Occurs when a new form is created, when an existing form is opened, or when another form is made the active form.</span></span>  <br/> |
|<span data-ttu-id="60deb-244">[XDocumentOpen](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentOpen.aspx) (Evento)</span><span class="sxs-lookup"><span data-stu-id="60deb-244">[XDocumentOpen](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentOpen.aspx) Event</span></span>  <br/> |<span data-ttu-id="60deb-245">Este evento se produce al abrir un documento.</span><span class="sxs-lookup"><span data-stu-id="60deb-245">Occurs when a document is opened.</span></span>  <br/> |
   
<span data-ttu-id="60deb-246">Para capturar estos eventos en COM Add-in, debe declarar las siguientes variables de nivel de clase en la clase **Connect** :</span><span class="sxs-lookup"><span data-stu-id="60deb-246">To capture these events in the COM Add-in, you must declare the following class-level variables in your **Connect** class:</span></span> 
  
```vb
InfoPathApplication = DirectCast( _
   application, Microsoft.Office.Interop.InfoPath._Application3)
InfoPathApplicationEvents = DirectCast( _
   InfoPathApplication.Events, _
   Microsoft.Office.Interop.InfoPath.ApplicationEvents)
```

```cs
InfoPathApplication =
   (Microsoft.Office.Interop.InfoPath._Application3)application;
InfoPathApplicationEvents =
   (Microsoft.Office.Interop.InfoPath.ApplicationEvents)
   InfoPathApplication.Events;
```

<span data-ttu-id="60deb-247">La primera línea convierte el **objeto** recibido por el complemento en el objeto [_Application3](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._Application3.aspx) de aplicación genérica.</span><span class="sxs-lookup"><span data-stu-id="60deb-247">The first line casts the generic application **Object** received by the add-in to the [_Application3](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._Application3.aspx) object.</span></span> <span data-ttu-id="60deb-248">La segunda línea convierte la propiedad [Events](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._Application3.Events.aspx) del objeto **_Application3** (representado por la variable **InfoPathApplication** ) en el objeto [ApplicationEvents](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ApplicationEvents.aspx) .</span><span class="sxs-lookup"><span data-stu-id="60deb-248">The second line casts the [Events](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._Application3.Events.aspx) property of the **_Application3** object (represented by the **InfoPathApplication** variable) to the [ApplicationEvents](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ApplicationEvents.aspx) object.</span></span> 
  
<span data-ttu-id="60deb-249">Para crear controladores de eventos, seleccione **InfoPathApplicationEvents** en el cuadro de lista desplegable **Nombre de clase** en la parte superior de la ventana de Visual Studio y, a continuación, seleccione el evento que desea controlar en el cuadro de lista desplegable **Nombre de método** en la parte superior del objeto Visual Ventana de Studio.</span><span class="sxs-lookup"><span data-stu-id="60deb-249">To create event handlers, select **InfoPathApplicationEvents** from the **Class Name** drop-down box at the top of the Visual Studio window, and then select the event you want to handle in the **Method Name** drop-down box at the top of the Visual Studio window.</span></span> <span data-ttu-id="60deb-250">Por ejemplo, si necesita controlar cuándo se guarda un formulario, debe controlar el evento **XDocumentBeforeSave** .</span><span class="sxs-lookup"><span data-stu-id="60deb-250">For example, if you need to control when a form is saved, you handle the **XDocumentBeforeSave** event.</span></span> <span data-ttu-id="60deb-251">Automáticamente, se selecciona **XDocumentBeforeSave** en la lista desplegable **Nombre de método** , inserta el siguiente procedimiento:</span><span class="sxs-lookup"><span data-stu-id="60deb-251">Selecting **XDocumentBeforeSave** from the **Method Name** drop-down automatically inserts the following procedure:</span></span> 
  
```vb
Private Sub InfoPathApplicationEvents_XDocumentBeforeSave( _
   ByVal pDocument As Microsoft.Office.Interop.InfoPath._XDocument, _
   ByRef pfCancel As Boolean) _
   Handles InfoPathApplicationEvents.XDocumentBeforeSave
End Sub
```

```cs
private void InfoPathApplicationEvents_XDocumentBeforeSave(
   Microsoft.Office.Interop.InfoPath._XDocument pDocument, ref bool pfCancel)
{
}

```

<span data-ttu-id="60deb-252">Cualquiera de los eventos del objeto **ApplicationEvents** puede ser controlado por el COM Add-in utilizando el mismo método.</span><span class="sxs-lookup"><span data-stu-id="60deb-252">Any of the events of the **ApplicationEvents** object can be handled by the COM Add-in using the same method.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="60deb-253">Vea también</span><span class="sxs-lookup"><span data-stu-id="60deb-253">See also</span></span>

- [<span data-ttu-id="60deb-254">Creación de una Microsoft Office 2000 COM Add-in</span><span class="sxs-lookup"><span data-stu-id="60deb-254">Creating a Microsoft Office 2000 COM Add-in</span></span>](http://go.microsoft.com/fwlink/?LinkID=73468) 
- [<span data-ttu-id="60deb-255">Creación de Office Managed COM Add-Ins con Visual Studio .NET</span><span class="sxs-lookup"><span data-stu-id="60deb-255">Creating Office Managed COM Add-Ins with Visual Studio .NET</span></span>](http://go.microsoft.com/fwlink/?LinkID=73470)
- [<span data-ttu-id="60deb-256">Trabajar con los procedimientos del evento IDTExtensibility2</span><span class="sxs-lookup"><span data-stu-id="60deb-256">Working with the IDTExtensibility2 Event Procedures</span></span>](http://go.microsoft.com/fwlink/?LinkID=73471)
- [<span data-ttu-id="60deb-257">Crear un complemento COM de Office con Visual Basic .NET</span><span class="sxs-lookup"><span data-stu-id="60deb-257">Build an Office COM Add-in With Visual Basic .NET</span></span>](http://go.microsoft.com/fwlink/?LinkID=73469)
- [<span data-ttu-id="60deb-258">Crear un complemento COM de Office con Visual C# .NET</span><span class="sxs-lookup"><span data-stu-id="60deb-258">Build an Office COM Add-in With Visual C# .NET</span></span>](http://go.microsoft.com/fwlink/?LinkID=73472)
- [<span data-ttu-id="60deb-259">Creación de complementos de 2007 de InfoPath mediante el uso de Visual Studio 2005 Tools para Office System SE</span><span class="sxs-lookup"><span data-stu-id="60deb-259">Creating InfoPath 2007 Add-Ins by Using Visual Studio 2005 Tools for the Office System SE</span></span>](http://msdn.microsoft.com/en-us/library/bb968857%28office.12%29.aspx)

