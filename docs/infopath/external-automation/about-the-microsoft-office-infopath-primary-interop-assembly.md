---
title: Información sobre el conjunto de interoperabilidad principal de InfoPath de Microsoft Office
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
keywords:
- InfoPath 2007, ensamblado de interoperabilidad primario, InfoPath ensamblado de interoperabilidad primario, PIA [InfoPath 2007], ensamblados de interoperabilidad primarios [InfoPath 2007]
localization_priority: Normal
ms.assetid: 1b3ae03c-6951-49e4-a489-4712d3f7ba72
description: Para admitir la creación de soluciones de InfoPath que usan los lenguajes de código administrado como Visual C# y Visual Basic, la opción de compatibilidad con programación de .NET en el programa de instalación de InfoPath instala a los ensamblados de interoperabilidad tres.
ms.openlocfilehash: b6b37254773d758dc064e22045d68f29febe7bbe
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19815766"
---
# <a name="about-the-microsoft-office-infopath-primary-interop-assembly"></a><span data-ttu-id="21627-104">Información sobre el conjunto de interoperabilidad principal de InfoPath de Microsoft Office</span><span class="sxs-lookup"><span data-stu-id="21627-104">About the Microsoft Office InfoPath Primary Interop Assembly</span></span>

<span data-ttu-id="21627-105">La aplicación InfoPath se crea como una aplicación de modelo de objetos componentes (COM) que expone sus interfaces de programación para la automatización externa como interfaces COM.</span><span class="sxs-lookup"><span data-stu-id="21627-105">The InfoPath application is built as a Component Object Model (COM) application that exposes its programmability interfaces for external automation as COM interfaces.</span></span> <span data-ttu-id="21627-106">Para admitir la creación de soluciones de InfoPath que usan los lenguajes de código administrado como Visual C# y Visual Basic, la opción de **Compatibilidad con programación de .NET** en el programa de instalación de InfoPath instala a los ensamblados de interoperabilidad tres.</span><span class="sxs-lookup"><span data-stu-id="21627-106">To support the creation of InfoPath solutions that use managed-code languages such as Visual C# and Visual Basic, the **.NET Programmability Support** option in the InfoPath setup program installs three interop assemblies.</span></span> <span data-ttu-id="21627-107">Los ensamblados de interoperabilidad son ensamblados .NET que actúan como puente entre el código administrado y no administrado, asignando miembros de objetos COM a los miembros administrados .NET equivalentes.</span><span class="sxs-lookup"><span data-stu-id="21627-107">Interop assemblies are .NET assemblies that act as a bridge between managed and unmanaged code, mapping COM object members to equivalent .NET managed members.</span></span> 
  
<span data-ttu-id="21627-108">Los archivos de los tres ensamblados de interoperabilidad que instala InfoPath se denominan:</span><span class="sxs-lookup"><span data-stu-id="21627-108">The files for the three interop assemblies installed by InfoPath are named:</span></span>
  
- <span data-ttu-id="21627-109">Microsoft.Office.Interop.InfoPath.dll</span><span class="sxs-lookup"><span data-stu-id="21627-109">Microsoft.Office.Interop.InfoPath.dll</span></span>
    
- <span data-ttu-id="21627-110">Microsoft.Office.Interop.InfoPath.SemiTrust.dll</span><span class="sxs-lookup"><span data-stu-id="21627-110">Microsoft.Office.Interop.InfoPath.SemiTrust.dll</span></span>
    
- <span data-ttu-id="21627-111">Microsoft.Office.Interop.InfoPath.Xml.dll</span><span class="sxs-lookup"><span data-stu-id="21627-111">Microsoft.Office.Interop.InfoPath.Xml.dll</span></span>
    
<span data-ttu-id="21627-112">En este tema se describe el modelo de objetos expuesto a través del ensamblado de interoperabilidad Microsoft.Office.Interop.InfoPath, que se usa exclusivamente para el código de automatización externo.</span><span class="sxs-lookup"><span data-stu-id="21627-112">This topic discusses the object model exposed through the Microsoft.Office.Interop.InfoPath interop assembly, which is used exclusively for external automation code.</span></span> <span data-ttu-id="21627-113">Para obtener información sobre el ensamblado Microsoft.Office.Interop.InfoPath.SemiTrust, que se usa exclusivamente para escribir y ejecutar código administrado que se ejecuta desde dentro de las plantillas de formulario de InfoPath (.xsn), vea [Modelos de objetos compatible con InfoPath 2003](http://msdn.microsoft.com/library/e4511af6-d7e7-44ad-a50d-1b7ee04f8215%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="21627-113">For information on the Microsoft.Office.Interop.InfoPath.SemiTrust assembly, which is used exclusively for writing and running managed code that runs from within InfoPath form templates (.xsn), see [InfoPath 2003 Compatible Object Models](http://msdn.microsoft.com/library/e4511af6-d7e7-44ad-a50d-1b7ee04f8215%28Office.15%29.aspx).</span></span>
  
## <a name="important-installation-information"></a><span data-ttu-id="21627-114">Información importante sobre la instalación</span><span class="sxs-lookup"><span data-stu-id="21627-114">Important Installation Information</span></span>

<span data-ttu-id="21627-115">La opción de instalación predeterminada del programa de instalación de InfoPath instala al ensamblado Microsoft.Office.Interop.InfoPath en la caché de ensamblados Global (GAC) el contenido de los cuales se puede ver desde la carpeta C:\Windows\Assembly (o en C:\Windows\assembly\GAC_ MSIL al ver directamente el sistema de archivos).</span><span class="sxs-lookup"><span data-stu-id="21627-115">The default installation option of the InfoPath setup program installs the Microsoft.Office.Interop.InfoPath assembly in the Global Assembly Cache (GAC), the contents of which can be viewed from the C:\Windows\Assembly folder (or in C:\Windows\assembly\GAC_MSIL when viewing the file system directly).</span></span> <span data-ttu-id="21627-116">Este ensamblado se denomina "Microsoft Office InfoPath ensamblado de interoperabilidad primario" y a menudo se utiliza junto con el ensamblado Microsoft.Office.Interop.InfoPath.Xml, que también se instala en la GAC, para automatizar la aplicación InfoPath desde aplicaciones externas que usan código administrado.</span><span class="sxs-lookup"><span data-stu-id="21627-116">This assembly is referred to as the "Microsoft Office InfoPath Primary Interop Assembly" and is often used in conjunction with the Microsoft.Office.Interop.InfoPath.Xml assembly, which is also installed in the GAC, to automate the InfoPath application from external applications that use managed code.</span></span> <span data-ttu-id="21627-117">Para obtener información sobre el ensamblado Microsoft.Office.Interop.InfoPath.Xml, vea [Acerca de que el ensamblado de interoperabilidad InfoPath XML](about-the-infopath-xml-interop-assembly.md).</span><span class="sxs-lookup"><span data-stu-id="21627-117">For information about the Microsoft.Office.Interop.InfoPath.Xml assembly, see [About the InfoPath XML Interop Assembly](about-the-infopath-xml-interop-assembly.md).</span></span>
  
<span data-ttu-id="21627-118">Si el ensamblado Microsoft.Office.Interop.InfoPath no está visible en la GAC, debería confirmar que InfoPath se ha instalado correctamente.</span><span class="sxs-lookup"><span data-stu-id="21627-118">If the Microsoft.Office.Interop.InfoPath assembly is not visible in the GAC, you should confirm that InfoPath was installed correctly.</span></span> <span data-ttu-id="21627-119">De forma predeterminada, se establece la opción de **Compatibilidad con programación de .NET** en el programa de instalación a **Ejecutar desde Mi PC** mientras el paquete redistribuible de .NET Framework 1.1, Kit de desarrollo de Software (SDK) de .NET Framework 1.1 o una versión posterior de .NET Framework está instalado antes de ejecutar el programa de instalación.</span><span class="sxs-lookup"><span data-stu-id="21627-119">By default, the **.NET Programmability Support** option in the setup program is set to **Run from My Computer** as long as the .NET Framework 1.1 Redistributable, .NET Framework 1.1 Software Development Kit (SDK), or a later version of the .NET Framework is installed before running setup.</span></span> <span data-ttu-id="21627-120">Si estos ensamblados de interoperabilidad no están disponibles en su equipo, debe confirmar que está instalado .NET Framework 1.1 o posterior y, a continuación, usar **programas y características** del **Panel de Control** para cambiar el programa de instalación mediante la configuración de la programación de .NET ** Compatibilidad con** opción en **Microsoft Office InfoPath** para **Ejecutar desde Mi PC**.</span><span class="sxs-lookup"><span data-stu-id="21627-120">If these interop assemblies are not available on your computer, you must confirm that .NET Framework 1.1 or later is installed, and then use **Programs and Features** from the **Control Panel** to change setup by setting the **.NET Programmability Support** option under **Microsoft Office InfoPath** to **Run from My Computer**.</span></span>
  
<span data-ttu-id="21627-121">Para obtener información acerca de cómo descargar el paquete redistribuible de .NET Framework 1.1, consulte el [Paquete redistribuible de .NET Framework 1.1](http://msdn.microsoft.com/netframework/technologyinfo/redist/default.aspx).</span><span class="sxs-lookup"><span data-stu-id="21627-121">For information on downloading the .NET Framework 1.1 Redistributable, see [.NET Framework 1.1 Redistributable](http://msdn.microsoft.com/netframework/technologyinfo/redist/default.aspx).</span></span>
  
## <a name="the-microsoftofficeinteropinfopath-namespace"></a><span data-ttu-id="21627-122">El Namespace Microsoft.Office.Interop.InfoPath</span><span class="sxs-lookup"><span data-stu-id="21627-122">The Microsoft.Office.Interop.InfoPath Namespace</span></span>

<span data-ttu-id="21627-123">Aunque administra el proceso de escribir código para una tarea determinada es muy similar a realizar la misma tarea utilizando un lenguaje como Visual Basic para aplicaciones o JScript, el modelo de objetos expuesto al ver el **Microsoft.Office.Interop.InfoPath** espacio de nombres desde el **Examinador de objetos** en Microsoft Visual Studio busca más compleja.</span><span class="sxs-lookup"><span data-stu-id="21627-123">Although the process of writing managed code for a given task is very similar to performing the same task using a language such as Visual Basic for Applications or JScript, the object model exposed when viewing the **Microsoft.Office.Interop.InfoPath** namespace from the **Object Browser** in Microsoft Visual Studio looks more complex.</span></span> <span data-ttu-id="21627-124">Esto es debido a que la interoperabilidad con .NET Framework requiere un servidor COM para exponer todas sus interfaces públicas, así como algunas construcciones adicionales requeridos por el propio .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="21627-124">This is because interoperability with the .NET Framework requires a COM server to expose all of its public interfaces, as well as some additional constructs required by the .NET Framework itself.</span></span> <span data-ttu-id="21627-125">Para obtener más información sobre cómo y por qué el modelo de objetos expuesto por un ensamblado de interoperabilidad aparece más complejo, vea la sección "Cómo COM objetos están expuestos a código administrado" del tema de [Modelos de objetos compatible con InfoPath 2003](http://msdn.microsoft.com/library/e4511af6-d7e7-44ad-a50d-1b7ee04f8215%28Office.15%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="21627-125">For more information on how and why the object model exposed by an interop assembly appears more complex, see the "How COM Objects are Exposed to Managed Code" section of the [InfoPath 2003 Compatible Object Models](http://msdn.microsoft.com/library/e4511af6-d7e7-44ad-a50d-1b7ee04f8215%28Office.15%29.aspx) topic.</span></span> 
  
### <a name="using-intellisense"></a><span data-ttu-id="21627-126">Utilizar IntelliSense</span><span class="sxs-lookup"><span data-stu-id="21627-126">Using IntelliSense</span></span>

<span data-ttu-id="21627-127">Los ejemplos de esta sección se supone que ha establecido las referencias a los ensamblados Microsoft.Office.Interop.InfoPath y Microsoft.Office.Interop.InfoPath.Xml.</span><span class="sxs-lookup"><span data-stu-id="21627-127">The examples in this section assume that you have established references to the Microsoft.Office.Interop.InfoPath and Microsoft.Office.Interop.InfoPath.Xml assemblies.</span></span> <span data-ttu-id="21627-128">Para obtener información acerca de cómo establecer referencias y ejemplos adicionales de automatización externa, vea [escenarios de automatización externo y ejemplos](external-automation-scenarios-and-examples.md).</span><span class="sxs-lookup"><span data-stu-id="21627-128">For information on how to set references and additional external automation examples, see [External Automation Scenarios and Examples](external-automation-scenarios-and-examples.md).</span></span>
  
<span data-ttu-id="21627-129">Antes de finalización de instrucciones IntelliSense de Microsoft puede usar en el código de automatización externo, debe crear una variable de objeto de una instancia de la clase de [aplicación](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Application.aspx) tal como se muestra en la siguiente línea de código.</span><span class="sxs-lookup"><span data-stu-id="21627-129">Before you can use Microsoft IntelliSense statement completion in external automation code, you must create an object variable for an instance of the [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Application.aspx) class as shown in the following line of code.</span></span> 
  
```cs
Application myApp = 
    new Microsoft.Office.Interop.InfoPath.Application();
```

```vb
Dim myApp As Application = _
    New Microsoft.Office.Interop.InfoPath.Application()
```

<span data-ttu-id="21627-130">Después de crear la variable de objeto, cuando escriba el nombre de variable seguido de un punto, se muestra una lista desplegable con los miembros de la clase de **aplicación** para seleccionar.</span><span class="sxs-lookup"><span data-stu-id="21627-130">After creating the object variable, when you type the variable name followed by a period, a drop-down list is displayed with members of the **Application** class to select.</span></span> 
  
<span data-ttu-id="21627-131">Para trabajar con un formulario de InfoPath, declare una variable de objeto del tipo [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.XDocument.aspx) y, a continuación, inicializarlo abriendo el formulario de la colección [XDocuments](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.XDocuments.aspx) de la variable de objeto de **aplicación** tal como se muestra en la siguiente línea de código.</span><span class="sxs-lookup"><span data-stu-id="21627-131">To work with an InfoPath form, declare an object variable of type [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.XDocument.aspx) , and then initialize it by opening the form from the [XDocuments](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.XDocuments.aspx) collection of the **Application** object variable as shown in the following line of code.</span></span> 
  
```cs
XDocument myXDoc = myApp.XDocuments.Open(
    "c:\\temp\\Form1.xml",
    (int) XdDocumentVersionMode.xdFailOnVersionOlder);
```

```vb
Dim myXDoc As XDocument = myApp.XDocuments.Open( _
    "c:\\temp\\Form1.xml", _
    XdDocumentVersionMode.xdFailOnVersionOlder)
```

<span data-ttu-id="21627-132">Cuando escriba el nombre de la variable seguido de un período, se mostrará la lista de lista desplegable de finalización de instrucciones de IntelliSense para los miembros de la clase **XDocument** .</span><span class="sxs-lookup"><span data-stu-id="21627-132">The IntelliSense statement completion drop-down list for members of the **XDocument** class will be displayed when you type the name of the variable followed by a period.</span></span> 
  
<span data-ttu-id="21627-133">Para trabajar con el contenido del documento XML subyacente para el formulario mediante Microsoft XML Core Services (MSXML), debe crear una variable de tipo [IXMLDOMDocument2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Xml.IXMLDOMDocument2.aspx) y, a continuación, usar la propiedad [DOM](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._XDocument2.DOM.aspx) de la clase **XDocument** para asignar el código XML Modelo de objetos de documento (DOM) del formulario a la variable.</span><span class="sxs-lookup"><span data-stu-id="21627-133">To work with the contents of the underlying XML document for the form using Microsoft XML Core Services (MSXML), you must create a variable of type [IXMLDOMDocument2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Xml.IXMLDOMDocument2.aspx) , and then use the [DOM](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._XDocument2.DOM.aspx) property of the **XDocument** class to assign the XML Document Object Model (DOM) of the form to that variable.</span></span> 
  
```cs
IXMLDOMDocument2 doc= myXDoc.DOM as IXMLDOMDocument2;
```

```vb
Dim doc As IXMLDOMDocument2 = myXDoc.DOM
```

<span data-ttu-id="21627-134">Se mostrará la lista de lista desplegable de finalización de instrucciones de IntelliSense para los miembros de la clase **IXMLDOMDocument2** cuando escriba el nombre de la variable seguido de un período, que le permite usar MSXML para trabajar con el documento XML.</span><span class="sxs-lookup"><span data-stu-id="21627-134">The IntelliSense statement completion drop-down list for members of the **IXMLDOMDocument2** class will be displayed when you type the name of the variable followed by a period, which allows you to use MSXML to work with the XML document.</span></span> 
  
### <a name="using-the-class-library-reference-documentation"></a><span data-ttu-id="21627-135">Utilizar la documentación de referencia de la Biblioteca de clases</span><span class="sxs-lookup"><span data-stu-id="21627-135">Using the Class Library Reference Documentation</span></span>

<span data-ttu-id="21627-136">La organización de la documentación de referencia de biblioteca de clases de espacio de nombres de [Microsoft.Office.Interop.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.aspx) refleja las relaciones entre las interfaces de coclase y las interfaces heredadas que implementan.</span><span class="sxs-lookup"><span data-stu-id="21627-136">The organization of the [Microsoft.Office.Interop.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.aspx) namespace Class Library reference documentation reflects the relationships between coclass interfaces and the inherited interfaces they implement.</span></span> 
  
<span data-ttu-id="21627-137">Cuando abra un tema de una interfaz de coclase, por ejemplo, la [aplicación](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Application.aspx) , el vínculo a los miembros de la interfaz de coclase después de la descripción de la interfaz al principio del tema muestra un tema de vacío.</span><span class="sxs-lookup"><span data-stu-id="21627-137">When you open a topic for a coclass interface, such as [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Application.aspx) , the link to the members of the coclass interface following the description of the interface at the beginning of the topic displays an empty topic.</span></span> <span data-ttu-id="21627-138">Para mostrar la lista de miembros que la interfaz de coclase implementa, debe abrir el tema de la interfaz más reciente heredado por la coclase y, a continuación, abrir la tabla de sus miembros.</span><span class="sxs-lookup"><span data-stu-id="21627-138">To display the list of members that are implemented by the coclass interface, you must open the topic for the most recent interface that is inherited by the coclass, and then open the table of its members.</span></span> <span data-ttu-id="21627-139">Al principio de la sección Observaciones del tema de la interfaz de coclase se proporciona un vínculo a la interfaz heredada.</span><span class="sxs-lookup"><span data-stu-id="21627-139">A link to the inherited interface is provided at the beginning of the Remarks section in the coclass interface topic.</span></span> 
  
<span data-ttu-id="21627-140">Cuando se presiona F1 en el Editor de código de Visual Studio, el comportamiento es similar, excepto en que el miembro en el que se invoca ayuda (F1) se mostrará directamente, porque normalmente se trabaja con los miembros de una interfaz.</span><span class="sxs-lookup"><span data-stu-id="21627-140">When you press F1 in the Visual Studio Code Editor, the behavior is similar, except that the member on which you invoke F1 Help will be displayed directly, because you are most typically working with members of an interface.</span></span> <span data-ttu-id="21627-141">No obstante, puesto que los miembros pueden implementarse desde una interfaz que tiene versión, puede resultar confuso la primera vez que se ve.</span><span class="sxs-lookup"><span data-stu-id="21627-141">However, the fact that a member can be implemented from a versioned interface may be confusing the first time you encounter it.</span></span> <span data-ttu-id="21627-142">Por ejemplo, si escribe  `myXDocument.UI.Alert`, coloca el cursor en  `Alert` y pulsa F1, se mostrará un tema titulado "Método UI2.Alert".</span><span class="sxs-lookup"><span data-stu-id="21627-142">For example, if you type  `myXDocument.UI.Alert` and place the cursor on  `Alert` and press F1, a topic titled "UI2.Alert Method" is displayed.</span></span> <span data-ttu-id="21627-143">Ello se debe a que el método **Alert** es una implementación de un miembro de la interfaz **UI2**.</span><span class="sxs-lookup"><span data-stu-id="21627-143">This is because the **Alert** method is an implementation of a member of the **UI2** interface.</span></span> 
  
### <a name="passing-optional-parameters-to-infopath-object-model-members"></a><span data-ttu-id="21627-144">Pasar parámetros opcionales a los miembros del modelo de objetos de InfoPath</span><span class="sxs-lookup"><span data-stu-id="21627-144">Passing Optional Parameters to InfoPath Object Model Members</span></span>

<span data-ttu-id="21627-145">Si un miembro del modelo de objetos de InfoPath contiene un parámetro opcional, y no se especifica un valor de dicho parámetro, debe pasar el campo **Type.Missing** para ese parámetro.</span><span class="sxs-lookup"><span data-stu-id="21627-145">If an InfoPath object model member contains an optional parameter, and you do not specify a value for that parameter, you must pass the **Type.Missing** field for that parameter.</span></span> <span data-ttu-id="21627-146">Si no se pasa el campo **Type.Missing** al omitir un valor real, se producirá un error de generación.</span><span class="sxs-lookup"><span data-stu-id="21627-146">Failure to pass the **Type.Missing** field when an actual value is omitted will result in a build error.</span></span> <span data-ttu-id="21627-147">Esto es así para el código escrito en C# y Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="21627-147">This is true for code written in both C# and Visual Basic.</span></span> <span data-ttu-id="21627-148">Por ejemplo, el método [SelectNodes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.View2.SelectNodes.aspx) de la interfaz [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ViewObject.aspx) incluye dos parámetros opcionales:  _varEndNode_ y  _varViewContext_.</span><span class="sxs-lookup"><span data-stu-id="21627-148">For example, the [SelectNodes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.View2.SelectNodes.aspx) method of the [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ViewObject.aspx) interface includes two optional parameters:  _varEndNode_ and  _varViewContext_.</span></span> <span data-ttu-id="21627-149">Una línea de código que no especifique valores reales para estos parámetros opcionales debería ser como se muestra a continuación.</span><span class="sxs-lookup"><span data-stu-id="21627-149">A line of code that does not specify actual values for these optional parameters should look like the following examples.</span></span>
  
```cs
myXDocument.View.SelectNodes(group1, Type.Missing, Type.Missing);
```

```vb
myXDocument.View.SelectNodes(group1, Type.Missing, Type.Missing)
```

## <a name="see-also"></a><span data-ttu-id="21627-150">Vea también</span><span class="sxs-lookup"><span data-stu-id="21627-150">See also</span></span>

- [<span data-ttu-id="21627-151">Ejemplos y escenarios de automatización externa</span><span class="sxs-lookup"><span data-stu-id="21627-151">External automation scenarios and examples</span></span>](external-automation-scenarios-and-examples.md)

