---
title: Funciones seguras de clúster
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
localization_priority: Normal
ms.assetid: 787badaf-8782-454d-a016-7eae83bbd8a9
description: 'Hace referencia a: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: d32925fcd5c3be7fe3e615ee2290f25c7595911c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33409303"
---
# <a name="cluster-safe-functions"></a><span data-ttu-id="7fde2-103">Funciones seguras de clúster</span><span class="sxs-lookup"><span data-stu-id="7fde2-103">Cluster safe functions</span></span>

<span data-ttu-id="7fde2-104">**Hace referencia a**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="7fde2-104">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="7fde2-105">En Excel 2013, Excel puede descargar llamadas de User-Defined Function (UDF) a un clúster informático de alto rendimiento a través de una interfaz de conector de clúster dedicada.</span><span class="sxs-lookup"><span data-stu-id="7fde2-105">In Excel 2013, Excel can offload User-Defined Function (UDF) calls to a high-performance computing cluster through a dedicated cluster connector interface.</span></span> <span data-ttu-id="7fde2-106">Los proveedores de clústeres de cálculo proporcionan conectores de clúster.</span><span class="sxs-lookup"><span data-stu-id="7fde2-106">Compute cluster vendors provide Cluster Connectors.</span></span> <span data-ttu-id="7fde2-107">Los autores de UDF pueden declarar sus UDF como seguras para clústeres y, cuando hay un conector de clúster presente, Excel envía llamadas a estas UDF al conector de clúster para su descarga.</span><span class="sxs-lookup"><span data-stu-id="7fde2-107">UDF authors can declare their UDFs as cluster safe and then, when a cluster connector is present, Excel sends calls to these UDFs to the cluster connector for offloading.</span></span>
  
<span data-ttu-id="7fde2-108">Cuando Excel detecta una UDF segura para clústeres durante la actualización, pasa el nombre del XLL que se está ejecutando actualmente, el nombre de la UDF segura para clústeres y los parámetros al conector de clúster.</span><span class="sxs-lookup"><span data-stu-id="7fde2-108">When Excel discovers a cluster-safe UDF during recalculation, it passes the name of the XLL that is currently running, the name of the cluster-safe UDF, and any parameters to the cluster connector.</span></span> <span data-ttu-id="7fde2-109">El conector ejecuta la llamada UDF de forma remota y devuelve los resultados a Excel.</span><span class="sxs-lookup"><span data-stu-id="7fde2-109">The connector runs the UDF call remotely and returns the results to Excel.</span></span> <span data-ttu-id="7fde2-110">El cálculo no dependiente continúa y cuando el conector de clúster ha terminado de ejecutar la UDF, pasa los resultados a Excel y los cálculos dependientes continúan.</span><span class="sxs-lookup"><span data-stu-id="7fde2-110">Non-dependent calculation continues and when the cluster connector has finished running the UDF, it passes the results to Excel and dependent calculations continue.</span></span> <span data-ttu-id="7fde2-111">El mecanismo para este comportamiento asincrónico imita el mecanismo usado por las UDF asincrónicas, excepto que el conector de clúster administra los aspectos asincrónicos en lugar del autor de UDF.</span><span class="sxs-lookup"><span data-stu-id="7fde2-111">The mechanism for this asynchronous behavior mimics the mechanism used by asynchronous UDFs, except that the cluster connector manages the asynchronous aspects instead of the UDF author.</span></span> <span data-ttu-id="7fde2-112">Normalmente, un conector de clúster implementa una corrección de compatibilidad de XLL para cargar XLL y ejecutar UDF en nodos de clúster de cálculo.</span><span class="sxs-lookup"><span data-stu-id="7fde2-112">Typically, a cluster connector implements an XLL shim to load XLLs and run UDFs on compute cluster nodes.</span></span>
  
<span data-ttu-id="7fde2-113">La mecánica de declarar las UDF como seguras para clústeres es similar a la de declarar las UDF como seguras para el recálculo multiproceso.</span><span class="sxs-lookup"><span data-stu-id="7fde2-113">The mechanics of declaring UDFs as cluster-safe resemble those of declaring UDFs as safe for multi-threaded recalculation.</span></span> <span data-ttu-id="7fde2-114">Sin embargo, dado que la UDF no se ejecuta necesariamente en el mismo equipo que otras UDF de la misma sesión de Excel, existen diferentes consideraciones al escribir UDF seguras para clústeres.</span><span class="sxs-lookup"><span data-stu-id="7fde2-114">However, because the UDF is not necessarily running on the same computer as other UDFs from the same Excel session, there are different considerations when writing cluster-safe UDFs.</span></span>
  
<span data-ttu-id="7fde2-115">Para registrar una UDF como segura para clústeres, debe llamar a la función de devolución de llamada [xlfRegister (Formulario 1)](xlfregister-form-1.md) a través de la interfaz de **Excel12** o **Excel12v.**</span><span class="sxs-lookup"><span data-stu-id="7fde2-115">To register a UDF as cluster-safe, you must call the [xlfRegister (Form 1)](xlfregister-form-1.md) callback function through the **Excel12** or **Excel12v** interface.</span></span> <span data-ttu-id="7fde2-116">Para obtener más información acerca de estas interfaces, vea [Excel4/Excel12](excel4-excel12.md) y [Excel4v/Excel12v](excel4v-excel12v.md).</span><span class="sxs-lookup"><span data-stu-id="7fde2-116">For more information about these interfaces, see the [Excel4/Excel12](excel4-excel12.md) and [Excel4v/Excel12v](excel4v-excel12v.md).</span></span> <span data-ttu-id="7fde2-117">No se admite el registro de una UDF como segura para clústeres a través de la interfaz de **Excel4** o **Excel4v.**</span><span class="sxs-lookup"><span data-stu-id="7fde2-117">Registering a UDF as cluster-safe through the **Excel4** or **Excel4v** interface is not supported.</span></span> 
  
<span data-ttu-id="7fde2-118">Si registra una función como segura para clústeres, debe asegurarse de que la función se comporta de forma segura para clústeres.</span><span class="sxs-lookup"><span data-stu-id="7fde2-118">If you register a function as cluster-safe, you must ensure that the function behaves in a cluster-safe way.</span></span> <span data-ttu-id="7fde2-119">Aunque el comportamiento exacto del conector de clúster es específico de la implementación, debe diseñar la UDF para que se ejecute en un sistema informático distribuido y tenga las siguientes características:</span><span class="sxs-lookup"><span data-stu-id="7fde2-119">Although the exact behavior of the cluster connector is implementation-specific, you should design your UDF to run on a distributed computer system and to have the following characteristics:</span></span>
  
- <span data-ttu-id="7fde2-120">Una UDF no debe depender de ningún estado de memoria.</span><span class="sxs-lookup"><span data-stu-id="7fde2-120">A UDF should not rely on any memory state.</span></span> <span data-ttu-id="7fde2-121">Por ejemplo, una UDF no debe depender de una memoria caché en memoria existente.</span><span class="sxs-lookup"><span data-stu-id="7fde2-121">For example, a UDF should not rely on an existing in-memory cache.</span></span>
    
- <span data-ttu-id="7fde2-122">Una UDF no debe realizar devoluciones de llamada de Excel que el proveedor de conectores de clúster no admita.</span><span class="sxs-lookup"><span data-stu-id="7fde2-122">A UDF should not perform Excel callbacks that the cluster connector provider does not support.</span></span>
    
<span data-ttu-id="7fde2-123">Además del comportamiento seguro para clústeres, existen las siguientes restricciones técnicas en las UDF seguras para clústeres:</span><span class="sxs-lookup"><span data-stu-id="7fde2-123">In addition to cluster-safe behavior, there are the following technical restrictions on cluster-safe UDFs:</span></span>
  
1. <span data-ttu-id="7fde2-124">No hay argumentos XLOPER (tipos 'P', 'R').</span><span class="sxs-lookup"><span data-stu-id="7fde2-124">No XLOPER arguments (types 'P', 'R').</span></span>
    
2. <span data-ttu-id="7fde2-125">No hay argumentos XLOPER12 que admitan referencias de rango (tipo 'U').</span><span class="sxs-lookup"><span data-stu-id="7fde2-125">No XLOPER12 arguments that support range references (type 'U').</span></span>
    
3. <span data-ttu-id="7fde2-126">No puede ser una función equivalente de hoja de macros ('#' y ' &amp; ' no se pueden combinar).</span><span class="sxs-lookup"><span data-stu-id="7fde2-126">Cannot be a macro sheet equivalent function ('#' and '&amp;' cannot be combined).</span></span>
    
<span data-ttu-id="7fde2-127">En el caso de las UDF con tiempos de ejecución más cortos, la sobrecarga de descarga puede ser mayor que el tiempo que tarda la UDF en ejecutarse, lo que anula muchas de las ventajas de usar esta infraestructura.</span><span class="sxs-lookup"><span data-stu-id="7fde2-127">For UDFs with shorter execution times, the overhead of offloading may be larger than the time it takes the UDF to execute, negating many of the benefits of using this infrastructure.</span></span>
  
> [!NOTE]
> <span data-ttu-id="7fde2-128">No puede declarar una UDF segura para clústeres como UDF asincrónica.</span><span class="sxs-lookup"><span data-stu-id="7fde2-128">You cannot declare a cluster-safe UDF as an asynchronous UDF.</span></span> 
  
<span data-ttu-id="7fde2-129">Una UDF puede determinar si se ejecuta mediante un conector de clúster llamando a la función de devolución de llamada [xlRunningOnCluster.](xlrunningoncluster.md)</span><span class="sxs-lookup"><span data-stu-id="7fde2-129">A UDF can determine whether it is being run using a cluster connector by calling the [xlRunningOnCluster](xlrunningoncluster.md) callback function.</span></span> 
  

