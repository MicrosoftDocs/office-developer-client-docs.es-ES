---
title: Funciones seguras de clúster
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
localization_priority: Normal
ms.assetid: 787badaf-8782-454d-a016-7eae83bbd8a9
description: 'Hace referencia a: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: f73f49e4d76a8545399eede283b70551ee6569f9
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19815514"
---
# <a name="cluster-safe-functions"></a><span data-ttu-id="4af58-103">Funciones seguras de clúster</span><span class="sxs-lookup"><span data-stu-id="4af58-103">Cluster safe functions</span></span>

<span data-ttu-id="4af58-104">**Hace referencia a**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="4af58-104">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="4af58-105">En Excel 2013, Excel puede descargar las llamadas de función definida por el usuario (UDF) a un clúster de sistemas de alto rendimiento a través de una interfaz de conector de clúster dedicado.</span><span class="sxs-lookup"><span data-stu-id="4af58-105">In Excel 2013, Excel can offload User-Defined Function (UDF) calls to a high-performance computing cluster through a dedicated cluster connector interface.</span></span> <span data-ttu-id="4af58-106">Compute Cluster Server proveedores disponen de conectores de clúster.</span><span class="sxs-lookup"><span data-stu-id="4af58-106">Compute cluster vendors provide Cluster Connectors.</span></span> <span data-ttu-id="4af58-107">Los autores UDF pueden declarar sus UDF como clúster seguros y, a continuación, cuando un conector de clúster está presente, Excel envía las llamadas a estos archivos de UDF para el conector de clúster para descarga.</span><span class="sxs-lookup"><span data-stu-id="4af58-107">UDF authors can declare their UDFs as cluster safe and then, when a cluster connector is present, Excel sends calls to these UDFs to the cluster connector for offloading.</span></span>
  
<span data-ttu-id="4af58-108">Cuando Excel descubre una UDF seguras de clúster durante la actualización, se pasa el nombre del XLL que se está ejecutando actualmente, el nombre de la UDF seguras de clúster y los parámetros para el conector de clúster.</span><span class="sxs-lookup"><span data-stu-id="4af58-108">When Excel discovers a cluster-safe UDF during recalculation, it passes the name of the XLL that is currently running, the name of the cluster-safe UDF, and any parameters to the cluster connector.</span></span> <span data-ttu-id="4af58-109">El conector ejecuta la llamada UDF de forma remota y devuelve los resultados a Excel.</span><span class="sxs-lookup"><span data-stu-id="4af58-109">The connector runs the UDF call remotely and returns the results to Excel.</span></span> <span data-ttu-id="4af58-110">No dependientes cálculo continúa y cuando el conector de clúster ha terminado de ejecutarse la UDF, se pasan los resultados a Excel y continuar cálculos dependientes.</span><span class="sxs-lookup"><span data-stu-id="4af58-110">Non-dependent calculation continues and when the cluster connector has finished running the UDF, it passes the results to Excel and dependent calculations continue.</span></span> <span data-ttu-id="4af58-111">El mecanismo para este comportamiento asincrónico imite el mecanismo de UDF asincrónicas, excepto en que el conector de clúster administra los aspectos asincrónicos en lugar del autor UDF.</span><span class="sxs-lookup"><span data-stu-id="4af58-111">The mechanism for this asynchronous behavior mimics the mechanism used by asynchronous UDFs, except that the cluster connector manages the asynchronous aspects instead of the UDF author.</span></span> <span data-ttu-id="4af58-112">Normalmente, un conector de clúster implementa una corrección de XLL para cargar los XLL y ejecutar las UDF en compute nodos de clúster.</span><span class="sxs-lookup"><span data-stu-id="4af58-112">Typically, a cluster connector implements an XLL shim to load XLLs and run UDFs on compute cluster nodes.</span></span>
  
<span data-ttu-id="4af58-113">La mecánica de la declaración de las UDF como seguras de clúster son similares a las de la declaración de las UDF como seguros para la actualización de cálculos multiproceso.</span><span class="sxs-lookup"><span data-stu-id="4af58-113">The mechanics of declaring UDFs as cluster-safe resemble those of declaring UDFs as safe for multi-threaded recalculation.</span></span> <span data-ttu-id="4af58-114">Sin embargo, debido a que no se está ejecutando necesariamente las UDF en el mismo equipo que otros las UDF desde la misma sesión de Excel, existen diferentes consideraciones al escribir las UDF seguras de clúster.</span><span class="sxs-lookup"><span data-stu-id="4af58-114">However, because the UDF is not necessarily running on the same computer as other UDFs from the same Excel session, there are different considerations when writing cluster-safe UDFs.</span></span>
  
<span data-ttu-id="4af58-115">Para registrar una UDF como seguras de clúster, debe llamar a la función de devolución de llamada [xlfRegister (formulario 1)](xlfregister-form-1.md) a través de la interfaz **Excel12** o **Excel12v** .</span><span class="sxs-lookup"><span data-stu-id="4af58-115">To register a UDF as cluster-safe, you must call the [xlfRegister (Form 1)](xlfregister-form-1.md) callback function through the **Excel12** or **Excel12v** interface.</span></span> <span data-ttu-id="4af58-116">Para obtener más información acerca de estas interfaces, vea la [Excel4/Excel12](excel4-excel12.md) y la [Excel4v/Excel12v](excel4v-excel12v.md).</span><span class="sxs-lookup"><span data-stu-id="4af58-116">For more information about these interfaces, see the [Excel4/Excel12](excel4-excel12.md) and [Excel4v/Excel12v](excel4v-excel12v.md).</span></span> <span data-ttu-id="4af58-117">Registrar una UDF como seguras de clúster a través de la interfaz de **Excel4** o **Excel4v** no es compatible.</span><span class="sxs-lookup"><span data-stu-id="4af58-117">Registering a UDF as cluster-safe through the **Excel4** or **Excel4v** interface is not supported.</span></span> 
  
<span data-ttu-id="4af58-118">Si se registra una función como seguras de clúster, debe asegurarse de que la función se comporta de forma segura para el clúster.</span><span class="sxs-lookup"><span data-stu-id="4af58-118">If you register a function as cluster-safe, you must ensure that the function behaves in a cluster-safe way.</span></span> <span data-ttu-id="4af58-119">Aunque el comportamiento exacto del conector de clúster es específico de la implementación, debe diseñar su UDF para ejecutar en un sistema distribuido y tienen las siguientes características:</span><span class="sxs-lookup"><span data-stu-id="4af58-119">Although the exact behavior of the cluster connector is implementation-specific, you should design your UDF to run on a distributed computer system and to have the following characteristics:</span></span>
  
- <span data-ttu-id="4af58-120">Un archivo UDF no debe confiar en cualquier estado de la memoria.</span><span class="sxs-lookup"><span data-stu-id="4af58-120">A UDF should not rely on any memory state.</span></span> <span data-ttu-id="4af58-121">Por ejemplo, un archivo UDF no debe confiar en una caché en memoria existente.</span><span class="sxs-lookup"><span data-stu-id="4af58-121">For example, a UDF should not rely on an existing in-memory cache.</span></span>
    
- <span data-ttu-id="4af58-122">Un archivo UDF no debe llevar a cabo las devoluciones de llamada de Excel que no es compatible con el proveedor de conector de clúster.</span><span class="sxs-lookup"><span data-stu-id="4af58-122">A UDF should not perform Excel callbacks that the cluster connector provider does not support.</span></span>
    
<span data-ttu-id="4af58-123">Además de comportamiento de seguridad de clúster, existen las siguientes restricciones técnicas de las UDF seguras de clúster:</span><span class="sxs-lookup"><span data-stu-id="4af58-123">In addition to cluster-safe behavior, there are the following technical restrictions on cluster-safe UDFs:</span></span>
  
1. <span data-ttu-id="4af58-124">Sin argumentos XLOPER (tipos de 'P', 'R').</span><span class="sxs-lookup"><span data-stu-id="4af58-124">No XLOPER arguments (types 'P', 'R').</span></span>
    
2. <span data-ttu-id="4af58-125">Sin argumentos XLOPER12 que admiten referencias de rango (tipo 'U').</span><span class="sxs-lookup"><span data-stu-id="4af58-125">No XLOPER12 arguments that support range references (type 'U').</span></span>
    
3. <span data-ttu-id="4af58-126">No puede ser una función equivalente de hoja macro ('#' y '&amp;' no se puede combinar).</span><span class="sxs-lookup"><span data-stu-id="4af58-126">Cannot be a macro sheet equivalent function ('#' and '&amp;' cannot be combined).</span></span>
    
<span data-ttu-id="4af58-127">Para las UDF con tiempos de ejecución, la sobrecarga de descarga puede ser mayor que el tiempo que tarda la UDF en ejecución, al negar muchas de las ventajas de usar esta infraestructura.</span><span class="sxs-lookup"><span data-stu-id="4af58-127">For UDFs with shorter execution times, the overhead of offloading may be larger than the time it takes the UDF to execute, negating many of the benefits of using this infrastructure.</span></span>
  
> [!NOTE]
> <span data-ttu-id="4af58-128">No se puede declarar una UDF seguras de clúster como un UDF asincrónico.</span><span class="sxs-lookup"><span data-stu-id="4af58-128">You cannot declare a cluster-safe UDF as an asynchronous UDF.</span></span> 
  
<span data-ttu-id="4af58-129">Un archivo UDF puede determinar si se está ejecutando con un conector de clúster mediante una llamada a la función de devolución de llamada de [xlRunningOnCluster](xlrunningoncluster.md) .</span><span class="sxs-lookup"><span data-stu-id="4af58-129">A UDF can determine whether it is being run using a cluster connector by calling the [xlRunningOnCluster](xlrunningoncluster.md) callback function.</span></span> 
  

