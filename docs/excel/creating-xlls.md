---
title: Crear XLL
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
keywords:
- archivos DLL [excel 2007], llamada a excel, xlAutoFree (función) [Excel 2007], [Excel 2007],xlcall32.lib [Excel 2007], [Excel 2007],xlcall.cpp [Excel 2007], xlAutoRemove (función) [Excel 2007], xlAddInManagerInfo (función) xlAutoRegister (función) xlAutoFree12 función [Excel 2007], xlAutoAdd (función) [Excel 2007], xlAutoOpen (función) [Excel 2007], xlAutoClose (función) [Excel 2007], archivos DLL [Excel 2007], convirtiendo en XLL, XLL [Excel 2007], llamada a Excel, xlAutoRegister12 (función) [Excel 2007],xlcall.h [Excel función de xlAddInManagerInfo12 de 2007], [Excel 2007]
localization_priority: Normal
ms.assetid: 7754998f-4e13-4a37-9724-43b6ee6c919b
description: 'Hace referencia a: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: de347d34768c25adf0d96642b4fade781ae26a9c
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19815535"
---
# <a name="creating-xlls"></a><span data-ttu-id="b6eb0-104">Crear XLL</span><span class="sxs-lookup"><span data-stu-id="b6eb0-104">Creating XLLs</span></span>

<span data-ttu-id="b6eb0-105">**Hace referencia a**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="b6eb0-105">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="b6eb0-106">Si el archivo DLL es autónoma o se basa únicamente en otras bibliotecas, debe conocer cómo habilitar Microsoft Excel tener acceso a sus funciones y comandos.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-106">If your DLL is self-contained or relies only on other libraries, you must know how to enable Microsoft Excel to access its functions and commands.</span></span> <span data-ttu-id="b6eb0-107">Para obtener más información, vea [Archivos DLL de Access en Excel](how-to-access-dlls-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="b6eb0-107">For more information, see [Access DLLs in Excel](how-to-access-dlls-in-excel.md).</span></span> 
  
<span data-ttu-id="b6eb0-108">Sin embargo, si el archivo DLL necesita tener acceso a funcionalidad de Excel (por ejemplo, para obtener el contenido de una celda, para llamar a una función de hoja de cálculo, o para consultar Excel para obtener información del área de trabajo), el código debe ser capaz de devolver la llamada en Excel.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-108">However, if your DLL needs to access Excel functionality (for example, to get the contents of a cell, to call a worksheet function, or to interrogate Excel to obtain workspace information), your code must be able to call back into Excel.</span></span>
  
<span data-ttu-id="b6eb0-109">La API de C de Excel proporciona varias funciones que les permiten a las DLL devolver la llamada en Excel.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-109">The Excel C API provides several functions that enable DLLs to call back into Excel.</span></span> <span data-ttu-id="b6eb0-110">Para obtener acceso a estos, el archivo DLL debe estar vinculado estáticamente en tiempo de compilación con la biblioteca de Excel 32-bit, xlcall32.lib.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-110">To access these, the DLL must be linked statically at compile time with the Excel 32-bit library, xlcall32.lib.</span></span> <span data-ttu-id="b6eb0-111">La biblioteca estática es que se pueden descargar de Microsoft como parte del SDK de XLL de Microsoft Excel 2013, que incluye las versiones de 32 bits y 64 bits de esta biblioteca.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-111">The static library is downloadable from Microsoft as part of the Microsoft Excel 2013 XLL SDK, which includes both 32-bit and 64-bit versions of this library.</span></span>
  
## <a name="enabling-dlls-to-call-back-into-excel"></a><span data-ttu-id="b6eb0-112">Habilitación de la DLL de devolución de llamada a Excel</span><span class="sxs-lookup"><span data-stu-id="b6eb0-112">Enabling DLLs to Call Back into Excel</span></span>

<span data-ttu-id="b6eb0-113">Para un archivo DLL para poder tener acceso a la funcionalidad de Excel y obtener o establecer la información del área de trabajo, primero debe obtener las direcciones de las funciones de devolución de llamada de Excel **Excel4**, **Excel4v**, **Excel12**y **Excel12v**.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-113">For a DLL to be able to access the functionality in Excel and get or set workspace information, it must first obtain the addresses of the Excel callback functions **Excel4**, **Excel4v**, **Excel12**, and **Excel12v**.</span></span> <span data-ttu-id="b6eb0-114">Los dos últimos se introdujeron en Excel 2007 y están disponibles en versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-114">The last two were introduced in Excel 2007 and are available in subsequent versions.</span></span> <span data-ttu-id="b6eb0-115">Para obtener acceso a todos ellos, el proyecto de archivo DLL debe incluir las referencias a los siguientes archivos desde el SDK de XLL de Excel de 2013.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-115">To access all of these, the DLL project must include references to the following files from the Excel 2013 XLL SDK.</span></span> <span data-ttu-id="b6eb0-116">Si desea obtener acceso sólo las dos primeras devoluciones de llamada (en cualquier versión de Excel), el proyecto debe incluir sólo los dos primeros archivos.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-116">If you want to access only the first two callbacks (in any version of Excel), your project needs to include only the first two files.</span></span>
  
### <a name="xlcallh"></a><span data-ttu-id="b6eb0-117">Xlcall.h</span><span class="sxs-lookup"><span data-stu-id="b6eb0-117">Xlcall.h</span></span>

<span data-ttu-id="b6eb0-118">El archivo Xlcall.h contiene los siguientes elementos:</span><span class="sxs-lookup"><span data-stu-id="b6eb0-118">The Xlcall.h file contains the following items:</span></span>
  
- <span data-ttu-id="b6eb0-119">Prototipos de función para todas las funciones de devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-119">Function prototypes for all callback functions.</span></span>
    
- <span data-ttu-id="b6eb0-120">Definiciones de las estructuras de datos que las devoluciones de llamada que se usan para intercambiar datos entre el archivo DLL o XLL y Excel y las definiciones de constantes de tipo de datos.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-120">Definitions of the data structures that the callbacks use to exchange data between the DLL/XLL and Excel, and data-type constant definitions.</span></span>
    
- <span data-ttu-id="b6eb0-121">Definiciones de los equivalentes de función y el comando de API de C de la hoja de cálculo, las funciones de hoja de macros y comandos admitidos de Excel.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-121">Definitions of the C API function and command equivalents of the worksheet, macro sheet functions, and supported Excel commands.</span></span>
    
- <span data-ttu-id="b6eb0-122">Definiciones de función de devolución de llamada devuelven valores.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-122">Definitions of callback function return values.</span></span>
    
<span data-ttu-id="b6eb0-123">Debe utilizar el **#include** la directiva para este archivo, directa o indirectamente a través de otro archivo de encabezado, en todos los archivos que obtener acceso a la API de C o que controlar los tipos de datos que utiliza la API de C.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-123">You should use the **#include** directive for this file, directly or indirectly via another header file, in all files that access the C API or that handle data types that the C API uses.</span></span> 
  
### <a name="xlcall32lib"></a><span data-ttu-id="b6eb0-124">Xlcall32.lib</span><span class="sxs-lookup"><span data-stu-id="b6eb0-124">Xlcall32.lib</span></span>

<span data-ttu-id="b6eb0-125">La biblioteca de Xlcall32.lib exporta las dos primeras devoluciones de llamada, **Excel4** y **Excel4v**y también la función **XlCallVer** .</span><span class="sxs-lookup"><span data-stu-id="b6eb0-125">The Xlcall32.lib library exports the first two callbacks, **Excel4** and **Excel4v**, and also the **XlCallVer** function.</span></span> <span data-ttu-id="b6eb0-126">Sin una referencia a esta biblioteca en el proyecto, el vinculador no puede crear el XLL si ha usado cualquiera de estas devoluciones de llamada en el código.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-126">Without a reference to this library in your project, the linker cannot create the XLL if you have used any of these callbacks in your code.</span></span> <span data-ttu-id="b6eb0-127">(Puede obtener las direcciones de estas funciones si vincula dinámicamente a la Xlcall32.dll equivalente a la que se copian en el sistema como parte de una instalación normal de Excel).</span><span class="sxs-lookup"><span data-stu-id="b6eb0-127">(You can obtain the addresses of these functions by linking dynamically to the equivalent Xlcall32.dll that is copied to your system as part of a normal Excel installation.)</span></span> 
  
### <a name="xlcallcpp"></a><span data-ttu-id="b6eb0-128">Xlcall.cpp</span><span class="sxs-lookup"><span data-stu-id="b6eb0-128">Xlcall.cpp</span></span>

<span data-ttu-id="b6eb0-129">No se exportan las devoluciones de llamada de Excel **Excel12** y **Excel12v** en Xlcall32.lib.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-129">The Excel callbacks **Excel12** and **Excel12v** are not exported in Xlcall32.lib.</span></span> <span data-ttu-id="b6eb0-130">Esto garantiza que los proyectos XLL que se crea a partir de Excel 2007 también funciona con versiones anteriores de Excel.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-130">This ensures that XLL projects that you create starting in Excel 2007 will also work with earlier versions of Excel.</span></span> <span data-ttu-id="b6eb0-131">El módulo Xlcall.cpp contiene código para la **Excel12** y **Excel12v** funciones, que llaman a una entrada de Excel elija Iniciar en Excel 2007, o devuelven un valor de error seguros si está ejecutando una versión anterior de Excel.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-131">The Xlcall.cpp module contains code for the **Excel12** and **Excel12v** functions, which call into an Excel entry point starting in Excel 2007, or return a safe error value if you are running an earlier version of Excel.</span></span> <span data-ttu-id="b6eb0-132">Debe incluir este módulo en el proyecto si desea crear un XLL que ejecuta a partir de Excel 2007 y que es capaz de usar los nuevos tipos de datos que administran las cuadrículas más grandes y cadenas Unicode más largas.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-132">You should include this module in your project if you want to create an XLL that runs starting in Excel 2007 and that is able to use the new data types that handle larger grids and longer Unicode strings.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="b6eb0-133">Iniciar con el SDK de Excel 2010, se puede compilar este archivo para los XLL de 32 bits y 64 bits.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-133">Starting with the Excel 2010 SDK, this file can be compiled for both 32-bit and 64-bit XLLs.</span></span> 
  
## <a name="turning-dlls-into-xlls-add-in-manager-interface-functions"></a><span data-ttu-id="b6eb0-134">Cómo convertir archivos DLL en XLL: Administrador de funciones de la interfaz de complemento</span><span class="sxs-lookup"><span data-stu-id="b6eb0-134">Turning DLLs into XLLs: Add-in Manager Interface Functions</span></span>

<span data-ttu-id="b6eb0-135">Un XLL es un archivo DLL que se exporta varios procedimientos que son llamados por Excel o el Administrador de complementos de Excel.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-135">An XLL is a DLL that exports several procedures that are called by Excel or the Excel Add-in Manager.</span></span> <span data-ttu-id="b6eb0-136">Estos procedimientos se describe brevemente aquí y se analizan detalladamente en [Administrador de complementos y funciones de la interfaz de XLL](add-in-manager-and-xll-interface-functions.md).</span><span class="sxs-lookup"><span data-stu-id="b6eb0-136">These procedures are described briefly here and discussed in detail in [Add-in Manager and XLL Interface Functions](add-in-manager-and-xll-interface-functions.md).</span></span> <span data-ttu-id="b6eb0-137">Todas estas devoluciones de llamada DLL empiece con el prefijo **xlAuto**.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-137">All of these DLL callbacks start with the prefix **xlAuto**.</span></span> <span data-ttu-id="b6eb0-138">Sólo uno de ellos, el comando **xlAutoOpen**, es necesario.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-138">Only one of these, the command **xlAutoOpen**, is required.</span></span> <span data-ttu-id="b6eb0-139">Se llama cuando el complemento se activa y se utiliza normalmente para registrar funciones XLL y comandos con Excel y realizar otras tareas de inicialización.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-139">It is called when the add-in is activated, and it is typically used to register XLL functions and commands with Excel and to do other initialization tasks.</span></span> <span data-ttu-id="b6eb0-140">Las firmas de función y las implementaciones de ejemplo de todas las funciones **xlAuto** se proporcionan en secciones posteriores.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-140">The function signatures and example implementations of all of the **xlAuto** functions are provided in later sections.</span></span> 
  
<span data-ttu-id="b6eb0-141">Aunque **xlAutoOpen** es la única necesaria de estas devoluciones de llamada, el complemento es posible que también necesite exportar otros usuarios según su comportamiento.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-141">Even though **xlAutoOpen** is the only required one of these callbacks, your add-in may also need to export others depending on its behavior.</span></span> 
  
<span data-ttu-id="b6eb0-142">Excel 2007 introdujo un nuevo tipo de datos, **XLOPER12**, para dar cabida a las cuadrículas más grandes y para admitir cadenas largas de Unicode.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-142">Excel 2007 introduced a new data type, **XLOPER12**, to accommodate larger grids and to support long Unicode strings.</span></span> <span data-ttu-id="b6eb0-143">**XLOPER12** se describe más adelante en este tema.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-143">**XLOPER12** is described later in this topic.</span></span> <span data-ttu-id="b6eb0-144">Mientras que funciones **xlAuto** toman o devuelven el tipo de datos anterior **XLOPER**, nuevas versiones de estas funciones se introdujeron en Excel 2007 que usan tipos de datos **XLOPER12** .</span><span class="sxs-lookup"><span data-stu-id="b6eb0-144">Whereas **xlAuto** functions take or return the old data type **XLOPER**, new versions of these functions were introduced in Excel 2007 that use **XLOPER12** data types.</span></span> <span data-ttu-id="b6eb0-145">Con la excepción de **xlAutoFree12**, que a veces se debe implementar para evitar **XLOPER12** memoria pérdidas, puede omitir sin ningún riesgo todas la versión 12 funciones **xlAuto** , en cuyo caso, empezando en Excel 2007, las llamadas de Excel **XLOPER** versiones.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-145">With the exception of **xlAutoFree12**, which you must sometimes implement to avoid **XLOPER12** memory leaks, you can safely omit all the version 12 **xlAuto** functions, in which case, starting in Excel 2007, Excel calls the **XLOPER** versions.</span></span> 
  
### <a name="xlautoopen"></a><span data-ttu-id="b6eb0-146">xlAutoOpen</span><span class="sxs-lookup"><span data-stu-id="b6eb0-146">xlAutoOpen</span></span>

<span data-ttu-id="b6eb0-147">Excel llama a la función [xlAutoOpen](xlautoopen.md) cada vez que se activa el XLL.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-147">Excel calls the [xlAutoOpen](xlautoopen.md) function whenever the XLL is activated.</span></span> <span data-ttu-id="b6eb0-148">El complemento se activará en el inicio de una sesión de Excel si estaba activo en la última sesión de Excel que finalizó normalmente.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-148">The add-in will be activated at the start of an Excel session if it was active in the last Excel session that ended normally.</span></span> <span data-ttu-id="b6eb0-149">El complemento se activa si se carga durante una sesión de Excel.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-149">The add-in is activated if it is loaded during an Excel session.</span></span> <span data-ttu-id="b6eb0-150">El complemento se puede desactivar y reactivar una durante una sesión de Excel, y se llama a la función de reactivación.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-150">The add-in can be deactivated and reactivated during an Excel session, and the function is called on reactivation.</span></span> 
  
<span data-ttu-id="b6eb0-151">Debe usar **xlAutoOpen** para registrar los comandos y funciones XLL, inicializar las estructuras de datos, personalizar la interfaz de usuario y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-151">You should use **xlAutoOpen** to register XLL functions and commands, initialize data structures, customize the user interface, and so on.</span></span> 
  
<span data-ttu-id="b6eb0-152">Si el complemento implementa y exporta la función [xlAutoRegister](xlautoregister-xlautoregister12.md) o la función [xlAutoRegister12](xlautoregister-xlautoregister12.md) , Excel puede intentar activar y registrar un comando o función sin llamar primero a la función **xlAutoOpen** .</span><span class="sxs-lookup"><span data-stu-id="b6eb0-152">If your add-in implements and exports the [xlAutoRegister](xlautoregister-xlautoregister12.md) function or the [xlAutoRegister12](xlautoregister-xlautoregister12.md) function, Excel might attempt to activate and register a function or command without first calling the **xlAutoOpen** function.</span></span> <span data-ttu-id="b6eb0-153">En este caso, debe asegurarse de que el complemento está lo suficientemente inicializado para que su función o el comando para que funcione correctamente.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-153">In this case, you should ensure that your add-in is sufficiently initialized for your function or command to work properly.</span></span> <span data-ttu-id="b6eb0-154">Si no es así, se debe ya sea producirá un error en el intento para registrar la función o el comando, o realizar la inicialización necesaria.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-154">If it is not, you should either fail the attempt to register the function or command, or carry out the necessary initialization.</span></span> 
  
### <a name="xlautoclose"></a><span data-ttu-id="b6eb0-155">xlAutoClose</span><span class="sxs-lookup"><span data-stu-id="b6eb0-155">xlAutoClose</span></span>

<span data-ttu-id="b6eb0-156">Excel llama a la función [xlAutoClose](xlautoclose.md) cada vez que se desactiva el XLL.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-156">Excel calls the [xlAutoClose](xlautoclose.md) function whenever the XLL is deactivated.</span></span> <span data-ttu-id="b6eb0-157">El complemento se desactivará cuando finaliza una sesión de Excel normalmente.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-157">The add-in will be deactivated when an Excel session ends normally.</span></span> <span data-ttu-id="b6eb0-158">Si el usuario desactiva el complemento durante una sesión de Excel, se llama a la función.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-158">If the user deactivates the add-in during an Excel session, the function is called.</span></span> 
  
<span data-ttu-id="b6eb0-159">Debe usar **xlAutoClose** para anular el registro de las funciones y comandos, liberar recursos, deshacer las personalizaciones y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-159">You should use **xlAutoClose** to unregister functions and commands, release resources, undo customizations, and so on.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="b6eb0-160">Hay un problema conocido con la anulación del registro de las funciones y comandos.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-160">There is a known issue with the unregistration of functions and commands.</span></span> <span data-ttu-id="b6eb0-161">Para obtener m�s informaci�n, consulte [Problemas conocidos en el desarrollo de XLL de Excel](known-issues-in-excel-xll-development.md).</span><span class="sxs-lookup"><span data-stu-id="b6eb0-161">For more information, see [Known Issues in Excel XLL Development](known-issues-in-excel-xll-development.md).</span></span> 
  
### <a name="xlautoadd"></a><span data-ttu-id="b6eb0-162">xlAutoAdd</span><span class="sxs-lookup"><span data-stu-id="b6eb0-162">xlAutoAdd</span></span>

<span data-ttu-id="b6eb0-163">Excel llama a la [función xlAutoAdd](xlautoadd.md) cada vez que el usuario activa el XLL durante una sesión de Excel mediante el uso del administrador.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-163">Excel calls the [xlAutoAdd function](xlautoadd.md) whenever the user activates the XLL during an Excel session by using the Add-In Manager.</span></span> <span data-ttu-id="b6eb0-164">Esta función no se llama cuando Excel se inicia y carga un complemento preinstalado.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-164">This function is not called when Excel starts and loads a preinstalled add-in.</span></span> 
  
<span data-ttu-id="b6eb0-165">Puede usar esta función para mostrar un cuadro de diálogo personalizado que indica al usuario que se ha activado el complemento, para leer o escribir en el registro o para comprobar la información de licencias.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-165">You can use this function to display a custom dialog box that tells the user that the add-in has been activated, to read from or write to the registry, or to check licensing information.</span></span>
  
### <a name="xlautoremove"></a><span data-ttu-id="b6eb0-166">xlAutoRemove</span><span class="sxs-lookup"><span data-stu-id="b6eb0-166">xlAutoRemove</span></span>

<span data-ttu-id="b6eb0-167">Excel llama a la función [xlAutoRemove](xlautoremove.md) cada vez que el usuario desactiva el XLL durante una sesión de Excel mediante el uso del administrador.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-167">Excel calls the [xlAutoRemove](xlautoremove.md) function whenever the user deactivates the XLL during an Excel session by using the Add-In Manager.</span></span> <span data-ttu-id="b6eb0-168">Esta función no se llama cuando se cierra una sesión de Excel, normalmente o de forma anómala, con el complemento instalado.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-168">This function is not called when an Excel session closes, normally or abnormally, with the add-in installed.</span></span> 
  
<span data-ttu-id="b6eb0-169">Puede usar esta función para mostrar un cuadro de diálogo personalizado que indica al usuario que el complemento se ha desactivado, o para leer o escribir en el registro.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-169">You can use this function to display a custom dialog box that tells the user that the add-in has been deactivated, or to read from or write to the registry.</span></span>
  
### <a name="xladdinmanagerinfoxladdinmanagerinfo12"></a><span data-ttu-id="b6eb0-170">xlAddInManagerInfo/xlAddInManagerInfo12</span><span class="sxs-lookup"><span data-stu-id="b6eb0-170">xlAddInManagerInfo/xlAddInManagerInfo12</span></span>

<span data-ttu-id="b6eb0-171">Excel llama a la función [xlAddInManagerInfo](xladdinmanagerinfo-xladdinmanagerinfo12.md) cuando se invoca el Administrador de complementos por primera vez en una sesión de Excel.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-171">Excel calls the [xlAddInManagerInfo](xladdinmanagerinfo-xladdinmanagerinfo12.md) function when the Add-in Manager is invoked for the first time in an Excel session.</span></span> <span data-ttu-id="b6eb0-172">Si Excel pasa un argumento igual a 1, esta función debe devolver una cadena (normalmente, el nombre del complemento) de lo contrario, debe devolver **#VALUE!**.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-172">If Excel passes an argument equal to 1, this function should return a string (typically, the name of the add-in); otherwise, it should return **#VALUE!**.</span></span>
  
<span data-ttu-id="b6eb0-173">Iniciar en Excel 2007, Excel llama a la función **xlAddInManagerInfo12** preferencia a la función **xlAddInManagerInfo** si lo exporta el XLL.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-173">Starting in Excel 2007, Excel calls the **xlAddInManagerInfo12** function in preference to the **xlAddInManagerInfo** function if it is exported by the XLL.</span></span> <span data-ttu-id="b6eb0-174">La función **xlAddInManagerInfo12** debe trabajar en la misma manera que la función **xlAddInManagerInfo** para evitar las diferencias específicas de la versión en el comportamiento de los XLL.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-174">The **xlAddInManagerInfo12** function should work in the same way as the **xlAddInManagerInfo** function to avoid version-specific differences in the behavior of the XLL.</span></span> <span data-ttu-id="b6eb0-175">La función **xlAddInManagerInfo12** debe devolver un tipo de datos **XLOPER12** , mientras que la función **xlAddInManagerInfo** debe devolver un tipo de datos **XLOPER** .</span><span class="sxs-lookup"><span data-stu-id="b6eb0-175">The **xlAddInManagerInfo12** function should return an **XLOPER12** data type, whereas the **xlAddInManagerInfo** function should return an **XLOPER** data type.</span></span> 
  
### <a name="xlautoregisterxlautoregister12"></a><span data-ttu-id="b6eb0-176">xlAutoRegister/xlAutoRegister12</span><span class="sxs-lookup"><span data-stu-id="b6eb0-176">xlAutoRegister/xlAutoRegister12</span></span>

<span data-ttu-id="b6eb0-177">Excel llama a la función [xlAutoRegister](xlautoregister-xlautoregister12.md) cada vez que se ha realizado una llamada a la función XLM **registrar**o la función de API de C equivalente [xlfRegister](xlfregister-form-1.md) , con la devolución y tipos de argumento falta para la función que se está registrada.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-177">Excel calls the [xlAutoRegister](xlautoregister-xlautoregister12.md) function whenever a call has been made to the XLM function **REGISTER**, or the C API equivalent [xlfRegister](xlfregister-form-1.md) function, with the return and argument types missing for the function being registered.</span></span> <span data-ttu-id="b6eb0-178">La función **xlAutoRegister** permite el XLL buscar sus listas internas de funciones exportadas y comandos para registrar la función con el argumento y devolver los tipos especificados.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-178">The **xlAutoRegister** function allows the XLL to search its internal lists of exported functions and commands to register the function with the argument and return the specified types.</span></span> 
  
<span data-ttu-id="b6eb0-179">Iniciar en Excel 2007, Excel llama a la función **xlAddInRegister12** preferencia a la función **xlAddInRegister** si lo exporta el XLL.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-179">Starting in Excel 2007, Excel calls the **xlAddInRegister12** function in preference to the **xlAddInRegister** function if it is exported by the XLL.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="b6eb0-180">Si **xlAddInRegister**/ **xlAddInRegister12** intenta registrar la función sin proporcionar el argumento y devolver tipos, una recursiva al llamar a bucle se produce que finalmente desbordamientos de la pila de llamadas y hace que Excel cerrar o detener responder.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-180">If **xlAddInRegister**/ **xlAddInRegister12** tries to register the function without supplying the argument and return types, a recursive calling loop occurs that eventually overflows the call stack and causes Excel to close or stop responding.</span></span> 
  
### <a name="xlautofreexlautofree12"></a><span data-ttu-id="b6eb0-181">xlAutoFree/xlAutoFree12</span><span class="sxs-lookup"><span data-stu-id="b6eb0-181">xlAutoFree/xlAutoFree12</span></span>

<span data-ttu-id="b6eb0-182">Excel llama a la función [xlAutoFree/xlAutoFree12](xlautofree-xlautofree12.md) justo después de que una función de hoja de cálculo XLL devuelve un **XLOPER**/ tipo de datos de**XLOPER12** con un conjunto de marca que indica a Excel hay memoria que el XLL debe liberar aún.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-182">Excel calls the [xlAutoFree/xlAutoFree12](xlautofree-xlautofree12.md) function just after an XLL worksheet function returns an **XLOPER**/ **XLOPER12** data type with a flag set that tells Excel there is memory that the XLL still needs to release.</span></span> <span data-ttu-id="b6eb0-183">Esto permite que el XLL devolver dinámicamente asignado matrices, cadenas y las referencias externas a la hoja de cálculo sin pérdidas de memoria.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-183">This enables the XLL to return dynamically allocated arrays, strings, and external references to the worksheet without memory leaks.</span></span> <span data-ttu-id="b6eb0-184">Iniciar en Excel 2007, se admite el tipo de datos **XLOPER12** .</span><span class="sxs-lookup"><span data-stu-id="b6eb0-184">Starting in Excel 2007, the **XLOPER12** data type is supported.</span></span> <span data-ttu-id="b6eb0-185">Para obtener m�s informaci�n, consulte [Administraci�n de memoria en Excel](memory-management-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="b6eb0-185">For more information, see [Memory Management in Excel](memory-management-in-excel.md).</span></span>
  
> [!NOTE]
> <span data-ttu-id="b6eb0-186">Iniciar en Excel 2007, cuando Excel está configurada para usar recálculo de hoja de cálculo multiproceso, la **xlAutoFree**/ **xlAutoFree12** función se llama en el mismo subproceso que simplemente se usó para llamar a la función que se devuelve.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-186">Starting in Excel 2007, when Excel is configured to use multithreaded worksheet recalculation, the **xlAutoFree**/ **xlAutoFree12** function is called on the same thread that was just used to call the function that returned it.</span></span> <span data-ttu-id="b6eb0-187">La llamada a **xlAutoFree**/ **xlAutoFree12** siempre se realiza antes de que todas las celdas de la hoja de cálculo subsiguientes se evalúan en ese subproceso.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-187">The call to **xlAutoFree**/ **xlAutoFree12** is always made before any subsequent worksheet cells are evaluated on that thread.</span></span> <span data-ttu-id="b6eb0-188">Esto simplifica el diseño de subprocesos en su XLL.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-188">This simplifies thread-safe design in your XLL.</span></span> <span data-ttu-id="b6eb0-189">Para obtener más información, vea [Nuevo cálculo multiproceso en Excel](multithreaded-recalculation-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="b6eb0-189">For more information, see [Multithreaded Recalculation in Excel](multithreaded-recalculation-in-excel.md).</span></span> 
  
### <a name="creating-64-bit-xlls"></a><span data-ttu-id="b6eb0-190">Creación de XLL de 64 bits</span><span class="sxs-lookup"><span data-stu-id="b6eb0-190">Creating 64-bit XLLs</span></span>

<span data-ttu-id="b6eb0-191">Excel y funciones definidas por el usuario pueden ejecutar en sistemas operativos de 64 bits para aprovechar las ventajas de rendimiento sobre los sistemas operativos de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-191">Excel and user-defined functions can run on 64-bit operating systems to take advantage of performance benefits over 32-bit operating systems.</span></span> <span data-ttu-id="b6eb0-192">Excel pasa valores en estructuras **XLOPER12** que incluyen información acerca de los tipos de los datos.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-192">Excel passes values in **XLOPER12** structures that include information about the types for the data.</span></span> <span data-ttu-id="b6eb0-193">Preste atención al convertir entre valores de la estructura de **XLOPER12** y tipos nativos como **int** o punteros para conservar los valores en el tipo de mayor tamaño.</span><span class="sxs-lookup"><span data-stu-id="b6eb0-193">Be careful when you convert between values in the **XLOPER12** structure and native types like **int** or pointers to preserve the values in the larger type.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="b6eb0-194">Vea también</span><span class="sxs-lookup"><span data-stu-id="b6eb0-194">See also</span></span>



[<span data-ttu-id="b6eb0-195">Llamar a funciones XLL desde el Asistente para funciones o los cuadros de diálogo Reemplazar</span><span class="sxs-lookup"><span data-stu-id="b6eb0-195">Call XLL Functions from the Function Wizard or Replace Dialog Boxes</span></span>](how-to-call-xll-functions-from-the-function-wizard-or-replace-dialog-boxes.md)
  
[<span data-ttu-id="b6eb0-196">Administrador de complementos y funciones de la interfaz de XLL</span><span class="sxs-lookup"><span data-stu-id="b6eb0-196">Add-in Manager and XLL Interface Functions</span></span>](add-in-manager-and-xll-interface-functions.md)
  
[<span data-ttu-id="b6eb0-197">Desarrollo de XLL de Excel de 2013</span><span class="sxs-lookup"><span data-stu-id="b6eb0-197">Developing Excel XLLs</span></span>](developing-excel-xlls.md)

