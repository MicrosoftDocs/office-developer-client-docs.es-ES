---
title: Crear XLL
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
keywords:
- dlls [excel 2007], llamar a la función excel,xlAutoFree [Excel 2007], función xlAutoFree12 [Excel 2007], xlcall32.lib [Excel 2007], función xlAutoRegister [Excel 2007], xlcall.cpp [Excel 2007], función xlAutoRemove [Excel 2007], función xlAddInManagerInfo [Excel 2007], función xlAutoAdd [Excel 2007], función xlAutoOpen [Excel 2007], función xlAutoClose [Excel 2007],DLLs [Excel 2007], convertir en XLL,XLL [Excel 2007], llamar a la función Excel,xlAutoRegister12 [Excel 2007],xlcall.h [Excel 2007], función xlAddInManagerInfo12 [Excel 2007]
ms.assetid: 7754998f-4e13-4a37-9724-43b6ee6c919b
description: 'Hace referencia a: Excel 2013 | Office 2013 | Visual Studio'
localization_priority: Priority
ms.openlocfilehash: 886b8e74f00f2e724785d43475ee0ffa3c922710
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 01/17/2019
ms.locfileid: "28706747"
---
# <a name="creating-xlls"></a><span data-ttu-id="53928-104">Crear XLL</span><span class="sxs-lookup"><span data-stu-id="53928-104">Creating XLLs</span></span>

<span data-ttu-id="53928-105">**Hace referencia a**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="53928-105">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="53928-106">Si tu DLL es autónoma o se basa en otras bibliotecas, debes saber cómo habilitar el acceso de Microsoft Excel a sus funciones y comandos.</span><span class="sxs-lookup"><span data-stu-id="53928-106">If your DLL is self-contained or relies only on other libraries, you must know how to enable Microsoft Excel to access its functions and commands.</span></span> <span data-ttu-id="53928-107">Para obtener más información, consulta [Acceder a DLL en Excel](how-to-access-dlls-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="53928-107">For more information, see [Memory Management in Excel](how-to-access-dlls-in-excel.md).</span></span> 
  
<span data-ttu-id="53928-108">Sin embargo, si tu DLL necesita tener acceso a las funciones de Excel (por ejemplo, para obtener el contenido de una celda, llamar a una función de hoja de cálculo o interrogar a Excel para obtener la información del área de trabajo), el código debe ser capaz de devolver la llamada a Excel.</span><span class="sxs-lookup"><span data-stu-id="53928-108">However, if your DLL needs to access Excel functionality (for example, to get the contents of a cell, to call a worksheet function, or to interrogate Excel to obtain workspace information), your code must be able to call back into Excel.</span></span>
  
<span data-ttu-id="53928-109">La API de C de Excel proporciona varias funciones que permiten a las DLL devolver la llamada a Excel.</span><span class="sxs-lookup"><span data-stu-id="53928-109">The Excel C API provides several functions that enable DLLs to call back into Excel.</span></span> <span data-ttu-id="53928-110">Para acceder a ellas, la DLL debe estar vinculada de forma estática en tiempo de compilación con la biblioteca de Excel de 32 bits, xlcall32.lib.</span><span class="sxs-lookup"><span data-stu-id="53928-110">To access these, the DLL must be linked statically at compile time with the Excel 32-bit library, xlcall32.lib.</span></span> <span data-ttu-id="53928-111">La biblioteca estática se puede descargar de Microsoft como parte del SDK de XLL de Microsoft Excel 2013, que incluye las versiones de 32 bits y 64 bits de esta biblioteca.</span><span class="sxs-lookup"><span data-stu-id="53928-111">The static library is downloadable from Microsoft as part of the Microsoft Excel 2013 XLL SDK, which includes both 32-bit and 64-bit versions of this library.</span></span>
  
## <a name="enabling-dlls-to-call-back-into-excel"></a><span data-ttu-id="53928-112">Habilitar la DLL para devolver la llamada a Excel</span><span class="sxs-lookup"><span data-stu-id="53928-112">Enabling DLLs to Call Back into Excel</span></span>

<span data-ttu-id="53928-113">Para que un archivo DLL pueda obtener acceso a las funciones de Excel y obtener o establecer información del área de trabajo, primero debe obtener las direcciones de las funciones de retrollamada de Excel **Excel4**, **Excel4v**, \*\* Excel12\*\* y **Excel12v**.</span><span class="sxs-lookup"><span data-stu-id="53928-113">For a DLL to be able to access the functionality in Excel and get or set workspace information, it must first obtain the addresses of the Excel callback functions **Excel4**, **Excel4v**, **Excel12**, and **Excel12v**.</span></span> <span data-ttu-id="53928-114">Las dos últimas se introdujeron en Excel 2007 y están disponibles en versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="53928-114">The last two were introduced in Excel 2007 and are available in subsequent versions.</span></span> <span data-ttu-id="53928-115">Para obtener acceso a todas ellas, el proyecto DLL debe incluir referencias a los siguientes archivos de SDK de XLL de Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="53928-115">To access all of these, the DLL project must include references to the following files from the Excel 2013 XLL SDK.</span></span> <span data-ttu-id="53928-116">Si deseas tener acceso solo a las dos primeras retrollamadas (en cualquier versión de Excel), tu proyecto solo debe incluir los dos primeros archivos.</span><span class="sxs-lookup"><span data-stu-id="53928-116">If you want to access only the first two callbacks (in any version of Excel), your project needs to include only the first two files.</span></span>
  
### <a name="xlcallh"></a><span data-ttu-id="53928-117">Xlcall.h</span><span class="sxs-lookup"><span data-stu-id="53928-117">Xlcall.h</span></span>

<span data-ttu-id="53928-118">El archivo Xlcall.h contiene los siguientes elementos:</span><span class="sxs-lookup"><span data-stu-id="53928-118">The Xlcall.h file contains the following items:</span></span>
  
- <span data-ttu-id="53928-119">Prototipos de función para todas las funciones de retrollamada.</span><span class="sxs-lookup"><span data-stu-id="53928-119">Function prototypes for all callback functions.</span></span>
    
- <span data-ttu-id="53928-120">Definiciones de las estructuras de datos que usan las retrollamadas para intercambiar datos entre DLL/XLL y Excel, y definiciones de constantes de tipo de datos.</span><span class="sxs-lookup"><span data-stu-id="53928-120">Definitions of the data structures that the callbacks use to exchange data between the DLL/XLL and Excel, and data-type constant definitions.</span></span>
    
- <span data-ttu-id="53928-121">Definiciones de los equivalentes de función y comando de C de API de la hoja de cálculo, funciones de hoja de macros y comandos de Excel admitidos.</span><span class="sxs-lookup"><span data-stu-id="53928-121">Definitions of the C API function and command equivalents of the worksheet, macro sheet functions, and supported Excel commands.</span></span>
    
- <span data-ttu-id="53928-122">Definiciones de los valores devueltos de la función de retrollamada.</span><span class="sxs-lookup"><span data-stu-id="53928-122">Definitions of callback function return values.</span></span>
    
<span data-ttu-id="53928-123">Debes usar la directiva **#incluir** para este archivo, directa o indirectamente a través de otro archivo de encabezado, en todos los archivos que tienen acceso a la API de C o que controlan los tipos de datos que usa la API de C.</span><span class="sxs-lookup"><span data-stu-id="53928-123">You should use the **#include** directive for this file, directly or indirectly via another header file, in all files that access the C API or that handle data types that the C API uses.</span></span> 
  
### <a name="xlcall32lib"></a><span data-ttu-id="53928-124">Xlcall32.lib</span><span class="sxs-lookup"><span data-stu-id="53928-124">Xlcall32.lib</span></span>

<span data-ttu-id="53928-125">La biblioteca Xlcall32.lib exporta las dos primeras retrollamadas, **Excel4** y **Excel4v**así como la función **XlCallVer**.</span><span class="sxs-lookup"><span data-stu-id="53928-125">The Xlcall32.lib library exports the first two callbacks, **Excel4** and **Excel4v**, and also the **XlCallVer** function.</span></span> <span data-ttu-id="53928-126">Sin una referencia a esta biblioteca en tu proyecto, el vinculador no puede crear el XLL si usaste alguna de estas retrollamadas en tu código.</span><span class="sxs-lookup"><span data-stu-id="53928-126">Without a reference to this library in your project, the linker cannot create the XLL if you have used any of these callbacks in your code.</span></span> <span data-ttu-id="53928-127">(Puedes obtener las direcciones de estas funciones mediante un vínculo dinámico al archivo Xlcall32.dll equivalente que se copia en tu sistema como parte de una instalación de Excel normal).</span><span class="sxs-lookup"><span data-stu-id="53928-127">(You can obtain the addresses of these functions by linking dynamically to the equivalent Xlcall32.dll that is copied to your system as part of a normal Excel installation.)</span></span> 
  
### <a name="xlcallcpp"></a><span data-ttu-id="53928-128">Xlcall.cpp</span><span class="sxs-lookup"><span data-stu-id="53928-128">Xlcall.cpp</span></span>

<span data-ttu-id="53928-129">Las retrollamadas **Excel12** y **Excel12v** de Excel no se exportan en Xlcall32.lib.</span><span class="sxs-lookup"><span data-stu-id="53928-129">The Excel callbacks **Excel12** and **Excel12v** are not exported in Xlcall32.lib.</span></span> <span data-ttu-id="53928-130">Así se garantiza que los proyectos XLL que creas a partir de Excel 2007 también funcionen con versiones anteriores de Excel.</span><span class="sxs-lookup"><span data-stu-id="53928-130">This ensures that XLL projects that you create starting in Excel 2007 will also work with earlier versions of Excel.</span></span> <span data-ttu-id="53928-131">El módulo Xlcall.cpp contiene el código para las funciones de **Excel12** y **Excel12v**, que llaman a un punto de entrada de Excel a partir de Excel 2007, o devuelven un valor de error seguro si estás ejecutando una versión anterior de Excel.</span><span class="sxs-lookup"><span data-stu-id="53928-131">The Xlcall.cpp module contains code for the **Excel12** and **Excel12v** functions, which call into an Excel entry point starting in Excel 2007, or return a safe error value if you are running an earlier version of Excel.</span></span> <span data-ttu-id="53928-132">Si deseas crear un XLL que se ejecuta a partir de Excel 2007 y que es capaz de usar los nuevos tipos de datos que administran las cuadrículas más grandes y cadenas Unicode más largas, debes incluir este módulo en tu proyecto.</span><span class="sxs-lookup"><span data-stu-id="53928-132">You should include this module in your project if you want to create an XLL that runs starting in Excel 2007 and that is able to use the new data types that handle larger grids and longer Unicode strings.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="53928-133">Empezando con el SDK de Excel 2010, este archivo se puede compilar para XLL de 32 y 64 bits.</span><span class="sxs-lookup"><span data-stu-id="53928-133">Starting with the Excel 2010 SDK, this file can be compiled for both 32-bit and 64-bit XLLs.</span></span> 
  
## <a name="turning-dlls-into-xlls-add-in-manager-interface-functions"></a><span data-ttu-id="53928-134">Cómo convertir DLL en XLL: funciones de la interfaz del administrador de complementos</span><span class="sxs-lookup"><span data-stu-id="53928-134">Turning DLLs into XLLs: Add-in Manager Interface Functions</span></span>

<span data-ttu-id="53928-135">Un XLL es un archivo DLL que exporta varios procedimientos llamados por Excel o el administrador de complementos de Excel.</span><span class="sxs-lookup"><span data-stu-id="53928-135">An XLL is a DLL that exports several procedures that are called by Excel or the Excel Add-in Manager.</span></span> <span data-ttu-id="53928-136">Estos procedimientos se describen brevemente aquí y se explican en detalle en las [funciones de la interfaz del administrador de complementos y XLL](add-in-manager-and-xll-interface-functions.md).</span><span class="sxs-lookup"><span data-stu-id="53928-136">These procedures are described briefly here and discussed in detail in [Add-in Manager and XLL Interface Functions](add-in-manager-and-xll-interface-functions.md).</span></span> <span data-ttu-id="53928-137">Todas estas retrollamadas de DLL comienzan con el prefijo **xlAuto**.</span><span class="sxs-lookup"><span data-stu-id="53928-137">All of these DLL callbacks start with the prefix **xlAuto**.</span></span> <span data-ttu-id="53928-138">Solo una de ellas, el comando **xlAutoOpen**, es necesaria.</span><span class="sxs-lookup"><span data-stu-id="53928-138">Only one of these, the command **xlAutoOpen**, is required.</span></span> <span data-ttu-id="53928-139">Se la llama cuando el complemento está activado y se usa normalmente para registrar funciones y comandos XLL con Excel y para realizar otras tareas de inicialización.</span><span class="sxs-lookup"><span data-stu-id="53928-139">It is called when the add-in is activated, and it is typically used to register XLL functions and commands with Excel and to do other initialization tasks.</span></span> <span data-ttu-id="53928-140">Las firmas de función e implementación de ejemplos de todas las funciones **xlAuto** se proporcionan en las secciones posteriores.</span><span class="sxs-lookup"><span data-stu-id="53928-140">The function signatures and example implementations of all of the **xlAuto** functions are provided in later sections.</span></span> 
  
<span data-ttu-id="53928-141">Aunque **xlAutoOpen** es la única retrollamada requerida, tu complemento puede necesitar exportar otras según su comportamiento.</span><span class="sxs-lookup"><span data-stu-id="53928-141">Even though **xlAutoOpen** is the only required one of these callbacks, your add-in may also need to export others depending on its behavior.</span></span> 
  
<span data-ttu-id="53928-142">Excel 2007 introdujo un nuevo tipo de datos, **XLOPER12**, para dar cabida a las cuadrículas más grandes y admitir cadenas largas de Unicode.</span><span class="sxs-lookup"><span data-stu-id="53928-142">Excel 2007 introduced a new data type, **XLOPER12**, to accommodate larger grids and to support long Unicode strings.</span></span> <span data-ttu-id="53928-143">**XLOPER12** se describe más adelante en este tema.</span><span class="sxs-lookup"><span data-stu-id="53928-143">**XLOPER12** is described later in this topic.</span></span> <span data-ttu-id="53928-144">Si bien las funciones **xlAuto** toman o devuelven el tipo de datos antiguos **XLOPER**, se introdujeron nuevas versiones de estas funciones en Excel 2007 que usan tipos de datos **XLOPER12**.</span><span class="sxs-lookup"><span data-stu-id="53928-144">Whereas **xlAuto** functions take or return the old data type **XLOPER**, new versions of these functions were introduced in Excel 2007 that use **XLOPER12** data types.</span></span> <span data-ttu-id="53928-145">Con la excepción de **xlAutoFree12**, que a veces tendrás que implementar para evitar pérdidas de memoria de **XLOPER12**, puedes omitir sin problemas todas las funciones de la versión 12 **xlAuto**, en cuyo caso, a partir de Excel 2007, Excel llama a las versiones de **XLOPER**.</span><span class="sxs-lookup"><span data-stu-id="53928-145">With the exception of **xlAutoFree12**, which you must sometimes implement to avoid **XLOPER12** memory leaks, you can safely omit all the version 12 **xlAuto** functions, in which case, starting in Excel 2007, Excel calls the **XLOPER** versions.</span></span> 
  
### <a name="xlautoopen"></a><span data-ttu-id="53928-146">xlAutoOpen</span><span class="sxs-lookup"><span data-stu-id="53928-146">xlAutoOpen</span></span>

<span data-ttu-id="53928-147">Excel llama a la función [xlAutoOpen](xlautoopen.md) cuando se activa el archivo XLL.</span><span class="sxs-lookup"><span data-stu-id="53928-147">Excel calls the [xlAutoOpen](xlautoopen.md) function whenever the XLL is activated.</span></span> <span data-ttu-id="53928-148">El complemento se activará al comienzo de una sesión de Excel si estaba activo en la última sesión de Excel que finalizó normalmente.</span><span class="sxs-lookup"><span data-stu-id="53928-148">The add-in will be activated at the start of an Excel session if it was active in the last Excel session that ended normally.</span></span> <span data-ttu-id="53928-149">El complemento está activado si se carga durante una sesión de Excel.</span><span class="sxs-lookup"><span data-stu-id="53928-149">The add-in is activated if it is loaded during an Excel session.</span></span> <span data-ttu-id="53928-150">El complemento puede desactivarse y reactivarse durante una sesión de Excel y se llama a la función durante la reactivación.</span><span class="sxs-lookup"><span data-stu-id="53928-150">The add-in can be deactivated and reactivated during an Excel session, and the function is called on reactivation.</span></span> 
  
<span data-ttu-id="53928-151">Debes usar **xlAutoOpen** para registrar los comandos y funciones de XLL, inicializar estructuras de datos, personalizar la interfaz de usuario, etc.</span><span class="sxs-lookup"><span data-stu-id="53928-151">You should use **xlAutoOpen** to register XLL functions and commands, initialize data structures, customize the user interface, and so on.</span></span> 
  
<span data-ttu-id="53928-152">Si el complemento implementa y exporta la función [xlAutoRegister](xlautoregister-xlautoregister12.md) o la función [xlAutoRegister12](xlautoregister-xlautoregister12.md), Excel puede intentar activar y registrar un comando o función sin llamar primero a la función **xlAutoOpen**.</span><span class="sxs-lookup"><span data-stu-id="53928-152">If your add-in implements and exports the [xlAutoRegister](xlautoregister-xlautoregister12.md) function or the [xlAutoRegister12](xlautoregister-xlautoregister12.md) function, Excel might attempt to activate and register a function or command without first calling the **xlAutoOpen** function.</span></span> <span data-ttu-id="53928-153">En este caso, debes asegurarte de que la inicialización de tu complemento es suficiente para que tu función o comando funcionen correctamente.</span><span class="sxs-lookup"><span data-stu-id="53928-153">In this case, you should ensure that your add-in is sufficiently initialized for your function or command to work properly.</span></span> <span data-ttu-id="53928-154">Si no es así, debes fracasar en el intento de registrar la función o el comando o llevar a cabo la inicialización necesaria.</span><span class="sxs-lookup"><span data-stu-id="53928-154">If it is not, you should either fail the attempt to register the function or command, or carry out the necessary initialization.</span></span> 
  
### <a name="xlautoclose"></a><span data-ttu-id="53928-155">xlAutoClose</span><span class="sxs-lookup"><span data-stu-id="53928-155">xlAutoClose</span></span>

<span data-ttu-id="53928-156">Excel llama a la función [xlAutoClose](xlautoclose.md) cada vez que se desactiva XLL.</span><span class="sxs-lookup"><span data-stu-id="53928-156">Excel calls the [xlAutoClose](xlautoclose.md) function whenever the XLL is deactivated, that is, unloaded from memory.</span></span> <span data-ttu-id="53928-157">El complemento se desactivará cuando finalice una sesión de Excel normal.</span><span class="sxs-lookup"><span data-stu-id="53928-157">The add-in is deactivated when an Excel session ends normally.</span></span> <span data-ttu-id="53928-158">Si el usuario desactiva el complemento durante una sesión de Excel, se llama a la función.</span><span class="sxs-lookup"><span data-stu-id="53928-158">If the user deactivates the add-in during an Excel session, the function is called.</span></span> 
  
<span data-ttu-id="53928-159">Debes usar **xlAutoClose** para eliminar el registro de comandos y funciones, liberar recursos, deshacer las personalizaciones, etc.</span><span class="sxs-lookup"><span data-stu-id="53928-159">You should use **xlAutoClose** to unregister functions and commands, release resources, undo customizations, and so on.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="53928-160">Hay un problema conocido con la anulación del registro de comandos y funciones.</span><span class="sxs-lookup"><span data-stu-id="53928-160">There is a known issue with the unregistration of functions and commands.</span></span> <span data-ttu-id="53928-161">Para obtener más información, consulta [Problemas conocidos en el desarrollo de XLL de Excel](known-issues-in-excel-xll-development.md).</span><span class="sxs-lookup"><span data-stu-id="53928-161">For more information, see [Known Issues in Excel XLL Development](known-issues-in-excel-xll-development.md).</span></span> 
  
### <a name="xlautoadd"></a><span data-ttu-id="53928-162">xlAutoAdd</span><span class="sxs-lookup"><span data-stu-id="53928-162">xlAutoAdd</span></span>

<span data-ttu-id="53928-163">Excel llama a la [función xlAutoAdd](xlautoadd.md) cada vez que el usuario activa el XLL durante una sesión de Excel, mediante el administrador de complementos.</span><span class="sxs-lookup"><span data-stu-id="53928-163">Excel calls the [xlAutoAdd function](xlautoadd.md) whenever the user activates the XLL during an Excel session by using the Add-In Manager.</span></span> <span data-ttu-id="53928-164">No se llama a esta función cuando Excel inicia y carga un complemento preinstalado.</span><span class="sxs-lookup"><span data-stu-id="53928-164">This function is not called when Excel starts and loads a preinstalled add-in.</span></span> 
  
<span data-ttu-id="53928-165">Puedes usar esta función para mostrar el cuadro de diálogo personalizado que indica al usuario que se activó el complemento, para leer o escribir en el registro o para revisar la información de licencias.</span><span class="sxs-lookup"><span data-stu-id="53928-165">You can use this function to display a custom dialog box that tells the user that the add-in has been activated, to read from or write to the registry, or to check licensing information.</span></span>
  
### <a name="xlautoremove"></a><span data-ttu-id="53928-166">xlAutoRemove</span><span class="sxs-lookup"><span data-stu-id="53928-166">xlAutoRemove</span></span>

<span data-ttu-id="53928-167">Excel llama a la función [xlAutoRemove](xlautoremove.md) cada vez que el usuario desactiva el XLL durante una sesión de Excel, usando el administrador de complementos.</span><span class="sxs-lookup"><span data-stu-id="53928-167">Excel calls the [xlAutoRemove](xlautoremove.md) function whenever the user deactivates the XLL during an Excel session by using the Add-In Manager.</span></span> <span data-ttu-id="53928-168">No se llama a esta función cuando una sesión de Excel se cierra, de forma normal o excepcional, con el complemento instalado.</span><span class="sxs-lookup"><span data-stu-id="53928-168">This function is not called when an Excel session closes, normally or abnormally, with the add-in installed.</span></span> 
  
<span data-ttu-id="53928-169">Puedes usar esta función para mostrar el cuadro de diálogo personalizado que indica al usuario que se activó el complemento, o para leer o escribir en el registro.</span><span class="sxs-lookup"><span data-stu-id="53928-169">You can use this function to display a custom dialog box that tells the user that the add-in has been deactivated, or to read from or write to the registry.</span></span>
  
### <a name="xladdinmanagerinfoxladdinmanagerinfo12"></a><span data-ttu-id="53928-170">xlAddInManagerInfo/xlAddInManagerInfo12</span><span class="sxs-lookup"><span data-stu-id="53928-170">xlAddInManagerInfo/xlAddInManagerInfo12</span></span>

<span data-ttu-id="53928-171">Excel llama a la función [xlAddInManagerInfo](xladdinmanagerinfo-xladdinmanagerinfo12.md) cuando se invoca al administrador de complementos por primera vez en una sesión de Excel.</span><span class="sxs-lookup"><span data-stu-id="53928-171">Excel calls the [xlAddInManagerInfo](xladdinmanagerinfo-xladdinmanagerinfo12.md) function when the Add-in Manager is invoked for the first time in an Excel session.</span></span> <span data-ttu-id="53928-172">Si Excel pasa un argumento igual a 1, esta función debe devolver una cadena (normalmente, el nombre del complemento); en caso contrario, debe devolver **#VALUE!**.</span><span class="sxs-lookup"><span data-stu-id="53928-172">If Excel passes an argument equal to 1, this function should return a string (typically, the name of the add-in); otherwise, it should return **#VALUE!**.</span></span>
  
<span data-ttu-id="53928-173">A partir de Excel 2007, Excel prefiere llamar a la función **xlAddInManagerInfo12** antes que a la función **xlAddInManagerInfo** si lo exporta el XLL.</span><span class="sxs-lookup"><span data-stu-id="53928-173">Starting in Excel 2007, Excel calls the **xlAddInManagerInfo12** function in preference to the **xlAddInManagerInfo** function if it is exported by the XLL.</span></span> <span data-ttu-id="53928-174">La función **xlAddInManagerInfo12** debe funcionar de la misma forma que la función **xlAddInManagerInfo** para evitar diferencias específicas de la versión en el comportamiento del XLL.</span><span class="sxs-lookup"><span data-stu-id="53928-174">The **xlAddInManagerInfo12** function should work in the same way as the **xlAddInManagerInfo** function to avoid version-specific differences in the behavior of the XLL.</span></span> <span data-ttu-id="53928-175">La función **xlAddInManagerInfo12** debe devolver un tipo de datos **XLOPER12**, mientras que la función **xlAddInManagerInfo** debe devolver un tipo de datos **XLOPER**.</span><span class="sxs-lookup"><span data-stu-id="53928-175">The **xlAddInManagerInfo12** function should return an **XLOPER12** data type, whereas the **xlAddInManagerInfo** function should return an **XLOPER** data type.</span></span> 
  
### <a name="xlautoregisterxlautoregister12"></a><span data-ttu-id="53928-176">xlAutoRegister/xlAutoRegister12</span><span class="sxs-lookup"><span data-stu-id="53928-176">xlAutoRegister/xlAutoRegister12</span></span>

<span data-ttu-id="53928-177">Excel llama a la función [xlAutoRegister](xlautoregister-xlautoregister12.md) cada vez que se realiza una llamada a la función **REGISTRAR** de XML, o a la función de API de C equivalente [xlfRegister](xlfregister-form-1.md), con tipos de devolución y argumentos faltantes para la función que se registra.</span><span class="sxs-lookup"><span data-stu-id="53928-177">Excel calls the [xlAutoRegister](xlautoregister-xlautoregister12.md) function whenever a call has been made to the XLM function **REGISTER**, or the C API equivalent [xlfRegister](xlfregister-form-1.md) function, with the return and argument types missing for the function being registered.</span></span> <span data-ttu-id="53928-178">La función **xlAutoRegister** permite que el XLL busque en sus listas internas de funciones exportadas y comandos para registrar la función con el argumento y devolver los tipos especificados.</span><span class="sxs-lookup"><span data-stu-id="53928-178">The **xlAutoRegister** function allows the XLL to search its internal lists of exported functions and commands to register the function with the argument and return the specified types.</span></span> 
  
<span data-ttu-id="53928-179">A partir de Excel 2007, Excel prefiere llamar a la función **xlAddInRegister12** antes que a la función **xlAddInRegister** si lo exporta el XLL.</span><span class="sxs-lookup"><span data-stu-id="53928-179">Starting in Excel 2007, Excel calls the **xlAddInRegister12** function in preference to the **xlAddInRegister** function if it is exported by the XLL.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="53928-180">Si **xlAddInRegister**/ **xlAddInRegister12** intenta registrar la función sin proporcionar los tipos de argumento y devoluciones, se produce un bucle de llamada recursiva que eventualmente desborda la pila de llamadas y hace que Excel se cierre o deje de responder.</span><span class="sxs-lookup"><span data-stu-id="53928-180">If **xlAddInRegister**/ **xlAddInRegister12** tries to register the function without supplying the argument and return types, a recursive calling loop occurs that eventually overflows the call stack and causes Excel to close or stop responding.</span></span> 
  
### <a name="xlautofreexlautofree12"></a><span data-ttu-id="53928-181">xlAutoFree/xlAutoFree12</span><span class="sxs-lookup"><span data-stu-id="53928-181">xlAutoFree/xlAutoFree12</span></span>

<span data-ttu-id="53928-182">Excel llama a la función [xlAutoFree/xlAutoFree12](xlautofree-xlautofree12.md) justo después de que una función de hoja de cálculo de XLL devuelve un tipo de datos **XLOPER**/ **XLOPER12** con una advertencia que le indica a Excel que todavía queda memoria que debe liberarse.</span><span class="sxs-lookup"><span data-stu-id="53928-182">Excel calls the [xlAutoFree/xlAutoFree12](xlautofree-xlautofree12.md) function just after an XLL worksheet function returns an **XLOPER**/ **XLOPER12** data type with a flag set that tells Excel there is memory that the XLL still needs to release.</span></span> <span data-ttu-id="53928-183">Esto permite al XLL devolver matrices, cadenas y referencias externas asignadas dinámicamente a la hoja de cálculo sin pérdidas de memoria.</span><span class="sxs-lookup"><span data-stu-id="53928-183">This enables the XLL to return dynamically allocated arrays, strings, and external references to the worksheet without memory leaks.</span></span> <span data-ttu-id="53928-184">A partir de Excel 2007, se admite el tipo de datos **XLOPER12**.</span><span class="sxs-lookup"><span data-stu-id="53928-184">Starting in Excel 2007, the **XLOPER12** data type is supported.</span></span> <span data-ttu-id="53928-185">Para obtener más información, consulta [Administración de memoria en Excel](memory-management-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="53928-185">For more information, see [Memory Management in Excel](memory-management-in-excel.md).</span></span>
  
> [!NOTE]
> <span data-ttu-id="53928-186">A partir de Excel 2007, cuando Excel está configurado para usar los nuevos cálculos multiproceso de la hoja de cálculo, se llama a la función **xlAutoFree**/ **xlAutoFree12** en el mismo subproceso que se acaba de usar para llamar a la función que lo devolvió.</span><span class="sxs-lookup"><span data-stu-id="53928-186">Starting in Excel 2007, when Excel is configured to use multithreaded worksheet recalculation, the **xlAutoFree**/ **xlAutoFree12** function is called on the same thread that was just used to call the function that returned it.</span></span> <span data-ttu-id="53928-187">La llamada a **xlAutoFree**/ **xlAutoFree12** siempre se realiza antes de que las celdas de la hoja de cálculo siguientes se evalúen en dicho subproceso.</span><span class="sxs-lookup"><span data-stu-id="53928-187">The call to **xlAutoFree**/ **xlAutoFree12** is always made before any subsequent worksheet cells are evaluated on that thread.</span></span> <span data-ttu-id="53928-188">Esto simplifica el diseño de subprocesos seguros en tu XLL.</span><span class="sxs-lookup"><span data-stu-id="53928-188">This simplifies thread-safe design in your XLL.</span></span> <span data-ttu-id="53928-189">Para obtener más información, consulta [nuevos cálculos multiproceso en Excel](multithreaded-recalculation-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="53928-189">For more information, see [Multithreaded Recalculation in Excel](multithreaded-recalculation-in-excel.md).</span></span> 
  
### <a name="creating-64-bit-xlls"></a><span data-ttu-id="53928-190">Crear XLL de 64 bits</span><span class="sxs-lookup"><span data-stu-id="53928-190">Creating 64-bit XLLs</span></span>

<span data-ttu-id="53928-191">Excel y las funciones definidas por el usuario pueden ejecutarse en sistemas operativos de 64 bits para aprovechar las ventajas de desempeño sobre los sistemas operativos de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="53928-191">Excel and user-defined functions can run on 64-bit operating systems to take advantage of performance benefits over 32-bit operating systems.</span></span> <span data-ttu-id="53928-192">Excel pasa valores en estructuras **XLOPER12** que incluyen información sobre los tipos de datos.</span><span class="sxs-lookup"><span data-stu-id="53928-192">Excel passes values in **XLOPER12** structures that include information about the types for the data.</span></span> <span data-ttu-id="53928-193">Ten cuidado al convertir valores en la estructura **XLOPER12** y los tipos nativos como **int** o punteros para preservar los valores en el tipo más grande.</span><span class="sxs-lookup"><span data-stu-id="53928-193">Be careful when you convert between values in the **XLOPER12** structure and native types like **int** or pointers to preserve the values in the larger type.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="53928-194">Ver también</span><span class="sxs-lookup"><span data-stu-id="53928-194">See also</span></span>



[<span data-ttu-id="53928-195">Llamar a funciones XLL desde el Asistente para funciones o los cuadros de diálogo Reemplazar</span><span class="sxs-lookup"><span data-stu-id="53928-195">Call XLL functions from the Function Wizard or Replace dialog boxes</span></span>](how-to-call-xll-functions-from-the-function-wizard-or-replace-dialog-boxes.md)
  
[<span data-ttu-id="53928-196">Administrador de complementos y funciones de la interfaz de XLL</span><span class="sxs-lookup"><span data-stu-id="53928-196">Add-in Manager and XLL Interface Functions</span></span>](add-in-manager-and-xll-interface-functions.md)
  
[<span data-ttu-id="53928-197">Desarrollo de XLL de Excel</span><span class="sxs-lookup"><span data-stu-id="53928-197">Developing Excel XLLs</span></span>](developing-excel-xlls.md)

