---
title: Problemas conocidos en el desarrollo de XLL de Excel
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- problemas conocidos [excel 2007]
localization_priority: Normal
ms.assetid: 3dfecc0b-a91c-448e-8721-5d3486b625fa
description: 'Hace referencia a: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 34784f6895386efe7e6c3ca7ec213c7d71931058
ms.sourcegitcommit: f139451a43598b59da22775333779df691df460a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/27/2018
ms.locfileid: "26685182"
---
# <a name="known-issues-in-excel-xll-development"></a><span data-ttu-id="9809c-104">Problemas conocidos en el desarrollo de XLL de Excel</span><span class="sxs-lookup"><span data-stu-id="9809c-104">Known Issues in Excel XLL Development</span></span>

 <span data-ttu-id="9809c-105">**Hace referencia a**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="9809c-105">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="9809c-106">En este tema se describe los problemas conocidos de Microsoft Excel que pueden surgir en el desarrollo de XLL.</span><span class="sxs-lookup"><span data-stu-id="9809c-106">This topic describes known issues in Microsoft Excel that you might encounter in XLL development.</span></span>
  
## <a name="unregistering-xll-commands-and-functions"></a><span data-ttu-id="9809c-107">Anulando el registro de los comandos XLL y funciones</span><span class="sxs-lookup"><span data-stu-id="9809c-107">Unregistering XLL Commands and Functions</span></span>

<span data-ttu-id="9809c-108">Cuando registra un XLL una función o un comando, Excel crea un nuevo nombre para el recurso y asocia una referencia a la función DLL con ese nombre.</span><span class="sxs-lookup"><span data-stu-id="9809c-108">When an XLL registers a function or command, Excel creates a new name for the resource and associates a reference to the DLL function with that name.</span></span> <span data-ttu-id="9809c-109">Se toma el nombre del cuarto argumento, *pxFunctionText* , de la función [xlfRegister](xlfregister-form-1.md) .</span><span class="sxs-lookup"><span data-stu-id="9809c-109">The name is taken from the fourth argument,  *pxFunctionText*  , of the [xlfRegister](xlfregister-form-1.md) function.</span></span> <span data-ttu-id="9809c-110">Este nombre se oculta de los cuadros de diálogo normal para administrar los nombres de hoja de cálculo.</span><span class="sxs-lookup"><span data-stu-id="9809c-110">This name is hidden from the normal dialog boxes for managing worksheet names.</span></span> <span data-ttu-id="9809c-111">Para anular el registro de una función o un comando, debe eliminar el nombre mediante el uso de la función [xlfSetName](xlfsetname.md) , pasando el nombre pero no pasando una definición.</span><span class="sxs-lookup"><span data-stu-id="9809c-111">To unregister a function or command, you must delete the name by using the [xlfSetName](xlfsetname.md) function, passing the name but not passing a definition.</span></span> <span data-ttu-id="9809c-112">Sin embargo, un error Esto impide quitar el nombre de las listas del Asistente para la función.</span><span class="sxs-lookup"><span data-stu-id="9809c-112">However, a bug prevents this from removing the name from the Function Wizard lists.</span></span> 
  
## <a name="argument-description-string-truncation-in-the-function-wizard"></a><span data-ttu-id="9809c-113">Truncamiento de cadena de argumento descripción en el Asistente para funciones</span><span class="sxs-lookup"><span data-stu-id="9809c-113">Argument Description String Truncation in the Function Wizard</span></span>

<span data-ttu-id="9809c-114">El parámetro *pxArgumentHelp1* y todos los parámetros posteriores de la función **xlfRegister** son cadenas opcionales que se corresponden con los argumentos de la función XLL.</span><span class="sxs-lookup"><span data-stu-id="9809c-114">The  *pxArgumentHelp1*  parameter and all subsequent parameters of the **xlfRegister** function are optional strings that correspond to the arguments of the XLL function.</span></span> <span data-ttu-id="9809c-115">El Asistente para la función muestra estos para proporcionar ayuda en el cuadro de diálogo de construcción de argumento.</span><span class="sxs-lookup"><span data-stu-id="9809c-115">The Function Wizard displays these to provide help in the argument construction dialog box.</span></span> <span data-ttu-id="9809c-116">A veces Excel trunca la cadena que corresponde al argumento final por uno o dos caracteres cuando se muestra en el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="9809c-116">Sometimes Excel truncates the string that corresponds to the final argument by one or two characters when displaying it in the dialog box.</span></span> <span data-ttu-id="9809c-117">Se puede evitar mediante la adición de una adicional "cadena vacía" como el último parámetro "Ayuda argumento" del registro (función).</span><span class="sxs-lookup"><span data-stu-id="9809c-117">You can avoid this by adding an additional "empty string" as the last "argument help" parameter of your function registration.</span></span>
  
## <a name="binary-name-scope-limitation"></a><span data-ttu-id="9809c-118">Limitación del ámbito de nombre del archivo binario</span><span class="sxs-lookup"><span data-stu-id="9809c-118">Binary Name Scope Limitation</span></span>

<span data-ttu-id="9809c-119">Nombres binario y los datos se pueden recuperar sólo cuando la hoja de cálculo que estaba activa en el momento en que se crearon nuevo está activo.</span><span class="sxs-lookup"><span data-stu-id="9809c-119">Binary names and their data can be retrieved only when the worksheet that was active at the time they were created is again active.</span></span> <span data-ttu-id="9809c-120">Debido a que las funciones de hoja de cálculo no pueden activar las hojas de cálculo dentro de un libro (solo comandos pueden hacerlo), aplicaciones de nombres binarios son muy limitadas.</span><span class="sxs-lookup"><span data-stu-id="9809c-120">Because worksheet functions cannot activate worksheets within a workbook (only commands can do this), applications of binary names are very limited.</span></span> <span data-ttu-id="9809c-121">Si dispone de un comando que sólo se invoca desde una hoja de cálculo determinada, por ejemplo, podría usar un nombre del archivo binario para almacenar los datos relacionados con el comando.</span><span class="sxs-lookup"><span data-stu-id="9809c-121">If you have a command that is only invoked from a particular worksheet, for example, you could use a binary name to store command-related data.</span></span>
  
## <a name="xlset-and-workbooks-with-array-formulas"></a><span data-ttu-id="9809c-122">xlSet y libros con fórmulas de matriz</span><span class="sxs-lookup"><span data-stu-id="9809c-122">xlSet and Workbooks with Array Formulas</span></span>

<span data-ttu-id="9809c-123">En Excel 2003 y versiones anteriores, la [función xlSet](xlset.md) genera un error si se intenta asignar valores en un rango de una hoja de cálculo que no es la hoja de cálculo activa, donde el intervalo equivalente en la hoja activa contiene una fórmula de matriz.</span><span class="sxs-lookup"><span data-stu-id="9809c-123">In Excel 2003 and earlier versions, the [xlSet function](xlset.md) fails if you try to assign values to a range on a worksheet that is not the active worksheet, where the equivalent range on the active sheet contains an array formula.</span></span> <span data-ttu-id="9809c-124">En este caso, Excel muestra el mensaje "No se puede cambiar parte de una matriz."</span><span class="sxs-lookup"><span data-stu-id="9809c-124">In this case, Excel displays the message "You cannot change part of an array."</span></span> <span data-ttu-id="9809c-125">Esto se ha solucionado en Excel 2007.</span><span class="sxs-lookup"><span data-stu-id="9809c-125">This was fixed in Excel 2007.</span></span> 
  
## <a name="circular-references-are-tolerated-in-data-tables"></a><span data-ttu-id="9809c-126">Las referencias circulares se tolerarán en tablas de datos</span><span class="sxs-lookup"><span data-stu-id="9809c-126">Circular References are Tolerated in Data Tables</span></span>

<span data-ttu-id="9809c-127">Actualmente Excel no provoca un error si el cálculo basado en una tabla de datos hace referencia a algo en la propia tabla.</span><span class="sxs-lookup"><span data-stu-id="9809c-127">Excel currently does not raise an error if the calculation that a data table is based on refers to something in the table itself.</span></span> <span data-ttu-id="9809c-128">Como poco probable como es posible que en este escenario, debe tener cuidado cuando se está creando o modificando las fórmulas que se utilizan para calcular los valores de tabla de datos.</span><span class="sxs-lookup"><span data-stu-id="9809c-128">As unlikely as this scenario might be, you should be careful when you are creating or modifying formulas that are used to calculate data table values.</span></span>
  
## <a name="converting-an-integer-xloper12-to-an-xloper"></a><span data-ttu-id="9809c-129">Conversión de un número entero XLOPER12 a un XLOPER</span><span class="sxs-lookup"><span data-stu-id="9809c-129">Converting an Integer XLOPER12 to an XLOPER</span></span>

<span data-ttu-id="9809c-130">Debido a que el tipo de entero **xltypeInt** es un entero con signo de 32 bits en el tipo de datos **XLOPER12** , pero es sólo un entero con signo de 16 bits en el tipo de datos **XLOPER** , es posible que algunos valores de **XLOPER12** entero no pueden estar incluidos en un número entero **XLOPER**.</span><span class="sxs-lookup"><span data-stu-id="9809c-130">Because the integer type **xltypeInt** is a 32-bit signed integer in the **XLOPER12** data type, but it is only a 16-bit signed integer in the **XLOPER** data type, it is possible that some integer **XLOPER12** values cannot be contained in an integer **XLOPER**.</span></span> <span data-ttu-id="9809c-131">Donde Excel convierte este tipo internamente, obtiene este problema mediante la conversión del tipo a un punto flotante **xltypeNum** **XLOPER**.</span><span class="sxs-lookup"><span data-stu-id="9809c-131">Where Excel converts this type internally, it gets around this problem by converting the type to a floating-point **xltypeNum** **XLOPER**.</span></span>
  
<span data-ttu-id="9809c-132">La función de Framework [XLOper12ToXLOper](xloper12toxloper.md) refleja este comportamiento para que sea coherente con Excel internamente.</span><span class="sxs-lookup"><span data-stu-id="9809c-132">The Framework [XLOper12ToXLOper](xloper12toxloper.md) function mirrors this behavior to be consistent with Excel internally.</span></span> <span data-ttu-id="9809c-133">Cuando se llama a esta función, no debe asumir que el devuelto **XLOPER** siempre será **xltypeInt**; lectura de **my_xloper.val.w** proporciona un valor false si el tipo de **my_xloper** es **xltypeNum**.</span><span class="sxs-lookup"><span data-stu-id="9809c-133">When you call this function, you should not assume that the returned **XLOPER** will always be **xltypeInt**; reading **my_xloper.val.w** gives a false value if the **my_xloper** type is **xltypeNum**.</span></span>
  
## <a name="returning-xloper-or-xloper12-by-modifying-arguments-in-place"></a><span data-ttu-id="9809c-134">Devolver XLOPER o XLOPER12 mediante la modificación de argumentos en contexto</span><span class="sxs-lookup"><span data-stu-id="9809c-134">Returning XLOPER or XLOPER12 by Modifying Arguments in Place</span></span>

<span data-ttu-id="9809c-135">Excel permite el registro de las funciones que devuelven un **XLOPER** o **XLOPER12** mediante la modificación de un argumento en su lugar.</span><span class="sxs-lookup"><span data-stu-id="9809c-135">Excel permits the registration of functions that return an **XLOPER** or **XLOPER12** by modifying an argument in place.</span></span> <span data-ttu-id="9809c-136">Sin embargo, si un **XLOPER**/ puntos de argumento**XLOPER12** a la memoria y el puntero a continuación, se sobrescribe con el valor devuelto de la función DLL, Excel puede perder memoria.</span><span class="sxs-lookup"><span data-stu-id="9809c-136">However, if an **XLOPER**/ **XLOPER12** argument points to memory, and the pointer is then overwritten by the return value of the DLL function, Excel can leak memory.</span></span> <span data-ttu-id="9809c-137">Excel no muestra un error, pero podría bloquearse al final.</span><span class="sxs-lookup"><span data-stu-id="9809c-137">Excel does not display an error, but it might eventually crash.</span></span> <span data-ttu-id="9809c-138">Además, si el archivo DLL de memoria asignada para el valor devuelto, Excel intenta liberar esa memoria, lo que puede provocar un bloqueo de la aplicación inmediato.</span><span class="sxs-lookup"><span data-stu-id="9809c-138">Also, if the DLL allocated memory for the return value, Excel might try to free that memory, which could cause an immediate application crash.</span></span> <span data-ttu-id="9809c-139">Por lo tanto, no se debe modificar **XLOPER**/ **XLOPER12** argumentos en su lugar.</span><span class="sxs-lookup"><span data-stu-id="9809c-139">Therefore, you should not modify **XLOPER**/ **XLOPER12** arguments in place.</span></span> <span data-ttu-id="9809c-140">Argumentos de todos los **XLOPER** o **XLOPER12** deben tratarse como sólo lectura.</span><span class="sxs-lookup"><span data-stu-id="9809c-140">All **XLOPER** or **XLOPER12** arguments should be treated as strictly read-only.</span></span> 
  
<span data-ttu-id="9809c-141">Para obtener m�s informaci�n, consulte [Administraci�n de memoria en Excel](memory-management-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="9809c-141">For more information, see [Memory Management in Excel](memory-management-in-excel.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="9809c-142">Vea tambi�n</span><span class="sxs-lookup"><span data-stu-id="9809c-142">See also</span></span>



[<span data-ttu-id="9809c-143">XLOper12ToXLOper</span><span class="sxs-lookup"><span data-stu-id="9809c-143">XLOper12ToXLOper</span></span>](xloper12toxloper.md)


[<span data-ttu-id="9809c-144">Desarrollo de XLL de Excel de 2013</span><span class="sxs-lookup"><span data-stu-id="9809c-144">Developing Excel XLLs</span></span>](developing-excel-xlls.md)
  
[<span data-ttu-id="9809c-145">Referencia de funciones de API de SDK de XLL de Excel 2013</span><span class="sxs-lookup"><span data-stu-id="9809c-145">Excel XLL SDK API Function Reference</span></span>](excel-xll-sdk-api-function-reference.md)
  
[<span data-ttu-id="9809c-146">Administración de memoria en Excel</span><span class="sxs-lookup"><span data-stu-id="9809c-146">Memory Management in Excel</span></span>](memory-management-in-excel.md)

