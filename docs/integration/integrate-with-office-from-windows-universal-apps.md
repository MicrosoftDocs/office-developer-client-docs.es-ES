---
title: Integrar con Office desde aplicaciones universales de Windows
manager: soliver
ms.date: 02/06/2017
ms.audience: Developer
localization_priority: Normal
ms.assetid: 60b4fa23-0075-4f6a-8bd0-9e53e99432d5
description: Puede integrar aplicaciones de terceros de la plataforma de aplicaciones universales Windows con Excel Mobile, PowerPoint Mobile y Word Mobile. Las aplicaciones universales se integran con aplicaciones Office a través del contratos del selector de archivos de Windows, propiedades de Expando y contratos del Actualizador de archivos en caché.
ms.openlocfilehash: ad04ccc3ceb6e0f1d53e4aebc12cf9724ab8ab66
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 10/04/2018
ms.locfileid: "25388227"
---
# <a name="integrate-with-office-from-windows-universal-apps"></a><span data-ttu-id="76228-104">Integrar con Office desde aplicaciones universales de Windows</span><span class="sxs-lookup"><span data-stu-id="76228-104">Integrate with Office from Windows universal apps</span></span>

<span data-ttu-id="76228-p102">Puede integrar aplicaciones de terceros de la plataforma de aplicaciones universales Windows con Excel Mobile, PowerPoint Mobile y Word Mobile. Las aplicaciones universales se integran con aplicaciones Office a través del [contratos del selector de archivos](https://msdn.microsoft.com/library/windows/apps/hh465174.aspx) de Windows, [propiedades de Expando](https://msdn.microsoft.com/library/windows/apps/xaml/hh770655.aspx) y [contratos del Actualizador de archivos en caché](https://msdn.microsoft.com/library/windows/apps/windows.storage.provider.cachedfileupdater.aspx).</span><span class="sxs-lookup"><span data-stu-id="76228-p102">You can integrate your Windows universal app platform third-party apps with Excel Mobile, PowerPoint Mobile, and Word Mobile. Universal apps integrate with Office apps via Windows [file picker contracts](https://msdn.microsoft.com/library/windows/apps/hh465174.aspx), [expando properties](https://msdn.microsoft.com/library/windows/apps/xaml/hh770655.aspx), and [Cached File Updater contracts](https://msdn.microsoft.com/library/windows/apps/windows.storage.provider.cachedfileupdater.aspx).</span></span>
  
<span data-ttu-id="76228-p103">Al integrar la aplicación universal con Excel, PowerPoint o Word Mobile, los usuarios pueden abrir documentos Office que proporciona la aplicación, ya sea al buscar desde Office o cuando usan Windows para abrir archivos desde de la aplicación. También pueden guardar el archivo en la aplicación universal, que carga el archivo en su servicio.</span><span class="sxs-lookup"><span data-stu-id="76228-p103">When you integrate your universal app with Excel, PowerPoint, or Word Mobile, your users can open Office documents that your app provides, either when they browse from within Office or when they use Windows to open files from within your app. Users can also save the file back to your universal app, which uploads the file back to your service.</span></span>
  
<span data-ttu-id="76228-109">Los archivos abiertos de este modo aparecen en la lista Recientes de Office, por lo que los usuarios pueden buscarlos y abrirlos fácilmente.</span><span class="sxs-lookup"><span data-stu-id="76228-109">Files opened this way appear in the Recent list in Office, so your users can easily find and reopen them.</span></span>
  
<span data-ttu-id="76228-110">Esta integración requiere que la aplicación universal:</span><span class="sxs-lookup"><span data-stu-id="76228-110">This integration requires that your universal app:</span></span>
    
- <span data-ttu-id="76228-111">Implemente [los contratos de selector de archivos](https://msdn.microsoft.com/library/windows/apps/hh465174.aspx) de Windows.</span><span class="sxs-lookup"><span data-stu-id="76228-111">Implements the Windows [file picker contracts](https://msdn.microsoft.com/library/windows/apps/hh465174.aspx).</span></span>
    
- <span data-ttu-id="76228-112">Represente un almacén de archivos (por ejemplo, una aplicación que permita tener acceso al almacenamiento en la nube).</span><span class="sxs-lookup"><span data-stu-id="76228-112">Represents a file store (for example, an app that allows access to cloud storage).</span></span>
    
## <a name="expando-properties"></a><span data-ttu-id="76228-113">Propiedades de Expando</span><span class="sxs-lookup"><span data-stu-id="76228-113">Expando properties</span></span>

<span data-ttu-id="76228-p104">Las aplicaciones universales de Windows pueden usar propiedades de Expando para comunicar información adicional asociada a archivos. Para obtener información sobre cómo hacerlo en Windows, consulte "System.ExpandoProperties" en [StorageItemContentProperties.SavePropertiesAsync](https://msdn.microsoft.com/library/windows/apps/xaml/hh770655.aspx).</span><span class="sxs-lookup"><span data-stu-id="76228-p104">Windows universal apps can use Expando properties to communicate additional information that is associated with files. For information about how this works in Windows, see "System.ExpandoProperties" in [StorageItemContentProperties.SavePropertiesAsync](https://msdn.microsoft.com/library/windows/apps/xaml/hh770655.aspx).</span></span>
  
<span data-ttu-id="76228-p105">La tabla siguiente describe las propiedades que la aplicación tiene que proporcionar a Office para habilitar escenarios de archivos abiertos. Si no se proporciona esta información, todos los archivos de la aplicación se abren como de solo lectura. Que los usuarios puedan abrir archivos para su edición depende del tipo de licencia de Office que tengan y del tipo de documento que estén intentando abrir.</span><span class="sxs-lookup"><span data-stu-id="76228-p105">The following table describes the properties that your app has to provide to Office to enable file open scenarios. If this information is not provided, all files from your app are opened as read only. Whether users can open files for editing depends on the type of Office license they have and the type of document they're trying to open.</span></span>
  
<span data-ttu-id="76228-119">Establezca estas propiedades en el conjunto de propiedades de **System.ExpandoProperties**.</span><span class="sxs-lookup"><span data-stu-id="76228-119">Set these properties in the **System.ExpandoProperties** property set.</span></span> 
  
|<span data-ttu-id="76228-120">**Propiedad**</span><span class="sxs-lookup"><span data-stu-id="76228-120">**Property**</span></span>|<span data-ttu-id="76228-121">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="76228-121">**Description**</span></span>|<span data-ttu-id="76228-122">**Tipo**</span><span class="sxs-lookup"><span data-stu-id="76228-122">**Type**</span></span>|<span data-ttu-id="76228-123">**Ejemplo**</span><span class="sxs-lookup"><span data-stu-id="76228-123">**Example**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="76228-124">**AppDisplayName**</span><span class="sxs-lookup"><span data-stu-id="76228-124">**AppDisplayName**</span></span> <br/> |<span data-ttu-id="76228-p106">Nombre del proveedor para mostrar al usuario. Aparece en varios lugares de Office, como la lista de documentos recientes.</span><span class="sxs-lookup"><span data-stu-id="76228-p106">Provider name to display to the user. Appears in multiple places in Office, such as the recent document list.</span></span>  <br/> |<span data-ttu-id="76228-127">String</span><span class="sxs-lookup"><span data-stu-id="76228-127">String</span></span>  <br/> |<span data-ttu-id="76228-128">Contoso</span><span class="sxs-lookup"><span data-stu-id="76228-128">Contoso</span></span>  <br/> |
|<span data-ttu-id="76228-129">**MicrosoftOfficeOwnershipType**</span><span class="sxs-lookup"><span data-stu-id="76228-129">**MicrosoftOfficeOwnershipType**</span></span> <br/> |<span data-ttu-id="76228-p107">Para licencias, indique si la ubicación de los documentos es personal/de consumidor o de trabajo/de empresa. Los valores permitidos son 1 (personal) y 2 (empresa). Por ejemplo, si el archivo del usuario se almacena en la empresa Contoso, utilice el valor "2" para la empresa.</span><span class="sxs-lookup"><span data-stu-id="76228-p107">For licensing, indicate whether the document/location is Personal/Consumer or Work/Business. Allowed values are 1 (personal) and 2 (business). For example, if your user's file is stored in Contoso Business, use the value "2" for business.</span></span>  <br/> |<span data-ttu-id="76228-133">Unit32</span><span class="sxs-lookup"><span data-stu-id="76228-133">Unit32</span></span>  <br/> | <span data-ttu-id="76228-134">1 o 2</span><span class="sxs-lookup"><span data-stu-id="76228-134">1 or 2</span></span>  <br/> <span data-ttu-id="76228-135">Por ejemplo, si el archivo del usuario se almacena en la empresa Contoso, este archivo debe marcarse como 2 para la empresa.</span><span class="sxs-lookup"><span data-stu-id="76228-135">For example, if your user's file is stored in Contoso Business, this file should be marked 2 for business.</span></span>  <br/> |
|<span data-ttu-id="76228-136">**MicrosoftOfficeTermsOfUse**</span><span class="sxs-lookup"><span data-stu-id="76228-136">**MicrosoftOfficeTermsOfUse**</span></span> <br/> |<span data-ttu-id="76228-p108">Texto legal para declarar que la información proporcionada es válida según las condiciones de uso. Este texto no se muestra al usuario. Es un acuerdo entre el proveedor de la aplicación y Microsoft.</span><span class="sxs-lookup"><span data-stu-id="76228-p108">Legal text to declare that the information you provide is accurate per our terms of use. This text is not displayed to the user. It is an agreement between you, the application provider, and Microsoft.</span></span>  <br/> <span data-ttu-id="76228-140">Consulte el ejemplo que se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="76228-140">See the following for an example.</span></span>  <br/> | <span data-ttu-id="76228-141">String</span><span class="sxs-lookup"><span data-stu-id="76228-141">String</span></span>  <br/> | <span data-ttu-id="76228-142">Acepto los términos que figuran en [https://go.microsoft.com/fwlink/p/?LinkId=528381](third-party-applications-integrating-with-office-mobile-products.md)</span><span class="sxs-lookup"><span data-stu-id="76228-142">I agree to the terms located in [https://go.microsoft.com/fwlink/p/?LinkId=528381](third-party-applications-integrating-with-office-mobile-products.md)</span></span> <br/> |
   
<span data-ttu-id="76228-143">En el ejemplo de código siguiente se muestra cómo establecer estas propiedades.</span><span class="sxs-lookup"><span data-stu-id="76228-143">The following code example shows how to set these properties.</span></span>
  
```cs
public static async Task SetExpandoProperties(StorageFile file,... other params ...) 
  { 
     var expandoProperties = new PropertySet(); 
     expandoProperties.Add("AppDisplayName", "Contoso",);  
     // String value. 
     expandoProperties.Add("MicrosoftOfficeOwnershipType", 1);  
     // Unit32 value - 1 (for personal), 2 (for business).  
     expandoProperties.Add("MicrosoftOfficeTermsOfUse", "I agree to the terms located at https://go.microsoft.com/fwlink/p/?LinkId=528381");   
    // String value. 
          
       var fileProperties = new PropertySet(); 
       fileProperties.Add("System.ExpandoProperties", expandoProperties); 
       await file.Properties.SavePropertiesAsync(fileProperties); 
  } 

```

## <a name="cached-file-updater-contracts"></a><span data-ttu-id="76228-144">Contratos del Actualizador de archivos en caché</span><span class="sxs-lookup"><span data-stu-id="76228-144">Cached File Updater contracts</span></span>

<span data-ttu-id="76228-p109">Si la aplicación universal participa en los contratos del Actualizador de archivos en caché, se le notificarán los cambios realizados en el archivo por otra aplicación universal (como Office). Para obtener información sobre cómo hacerlo en Windows, consulte [clase CachedFileUpdater](https://msdn.microsoft.com/library/windows/apps/windows.storage.provider.cachedfileupdater.aspx).</span><span class="sxs-lookup"><span data-stu-id="76228-p109">If your universal app participates in Cached File Updater contracts, it will be notified of changes another universal app (such as Office) makes to the file. For information about how this works in Windows, see [CachedFileUpdater class](https://msdn.microsoft.com/library/windows/apps/windows.storage.provider.cachedfileupdater.aspx).</span></span>
  
<span data-ttu-id="76228-p110">Office usa la opción **AllowOnlyReaders** para abrir los archivos de lectura y escritura que proporciona su aplicación universal a través de los contratos del selector de archivos. Esto significa que otra aplicación no pueden mover, eliminar, cambiar el nombre ni escribir en el archivo, incluidas las suyas mientras el archivo está abierto en Office. Office guardará automáticamente el archivo, establece CachedFileManager.DeferUpdates para evitar la activación de la aplicación hasta que Office cierre el documento o Office suspenda Windows (cuando el usuario cambie a otra aplicación). Cuando Office cierre el archivo, la aplicación podrá escribir en él.</span><span class="sxs-lookup"><span data-stu-id="76228-p110">Office uses the **AllowOnlyReaders** option to open the read-write files your universal app provides via the file picker contracts. This means the file cannot be moved, deleted, renamed, or written to by another app, including your own, while it is open in Office. Office will autosave the file, but sets CachedFileManager.DeferUpdates to prevent activating your app until Office closes the document, or Office is suspended by Windows (when the user switches to another app). When Office closes the file, your app can write to it.</span></span> 
  
<span data-ttu-id="76228-151">La aplicación debe controlar toda la comunicación con el servicio, incluidas la descarga, la actualización y la carga.</span><span class="sxs-lookup"><span data-stu-id="76228-151">Your app must handle all communication with your service, including download, refresh, and upload.</span></span>
  
<span data-ttu-id="76228-152">En las tablas siguientes se enumeran los parámetros para configurar y controlar las interacciones entre la aplicación y Office.</span><span class="sxs-lookup"><span data-stu-id="76228-152">The following tables lists the parameters to set to handle interactions between your app and Office.</span></span>
  
|<span data-ttu-id="76228-153">**Parámetro**</span><span class="sxs-lookup"><span data-stu-id="76228-153">**Parameter**</span></span>|<span data-ttu-id="76228-154">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="76228-154">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="76228-155">ReadActivationMode</span><span class="sxs-lookup"><span data-stu-id="76228-155">ReadActivationMode</span></span>](https://msdn.microsoft.com/library/windows/apps/windows.storage.provider.readactivationmode.aspx) <br/> |<span data-ttu-id="76228-156">Establezca **BeforeAccess** para permitir que la aplicación actualice el archivo antes de enviarlo a Office.</span><span class="sxs-lookup"><span data-stu-id="76228-156">Set **BeforeAccess** to allow your app to update the file before it sends it to Office.</span></span>  <br/> |
|[<span data-ttu-id="76228-157">WriteActivationMode</span><span class="sxs-lookup"><span data-stu-id="76228-157">WriteActivationMode</span></span>](https://msdn.microsoft.com/library/windows/apps/windows.storage.provider.writeactivationmode.aspx) <br/> |<span data-ttu-id="76228-p111">Establezca **ReadOnly** para que el archivo sea de solo lectura. Establezca **AfterWrite** para asegurarse de que CacheFileUpdater activará la aplicación cuando Office acabe con el archivo.  </span><span class="sxs-lookup"><span data-stu-id="76228-p111">Set **ReadOnly** to make the file read only. Set **AfterWrite** to ensure that your app will be triggered by the CacheFileUpdater when Office is finished with the file.</span></span><br/><br/><span data-ttu-id="76228-160">**NOTA**: Si no establece **AfterWrite**, no se notificará a la aplicación para que cargue los cambios, lo que significa que los cambios del usuario solo serán locales.</span><span class="sxs-lookup"><span data-stu-id="76228-160">**NOTE**: If you do not set **AfterWrite**, your app will not be notified to upload the changes, which means that the user's changes will only be local.</span></span>           |
|[<span data-ttu-id="76228-161">CachedFileOptions.RequireUpdateOnAccess</span><span class="sxs-lookup"><span data-stu-id="76228-161">CachedFileOptions.RequireUpdateOnAccess</span></span>](https://msdn.microsoft.com/library/windows/apps/windows.storage.provider.cachedfileoptions.aspx) <br/> |<span data-ttu-id="76228-162">Establezca esta propiedad para asegurarse de que la aplicación puede actualizar el archivo cuando un usuario tenga acceso a él desde la lista utilizados recientemente.</span><span class="sxs-lookup"><span data-stu-id="76228-162">Set this property to ensure that your app can update the file when a user accesses it from the Recent list.</span></span>  <br/> |
   
## <a name="invoking-office-from-your-app"></a><span data-ttu-id="76228-163">Invocar a Office desde la aplicación</span><span class="sxs-lookup"><span data-stu-id="76228-163">Invoking Office from your app</span></span>

<span data-ttu-id="76228-p112">Cuando un usuario abre un documento de Office desde la aplicación, el documento se puede abrir en Excel Mobile, PowerPoint Mobile y Word Mobile. Por ejemplo, cuando un usuario selecciona un archivo \*.docx en su aplicación, se inicia Word Mobilecon el archivo \*.docx abierto. La aplicación Office que se abre se basa en la aplicación que el usuario ha asociado con el tipo de archivo.</span><span class="sxs-lookup"><span data-stu-id="76228-p112">When a user opens an Office document from your app, the document can open in Excel Mobile, PowerPoint Mobile, and Word Mobile. For example, when a user selects a \*.docx file in your app, Word Mobile launches with the \*.docx file opened. The Office app that opens is based on which app the user associated with the file type.</span></span>
  
<span data-ttu-id="76228-p113">Para abrir un archivo desde la aplicación en Office, le recomendamos que use **LaunchFileAsync()** para iniciar el archivo. No se recomienda utilizar **LaunchUriAsync()** para iniciar el archivo ya que hará que se inicie la aplicación registrada para el esquema URI (el explorador) en lugar de Office. Aunque **LaunchUriAsync()** con la opción **LauncherOptions.ContentType()** puede invocar a Office, en este caso el archivo abierto se marca como temporal y es de solo lectura en Office.</span><span class="sxs-lookup"><span data-stu-id="76228-p113">To open a file from your app in Office, we recommend that you use **LaunchFileAsync()** to launch the file. We don't recommend that you use **LaunchUriAsync()** to launch the file because that will cause the application registered for the URI scheme to launch (the browser) instead of Office. Although **LaunchUriAsync()** with the **LauncherOptions.ContentType()** option can invoke Office, in this case the file opened is marked as temporary and is read-only in Office.</span></span> 
  
<span data-ttu-id="76228-170">Para obtener más información, consulte [clase Iniciador](https://msdn.microsoft.com/library/windows/apps/windows.system.launcher.aspx).</span><span class="sxs-lookup"><span data-stu-id="76228-170">For more information, see [Launcher class](https://msdn.microsoft.com/library/windows/apps/windows.system.launcher.aspx).</span></span>
  
## <a name="temporary-and-read-only-files"></a><span data-ttu-id="76228-171">Archivos temporales y de solo lectura</span><span class="sxs-lookup"><span data-stu-id="76228-171">Temporary and read-only files</span></span>

<span data-ttu-id="76228-172">Establezca el atributo **FILE_ATTRIBUTE_TEMPORARY** en los archivos temporales y el atributo **FILE_ATTRIBUTE_READONLY** en los archivos de solo lectura en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="76228-172">Set the **FILE_ATTRIBUTE_TEMPORARY** attribute on temporary files and the **FILE_ATTRIBUTE_READONLY** attribute on read-only files in your app.</span></span> 
  
<span data-ttu-id="76228-p114">Los archivos que tienen el conjunto de atributos **FILE_ATTRIBUTE_TEMPORARY** o **FILE_ATTRIBUTE_READONLY** se abren como de solo lectura en Office. **FILE_ATTRIBUTE_TEMPORARY** también impide que el archivo aparezca en la lista de utilizados recientemente.</span><span class="sxs-lookup"><span data-stu-id="76228-p114">Files that have the **FILE_ATTRIBUTE_TEMPORARY** or **FILE_ATTRIBUTE_READONLY** attributes set open as read-only in Office. The **FILE_ATTRIBUTE_TEMPORARY** also prevents the file from appearing in the Recent list.</span></span> 
  
<span data-ttu-id="76228-175">Para obtener más información sobre los atributos de archivo, consulte [función SetFileAttributes](https://msdn.microsoft.com/library/windows/desktop/aa365535%28v=vs.85%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="76228-175">For more information about file attributes, see [SetFileAttributes function](https://msdn.microsoft.com/library/windows/desktop/aa365535%28v=vs.85%29.aspx).</span></span>
  
## <a name="other-best-practices"></a><span data-ttu-id="76228-176">Otros procedimientos recomendados</span><span class="sxs-lookup"><span data-stu-id="76228-176">Other best practices</span></span>

<span data-ttu-id="76228-177">Para optimizar la coherencia del archivo, por ejemplo cuando hay modificaciones conflictivas o se producen errores, se aplican los siguientes procedimientos recomendados:</span><span class="sxs-lookup"><span data-stu-id="76228-177">To optimize for file consistency, for example when conflicting edits or errors occur, apply the following best practices:</span></span>
  
- <span data-ttu-id="76228-178">Evite guardar conflictos.</span><span class="sxs-lookup"><span data-stu-id="76228-178">Prevent save conflicts.</span></span>
    
  - <span data-ttu-id="76228-p115">Pause las cargas cuando se produzcan conflictos de servidor para evitar la bifurcación (solo se bifurca cuando Office ya no tiene un archivo abierto para escritura). Normalmente, si un archivo está abierto en la aplicación Office, la aplicación solo se activa cuando Office se cierra o se suspende por Windows.</span><span class="sxs-lookup"><span data-stu-id="76228-p115">Pause uploads when server conflicts occur to avoid forking (only fork when Office no longer has a write file open). Typically, if a file from your app is open in Office, your app is activated only when Office closes or is suspended by Windows.</span></span>
    
  - <span data-ttu-id="76228-181">Si necesita controlar los conflictos de la interfaz de usuario, implemente notificaciones del sistema.</span><span class="sxs-lookup"><span data-stu-id="76228-181">If you need UI to handle conflicts, implement toast notifications.</span></span> <span data-ttu-id="76228-182">La interfaz de usuario completa no está disponible cuando se suspende Office.</span><span class="sxs-lookup"><span data-stu-id="76228-182">Full UI is not available when Office is suspended.</span></span>
    
- <span data-ttu-id="76228-183">Controle los errores.</span><span class="sxs-lookup"><span data-stu-id="76228-183">Handle errors.</span></span>
    
  - <span data-ttu-id="76228-184">Cuando se libere un bloqueo, notifique a los usuarios del conflicto y proporcione una ruta para resolverlo dentro de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="76228-184">When a lock is released, notify users of the conflict and provide a path to resolve it within your app.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="76228-185">Vea también</span><span class="sxs-lookup"><span data-stu-id="76228-185">See also</span></span>

- [<span data-ttu-id="76228-186">Integración con Office</span><span class="sxs-lookup"><span data-stu-id="76228-186">Integrate with Office</span></span>](integrate-with-office.md)   
- [<span data-ttu-id="76228-187">Integrar con Office desde clientes de sincronización de Win32</span><span class="sxs-lookup"><span data-stu-id="76228-187">Integrate with Office from Win32 sync clients</span></span>](integrate-with-office-from-win32-sync-clients.md)
    

