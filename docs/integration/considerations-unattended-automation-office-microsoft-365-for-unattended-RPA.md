---
title: Consideraciones para la automatización desatendida de Office en Microsoft 365 para el entorno de RPA desatendida
ms.date: 03/30/2020
ms.audience: Developer
localization_priority: Normal
description: Consideraciones para la automatización desatendida de Office en Microsoft 365 para el entorno de RPA desatendida.
ms.openlocfilehash: 576217fc85f2980a6d2451e3f930296ea4c11a56
ms.sourcegitcommit: 007aa2ceb4f569201c3f4372de5c83b6c61f8875
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/02/2020
ms.locfileid: "43103053"
---
# <a name="considerations-for-unattended-automation-of-office-in-the-microsoft-365-for-unattended-rpa-environment"></a><span data-ttu-id="c6db9-103">Consideraciones para la automatización desatendida de Office en Microsoft 365 para el entorno de RPA desatendida</span><span class="sxs-lookup"><span data-stu-id="c6db9-103">Considerations for unattended automation of Office in the Microsoft 365 for unattended RPA environment</span></span>

<span data-ttu-id="c6db9-104">Aunque Microsoft 365 para RPA desatendida ofrece una licencia que permite la automatización de Office sin ningún usuario, todas las versiones actuales de Office se diseñaron y probaron para ejecutarse como productos de usuario final en una estación de trabajo cliente con un usuario presente para interactuar con la interfaz de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c6db9-104">Although Microsoft 365 for unattended RPA provides a license that enables the automation of Office with no user present, all current versions of Office were designed and tested to run as end-user products on a client workstation with a user present to interact with the application’s interface.</span></span> <span data-ttu-id="c6db9-105">Los comportamientos inesperados que se derivan del uso de aplicaciones sin un usuario presente no son defectos.</span><span class="sxs-lookup"><span data-stu-id="c6db9-105">Unexpected behaviors resulting from the use of applications without a user present are not defects.</span></span> <span data-ttu-id="c6db9-106">Si desea ejecutar Office en esta configuración, debe estar preparado para tener en cuenta estos comportamientos inesperados en la lógica de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c6db9-106">If you want to run Office in this configuration, you must be prepared to account for these unexpected behaviors in your application logic.</span></span>

<span data-ttu-id="c6db9-107">En este artículo se describen algunas de las consideraciones para la automatización desatendida de Office para ayudarle si usa este método.</span><span class="sxs-lookup"><span data-stu-id="c6db9-107">This article outlines some of the considerations for unattended automation of Office to help you if you use this approach.</span></span> <span data-ttu-id="c6db9-108">Sin embargo, tenga en cuenta que el uso de Office en esta configuración es estrictamente "tal cual" y debe tener en cuenta estos comportamientos inesperados.</span><span class="sxs-lookup"><span data-stu-id="c6db9-108">However, note that usage of Office in this configuration is strictly “AS IS” and must account for these unexpected behaviors.</span></span> <span data-ttu-id="c6db9-109">La información que se proporciona aquí no es exhaustiva y no se garantiza que resuelva todos los problemas de todos los clientes.</span><span class="sxs-lookup"><span data-stu-id="c6db9-109">The information provided here is not exhaustive and is not guaranteed to resolve all issues for all clients.</span></span> <span data-ttu-id="c6db9-110">Le recomendamos que pruebe minuciosamente su solución antes de implementarla.</span><span class="sxs-lookup"><span data-stu-id="c6db9-110">We encourage you to test your solution thoroughly before you deploy.</span></span>

## <a name="common-problems-in-unattended-automation"></a><span data-ttu-id="c6db9-111">Problemas comunes en la automatización desatendida</span><span class="sxs-lookup"><span data-stu-id="c6db9-111">Common problems in unattended automation</span></span>

<span data-ttu-id="c6db9-112">Si desea usar Office sin un usuario presente, tenga en cuenta las siguientes áreas en las que Office puede comportarse de forma diferente a lo esperado.</span><span class="sxs-lookup"><span data-stu-id="c6db9-112">If you want to use Office without a user present, be aware of the following areas in which Office can behave differently than expected.</span></span> <span data-ttu-id="c6db9-113">Para que la solución se ejecute correctamente, debe solucionar estos problemas y minimizar sus efectos lo máximo posible.</span><span class="sxs-lookup"><span data-stu-id="c6db9-113">For your solution to run successfully, it must address these issues and minimize their effects as much as possible.</span></span> <span data-ttu-id="c6db9-114">Tenga en cuenta estos problemas con cuidado al compilar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c6db9-114">Consider these issues carefully when you build your application.</span></span>

### <a name="interactive-ui-elements"></a><span data-ttu-id="c6db9-115">Elementos interactivos de interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="c6db9-115">Interactive UI elements</span></span>

<span data-ttu-id="c6db9-116">Las aplicaciones de Office suponen que se ejecutan de forma interactiva.</span><span class="sxs-lookup"><span data-stu-id="c6db9-116">Office applications assume that they are being run interactively.</span></span> <span data-ttu-id="c6db9-117">Si se produce un error inesperado, o si se necesita un parámetro sin especificar para completar una función, Office está diseñado para solicitar al usuario un cuadro de diálogo que le pregunte cómo desea continuar.</span><span class="sxs-lookup"><span data-stu-id="c6db9-117">If an unexpected error occurs, or if an unspecified parameter is needed to complete a function, Office is designed to prompt the user with a dialog box that asks the user how they want to proceed.</span></span> <span data-ttu-id="c6db9-118">En la automatización desatendida, esto puede hacer que la aplicación aparezca como "bloqueo" cuando la aplicación se detiene hasta que recibe esta entrada.</span><span class="sxs-lookup"><span data-stu-id="c6db9-118">In unattended automation, this might result in the application appearing to “hang” as the application stops until it receives this input.</span></span> <span data-ttu-id="c6db9-119">Si está automatizando Office a través de sus API públicas, puede suprimir muchas de estas alertas mediante la configuración de propiedades como [Application. DisplayAlerts](https://docs.microsoft.com/office/vba/api/word.application.displayalerts) y [Application. AutomationSecurity](https://docs.microsoft.com/office/vba/api/word.application.automationsecurity) correctamente.</span><span class="sxs-lookup"><span data-stu-id="c6db9-119">If you’re automating Office via its public APIs, you can suppress many of these alerts by configuring properties like [Application.DisplayAlerts](https://docs.microsoft.com/office/vba/api/word.application.displayalerts) and [Application.AutomationSecurity](https://docs.microsoft.com/office/vba/api/word.application.automationsecurity) appropriately.</span></span> <span data-ttu-id="c6db9-120">El código debe diseñarse para identificar y procesar las alertas de bloqueo en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="c6db9-120">Your code should be designed to identify and process blocking alerts at any time.</span></span>

### <a name="user-identity"></a><span data-ttu-id="c6db9-121">Identidad del usuario</span><span class="sxs-lookup"><span data-stu-id="c6db9-121">User identity</span></span>

<span data-ttu-id="c6db9-122">Las aplicaciones de Office requieren una identidad de usuario cuando se ejecutan las aplicaciones, incluso cuando la aplicación se inicia a través de la automatización.</span><span class="sxs-lookup"><span data-stu-id="c6db9-122">Office applications require a user identity when the applications are run, even when the application is started via automation.</span></span> <span data-ttu-id="c6db9-123">La identidad de este usuario puede provocar alguna o todas las acciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="c6db9-123">This user identity can cause any or all of the following:</span></span>

- <span data-ttu-id="c6db9-124">La presencia de interfaz de usuario de inicio de sesión adicional que se debe controlar.</span><span class="sxs-lookup"><span data-stu-id="c6db9-124">The presence of additional sign-in UI that must be handled.</span></span>
- <span data-ttu-id="c6db9-125">Archivos que no se pueden abrir o editar en función de los permisos de acceso por usuario.</span><span class="sxs-lookup"><span data-stu-id="c6db9-125">Files that cannot be opened and/or edited based on per-user access permissions.</span></span>
- <span data-ttu-id="c6db9-126">Cambios inesperados en los metadatos del archivo (por ejemplo, algunas propiedades de archivo se actualizarán en función de la identidad de la identidad del usuario de la instancia de la aplicación automatizada).</span><span class="sxs-lookup"><span data-stu-id="c6db9-126">Unexpected changes to the metadata of the file (for example, certain file properties will be updated based on the identity of the user identity of the automated application instance).</span></span>

<span data-ttu-id="c6db9-127">Varios métodos pueden ayudar a mitigar estos problemas; por ejemplo, ejecutar el [Inspector de documento](https://docs.microsoft.com/office/vba/library-reference/concepts/using-the-document-inspector) para quitar metadatos.</span><span class="sxs-lookup"><span data-stu-id="c6db9-127">Various approaches can help to mitigate these issues; for example, running the [Document Inspector](https://docs.microsoft.com/office/vba/library-reference/concepts/using-the-document-inspector) to remove metadata.</span></span> <span data-ttu-id="c6db9-128">Considere si estos enfoques son adecuados según su escenario.</span><span class="sxs-lookup"><span data-stu-id="c6db9-128">Consider whether these approaches are appropriate based on your scenario.</span></span>

### <a name="server-side-security"></a><span data-ttu-id="c6db9-129">Seguridad del servidor</span><span class="sxs-lookup"><span data-stu-id="c6db9-129">Server-side security</span></span>

<span data-ttu-id="c6db9-130">Cuando se ejecuta Office de forma desatendida y se procesa contenido de archivo arbitrario, no hay disponibles protecciones adicionales específicas en ese entorno para evitar que las macros almacenadas en esos archivos se carguen y se ejecuten.</span><span class="sxs-lookup"><span data-stu-id="c6db9-130">When running Office unattended and processing arbitrary file content, no additional protections specific in that environment are available to prevent macros stored in those files from loading and running.</span></span> <span data-ttu-id="c6db9-131">Office no protege el usuario de las macros que se ejecutan involuntariamente desde el código o iniciando otro servidor que pueda ejecutar macros.</span><span class="sxs-lookup"><span data-stu-id="c6db9-131">Office does not protect you from unintentionally running macros from your code, or from starting another server that might run macros.</span></span> <span data-ttu-id="c6db9-132">Puede usar propiedades como [Application. AutomationSecurity](https://docs.microsoft.com/office/vba/api/word.application.automationsecurity) para mitigar este riesgo, pero debe asegurarse de que solo carga contenido de confianza.</span><span class="sxs-lookup"><span data-stu-id="c6db9-132">You can use properties like [Application.AutomationSecurity](https://docs.microsoft.com/office/vba/api/word.application.automationsecurity) to mitigate this risk, but you should ensure that you are only loading trusted content.</span></span>

<span data-ttu-id="c6db9-133">Además, Office usa muchos componentes (como simple MAPI, WinInet y MSDAIPP) que pueden almacenar en caché la información de autenticación del cliente para acelerar el procesamiento.</span><span class="sxs-lookup"><span data-stu-id="c6db9-133">Additionally, Office uses many components (such as Simple MAPI, WinInet, and MSDAIPP) that can cache client authentication information to speed processing.</span></span> <span data-ttu-id="c6db9-134">Cuando Office se encuentra automatizado en el servidor y procesando varios archivos, si se ha almacenado en caché la información de autenticación de esa sesión, un cliente puede usar las credenciales almacenadas en caché de otro cliente.</span><span class="sxs-lookup"><span data-stu-id="c6db9-134">When Office is being automated server-side and processing multiple files, if authentication information has been cached for that session, one client can use the cached credentials of another client.</span></span> <span data-ttu-id="c6db9-135">Por lo tanto, el cliente puede obtener permisos de acceso no concedidos suplantando a otros usuarios.</span><span class="sxs-lookup"><span data-stu-id="c6db9-135">Therefore, the client can gain non-granted access permissions by impersonating other users.</span></span>

### <a name="ui-changes"></a><span data-ttu-id="c6db9-136">Cambios en la interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="c6db9-136">UI changes</span></span>

<span data-ttu-id="c6db9-137">Los elementos de la interfaz de usuario de Office son muy estables, pero la ubicación específica de cualquier elemento de la interfaz de usuario no está garantizada y puede cambiar a medida que el diseño del producto evolucione para incorporar los comentarios de los usuarios y satisfacer las necesidades de los clientes.</span><span class="sxs-lookup"><span data-stu-id="c6db9-137">The UI elements in Office are largely stable, but the specific location of any UI element is not guaranteed and might change as the product design evolves to incorporate user feedback and meet customer needs.</span></span> <span data-ttu-id="c6db9-138">La lógica de cualquier automatización debe tener en cuenta esto.</span><span class="sxs-lookup"><span data-stu-id="c6db9-138">The logic of any automation must account for this.</span></span> <span data-ttu-id="c6db9-139">Estos cambios pueden dar como resultado los cambios de nombre de las fichas de botón o grupo, el movimiento de comandos entre las pestañas, la adición de nuevas pestañas o la eliminación de comandos en función de nuestras directivas de desuso de características.</span><span class="sxs-lookup"><span data-stu-id="c6db9-139">These changes might result in button or group tab naming changes, movement of commands between tabs, the addition of new tabs, or the removal of commands in alignment with our feature deprecation policies.</span></span> <span data-ttu-id="c6db9-140">Estos cambios pueden tener efecto en la interfaz de usuario, así como en la información de accesibilidad proporcionada por la aplicación, ya que esta información se modifica para mejorar el uso y la cuenta para los comentarios de los clientes en curso y se puede implementar para distintos usuarios en momentos diferentes.</span><span class="sxs-lookup"><span data-stu-id="c6db9-140">These changes can take place in the UI as well as within the accessibility information provided by the application, as that information is modified to improve usability and account for ongoing customer feedback, and might be rolled out for different users at different times.</span></span>

<span data-ttu-id="c6db9-141">Incluso sin cambios en el producto, las diferencias entre los entornos del sistema (como el tamaño de pantalla/resolución/PPP) pueden dar lugar a cambios en la ubicación de los elementos en la pantalla.</span><span class="sxs-lookup"><span data-stu-id="c6db9-141">Even without product changes, differences between system environments (such as screen size/resolution/DPI) can result in changes in the location of items on screen.</span></span> <span data-ttu-id="c6db9-142">Cualquier método que se base en coordenadas de pantalla para simular la entrada del usuario debe considerar estos cambios y adaptarlos en consecuencia.</span><span class="sxs-lookup"><span data-stu-id="c6db9-142">Any approach that relies on screen coordinates to simulate user input must consider these changes and adapt accordingly.</span></span>

### <a name="single-threading"></a><span data-ttu-id="c6db9-143">Subprocesamiento único</span><span class="sxs-lookup"><span data-stu-id="c6db9-143">Single-threading</span></span>

<span data-ttu-id="c6db9-144">Las aplicaciones de Office son aplicaciones no reentrantes basadas en STA que están diseñadas para proporcionar una funcionalidad diversa pero de uso intensivo de recursos para un único cliente.</span><span class="sxs-lookup"><span data-stu-id="c6db9-144">Office applications are non-reentrant, STA-based applications that are designed to provide diverse but resource-intensive functionality for a single client.</span></span> <span data-ttu-id="c6db9-145">Las aplicaciones usan recursos globales como archivos asignados a memoria, Complementos globales o plantillas y servidores de automatización compartidos.</span><span class="sxs-lookup"><span data-stu-id="c6db9-145">The applications use global resources such as memory mapped files, global add-ins or templates, and shared automation servers.</span></span> <span data-ttu-id="c6db9-146">Esto puede limitar el número de instancias que se pueden ejecutar simultáneamente y puede llevar a condiciones de carrera si las aplicaciones se configuran en un entorno multicliente.</span><span class="sxs-lookup"><span data-stu-id="c6db9-146">This can limit the number of instances that can run concurrently and can lead to race conditions if the applications are configured in a multiclient environment.</span></span> <span data-ttu-id="c6db9-147">Si tiene previsto ejecutar más de una instancia de cualquier aplicación de Office, debe planear la forma de aislarlas en el nivel de la máquina virtual para garantizar la estabilidad de la solución resultante.</span><span class="sxs-lookup"><span data-stu-id="c6db9-147">If you plan to run more than one instance of any Office application, you should plan to isolate them at the virtual machine level to ensure the stability of the resulting solution.</span></span>

### <a name="resiliency-and-stability"></a><span data-ttu-id="c6db9-148">Resistencia y estabilidad</span><span class="sxs-lookup"><span data-stu-id="c6db9-148">Resiliency and stability</span></span>

<span data-ttu-id="c6db9-149">Incluso con las consideraciones anteriores, si las aplicaciones están automatizadas de manera que se simula la entrada del usuario o la duración de las sesiones que superan considerablemente el uso interactivo, es posible que se encuentren problemas que no están presentes al ejecutarse de forma interactiva.</span><span class="sxs-lookup"><span data-stu-id="c6db9-149">Even with the considerations above, if the applications are automated in ways that simulate user input or for session lengths that dramatically exceed interactive usage, they might encounter issues that are not present when run interactively.</span></span> <span data-ttu-id="c6db9-150">Las soluciones que usan Office en este contexto deben crear mecanismos de forma proactiva para supervisar el estado de la aplicación y reiniciarlas (o la máquina virtual en la que se están ejecutando), si es necesario.</span><span class="sxs-lookup"><span data-stu-id="c6db9-150">Solutions that utilize Office in this context should proactively build mechanisms to monitor the state of the application and restart them (and/or the virtual machine on which they are running) if/as needed.</span></span>

## <a name="suggested-alternatives"></a><span data-ttu-id="c6db9-151">Sugerencias de alternativas</span><span class="sxs-lookup"><span data-stu-id="c6db9-151">Suggested Alternatives</span></span>

<span data-ttu-id="c6db9-152">Microsoft recomienda encarecidamente algunas alternativas que no requieran la instalación de Office y la ejecución del servidor, y que puedan realizar tareas comunes de forma más eficaz y rápida que la automatización en esta configuración.</span><span class="sxs-lookup"><span data-stu-id="c6db9-152">Microsoft strongly recommends a few alternatives that do not require Office to be installed and run server-side, and that can perform common tasks more efficiently and more quickly than automation in this configuration.</span></span> <span data-ttu-id="c6db9-153">Antes de involucrar a Office como componente del lado servidor en el proyecto, tenga en cuenta las alternativas.</span><span class="sxs-lookup"><span data-stu-id="c6db9-153">Before you involve Office as a server-side component in your project, consider alternatives.</span></span>

### <a name="microsoft-graph"></a><span data-ttu-id="c6db9-154">Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="c6db9-154">Microsoft Graph</span></span>

<span data-ttu-id="c6db9-155">La API de Microsoft Graph proporciona acceso a los servicios, datos e inteligencia que están disponibles para los usuarios y las soluciones como parte de Microsoft Cloud, incluidos muchos servicios que admiten las necesidades de la automatización desatendida: acceso al correo/calendario/contactos/archivos de los usuarios, la conversión de documentos, el cálculo de libros de Excel y mucho más.</span><span class="sxs-lookup"><span data-stu-id="c6db9-155">The Microsoft Graph API provides access to the services, data, and intelligence that are available to users and solutions as part of the Microsoft cloud, including many services supporting the needs of unattended automation: access to users’ mail / calendar / contacts / files, document conversion, Excel workbook calculation, and more.</span></span> <span data-ttu-id="c6db9-156">Estos servicios están diseñados para uso desatendido y acceso a gran escala, y usan una sintaxis de API RESTful estándar.</span><span class="sxs-lookup"><span data-stu-id="c6db9-156">These services are designed for unattended use and high-scale access, and utilize a standard RESTful API syntax.</span></span> <span data-ttu-id="c6db9-157">Para obtener más información sobre Microsoft Graph y cómo usarla para trabajar con los datos de los usuarios, visite el siguiente ejemplo:</span><span class="sxs-lookup"><span data-stu-id="c6db9-157">For more information on Microsoft Graph and how to use it to work with users’ data, visit the following:</span></span>

- [<span data-ttu-id="c6db9-158">Información general de Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="c6db9-158">Overview of Microsoft Graph</span></span>](https://docs.microsoft.com/graph/overview) 
- [<span data-ttu-id="c6db9-159">Introducción a Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="c6db9-159">Get started with Microsoft Graph</span></span>](https://developer.microsoft.com/graph/get-started)
- <span data-ttu-id="c6db9-160">[Descargar un archivo en otro formato](https://docs.microsoft.com/graph/api/driveitem-get-content-format?view=graph-rest-1.0&tabs=http) (conversión de archivos)</span><span class="sxs-lookup"><span data-stu-id="c6db9-160">[Download a file in another format](https://docs.microsoft.com/graph/api/driveitem-get-content-format?view=graph-rest-1.0&tabs=http) (file conversion)</span></span>
- <span data-ttu-id="c6db9-161">[Trabajar con Excel en Microsoft Graph](https://docs.microsoft.com/graph/api/resources/excel?view=graph-rest-1.0) (detalles del libro)</span><span class="sxs-lookup"><span data-stu-id="c6db9-161">[Working with Excel in Microsoft Graph](https://docs.microsoft.com/graph/api/resources/excel?view=graph-rest-1.0) (workbook details)</span></span>

### <a name="open-xml-file-formats"></a><span data-ttu-id="c6db9-162">Formatos de archivo Open XML</span><span class="sxs-lookup"><span data-stu-id="c6db9-162">Open XML file formats</span></span>

<span data-ttu-id="c6db9-163">Muchas tareas de automatización implican la creación o edición de documentos.</span><span class="sxs-lookup"><span data-stu-id="c6db9-163">Many automation tasks involve document creation or editing.</span></span> <span data-ttu-id="c6db9-164">Office admite formatos de archivo Open XML que permiten a los desarrolladores crear, editar, leer y transformar contenido de archivos con tecnologías estándar de XML y ZIP, definidas en el estándar internacional ISO 29500.</span><span class="sxs-lookup"><span data-stu-id="c6db9-164">Office supports Open XML file formats that let developers create, edit, read, and transform file content using standard XML and ZIP technologies, defined in the ISO 29500 International Standard.</span></span> <span data-ttu-id="c6db9-165">Estos formatos de archivo pueden manipularse a través de cualquier herramienta ZIP/XML, incluido el espacio de nombres System.IO.Package.IO en Microsoft .NET 3. x Framework.</span><span class="sxs-lookup"><span data-stu-id="c6db9-165">These file formats can be manipulated via any ZIP/XML tools, including the System.IO.Package.IO namespace in the Microsoft .NET 3.x Framework.</span></span> <span data-ttu-id="c6db9-166">La edición directa de los formatos de archivo es el método recomendado y compatible para controlar los cambios en los archivos de Office desde un servicio.</span><span class="sxs-lookup"><span data-stu-id="c6db9-166">Direct editing of the file formats is the recommended and supported method for handling changes to Office files from a service.</span></span>

<span data-ttu-id="c6db9-167">Microsoft proporciona un SDK para manipular formatos de archivo Open XML desde .NET 3. x Framework.</span><span class="sxs-lookup"><span data-stu-id="c6db9-167">Microsoft provides an SDK for manipulating Open XML file formats from the .NET 3.x Framework.</span></span> <span data-ttu-id="c6db9-168">Para obtener más información sobre el SDK y cómo usar el SDK para crear o editar archivos Open XML, visite el siguiente ejemplo:</span><span class="sxs-lookup"><span data-stu-id="c6db9-168">For more information about the SDK and how to use the SDK to create or edit Open XML files, visit the following:</span></span>

- [<span data-ttu-id="c6db9-169">Descripción de los formatos de archivo Open XML</span><span class="sxs-lookup"><span data-stu-id="c6db9-169">Understanding the Open XML file formats</span></span>](https://docs.microsoft.com/office/open-xml/understanding-the-open-xml-file-formats)
- [<span data-ttu-id="c6db9-170">Bienvenido al SDK de Open XML 2,5 para Office</span><span class="sxs-lookup"><span data-stu-id="c6db9-170">Welcome to the Open XML SDK 2.5 for Office</span></span>](https://docs.microsoft.com/office/open-xml/open-xml-sdk)
