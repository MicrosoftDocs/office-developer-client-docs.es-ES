---
title: Identificadores de entrada puntuales
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 741d21ae-f14a-4b7f-80aa-91d0f0ff3f34
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: abe52cb45e13e6713d28fffe379e245e2483bffa
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33411046"
---
# <a name="one-off-entry-identifiers"></a><span data-ttu-id="63d5c-103">Identificadores de entrada puntuales</span><span class="sxs-lookup"><span data-stu-id="63d5c-103">One-off entry identifiers</span></span>
  
<span data-ttu-id="63d5c-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="63d5c-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="63d5c-105">MAPI crea identificadores de entrada únicos en el método **IAddrBook::CreateOneOff** y en componentes que no tienen acceso al subsistema MAPI, como los componentes de puerta de enlace.</span><span class="sxs-lookup"><span data-stu-id="63d5c-105">One-off entry identifiers are created by MAPI in the **IAddrBook::CreateOneOff** method and by components that do not have access to the MAPI subsystem, such as gateway components.</span></span> <span data-ttu-id="63d5c-106">For more information, see [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md).</span><span class="sxs-lookup"><span data-stu-id="63d5c-106">For more information, see [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md).</span></span> <span data-ttu-id="63d5c-107">En la siguiente ilustración se muestra el formato de un identificador de entrada único.</span><span class="sxs-lookup"><span data-stu-id="63d5c-107">The following illustration shows the format of a one-off entry identifier.</span></span>
  
<span data-ttu-id="63d5c-108">**Formato de identificador de entrada con definición**</span><span class="sxs-lookup"><span data-stu-id="63d5c-108">**One-off entry identifier format**</span></span>
  
<span data-ttu-id="63d5c-109">![Formato de identificador de entrada único Formato]de identificador de entrada(media/amapi_69.gif "único")</span><span class="sxs-lookup"><span data-stu-id="63d5c-109">![One-off entry identifier format](media/amapi_69.gif "One-off entry identifier format")</span></span>
  
<span data-ttu-id="63d5c-110">El primer campo es una estructura [MAPIUID](mapiuid.md) especial que identifica el identificador de entrada como que representa un destinatario personalizado.</span><span class="sxs-lookup"><span data-stu-id="63d5c-110">The first field is a special [MAPIUID](mapiuid.md) structure that identifies the entry identifier as representing a custom recipient.</span></span> <span data-ttu-id="63d5c-111">Esta **estructura MAPIUID** debe establecerse en la constante MAPI_ONE_OFF_UID.</span><span class="sxs-lookup"><span data-stu-id="63d5c-111">This **MAPIUID** structure must be set to the constant MAPI_ONE_OFF_UID.</span></span> <span data-ttu-id="63d5c-112">MAPI_ONE_OFF_UID se define en el archivo de encabezado MAPIDEFS.H.</span><span class="sxs-lookup"><span data-stu-id="63d5c-112">MAPI_ONE_OFF_UID is defined in the header file MAPIDEFS.H.</span></span> 
  
<span data-ttu-id="63d5c-113">Los campos versión y marcas son palabras de 16 bits en orden de bytes intel.</span><span class="sxs-lookup"><span data-stu-id="63d5c-113">The version and flags fields are 16-bit words in Intel byte order.</span></span> <span data-ttu-id="63d5c-114">El campo de versión debe establecerse en cero.</span><span class="sxs-lookup"><span data-stu-id="63d5c-114">The version field must be set to zero.</span></span> <span data-ttu-id="63d5c-115">El campo de marcas se puede establecer en los siguientes valores:</span><span class="sxs-lookup"><span data-stu-id="63d5c-115">The flags field can be set to the following values:</span></span>
  
<span data-ttu-id="63d5c-116">MAPI_ONE_OFF_NO_RICH_INFO</span><span class="sxs-lookup"><span data-stu-id="63d5c-116">MAPI_ONE_OFF_NO_RICH_INFO</span></span>
  
<span data-ttu-id="63d5c-117">MAPI_ONE_OFF_UNICODE</span><span class="sxs-lookup"><span data-stu-id="63d5c-117">MAPI_ONE_OFF_UNICODE</span></span>
  
<span data-ttu-id="63d5c-118">La MAPI_ONE_OFF_NO_RICH_INFO se establece si un destinatario no debe recibir contenido del mensaje en el Formato de encapsulación neutral de transporte (TNEF).</span><span class="sxs-lookup"><span data-stu-id="63d5c-118">The MAPI_ONE_OFF_NO_RICH_INFO flag is set if a recipient should not receive message content in the Transport Neutral Encapsulation Format (TNEF).</span></span> <span data-ttu-id="63d5c-119">Esta marca se establece cuando MAPI_SEND_NO_RICH_INFO se pasa al [método IAddrBook::CreateOneOff.](iaddrbook-createoneoff.md)</span><span class="sxs-lookup"><span data-stu-id="63d5c-119">This flag is set when MAPI_SEND_NO_RICH_INFO is passed to [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md) method.</span></span> 
  
<span data-ttu-id="63d5c-120">La MAPI_ONE_OFF_UNICODE se establece si el nombre para mostrar y la dirección de correo electrónico son cadenas Unicode.</span><span class="sxs-lookup"><span data-stu-id="63d5c-120">The MAPI_ONE_OFF_UNICODE flag is set if the display name and email address are Unicode strings.</span></span> <span data-ttu-id="63d5c-121">Esta marca se establece cuando el MAPI_UNICODE se pasa a **IAddrBook::CreateOneOff**.</span><span class="sxs-lookup"><span data-stu-id="63d5c-121">This flag is set when the MAPI_UNICODE is passed to **IAddrBook::CreateOneOff**.</span></span> <span data-ttu-id="63d5c-122">Cuando la marca MAPI_UNICODE no se pasa a **CreateOneOff**, MAPI supone que las cadenas de dirección de correo electrónico y el nombre para mostrar están en el conjunto de caracteres ANSI actual de la estación de trabajo.</span><span class="sxs-lookup"><span data-stu-id="63d5c-122">When the MAPI_UNICODE flag is not passed to **CreateOneOff**, MAPI assumes that the display name and email address strings are in the workstation's current ANSI character set.</span></span> <span data-ttu-id="63d5c-123">Por lo general, las cadenas ANSI no funcionan bien en los mensajes que se envían entre plataformas mediante distintos conjuntos de caracteres porque la página de código no está codificada en el identificador de entrada.</span><span class="sxs-lookup"><span data-stu-id="63d5c-123">ANSI strings generally do not work well in messages that are sent between platforms using different character sets because the code page is not encoded in the entry identifier.</span></span> <span data-ttu-id="63d5c-124">Para protegerse contra esta posible incompatibilidad, muchos tipos de direcciones se limitan solo a los caracteres comunes en varios conjuntos de caracteres.</span><span class="sxs-lookup"><span data-stu-id="63d5c-124">To protect against this potential incompatibility, many address types are limited to only those characters that are common across multiple character sets.</span></span> <span data-ttu-id="63d5c-125">Sin embargo, para garantizar la compatibilidad de la plataforma y el conjunto de caracteres, los clientes deben usar Unicode para las cadenas de caracteres de sus mensajes.</span><span class="sxs-lookup"><span data-stu-id="63d5c-125">However, to ensure character set and platform compatibility, clients should use Unicode for the character strings in their messages.</span></span>
  
<span data-ttu-id="63d5c-126">El nombre para mostrar es una cadena terminada en null que corresponde **a** la propiedad PR_DISPLAY_NAME ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) del destinatario y al parámetro  _lpszName_ pasado a **IAddrBook::CreateOneOff**.</span><span class="sxs-lookup"><span data-stu-id="63d5c-126">The display name is a null-terminated string that corresponds to the recipient's **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) property and to the  _lpszName_ parameter passed to **IAddrBook::CreateOneOff**.</span></span> <span data-ttu-id="63d5c-127">El juego de caracteres es Unicode si la MAPI_ONE_OFF_UNICODE marca está establecida y ANSI si está clara.</span><span class="sxs-lookup"><span data-stu-id="63d5c-127">The character set is Unicode if the MAPI_ONE_OFF_UNICODE flag is set and ANSI if it is clear.</span></span> 
  
<span data-ttu-id="63d5c-128">El tipo de dirección es una cadena terminada en null que corresponde **a** la propiedad PR_ADDRTYPE ([PidTagAddressType](pidtagaddresstype-canonical-property.md)) del destinatario y al parámetro  _lpszAdrType_ pasado a **IAddrBook::CreateOneOff**.</span><span class="sxs-lookup"><span data-stu-id="63d5c-128">The address type is a null-terminated string that corresponds to the recipient's **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md)) property and to the  _lpszAdrType_ parameter passed to **IAddrBook::CreateOneOff**.</span></span> 
  
<span data-ttu-id="63d5c-129">La dirección de correo electrónico es una cadena terminada en null que corresponde a la propiedad **PR_EMAIL_ADDRESS** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md)) del destinatario y al parámetro  _lpszAddress_ pasado a **IAddrBook::CreateOneOff**.</span><span class="sxs-lookup"><span data-stu-id="63d5c-129">The email address is a null-terminated string that corresponds to the recipient's **PR_EMAIL_ADDRESS** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md)) property and to the  _lpszAddress_ parameter passed to **IAddrBook::CreateOneOff**.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="63d5c-130">No hay relleno en estructuras de identificador de entrada única; los bytes se empaquetan exactamente como se indica anteriormente y la longitud del identificador de entrada no debe incluir bytes más allá del carácter nulo de terminación de la dirección de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="63d5c-130">There is no padding in one-off entry identifier structures; the bytes are packed exactly as indicated above and the entry identifier length should not include any bytes beyond the terminating null character of the email address.</span></span> 
  
<span data-ttu-id="63d5c-131">Los clientes y proveedores de libreta de direcciones que construyen manualmente identificadores de entrada únicos también pueden necesitar generar valores para las propiedades **PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md)) y **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="63d5c-131">Clients and address book providers that manually construct one-off entry identifiers might also need to generate values for the **PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md)) and **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) properties.</span></span> <span data-ttu-id="63d5c-132">La clave de registro es idéntica al identificador de entrada.</span><span class="sxs-lookup"><span data-stu-id="63d5c-132">The record key is identical to the entry identifier.</span></span> <span data-ttu-id="63d5c-133">La clave de búsqueda debe formarse concatenando los campos siguientes en el orden siguiente:</span><span class="sxs-lookup"><span data-stu-id="63d5c-133">The search key should be formed by concatenating the following fields in the following order:</span></span>
  
1. <span data-ttu-id="63d5c-134">El tipo de dirección, convertido en caracteres en mayúsculas.</span><span class="sxs-lookup"><span data-stu-id="63d5c-134">The address type, converted to uppercase characters.</span></span>
    
2. <span data-ttu-id="63d5c-135">Dos puntos (:).</span><span class="sxs-lookup"><span data-stu-id="63d5c-135">A colon (:).</span></span>
    
3. <span data-ttu-id="63d5c-136">La dirección de correo electrónico, convertida en caracteres en mayúsculas.</span><span class="sxs-lookup"><span data-stu-id="63d5c-136">The email address, converted to uppercase characters.</span></span>
    
4. <span data-ttu-id="63d5c-137">Un carácter nulo de terminación.</span><span class="sxs-lookup"><span data-stu-id="63d5c-137">A terminating null character.</span></span>
    
<span data-ttu-id="63d5c-138">No se debe realizar ninguna conversión de juego de caracteres al generar la clave de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="63d5c-138">No character set conversion must be done when generating the search key.</span></span>
  

