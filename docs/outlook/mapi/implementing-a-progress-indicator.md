---
title: Implementar un indicador de progreso
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3a062a88-e87e-4c0c-944e-544a8f080930
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: 767b8723d9a544a31ee5c4bbc1d6186a15387b44
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19817669"
---
# <a name="implementing-a-progress-indicator"></a><span data-ttu-id="8f83f-103">Implementar un indicador de progreso</span><span class="sxs-lookup"><span data-stu-id="8f83f-103">Implementing a Progress Indicator</span></span>

  
  
<span data-ttu-id="8f83f-104">**Hace referencia a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="8f83f-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="8f83f-105">Muchas de las operaciones iniciadas por clientes toman una cantidad considerable de tiempo.</span><span class="sxs-lookup"><span data-stu-id="8f83f-105">Many of the operations initiated by clients take a significant amount of time.</span></span> <span data-ttu-id="8f83f-106">Uno de los parámetros de entrada para estas operaciones potencialmente largas es un puntero a un objeto de progreso: un objeto que implementa el [IMAPIProgress: IUnknown](imapiprogressiunknown.md) interfaz.</span><span class="sxs-lookup"><span data-stu-id="8f83f-106">One of the input parameters to these potentially lengthy operations is a pointer to a progress object — an object that implements the [IMAPIProgress : IUnknown](imapiprogressiunknown.md) interface.</span></span> <span data-ttu-id="8f83f-107">Objetos de progreso controlan el aspecto y la visualización de los indicadores de progreso y se implementan por los clientes y por MAPI.</span><span class="sxs-lookup"><span data-stu-id="8f83f-107">Progress objects control the appearance and display of progress indicators and are implemented by clients and by MAPI.</span></span> <span data-ttu-id="8f83f-108">Puede elegir si se va a implementar un objeto de progreso o no.</span><span class="sxs-lookup"><span data-stu-id="8f83f-108">You can choose whether or not to implement a progress object.</span></span> <span data-ttu-id="8f83f-109">La implementación de MAPI está disponible para los proveedores de servicio que se utilizará si opta por no proporcionar una implementación.</span><span class="sxs-lookup"><span data-stu-id="8f83f-109">The MAPI implementation is available for service providers to use if you elect not to supply an implementation.</span></span> 
  
<span data-ttu-id="8f83f-110">Objetos de progreso trabajan con las siguientes partes de datos:</span><span class="sxs-lookup"><span data-stu-id="8f83f-110">Progress objects work with the following pieces of data:</span></span>
  
- <span data-ttu-id="8f83f-111">Valor mínimo global que, cuando se llama al método [IMAPIProgress::Progress](imapiprogress-progress.md) , debe ser menor o igual que el valor del parámetro _ulValue_ .</span><span class="sxs-lookup"><span data-stu-id="8f83f-111">A global minimum value which, when your [IMAPIProgress::Progress](imapiprogress-progress.md) method is called, should be less than or equal to the value of the  _ulValue_ parameter.</span></span> <span data-ttu-id="8f83f-112">Al principio de la operación, _ulValue_ será igual a este valor mínimo.</span><span class="sxs-lookup"><span data-stu-id="8f83f-112">At the beginning of the operation,  _ulValue_ will be equal to this minimum value.</span></span> 
    
- <span data-ttu-id="8f83f-113">Valor máximo global que, cuando se llama al método **IMAPIProgress::Progress** , debe ser mayor o igual que el parámetro _ulValue_ .</span><span class="sxs-lookup"><span data-stu-id="8f83f-113">A global maximum value which, when your **IMAPIProgress::Progress** method is called, should be greater than or equal to the  _ulValue_ parameter.</span></span> <span data-ttu-id="8f83f-114">Al final de la operación, _ulValue_ será igual a este valor máximo.</span><span class="sxs-lookup"><span data-stu-id="8f83f-114">At the end of the operation,  _ulValue_ will be equal to this maximum value.</span></span> 
    
- <span data-ttu-id="8f83f-115">Indicadores de un valor que indica si el progreso corresponde a una parte superior o disminuir nivel de elemento.</span><span class="sxs-lookup"><span data-stu-id="8f83f-115">A flags value which indicates whether the progress corresponds to a top or lower level item.</span></span>
    
- <span data-ttu-id="8f83f-116">Un valor que indica el nivel de progreso de la operación actual.</span><span class="sxs-lookup"><span data-stu-id="8f83f-116">A value that indicates the current level of progress for the operation.</span></span>
    
- <span data-ttu-id="8f83f-117">El número de los elementos actualmente procesados en relación con el total.</span><span class="sxs-lookup"><span data-stu-id="8f83f-117">The number of the currently processed items relative to the total.</span></span>
    
- <span data-ttu-id="8f83f-118">El número total de elementos que se procesan durante la operación.</span><span class="sxs-lookup"><span data-stu-id="8f83f-118">The total number of items to be processed during the operation.</span></span>
    
<span data-ttu-id="8f83f-119">Los valores máximos y mínimos representan el principio y el final de la operación con formato numérico.</span><span class="sxs-lookup"><span data-stu-id="8f83f-119">The minimum and maximum values represent the beginning and end of the operation in numeric form.</span></span> <span data-ttu-id="8f83f-120">Utilice 1 para el valor mínimo inicial y 1000 para el valor máximo inicial, pasando estos valores a proveedores de servicios en los métodos [IMAPIProgress::GetMin](imapiprogress-getmin.md) y [IMAPIProgress::GetMax](imapiprogress-getmax.md) .</span><span class="sxs-lookup"><span data-stu-id="8f83f-120">Use 1 for the initial minimum value and 1000 for the initial maximum value, passing these values to service providers in the [IMAPIProgress::GetMin](imapiprogress-getmin.md) and [IMAPIProgress::GetMax](imapiprogress-getmax.md) methods.</span></span> <span data-ttu-id="8f83f-121">Proveedores de servicios de restablecen estos valores cuando llama a [IMAPIProgress::SetLimits](imapiprogress-setlimits.md).</span><span class="sxs-lookup"><span data-stu-id="8f83f-121">Service providers reset these values when they call [IMAPIProgress::SetLimits](imapiprogress-setlimits.md).</span></span> 
  
<span data-ttu-id="8f83f-122">El valor de flags se usa por proveedores de servicios para determinar cómo debe establecer los otros valores.</span><span class="sxs-lookup"><span data-stu-id="8f83f-122">The flags value is used by service providers to determine how they should set the other values.</span></span> <span data-ttu-id="8f83f-123">Inicializar el valor de flags en MAPI_TOP_LEVEL y devolver este valor en su implementación de **GetFlags** hasta que restablece en el proveedor de servicios mediante una llamada a **SetLimits**.</span><span class="sxs-lookup"><span data-stu-id="8f83f-123">Initialize the flags value to MAPI_TOP_LEVEL and return this value in your implementation of **GetFlags** until the service provider resets it by calling **SetLimits**.</span></span> 
  
<span data-ttu-id="8f83f-124">En la implementación del método **SetLimits** , guardar copias locales de cada uno de los parámetros: _lpulMin_, _lpulMax_y _lpulFlags_.</span><span class="sxs-lookup"><span data-stu-id="8f83f-124">In your implementation of the **SetLimits** method, save local copies of each of the parameters:  _lpulMin_,  _lpulMax_, and  _lpulFlags_.</span></span> <span data-ttu-id="8f83f-125">Estos valores debe estar disponibles cuando llama a un proveedor de servicios de los métodos **GetMin**, **GetMax**o **GetFlags** .</span><span class="sxs-lookup"><span data-stu-id="8f83f-125">These values should be readily available when a service provider calls your **GetMin**, **GetMax**, or **GetFlags** methods.</span></span> 
  
<span data-ttu-id="8f83f-126">Para actualizar la presentación del indicador de progreso, proveedores de servicios de llamar al método **IMAPIProgress::Progress** .</span><span class="sxs-lookup"><span data-stu-id="8f83f-126">To update the display of the progress indicator, service providers call your **IMAPIProgress::Progress** method.</span></span> <span data-ttu-id="8f83f-127">Hay tres parámetros a este método: un valor, un recuento y un total.</span><span class="sxs-lookup"><span data-stu-id="8f83f-127">There are three parameters to this method: a value, a count, and a total.</span></span> <span data-ttu-id="8f83f-128">Use el primer parámetro, _ulValue_, para mostrar el indicador de progreso.</span><span class="sxs-lookup"><span data-stu-id="8f83f-128">Use the first parameter,  _ulValue_, to display the progress indicator.</span></span> <span data-ttu-id="8f83f-129">El parámetro _ulValue_ es el indicador de progreso y será igual a global _ulMin_ sólo al principio de la operación y es igual a global _ulMax_ sólo al final de la operación.</span><span class="sxs-lookup"><span data-stu-id="8f83f-129">The  _ulValue_ parameter is the progress indicator and will be equal to global  _ulMin_ only at the very beginning of the operation and equal to global  _ulMax_ only at the completion of the operation.</span></span> 
  
<span data-ttu-id="8f83f-130">Utilice el segundo y tercer parámetros, _ulCount_ y _ulTotal_, si está disponible, para mostrar un mensaje opcional, como "5 elementos completadas del 10".</span><span class="sxs-lookup"><span data-stu-id="8f83f-130">Use the second and third parameters,  _ulCount_ and  _ulTotal_, if available, to display an optional message such as "5 items completed out of 10."</span></span> <span data-ttu-id="8f83f-131">Si el segundo y tercer parámetros se establecen en 0, puede elegir si desea o no cambiar visualmente el indicador de progreso.</span><span class="sxs-lookup"><span data-stu-id="8f83f-131">If the second and third parameters are set to 0, you can choose whether or not to visually change the progress indicator.</span></span> <span data-ttu-id="8f83f-132">Algunos proveedores de servicios establecen estos parámetros a ceros para indicar que va a procesar un subobjetos cuyo progreso se supervisa con respecto a un objeto primario.</span><span class="sxs-lookup"><span data-stu-id="8f83f-132">Some service providers set these parameters to zeroes to indicate that they are processing a subobject whose progress is monitored relative to a parent object.</span></span> <span data-ttu-id="8f83f-133">En esta situación, tiene sentido para cambiar la presentación sólo cuando el objeto primario informes de progreso.</span><span class="sxs-lookup"><span data-stu-id="8f83f-133">In this situation, it makes sense to change the display only when the parent object reports progress.</span></span> <span data-ttu-id="8f83f-134">Algunos proveedores de servicios pasan ceros para estos parámetros cada vez.</span><span class="sxs-lookup"><span data-stu-id="8f83f-134">Some service providers pass zeroes for these parameters every time.</span></span> 
  

