---
title: Implementar objetos seguros para subprocesos
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3c911694-b953-4d35-9a3a-22c17cfd79bc
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: 2f8235caceec8b27b2b14fac26d51e9e31ce1024
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/23/2018
ms.locfileid: "22579777"
---
# <a name="implementing-thread-safe-objects"></a><span data-ttu-id="ea624-103">Implementar objetos seguros para subprocesos</span><span class="sxs-lookup"><span data-stu-id="ea624-103">Implementing Thread-Safe Objects</span></span>

  
  
<span data-ttu-id="ea624-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="ea624-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="ea624-105">Con los objetos que se devuelven desde la interfaz llamadas al método directamente, es responsabilidad del proveedor para garantizar la seguridad para subprocesos.</span><span class="sxs-lookup"><span data-stu-id="ea624-105">With objects that are returned from interface method calls directly, it is the provider's responsibility to ensure thread-safety.</span></span> <span data-ttu-id="ea624-106">Con los objetos de devolución de llamada, es responsabilidad de la aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="ea624-106">With callback objects, it is the client application's responsibility.</span></span>
  
<span data-ttu-id="ea624-107">Un cliente puede implementar una devolución de llamada de notificación de subprocesos mediante una llamada a la utilidad MAPI [HrThisThreadAdviseSink](hrthisthreadadvisesink.md).</span><span class="sxs-lookup"><span data-stu-id="ea624-107">A client can implement a thread-safe notification callback by calling the MAPI utility [HrThisThreadAdviseSink](hrthisthreadadvisesink.md).</span></span> <span data-ttu-id="ea624-108">**HrThisThreadAdviseSink** transforma un receptor de notificaciones de que no son seguros para subprocesos en uno de los subprocesos.</span><span class="sxs-lookup"><span data-stu-id="ea624-108">**HrThisThreadAdviseSink** transforms a non-thread-safe advise sink into a thread-safe one.</span></span> <span data-ttu-id="ea624-109">Para realizar devoluciones de llamadas de progreso, no hay ningún dicha utilidad.</span><span class="sxs-lookup"><span data-stu-id="ea624-109">For progress callbacks, there is no such utility.</span></span> <span data-ttu-id="ea624-110">Un cliente puede optar por usar el objeto de progreso de subprocesos MAPI o crear uno de forma manual.</span><span class="sxs-lookup"><span data-stu-id="ea624-110">A client can choose to use the MAPI thread-safe progress object or create one manually.</span></span> 
  
<span data-ttu-id="ea624-111">Un objeto de seguros para subprocesos podría o no también pueden tener en cuenta de subproceso.</span><span class="sxs-lookup"><span data-stu-id="ea624-111">A thread-safe object might or might not also be thread-aware.</span></span> <span data-ttu-id="ea624-112">Un objeto de subproceso mantiene un contexto independiente para cada subproceso que lo está utilizando.</span><span class="sxs-lookup"><span data-stu-id="ea624-112">A thread-aware object maintains a separate context for every thread that is using it.</span></span> <span data-ttu-id="ea624-113">Proveedores de servicios no necesarios para admitir el reconocimiento de subproceso en sus objetos seguros para subprocesos, aunque apoyo del conocimiento de subproceso puede ser útil en algunas situaciones.</span><span class="sxs-lookup"><span data-stu-id="ea624-113">Service providers are not required to support thread-awareness in their thread-safe objects, although supporting thread-awareness can be useful in some situations.</span></span> <span data-ttu-id="ea624-114">Dos tablas MAPI siempre proporcionan su propio contexto por definición.</span><span class="sxs-lookup"><span data-stu-id="ea624-114">Two MAPI tables always provide their own context by definition.</span></span> <span data-ttu-id="ea624-115">Una tabla que se usan en distintos subprocesos no lo hace y no debe proporcionar contexto único.</span><span class="sxs-lookup"><span data-stu-id="ea624-115">One table used on different threads does not and should not provide unique context.</span></span>
  
<span data-ttu-id="ea624-116">Un cliente puede elegir entre recibir notificaciones en el mismo subproceso que se usó para la **MAPIInitialize** llamar, en el mismo subproceso que se usó para la llamada **Advise** , o en un subproceso separado que pertenecen a MAPI.</span><span class="sxs-lookup"><span data-stu-id="ea624-116">A client can choose between receiving notifications on the same thread that was used for the **MAPIInitialize** call, on the same thread that was used for the **Advise** call, or on a separate thread owned by MAPI.</span></span> <span data-ttu-id="ea624-117">Para asegurarse de que reciben notificaciones en el mismo subproceso que se usó para llamar **MAPIInitialize**, un cliente llama [MAPIInitialize](mapiinitialize.md) y pasa cero en el miembro **ulFlags** de la estructura [MAPIINIT_0](mapiinit_0.md) .</span><span class="sxs-lookup"><span data-stu-id="ea624-117">To ensure that notifications arrive on the same thread that was used to call **MAPIInitialize**, a client calls [MAPIInitialize](mapiinitialize.md) and passes zero in the **ulFlags** member of the [MAPIINIT_0](mapiinit_0.md) structure.</span></span> <span data-ttu-id="ea624-118">A continuación, se entregan las notificaciones durante el bucle de mensajes principal.</span><span class="sxs-lookup"><span data-stu-id="ea624-118">Notifications are then delivered during the main message loop.</span></span> 
  
<span data-ttu-id="ea624-119">Para recibir notificaciones en el subproceso de propiedad MAPI, un cliente llama **MAPIInitialize** con el miembro **ulFlags** de la estructura **MAPIINIT_0** establecido en MAPI_MULTITHREAD_NOTIFICATIONS.</span><span class="sxs-lookup"><span data-stu-id="ea624-119">To receive notifications on the MAPI-owned thread, a client calls **MAPIInitialize** with the **ulFlags** member of the **MAPIINIT_0** structure set to MAPI_MULTITHREAD_NOTIFICATIONS.</span></span> <span data-ttu-id="ea624-120">Se realiza la llamada **Advise** con el cliente de aviso objeto receptor en lugar de una versión ajustada.</span><span class="sxs-lookup"><span data-stu-id="ea624-120">The **Advise** call is made with the client's advise sink object rather than a wrapped version.</span></span> 
  
<span data-ttu-id="ea624-121">Para asegurarse de que reciben notificaciones en el mismo subproceso que se usó para llamar **Advise**, un cliente llama a [HrThisThreadAdviseSink](hrthisthreadadvisesink.md) y pasa ajustada recién creada de aviso receptor para **Advise** en lugar de la original receptor de notificaciones.</span><span class="sxs-lookup"><span data-stu-id="ea624-121">To ensure that notifications arrive on the same thread that was used to call **Advise**, a client calls [HrThisThreadAdviseSink](hrthisthreadadvisesink.md) and passes the newly created wrapped advise sink to **Advise** rather than the original advise sink.</span></span> <span data-ttu-id="ea624-122">**MAPIInitialize** puede llamarse con cualquier valor de marca.</span><span class="sxs-lookup"><span data-stu-id="ea624-122">**MAPIInitialize** can be called with either flag value.</span></span> 
  

