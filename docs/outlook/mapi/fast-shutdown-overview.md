---
title: Información general sobre el apagado rápido
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a7830d73-427c-4f8b-86f4-51e040c142c3
description: 'Última modificación: 26 de junio de 2012'
ms.openlocfilehash: 8b8335fb2722e193f0eab1288b8ffdb2aa62df8b
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/23/2018
ms.locfileid: "22577789"
---
# <a name="fast-shutdown-overview"></a><span data-ttu-id="4eff5-103">Información general sobre el apagado rápido</span><span class="sxs-lookup"><span data-stu-id="4eff5-103">Fast Shutdown Overview</span></span>

<span data-ttu-id="4eff5-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="4eff5-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="4eff5-105">Cierre rápido es un mecanismo para que un cliente MAPI iniciar un apagado rápido del proceso de cliente, se notifica a todos los proveedores con los que el cliente tiene una sesión activa de MAPI para guardar los datos y la configuración antes de salir del proceso de cliente.</span><span class="sxs-lookup"><span data-stu-id="4eff5-105">Fast shutdown is a mechanism for a MAPI client to initiate a quick shutdown of the client process, notifying all providers with which the client has an active MAPI session to save data and settings before the client process exits.</span></span> <span data-ttu-id="4eff5-106">En este tema se describe el mecanismo básico de apagado rápido.</span><span class="sxs-lookup"><span data-stu-id="4eff5-106">This topic describes the basic mechanism of fast shutdown.</span></span> 

<span data-ttu-id="4eff5-107">A partir de Microsoft Outlook 2010 y ahora incluyen Microsoft Outlook 2013, el subsistema MAPI proporciona el [IMAPIClientShutdown: IUnknown](imapiclientshutdowniunknown.md) interfaz.</span><span class="sxs-lookup"><span data-stu-id="4eff5-107">Starting in Microsoft Outlook 2010 and now including Microsoft Outlook 2013, the MAPI subsystem provides the [IMAPIClientShutdown : IUnknown](imapiclientshutdowniunknown.md) interface.</span></span> <span data-ttu-id="4eff5-108">Outlook y otros clientes MAPI pueden adoptar apagado rápido como el mecanismo predeterminado para salir del proceso de cliente.</span><span class="sxs-lookup"><span data-stu-id="4eff5-108">Outlook and other MAPI clients can adopt fast shutdown as the default mechanism to exit the client process.</span></span> <span data-ttu-id="4eff5-109">Una configuración de nivel de usuario en el registro de Windows del equipo cliente controla la adopción de apagado rápido para todos los clientes MAPI para ese usuario en ese equipo.</span><span class="sxs-lookup"><span data-stu-id="4eff5-109">A user-level setting in the Windows registry of the client computer controls the adoption of fast shutdown for all MAPI clients for that user on that computer.</span></span> <span data-ttu-id="4eff5-110">Para obtener información detallada acerca de la configuración del registro, vea [Opciones de usuario de apagado Fast](fast-shutdown-user-options.md).</span><span class="sxs-lookup"><span data-stu-id="4eff5-110">For details about the registry settings, see [Fast Shutdown User Options](fast-shutdown-user-options.md).</span></span>
  
<span data-ttu-id="4eff5-111">Si un cliente MAPI debe adoptar apagado rápido, debe utilizar el **IMAPIClientShutdown: IUnknown** interfaz.</span><span class="sxs-lookup"><span data-stu-id="4eff5-111">If a MAPI client needs to adopt fast shutdown, it must use the **IMAPIClientShutdown : IUnknown** interface.</span></span> <span data-ttu-id="4eff5-112">El siguiente es el curso típico de eventos cuando el cliente intenta apagar:</span><span class="sxs-lookup"><span data-stu-id="4eff5-112">The following is the typical course of events when the client attempts to shut down:</span></span> 
  
1. <span data-ttu-id="4eff5-113">El cliente MAPI inicia el apagado llamando al método [IMAPIClientShutdown::QueryFastShutdown](imapiclientshutdown-queryfastshutdown.md) para determinar si el subsistema MAPI admite apagado rápido.</span><span class="sxs-lookup"><span data-stu-id="4eff5-113">The MAPI client initiates the shutdown by calling the [IMAPIClientShutdown::QueryFastShutdown](imapiclientshutdown-queryfastshutdown.md) method to determine whether the MAPI subsystem supports fast shutdown.</span></span> 
    
2. <span data-ttu-id="4eff5-114">El subsistema MAPI responde con la compatibilidad de apagado rápido disponibles a la llamada del cliente **IMAPIClientShutdown::QueryFastShutdown** mediante el procedimiento siguiente:</span><span class="sxs-lookup"><span data-stu-id="4eff5-114">The MAPI subsystem responds with the available fast shutdown support to the client's **IMAPIClientShutdown::QueryFastShutdown** call by using the following procedure:</span></span> 
    
    1. <span data-ttu-id="4eff5-115">El subsistema MAPI llama al método de [IMAPIProviderShutdown::QueryFastShutdown](imapiprovidershutdown-queryfastshutdown.md) para cada proveedor MAPI con la que el proceso de cliente MAPI tiene una sesión MAPI activa, si ha implementado el proveedor de la [IMAPIProviderShutdown: IUnknown](imapiprovidershutdowniunknown.md) interfaz.</span><span class="sxs-lookup"><span data-stu-id="4eff5-115">The MAPI subsystem calls the [IMAPIProviderShutdown::QueryFastShutdown](imapiprovidershutdown-queryfastshutdown.md) method for each MAPI provider with which the MAPI client process has an active MAPI session, if the provider has implemented the [IMAPIProviderShutdown : IUnknown](imapiprovidershutdowniunknown.md) interface.</span></span> 
        
       > [!NOTE]
       >  <span data-ttu-id="4eff5-116">El subsistema MAPI siempre las consultas y se lo comunica proveedores MAPI a través de la **IMAPIProviderShutdown: IUnknown** interfaz dentro de cada sesión MAPI en el orden siguiente:</span><span class="sxs-lookup"><span data-stu-id="4eff5-116">The MAPI subsystem always queries and notifies MAPI providers through the **IMAPIProviderShutdown : IUnknown** interface within each MAPI session in the following order:</span></span>
       > 1. <span data-ttu-id="4eff5-117">Proveedores de transporte</span><span class="sxs-lookup"><span data-stu-id="4eff5-117">Transport providers</span></span>
       > 2. <span data-ttu-id="4eff5-118">Proveedores de la libreta de direcciones</span><span class="sxs-lookup"><span data-stu-id="4eff5-118">Address book providers</span></span>
       > 3. <span data-ttu-id="4eff5-119">Proveedores de almacén</span><span class="sxs-lookup"><span data-stu-id="4eff5-119">Store providers</span></span> 
    
    2. <span data-ttu-id="4eff5-120">Dependiendo de la configuración del registro de apagado rápido para ese usuario en el equipo cliente, el subsistema MAPI especifica que el código de retorno apropiado para **IMAPIClientShutdown::QueryFastShutdown**.</span><span class="sxs-lookup"><span data-stu-id="4eff5-120">Depending on the fast shutdown registry setting for that user on the client computer, the MAPI subsystem specifies the appropriate return code to **IMAPIClientShutdown::QueryFastShutdown**.</span></span> <span data-ttu-id="4eff5-121">El código de retorno es S_OK o MAPI_E_NO_SUPPORT.</span><span class="sxs-lookup"><span data-stu-id="4eff5-121">The return code is either S_OK or MAPI_E_NO_SUPPORT.</span></span>
        
    3. <span data-ttu-id="4eff5-122">El cliente MAPI llama al método de [IMAPIClientShutdown::NotifyProcessShutdown](imapiclientshutdown-notifyprocessshutdown.md) para indicar al subsistema MAPI la intención de apagado.</span><span class="sxs-lookup"><span data-stu-id="4eff5-122">The MAPI client calls the [IMAPIClientShutdown::NotifyProcessShutdown](imapiclientshutdown-notifyprocessshutdown.md) method to indicate to the MAPI subsystem the intention to shut down.</span></span> 
        
    4. <span data-ttu-id="4eff5-123">Indica el subsistema MAPI para cada proveedor MAPI cargado que se cerrará el cliente MAPI.</span><span class="sxs-lookup"><span data-stu-id="4eff5-123">The MAPI subsystem indicates to each loaded MAPI provider that the MAPI client will shut down.</span></span> <span data-ttu-id="4eff5-124">Para aquellos proveedores que han implementado el **IMAPIProviderShutdown: IUnknown** interfaz, el subsistema MAPI llama al método [IMAPIProviderShutdown::NotifyProcessShutdown](imapiprovidershutdown-notifyprocessshutdown.md) correspondiente.</span><span class="sxs-lookup"><span data-stu-id="4eff5-124">For those providers that have implemented the **IMAPIProviderShutdown : IUnknown** interface, the MAPI subsystem calls the corresponding [IMAPIProviderShutdown::NotifyProcessShutdown](imapiprovidershutdown-notifyprocessshutdown.md) method.</span></span> 
        
    5. <span data-ttu-id="4eff5-125">El cliente MAPI llama al método de [IMAPIClientShutdown::DoFastShutdown](imapiclientshutdown-dofastshutdown.md) para indicar al subsistema MAPI que el proceso de cliente está saliendo inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="4eff5-125">The MAPI client calls the [IMAPIClientShutdown::DoFastShutdown](imapiclientshutdown-dofastshutdown.md) method to indicate to the MAPI subsystem that the client process is exiting immediately.</span></span> 
        
    6. <span data-ttu-id="4eff5-126">El subsistema MAPI indica a cada proveedor MAPI cargado que está saliendo el proceso de cliente MAPI.</span><span class="sxs-lookup"><span data-stu-id="4eff5-126">The MAPI subsystem indicates to each loaded MAPI provider that the MAPI client process is exiting.</span></span> <span data-ttu-id="4eff5-127">Para aquellos proveedores que han implementado el **IMAPIProviderShutdown: IUnknown** interfaz, el subsistema MAPI llama al método [IMAPIProviderShutdown::DoFastShutdown](imapiprovidershutdown-dofastshutdown.md) correspondiente.</span><span class="sxs-lookup"><span data-stu-id="4eff5-127">For those providers that have implemented the **IMAPIProviderShutdown : IUnknown** interface, the MAPI subsystem calls the corresponding [IMAPIProviderShutdown::DoFastShutdown](imapiprovidershutdown-dofastshutdown.md) method.</span></span> <span data-ttu-id="4eff5-128">En este momento, estos proveedores MAPI deben comprobar que todas las acciones necesarias, como el almacenamiento de datos y la configuración, son completadas en la preparación para el cliente de MAPI desconectar todas las referencias y salir inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="4eff5-128">At this point, these MAPI providers should verify that all necessary actions, such as saving data and settings, are complete in preparation for the MAPI client to immediately disconnect all references and exit.</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="4eff5-129">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="4eff5-129">See also</span></span>

- [<span data-ttu-id="4eff5-130">Cierre del cliente de MAPI</span><span class="sxs-lookup"><span data-stu-id="4eff5-130">Client Shutdown in MAPI</span></span>](client-shutdown-in-mapi.md)
- [<span data-ttu-id="4eff5-131">Opciones de usuario de apagado rápido</span><span class="sxs-lookup"><span data-stu-id="4eff5-131">Fast Shutdown User Options</span></span>](fast-shutdown-user-options.md)
- [<span data-ttu-id="4eff5-132">Procedimientos recomendados para el apagado rápido</span><span class="sxs-lookup"><span data-stu-id="4eff5-132">Best Practices for Fast Shutdown</span></span>](best-practices-for-fast-shutdown.md)

