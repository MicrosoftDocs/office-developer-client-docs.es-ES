---
title: Perfiles de MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 493c87a4-317d-47ec-850b-342cac59594b
description: 'Última modificación: 09 de marzo de 2015'
ms.openlocfilehash: 7f241fde8aedeae9debc66f728ee21c1c6bed6fb
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19818171"
---
# <a name="mapi-profiles"></a><span data-ttu-id="635b9-103">Perfiles de MAPI</span><span class="sxs-lookup"><span data-stu-id="635b9-103">MAPI Profiles</span></span>

  
  
<span data-ttu-id="635b9-104">**Hace referencia a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="635b9-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="635b9-105">Un perfil de almacena información acerca de los proveedores de servicios y los servicios de mensaje que se instalan en un equipo.</span><span class="sxs-lookup"><span data-stu-id="635b9-105">A profile stores information about service providers and message services that are installed on a computer.</span></span> <span data-ttu-id="635b9-106">Para cada sesión, un cliente en tiempo de inicio de sesión selecciona un perfil que describe los servicios y los proveedores que se va a utilizar.</span><span class="sxs-lookup"><span data-stu-id="635b9-106">For every session, a client at logon time selects one profile that describes the providers and services to be used.</span></span> <span data-ttu-id="635b9-107">Puede elegir entre una colección de los perfiles de un cliente y, si así lo desea, establecer uno como el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="635b9-107">A client can choose from a collection of profiles and, if desired, establish one as the default.</span></span> <span data-ttu-id="635b9-108">El perfil predeterminado es el perfil que se selecciona automáticamente cuando un cliente inicia una sesión y no ha especificado explícitamente un perfil.</span><span class="sxs-lookup"><span data-stu-id="635b9-108">The default profile is the profile that is selected automatically when a client starts a session and has not explicitly specified a profile.</span></span>
  
<span data-ttu-id="635b9-109">También en estos temas, encontrará una explicación de la caché de alias, que se almacena en una secuencia binaria.</span><span class="sxs-lookup"><span data-stu-id="635b9-109">Also in these topics, you will find a discussion of the nickname cache, which is stored in a binary stream.</span></span>
  
- [<span data-ttu-id="635b9-110">Caché de sobrenombre</span><span class="sxs-lookup"><span data-stu-id="635b9-110">Nickname cache</span></span>](nickname-cache.md)
    
- [<span data-ttu-id="635b9-111">Secuencia de Autocompletar</span><span class="sxs-lookup"><span data-stu-id="635b9-111">Autocomplete Stream</span></span>](autocomplete-stream.md)
    
- [<span data-ttu-id="635b9-112">Análisis de archivos binarios</span><span class="sxs-lookup"><span data-stu-id="635b9-112">Binary File Parsing</span></span>](http://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)
    
## <a name="profile-sections"></a><span data-ttu-id="635b9-113">Secciones del perfil</span><span class="sxs-lookup"><span data-stu-id="635b9-113">Profile Sections</span></span>

<span data-ttu-id="635b9-114">Los perfiles se dividen en las secciones que los clientes y proveedores de servicios de acceso para mostrar las propiedades de perfil a los usuarios o para realizar cambios de configuración.</span><span class="sxs-lookup"><span data-stu-id="635b9-114">Profiles are divided into sections that clients and service providers access to display profile properties to users or to make configuration changes.</span></span> <span data-ttu-id="635b9-115">Una sección de perfil es un objeto MAPI que implementa la interfaz **IProfSect** , una interfaz que se deriva de **IMAPIProp** y no tiene ningún método adicional.</span><span class="sxs-lookup"><span data-stu-id="635b9-115">A profile section is a MAPI object that implements the **IProfSect** interface, an interface that derives from **IMAPIProp** and has no additional methods.</span></span> <span data-ttu-id="635b9-116">Para obtener más información, vea [IProfSect: IMAPIProp](iprofsectimapiprop.md).</span><span class="sxs-lookup"><span data-stu-id="635b9-116">For more information, see [IProfSect : IMAPIProp](iprofsectimapiprop.md).</span></span> <span data-ttu-id="635b9-117">Su único propósito es manipular las propiedades de una sección de perfil.</span><span class="sxs-lookup"><span data-stu-id="635b9-117">Its only purpose is to manipulate the properties of a profile section.</span></span> <span data-ttu-id="635b9-118">Para recuperar un puntero **IProfSect** a una sección de perfil determinada, clientes y proveedores de servicios de llamar a los métodos siguientes.</span><span class="sxs-lookup"><span data-stu-id="635b9-118">To retrieve an **IProfSect** pointer to a particular profile section, clients and service providers call the following methods.</span></span> 
  
|||
|:-----|:-----|
|<span data-ttu-id="635b9-119">Pueden llamar a los clientes:</span><span class="sxs-lookup"><span data-stu-id="635b9-119">Clients can call:</span></span>  <br/> |[<span data-ttu-id="635b9-120">IMAPISession::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="635b9-120">IMAPISession::OpenProfileSection</span></span>](imapisession-openprofilesection.md) <br/> |
|<span data-ttu-id="635b9-121">Pueden llamar a los proveedores de servicios:</span><span class="sxs-lookup"><span data-stu-id="635b9-121">Service providers can call:</span></span>  <br/> |[<span data-ttu-id="635b9-122">IMAPISupport::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="635b9-122">IMAPISupport::OpenProfileSection</span></span>](imapisupport-openprofilesection.md) <br/> |
|<span data-ttu-id="635b9-123">Pueden llamar a los clientes o proveedores:</span><span class="sxs-lookup"><span data-stu-id="635b9-123">Either clients or providers can call:</span></span>  <br/> |[<span data-ttu-id="635b9-124">IProviderAdmin::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="635b9-124">IProviderAdmin::OpenProfileSection</span></span>](iprovideradmin-openprofilesection.md) <br/> |
   
<span data-ttu-id="635b9-125">Los perfiles se organizan jerárquicamente mucho al igual que el archivo MAPISVC. Archivo INF.</span><span class="sxs-lookup"><span data-stu-id="635b9-125">Profiles are organized hierarchically much like the MAPISVC.INF file.</span></span> <span data-ttu-id="635b9-126">En la parte superior de la jerarquía, hay secciones de perfil que contienen información relevante para el perfil.</span><span class="sxs-lookup"><span data-stu-id="635b9-126">At the top of the hierarchy, there are profile sections that contain information relevant to the profile.</span></span> <span data-ttu-id="635b9-127">El nivel intermedio incluye secciones que contienen información acerca de un servicio de mensaje concreto y el nivel inferior incluye secciones que contienen información acerca de uno de los proveedores de servicios en un servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="635b9-127">The middle level includes sections that contain information about a particular message service and the lower level includes sections that contain information about one of the service providers in a message service.</span></span> 
  
<span data-ttu-id="635b9-128">Cada perfil tiene varias propiedades necesarias que se almacenan en una o varias de las secciones del perfil.</span><span class="sxs-lookup"><span data-stu-id="635b9-128">Every profile has several required properties that are stored in one or more of the sections of the profile.</span></span> <span data-ttu-id="635b9-129">Por ejemplo, cada perfil tiene las propiedades de **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) y **PR_PROFILE_NAME** ([PidTagProfileName](pidtagprofilename-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="635b9-129">For example, every profile has the **PR_PROFILE_NAME** ([PidTagProfileName](pidtagprofilename-canonical-property.md)) and **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) properties.</span></span> <span data-ttu-id="635b9-130">Clave de búsqueda de un perfil se establece en el valor que se define en MAPIGUID. H como MUID_PROFILE_INSTANCE y siempre se garantiza que es único entre todos los perfiles.</span><span class="sxs-lookup"><span data-stu-id="635b9-130">A profile's search key is set to the value defined in MAPIGUID.H as MUID_PROFILE_INSTANCE and is always guaranteed to be unique among all profiles.</span></span> <span data-ttu-id="635b9-131">Aunque dos perfiles pueden tener el mismo nombre, no pueden tener la misma clave de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="635b9-131">Although two profiles can have the same name, they cannot have the same search key.</span></span> <span data-ttu-id="635b9-132">Las claves de búsqueda deben tratarse como datos binarios en lugar de datos de ningún tipo concreto.</span><span class="sxs-lookup"><span data-stu-id="635b9-132">Search keys should be treated as binary data instead of data of any particular type.</span></span>
  
<span data-ttu-id="635b9-133">Los proveedores de almacén de mensajes se requieren para incluir propiedad de **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) de su almacén de mensajes en las secciones de perfil para el perfil y proveedor de almacén para su mensaje y mantener estas entradas sincronizadas.</span><span class="sxs-lookup"><span data-stu-id="635b9-133">Message store providers are required to include their message store's **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) property in the profile sections for the profile and for their message store provider and to keep these entries synchronized.</span></span> <span data-ttu-id="635b9-134">Cuando se crea un almacén de mensajes, el proveedor establece **PR_DISPLAY_NAME** según el valor almacenado en estas secciones del perfil.</span><span class="sxs-lookup"><span data-stu-id="635b9-134">When a message store is created, the provider sets **PR_DISPLAY_NAME** based on the value stored in these profile sections.</span></span> 
  
<span data-ttu-id="635b9-135">Hay dos diferencias principales entre las secciones de perfil y otros objetos que heredan de **IMAPIProp**:</span><span class="sxs-lookup"><span data-stu-id="635b9-135">There are two major differences between profile sections and other objects that inherit from **IMAPIProp**:</span></span> 
  
- <span data-ttu-id="635b9-136">Las secciones del perfil no admiten transacciones.</span><span class="sxs-lookup"><span data-stu-id="635b9-136">Profile sections do not support transactions.</span></span>
    
- <span data-ttu-id="635b9-137">Las secciones del perfil no admiten las propiedades con nombre, devolver MAPI_E_NO_SUPPORT de sus implementaciones de **IMAPIProp::GetIDsFromNames** y **IMAPIProp::GetNamesFromIDs** .</span><span class="sxs-lookup"><span data-stu-id="635b9-137">Profile sections do not support named properties, returning MAPI_E_NO_SUPPORT from their **IMAPIProp::GetIDsFromNames** and **IMAPIProp::GetNamesFromIDs** implementations.</span></span> <span data-ttu-id="635b9-138">Para obtener más información, vea [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) y [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md).</span><span class="sxs-lookup"><span data-stu-id="635b9-138">For more information, see [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) and [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md).</span></span>
    
<span data-ttu-id="635b9-139">Debido a que las secciones del perfil no admiten transacciones, todos los cambios realizados con llamadas a **IMAPIProp::CopyProps**, **CopyTo**o **SetProps** surte efecto inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="635b9-139">Because profile sections do not support transactions, any changes made with calls to **IMAPIProp::CopyProps**, **CopyTo**, or **SetProps** immediately take effect.</span></span> <span data-ttu-id="635b9-140">Para obtener más información, vea [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span><span class="sxs-lookup"><span data-stu-id="635b9-140">For more information, see [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span> <span data-ttu-id="635b9-141">Los clientes y proveedores de servicios pueden llamar (método **IMAPIProp::SaveChanges** ) de una sección de perfil y se realizará correctamente, pero no afecta a los datos de la sección de perfil.</span><span class="sxs-lookup"><span data-stu-id="635b9-141">Clients and service providers can call a profile section's **IMAPIProp::SaveChanges** method and it will succeed, but it does not affect the profile section data.</span></span> <span data-ttu-id="635b9-142">Para obtener más información, vea [IMAPIProp::SaveChanges](imapiprop-savechanges.md).</span><span class="sxs-lookup"><span data-stu-id="635b9-142">For more information, see [IMAPIProp::SaveChanges](imapiprop-savechanges.md).</span></span> <span data-ttu-id="635b9-143">Necesidad de cambios se producen inmediatamente puede afectar a cómo los proveedores de servicios de implementan las hojas de propiedades que los clientes usan para mostrar las propiedades de perfil a los usuarios.</span><span class="sxs-lookup"><span data-stu-id="635b9-143">Having changes occur immediately can affect how service providers implement the property sheets that clients use to display profile properties to users.</span></span> <span data-ttu-id="635b9-144">Proveedores de servicios que desean que los usuarios puedan posponer o deshacer los cambios deben implementar sus hojas de propiedades con copias de las secciones de perfil en lugar de las secciones reales.</span><span class="sxs-lookup"><span data-stu-id="635b9-144">Service providers that want users to be able to postpone or undo changes must implement their property sheets with copies of profile sections instead of the real sections.</span></span> <span data-ttu-id="635b9-145">Mediante el uso de copias, los usuarios pueden realizar cambios y, a continuación, más adelante cancelar los cambios, dejando intactos las secciones de perfil original.</span><span class="sxs-lookup"><span data-stu-id="635b9-145">By using copies, users can make changes and then later cancel those changes, leaving the original profile sections untouched.</span></span> 
  
<span data-ttu-id="635b9-146">El orden en el que aparece la información en un perfil afecta a cómo MAPI configura los recursos y realiza las asignaciones en una sesión.</span><span class="sxs-lookup"><span data-stu-id="635b9-146">The order in which information appears in a profile affects how MAPI configures resources and makes assignments in a session.</span></span> <span data-ttu-id="635b9-147">Las siguientes asignaciones se ven afectadas por orden de perfiles:</span><span class="sxs-lookup"><span data-stu-id="635b9-147">The following assignments are affected by profile order:</span></span>
  
- <span data-ttu-id="635b9-148">Almacén de mensajes predeterminado</span><span class="sxs-lookup"><span data-stu-id="635b9-148">Default message store</span></span>
    
- <span data-ttu-id="635b9-149">Libreta personal de direcciones</span><span class="sxs-lookup"><span data-stu-id="635b9-149">Personal address book</span></span>
    
- <span data-ttu-id="635b9-150">Ruta de acceso de búsqueda de almacén de mensaje predeterminada</span><span class="sxs-lookup"><span data-stu-id="635b9-150">Default message store search path</span></span>
    
- <span data-ttu-id="635b9-151">Valor predeterminado de ruta de acceso de búsqueda de la libreta de direcciones</span><span class="sxs-lookup"><span data-stu-id="635b9-151">Default address book search path</span></span>
    
- <span data-ttu-id="635b9-152">Orden del proveedor de transporte</span><span class="sxs-lookup"><span data-stu-id="635b9-152">Transport provider order</span></span>
    
<span data-ttu-id="635b9-153">MAPI establece el almacén de mensajes predeterminado a ser el primer almacén de mensajes en el perfil que tiene la marca STATUS_DEFAULT_STORE establecer en su propiedad **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)), que indica que puede ser el almacén predeterminado.</span><span class="sxs-lookup"><span data-stu-id="635b9-153">MAPI sets the default message store to be the first message store in the profile that has the STATUS_DEFAULT_STORE flag set in its **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) property, which indicates that it can be the default store.</span></span> <span data-ttu-id="635b9-154">Los clientes pueden invalidar esta configuración mediante una llamada a **IMAPISession::SetDefaultStore**.</span><span class="sxs-lookup"><span data-stu-id="635b9-154">Clients can override this setting by calling **IMAPISession::SetDefaultStore**.</span></span> <span data-ttu-id="635b9-155">Para obtener más información, vea [IMAPISession::SetDefaultStore](imapisession-setdefaultstore.md).</span><span class="sxs-lookup"><span data-stu-id="635b9-155">For more information, see [IMAPISession::SetDefaultStore](imapisession-setdefaultstore.md).</span></span>
  
<span data-ttu-id="635b9-156">MAPI crea un pedido de transporte para el tratamiento de mensajes entrantes y salientes.</span><span class="sxs-lookup"><span data-stu-id="635b9-156">MAPI creates a transport order for handling outgoing and incoming messages.</span></span> <span data-ttu-id="635b9-157">Cuando más de un proveedor de transporte se ha registrado para un mensaje de un tipo determinado, MAPI usa este orden para determinar qué proveedor debe controlar el mensaje.</span><span class="sxs-lookup"><span data-stu-id="635b9-157">When more than one transport provider has registered for a message of a particular type, MAPI uses this order to determine which provider should handle the message.</span></span> <span data-ttu-id="635b9-158">MAPI establece el orden de transporte que será el orden en el que se colocan el transporte proveedores se han agregado al perfil con una excepción: los transportes de establecer la marca STATUS_XP_PREFER_LAST en su propiedad **PR_RESOURCE_FLAGS** por última vez en el orden.</span><span class="sxs-lookup"><span data-stu-id="635b9-158">MAPI sets the transport order to be the order in which the transport providers were added to the profile with one exception--the transports that set the STATUS_XP_PREFER_LAST flag in their **PR_RESOURCE_FLAGS** property are positioned last in the order.</span></span> <span data-ttu-id="635b9-159">Los clientes pueden establecer el orden de transporte mediante una llamada a **IMsgServiceAdmin::MsgServiceTransportOrder**.</span><span class="sxs-lookup"><span data-stu-id="635b9-159">Clients can set the transport order by calling **IMsgServiceAdmin::MsgServiceTransportOrder**.</span></span> <span data-ttu-id="635b9-160">Para obtener más información, vea [IMsgServiceAdmin::MsgServiceTransportOrder](imsgserviceadmin-msgservicetransportorder.md).</span><span class="sxs-lookup"><span data-stu-id="635b9-160">For more information, see [IMsgServiceAdmin::MsgServiceTransportOrder](imsgserviceadmin-msgservicetransportorder.md).</span></span>
  
<span data-ttu-id="635b9-161">En ocasiones, es posible que entre en conflicto estas instrucciones para la ordenación de los proveedores de servicios y los servicios de mensajes.</span><span class="sxs-lookup"><span data-stu-id="635b9-161">These guidelines for ordering service providers and message services might sometimes conflict.</span></span> <span data-ttu-id="635b9-162">Si hay un conflicto, el código debe resolver el conflicto.</span><span class="sxs-lookup"><span data-stu-id="635b9-162">If there is a conflict, your code should resolve the conflict.</span></span> <span data-ttu-id="635b9-163">Puede usar el programa de Panel de Control de correo para inspeccionar un perfil que haya creado para determinar si se han configurado los proveedores como se esperaba.</span><span class="sxs-lookup"><span data-stu-id="635b9-163">You can use the Mail Control Panel program to inspect a profile that you have created to determine whether the providers have been configured as expected.</span></span>
  

