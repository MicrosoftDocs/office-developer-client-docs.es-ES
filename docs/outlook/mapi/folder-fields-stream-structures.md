---
title: Estructuras de la secuencia de campos de carpeta
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: edbc9e6c-008c-4c13-9a0c-cb47ac0f3686
description: 'Última modificación: 09 de marzo de 2015'
ms.openlocfilehash: 96051bd2b62fd7c0e908a1018aac0225e44986be
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/23/2019
ms.locfileid: "32336893"
---
# <a name="folder-fields-stream-structures"></a><span data-ttu-id="3159c-103">Estructuras de la secuencia de campos de carpeta</span><span class="sxs-lookup"><span data-stu-id="3159c-103">Folder Fields Stream Structures</span></span>

<span data-ttu-id="3159c-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="3159c-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="3159c-105">La propiedad [PidTagUserFields](pidtaguserfields-canonical-property.md) de un mensaje contiene una secuencia binaria, FolderUserFields, que contiene las definiciones de los campos definidos por el usuario de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="3159c-105">A message's [PidTagUserFields](pidtaguserfields-canonical-property.md) property contains a binary stream, FolderUserFields, which contains the folder user-defined field definitions.</span></span> <span data-ttu-id="3159c-106">En este tema se describen las estructuras de secuencia para las definiciones de campos definidos por el usuario de carpeta.</span><span class="sxs-lookup"><span data-stu-id="3159c-106">This topic describes the stream structures for folder user-defined field definitions.</span></span> 

<span data-ttu-id="3159c-107">Una estructura de secuencia FolderUserFields consiste en una estructura FolderUserFieldsA o FolderUserFieldsA seguida de una estructura FolderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="3159c-107">A FolderUserFields stream structure consists of either a FolderUserFieldsA structure or a FolderUserFieldsA structure followed by a FolderUserFieldsW structure.</span></span>
  
<span data-ttu-id="3159c-108">Los elementos de datos de esta secuencia se almacenan inmediatamente a continuación de otros en el siguiente orden especificado:</span><span class="sxs-lookup"><span data-stu-id="3159c-108">Data elements in this stream are stored immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="3159c-109">**FolderUserFieldsAnsi**: una estructura de secuencia FolderUserFieldsA.</span><span class="sxs-lookup"><span data-stu-id="3159c-109">**FolderUserFieldsAnsi**: A FolderUserFieldsA stream structure.</span></span>
    
- <span data-ttu-id="3159c-110">**FolderUserFieldsUnicode** (opcional): una estructura de secuencia FolderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="3159c-110">**FolderUserFieldsUnicode** (optional): A FolderUserFieldsW stream structure.</span></span>
    
<span data-ttu-id="3159c-111">La presencia de FolderUserFieldsUnicode se detecta por la longitud total del FolderUserFields mayor que la longitud de FolderUserFieldsAnsi.</span><span class="sxs-lookup"><span data-stu-id="3159c-111">The presence of FolderUserFieldsUnicode is detected by the total length of the FolderUserFields being greater than the length of FolderUserFieldsAnsi.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="3159c-112">FolderUserFieldsAnsi se usa para la compatibilidad con versiones anteriores, no Unicode, de clientes MAPI, por lo que, si FolderUserFieldsUnicode está presente, se omite el contenido de FolderUserFieldsAnsi.</span><span class="sxs-lookup"><span data-stu-id="3159c-112">FolderUserFieldsAnsi is used for compatibility with older, non-Unicode, versions of MAPI clients, therefore if FolderUserFieldsUnicode is present, the contents of FolderUserFieldsAnsi is ignored.</span></span> <span data-ttu-id="3159c-113">Para evitar una posible pérdida de datos en la conversión ANSI, al crear una secuencia FolderUserFields siempre incluya la parte FolderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="3159c-113">To avoid possible data loss in ANSI conversion, when creating a FolderUserFields stream always include the FolderUserFieldsW part.</span></span> 
  
## <a name="folderuserfieldsa-stream-structure"></a><span data-ttu-id="3159c-114">Estructura de la secuencia FolderUserFieldsA</span><span class="sxs-lookup"><span data-stu-id="3159c-114">FolderUserFieldsA Stream Structure</span></span>

<span data-ttu-id="3159c-115">Una estructura de secuencia FolderUserFieldsA es una matriz de estructuras de secuencia FolderFieldDefinitionA que contiene definiciones para todos los campos definidos por el usuario en una carpeta de Outlook, a menos que se reemplace por la parte FolderUserFieldsW de la estructura FolderUserFields.</span><span class="sxs-lookup"><span data-stu-id="3159c-115">A FolderUserFieldsA stream structure is an array of FolderFieldDefinitionA stream structures that contain definitions for all user-defined fields in an Outlook folder, unless overridden by the FolderUserFieldsW part of the FolderUserFields structure.</span></span>
  
<span data-ttu-id="3159c-116">Los elementos de datos de esta secuencia se almacenan en el orden de bytes Little-endian, inmediatamente a continuación entre sí en el siguiente orden especificado:</span><span class="sxs-lookup"><span data-stu-id="3159c-116">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="3159c-117">**FieldDefinitionCount**: DWORD (4 bytes), el número de definiciones de campo en esta secuencia.</span><span class="sxs-lookup"><span data-stu-id="3159c-117">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="3159c-118">Este es el número de elementos de la matriz **FieldDefinitions** .</span><span class="sxs-lookup"><span data-stu-id="3159c-118">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="3159c-119">**FieldDefinitions**: una matriz de estructuras de secuencia FolderFieldDefinitionA.</span><span class="sxs-lookup"><span data-stu-id="3159c-119">**FieldDefinitions**: An array of FolderFieldDefinitionA stream structures.</span></span> <span data-ttu-id="3159c-120">El recuento de esta matriz es igual al elemento de datos **FieldDefinitionCount** .</span><span class="sxs-lookup"><span data-stu-id="3159c-120">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="3159c-121">A menos que la parte FolderUserFieldsW de la estructura FolderUserFields Reemplace esta FolderUserFieldsA, la matriz **FieldDefinitions** debe estar "terminada en NULL" al hacer que el último campo común. FieldType del elemento FolderFieldDefinitionA sea igual a a ftNull.</span><span class="sxs-lookup"><span data-stu-id="3159c-121">Unless this FolderUserFieldsA is overridden by the FolderUserFieldsW part of the FolderUserFields structure, the **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionA element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderuserfieldsw-stream-structure"></a><span data-ttu-id="3159c-122">Estructura de la secuencia FolderUserFieldsW</span><span class="sxs-lookup"><span data-stu-id="3159c-122">FolderUserFieldsW Stream Structure</span></span>

<span data-ttu-id="3159c-123">Una estructura de secuencia FolderUserFieldsW es una matriz de estructuras de secuencia FolderFieldDefinitionW que contienen definiciones para todos los campos definidos por el usuario en una carpeta de Outlook.</span><span class="sxs-lookup"><span data-stu-id="3159c-123">A FolderUserFieldsW stream structure is an array of FolderFieldDefinitionW stream structures that contain definitions for all user-defined fields in an Outlook folder.</span></span>
  
<span data-ttu-id="3159c-124">Los elementos de datos de esta secuencia se almacenan en el orden de bytes Little-endian, inmediatamente a continuación entre sí en el siguiente orden especificado:</span><span class="sxs-lookup"><span data-stu-id="3159c-124">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="3159c-125">**FieldDefinitionCount**: DWORD (4 bytes), el número de definiciones de campo en esta secuencia.</span><span class="sxs-lookup"><span data-stu-id="3159c-125">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="3159c-126">Este es el número de elementos de la matriz **FieldDefinitions** .</span><span class="sxs-lookup"><span data-stu-id="3159c-126">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="3159c-127">**FieldDefinitions**: una matriz de estructuras de secuencia FolderFieldDefinitionW.</span><span class="sxs-lookup"><span data-stu-id="3159c-127">**FieldDefinitions**: An array of FolderFieldDefinitionW stream structures.</span></span> <span data-ttu-id="3159c-128">El recuento de esta matriz es igual al elemento de datos **FieldDefinitionCount** .</span><span class="sxs-lookup"><span data-stu-id="3159c-128">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="3159c-129">La matriz **FieldDefinitions** debe estar "terminada en NULL" haciendo que el campo Common. FieldType del último elemento de FolderFieldDefinitionW sea igual a ftNull.</span><span class="sxs-lookup"><span data-stu-id="3159c-129">The **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionW element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderfielddefinitiona-stream-structure"></a><span data-ttu-id="3159c-130">Estructura de la secuencia FolderFieldDefinitionA</span><span class="sxs-lookup"><span data-stu-id="3159c-130">FolderFieldDefinitionA Stream Structure</span></span>

<span data-ttu-id="3159c-131">Una estructura de secuencia FolderFieldDefinitionA contiene una definición de un campo definido por el usuario con el nombre de campo almacenado en ANSI.</span><span class="sxs-lookup"><span data-stu-id="3159c-131">A FolderFieldDefinitionA stream structure contains a definition of a user-defined field with the field name stored in ANSI.</span></span>
  
<span data-ttu-id="3159c-132">Los elementos de datos de esta secuencia se almacenan en el orden de bytes Little-endian, inmediatamente a continuación entre sí en el siguiente orden especificado:</span><span class="sxs-lookup"><span data-stu-id="3159c-132">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="3159c-133">**FieldType**: FldType (4 bytes), el tipo de este campo.</span><span class="sxs-lookup"><span data-stu-id="3159c-133">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="3159c-134">**FieldNameLength**: Word (2 bytes), el número de elementos de la matriz **FieldName** .</span><span class="sxs-lookup"><span data-stu-id="3159c-134">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="3159c-135">**FieldName**: una matriz de Char.</span><span class="sxs-lookup"><span data-stu-id="3159c-135">**FieldName**: An array of CHAR.</span></span> <span data-ttu-id="3159c-136">Esta es la representación de la página de códigos ANSI CP_ACP del nombre del campo.</span><span class="sxs-lookup"><span data-stu-id="3159c-136">This is the ANSI CP_ACP codepage representation of the field name.</span></span> <span data-ttu-id="3159c-137">El recuento de esta matriz es igual a **FieldNameLength**.</span><span class="sxs-lookup"><span data-stu-id="3159c-137">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="3159c-138">El nombre del campo debe cumplir con las restricciones del parámetro name tal como se especifica en el método [UserProperties. Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) .</span><span class="sxs-lookup"><span data-stu-id="3159c-138">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="3159c-139">Por motivos de compatibilidad heredada, es posible que Outlook pueda controlar algunos valores de **FieldName** que no cumplen estas restricciones, pero estos casos no se tratan en este tema.</span><span class="sxs-lookup"><span data-stu-id="3159c-139">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="3159c-140">**Common**: una estructura de secuencia FolderFieldDefinitionCommon.</span><span class="sxs-lookup"><span data-stu-id="3159c-140">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="folderfielddefinitionw-stream-structure"></a><span data-ttu-id="3159c-141">Estructura de la secuencia FolderFieldDefinitionW</span><span class="sxs-lookup"><span data-stu-id="3159c-141">FolderFieldDefinitionW Stream Structure</span></span>

<span data-ttu-id="3159c-142">Una estructura de secuencia FolderFieldDefinitionW contiene una definición de un campo definido por el usuario con el nombre de campo almacenado en Unicode.</span><span class="sxs-lookup"><span data-stu-id="3159c-142">A FolderFieldDefinitionW stream structure contains a definition of a user-defined field with the field name stored in Unicode.</span></span>
  
<span data-ttu-id="3159c-143">Los elementos de datos de esta secuencia se almacenan en el orden de bytes Little-endian, inmediatamente a continuación entre sí en el siguiente orden especificado:</span><span class="sxs-lookup"><span data-stu-id="3159c-143">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="3159c-144">**FieldType**: FldType (4 bytes), el tipo de este campo.</span><span class="sxs-lookup"><span data-stu-id="3159c-144">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="3159c-145">**FieldNameLength**: Word (2 bytes), el número de elementos de la matriz **FieldName** .</span><span class="sxs-lookup"><span data-stu-id="3159c-145">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="3159c-146">**FieldName**: una matriz de WCHAR.</span><span class="sxs-lookup"><span data-stu-id="3159c-146">**FieldName**: An array of WCHAR.</span></span> <span data-ttu-id="3159c-147">Esta es la representación Unicode (UTF-16) del nombre del campo.</span><span class="sxs-lookup"><span data-stu-id="3159c-147">This is the Unicode (UTF-16) representation of the field name.</span></span> <span data-ttu-id="3159c-148">El recuento de esta matriz es igual a **FieldNameLength**.</span><span class="sxs-lookup"><span data-stu-id="3159c-148">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="3159c-149">El nombre del campo debe cumplir con las restricciones del parámetro name tal como se especifica en el método [UserProperties. Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) .</span><span class="sxs-lookup"><span data-stu-id="3159c-149">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="3159c-150">Por motivos de compatibilidad heredada, es posible que Outlook pueda controlar algunos valores de **FieldName** que no cumplen estas restricciones, pero estos casos no se tratan en este tema.</span><span class="sxs-lookup"><span data-stu-id="3159c-150">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, but such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="3159c-151">**Common**: una estructura de secuencia FolderFieldDefinitionCommon.</span><span class="sxs-lookup"><span data-stu-id="3159c-151">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="fldtype-enumeration"></a><span data-ttu-id="3159c-152">Enumeración FldType</span><span class="sxs-lookup"><span data-stu-id="3159c-152">FldType Enumeration</span></span>

<span data-ttu-id="3159c-153">En la tabla siguiente se enumeran los valores de enumeración **FldType** .</span><span class="sxs-lookup"><span data-stu-id="3159c-153">**FldType** enumeration values are listed in the following table.</span></span> 
  
|<span data-ttu-id="3159c-154">Nombre</span><span class="sxs-lookup"><span data-stu-id="3159c-154">Name</span></span>|<span data-ttu-id="3159c-155">Valor</span><span class="sxs-lookup"><span data-stu-id="3159c-155">Value</span></span>|<span data-ttu-id="3159c-156">Significado</span><span class="sxs-lookup"><span data-stu-id="3159c-156">Meaning</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="3159c-157">ftNull</span><span class="sxs-lookup"><span data-stu-id="3159c-157">ftNull</span></span>  <br/> |<span data-ttu-id="3159c-158">0x0</span><span class="sxs-lookup"><span data-stu-id="3159c-158">0x0</span></span>  <br/> |<span data-ttu-id="3159c-159">Este tipo de campo se usa para terminar en NULL una matriz de definiciones de campo.</span><span class="sxs-lookup"><span data-stu-id="3159c-159">This field type is used to null-terminate an array of field definitions.</span></span>  <br/> |
|<span data-ttu-id="3159c-160">ftString</span><span class="sxs-lookup"><span data-stu-id="3159c-160">ftString</span></span>  <br/> |<span data-ttu-id="3159c-161">0x1</span><span class="sxs-lookup"><span data-stu-id="3159c-161">0x1</span></span>  <br/> |<span data-ttu-id="3159c-162">Texto</span><span class="sxs-lookup"><span data-stu-id="3159c-162">Text</span></span>  <br/> |
|<span data-ttu-id="3159c-163">ftInteger</span><span class="sxs-lookup"><span data-stu-id="3159c-163">ftInteger</span></span>  <br/> |<span data-ttu-id="3159c-164">0X3</span><span class="sxs-lookup"><span data-stu-id="3159c-164">0x3</span></span>  <br/> |<span data-ttu-id="3159c-165">Entero</span><span class="sxs-lookup"><span data-stu-id="3159c-165">Integer</span></span>  <br/> |
|<span data-ttu-id="3159c-166">ftTime</span><span class="sxs-lookup"><span data-stu-id="3159c-166">ftTime</span></span>  <br/> |<span data-ttu-id="3159c-167">0X5</span><span class="sxs-lookup"><span data-stu-id="3159c-167">0x5</span></span>  <br/> |<span data-ttu-id="3159c-168">Fecha y hora</span><span class="sxs-lookup"><span data-stu-id="3159c-168">Date/Time</span></span>  <br/> |
|<span data-ttu-id="3159c-169">ftBoolean</span><span class="sxs-lookup"><span data-stu-id="3159c-169">ftBoolean</span></span>  <br/> |<span data-ttu-id="3159c-170">0x6</span><span class="sxs-lookup"><span data-stu-id="3159c-170">0x6</span></span>  <br/> |<span data-ttu-id="3159c-171">Sí/No</span><span class="sxs-lookup"><span data-stu-id="3159c-171">Yes/No</span></span>  <br/> |
|<span data-ttu-id="3159c-172">ftDuration</span><span class="sxs-lookup"><span data-stu-id="3159c-172">ftDuration</span></span>  <br/> |<span data-ttu-id="3159c-173">0X7</span><span class="sxs-lookup"><span data-stu-id="3159c-173">0x7</span></span>  <br/> |<span data-ttu-id="3159c-174">Duracion</span><span class="sxs-lookup"><span data-stu-id="3159c-174">Duration</span></span>  <br/> |
|<span data-ttu-id="3159c-175">ftMultiString</span><span class="sxs-lookup"><span data-stu-id="3159c-175">ftMultiString</span></span>  <br/> |<span data-ttu-id="3159c-176">0xB</span><span class="sxs-lookup"><span data-stu-id="3159c-176">0xB</span></span>  <br/> |<span data-ttu-id="3159c-177">Palabras clave</span><span class="sxs-lookup"><span data-stu-id="3159c-177">Keywords</span></span>  <br/> |
|<span data-ttu-id="3159c-178">ftFloat</span><span class="sxs-lookup"><span data-stu-id="3159c-178">ftFloat</span></span>  <br/> |<span data-ttu-id="3159c-179">0xC</span><span class="sxs-lookup"><span data-stu-id="3159c-179">0xC</span></span>  <br/> |<span data-ttu-id="3159c-180">Número o porcentaje</span><span class="sxs-lookup"><span data-stu-id="3159c-180">Number or Percent</span></span>  <br/> |
|<span data-ttu-id="3159c-181">ftCurrency</span><span class="sxs-lookup"><span data-stu-id="3159c-181">ftCurrency</span></span>  <br/> |<span data-ttu-id="3159c-182">0xE</span><span class="sxs-lookup"><span data-stu-id="3159c-182">0xE</span></span>  <br/> |<span data-ttu-id="3159c-183">Moneda</span><span class="sxs-lookup"><span data-stu-id="3159c-183">Currency</span></span>  <br/> |
|<span data-ttu-id="3159c-184">ftCalc</span><span class="sxs-lookup"><span data-stu-id="3159c-184">ftCalc</span></span>  <br/> |<span data-ttu-id="3159c-185">0X12</span><span class="sxs-lookup"><span data-stu-id="3159c-185">0x12</span></span>  <br/> |<span data-ttu-id="3159c-186">Formula</span><span class="sxs-lookup"><span data-stu-id="3159c-186">Formula</span></span>  <br/> |
|<span data-ttu-id="3159c-187">ftSwitch</span><span class="sxs-lookup"><span data-stu-id="3159c-187">ftSwitch</span></span>  <br/> |<span data-ttu-id="3159c-188">0x13</span><span class="sxs-lookup"><span data-stu-id="3159c-188">0x13</span></span>  <br/> |<span data-ttu-id="3159c-189">Combinación de tipo que muestra sólo el primer campo que no está vacío y que omite los siguientes.</span><span class="sxs-lookup"><span data-stu-id="3159c-189">Combination of type showing only the first non-empty field - ignoring subsequent ones.</span></span>  <br/> |
|<span data-ttu-id="3159c-190">ftConcat</span><span class="sxs-lookup"><span data-stu-id="3159c-190">ftConcat</span></span>  <br/> |<span data-ttu-id="3159c-191">0x17</span><span class="sxs-lookup"><span data-stu-id="3159c-191">0x17</span></span>  <br/> |<span data-ttu-id="3159c-192">Combinación de tipos que se unen a los campos y los fragmentos de texto entre sí.</span><span class="sxs-lookup"><span data-stu-id="3159c-192">Combination of type joining fields and any text fragments to each other.</span></span>  <br/> |
   
## <a name="folderfielddefinitioncommon-stream-structure"></a><span data-ttu-id="3159c-193">Estructura de la secuencia FolderFieldDefinitionCommon</span><span class="sxs-lookup"><span data-stu-id="3159c-193">FolderFieldDefinitionCommon Stream Structure</span></span>

<span data-ttu-id="3159c-194">Una estructura de secuencia FolderFieldDefinitionCommon contiene los datos de una definición de campos definidos por el usuario que es común a un FolderFieldDefinitionA y a un FolderFieldDefinitionW.</span><span class="sxs-lookup"><span data-stu-id="3159c-194">A FolderFieldDefinitionCommon stream structure contains the data of a user-defined field definition that is common to both a FolderFieldDefinitionA and a FolderFieldDefinitionW.</span></span>
  
<span data-ttu-id="3159c-195">Los elementos de datos de esta secuencia se almacenan en el orden de bytes Little-endian, inmediatamente a continuación entre sí en el siguiente orden especificado:</span><span class="sxs-lookup"><span data-stu-id="3159c-195">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="3159c-196">**PropSetGuid**: GUID (16 bytes), el GUID del conjunto de propiedades del nombre de la propiedad MAPI correspondiente al campo de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="3159c-196">**PropSetGuid**: GUID (16 bytes), the property set GUID of the folder field's corresponding MAPI property name.</span></span> <span data-ttu-id="3159c-197">El valor de este campo debe ser igual a PS_PUBLIC_STRINGS, a menos que el tipo de campo sea **ftNone** en cuyo caso el valor de este campo debe ser igual a GUID_NULL.</span><span class="sxs-lookup"><span data-stu-id="3159c-197">This field's value must be equal to PS_PUBLIC_STRINGS, unless the field type is **ftNone** in which case this field's value must be equal to GUID_NULL.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="3159c-198">Por motivos de compatibilidad heredada, Outlook puede ser capaz de controlar algunos valores de **PropSetGuid** que no cumplen esta restricción, aunque estos casos no se tratan en este tema.</span><span class="sxs-lookup"><span data-stu-id="3159c-198">For reasons of legacy compatibility, Outlook may be able to handle some **PropSetGuid** values not satisfying this restriction, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="3159c-199">**fcapm**: DWORD (4 bytes), una combinación de cero o más indicadores cuyos valores y significados se enumeran en la siguiente tabla.</span><span class="sxs-lookup"><span data-stu-id="3159c-199">**fcapm**: DWORD (4 bytes), a combination of zero or more flags the values of which and meanings are listed in the following table.</span></span> <span data-ttu-id="3159c-200">Las marcas con el mismo valor tienen significados que dependen del tipo de campo, es decir, del valor FldType.</span><span class="sxs-lookup"><span data-stu-id="3159c-200">Flags with the same value have meanings dependent on the field's type, that is, FldType value.</span></span>
    
    |<span data-ttu-id="3159c-201">Nombre de marca</span><span class="sxs-lookup"><span data-stu-id="3159c-201">Flag name</span></span>|<span data-ttu-id="3159c-202">Valor</span><span class="sxs-lookup"><span data-stu-id="3159c-202">Value</span></span>|<span data-ttu-id="3159c-203">Significado</span><span class="sxs-lookup"><span data-stu-id="3159c-203">Meaning</span></span>|
    |:-----|:-----|:-----|
    |<span data-ttu-id="3159c-204">FCAPM_CAN_EDIT</span><span class="sxs-lookup"><span data-stu-id="3159c-204">FCAPM_CAN_EDIT</span></span>  <br/> |<span data-ttu-id="3159c-205">0x00000001</span><span class="sxs-lookup"><span data-stu-id="3159c-205">0x00000001</span></span>  <br/> |<span data-ttu-id="3159c-206">El campo se puede editar.</span><span class="sxs-lookup"><span data-stu-id="3159c-206">The field is editable.</span></span>  <br/> |
    |<span data-ttu-id="3159c-207">FCAPM_CAN_SORT</span><span class="sxs-lookup"><span data-stu-id="3159c-207">FCAPM_CAN_SORT</span></span>  <br/> |<span data-ttu-id="3159c-208">0x00000002</span><span class="sxs-lookup"><span data-stu-id="3159c-208">0x00000002</span></span>  <br/> |<span data-ttu-id="3159c-209">El campo se puede ordenar.</span><span class="sxs-lookup"><span data-stu-id="3159c-209">The field is sortable.</span></span>  <br/> |
    |<span data-ttu-id="3159c-210">FCAPM_CAN_GROUP</span><span class="sxs-lookup"><span data-stu-id="3159c-210">FCAPM_CAN_GROUP</span></span>  <br/> |<span data-ttu-id="3159c-211">0x00000004</span><span class="sxs-lookup"><span data-stu-id="3159c-211">0x00000004</span></span>  <br/> |<span data-ttu-id="3159c-212">El campo es agrupable.</span><span class="sxs-lookup"><span data-stu-id="3159c-212">The field is groupable.</span></span>  <br/> |
    |<span data-ttu-id="3159c-213">FCAPM_MULTILINE_TEXT</span><span class="sxs-lookup"><span data-stu-id="3159c-213">FCAPM_MULTILINE_TEXT</span></span>  <br/> |<span data-ttu-id="3159c-214">0x00000100</span><span class="sxs-lookup"><span data-stu-id="3159c-214">0x00000100</span></span>  <br/> |<span data-ttu-id="3159c-215">El campo puede contener varias líneas de texto.</span><span class="sxs-lookup"><span data-stu-id="3159c-215">The field can hold multiple lines of text.</span></span>  <br/> |
    |<span data-ttu-id="3159c-216">FCAPM_PERCENT</span><span class="sxs-lookup"><span data-stu-id="3159c-216">FCAPM_PERCENT</span></span>  <br/> |<span data-ttu-id="3159c-217">0x01000000</span><span class="sxs-lookup"><span data-stu-id="3159c-217">0x01000000</span></span>  <br/> |<span data-ttu-id="3159c-218">Este campo del tipo ftFloat es un campo de porcentaje.</span><span class="sxs-lookup"><span data-stu-id="3159c-218">This field of the type ftFloat is a percentage field.</span></span>  <br/> |
    |<span data-ttu-id="3159c-219">FCAPM_DATEONLY</span><span class="sxs-lookup"><span data-stu-id="3159c-219">FCAPM_DATEONLY</span></span>  <br/> |<span data-ttu-id="3159c-220">0x01000000</span><span class="sxs-lookup"><span data-stu-id="3159c-220">0x01000000</span></span>  <br/> |<span data-ttu-id="3159c-221">Este campo del tipo ftTime es un campo de hora de fecha y hora.</span><span class="sxs-lookup"><span data-stu-id="3159c-221">This field of the type ftTime is a date-only time field.</span></span>  <br/> |
    |<span data-ttu-id="3159c-222">FCAPM_UNITLESS</span><span class="sxs-lookup"><span data-stu-id="3159c-222">FCAPM_UNITLESS</span></span>  <br/> |<span data-ttu-id="3159c-223">0x01000000</span><span class="sxs-lookup"><span data-stu-id="3159c-223">0x01000000</span></span>  <br/> |<span data-ttu-id="3159c-224">Para este campo del tipo ftInteger, no se permite ninguna unidad en formato de presentación; por ejemplo, formatos como "equipo-640 K..." no están permitidas.</span><span class="sxs-lookup"><span data-stu-id="3159c-224">For this field of the type ftInteger, no unit is allowed in display format; for example such formats as "Computer - 640 K…" are not allowed.</span></span>  <br/> |
    |<span data-ttu-id="3159c-225">FCAPM_CAN_EDIT_IN_ITEM</span><span class="sxs-lookup"><span data-stu-id="3159c-225">FCAPM_CAN_EDIT_IN_ITEM</span></span>  <br/> |<span data-ttu-id="3159c-226">0x80000000</span><span class="sxs-lookup"><span data-stu-id="3159c-226">0x80000000</span></span>  <br/> |<span data-ttu-id="3159c-227">El campo se puede editar en el elemento: esto es específicamente para los formularios personalizados.</span><span class="sxs-lookup"><span data-stu-id="3159c-227">The field can be edited in the item: This is specifically for custom forms.</span></span>  <br/> |
   
- <span data-ttu-id="3159c-228">**dwString**: DWORD (4 bytes).</span><span class="sxs-lookup"><span data-stu-id="3159c-228">**dwString**: DWORD (4 bytes).</span></span> <span data-ttu-id="3159c-229">Vea la primera nota siguiente.</span><span class="sxs-lookup"><span data-stu-id="3159c-229">See the first following Note.</span></span>
    
- <span data-ttu-id="3159c-230">**dwBitmap**: DWORD (4 bytes).</span><span class="sxs-lookup"><span data-stu-id="3159c-230">**dwBitmap**: DWORD (4 bytes).</span></span> <span data-ttu-id="3159c-231">Vea la primera nota siguiente.</span><span class="sxs-lookup"><span data-stu-id="3159c-231">See the first following Note.</span></span>
    
- <span data-ttu-id="3159c-232">**dwDisplay**: DWORD (4 bytes).</span><span class="sxs-lookup"><span data-stu-id="3159c-232">**dwDisplay**: DWORD (4 bytes).</span></span> <span data-ttu-id="3159c-233">Vea la primera nota siguiente.</span><span class="sxs-lookup"><span data-stu-id="3159c-233">See the first following Note.</span></span>
    
- <span data-ttu-id="3159c-234">**iFmt**: int (4 bytes).</span><span class="sxs-lookup"><span data-stu-id="3159c-234">**iFmt**: INT (4 bytes).</span></span> <span data-ttu-id="3159c-235">Para los tipos de campo que tienen el cuadro combinado "formato:" en los cuadros de diálogo "nuevo campo", "editar campo" y "propiedades de campo", el índice de base cero del formato seleccionado en ese cuadro combinado.</span><span class="sxs-lookup"><span data-stu-id="3159c-235">For the field types that have the "Format:" combo box in the "New Field", "Edit Field", and "Field Properties" dialogs, the 0-based index of the format selected in that combo box.</span></span> <span data-ttu-id="3159c-236">Para los tipos de campo sin ese cuadro combinado, debe ser 0.</span><span class="sxs-lookup"><span data-stu-id="3159c-236">For the field types without that combo box, this must be 0.</span></span> <span data-ttu-id="3159c-237">El valor del campo, junto con el tipo de campo, determinan de forma única los valores de los campos **dwString**, **dwBitmap**y **DwDisplay** , vea la primera nota siguiente.</span><span class="sxs-lookup"><span data-stu-id="3159c-237">The field's value together with the field type uniquely determine the values of the **dwString**, **dwBitmap**, and **dwDisplay** fields, see the first following Note.</span></span>
    
- <span data-ttu-id="3159c-238">**wszFormulaLength**: Word (2 bytes), el número de elementos de la matriz **wszFormulaLength** .</span><span class="sxs-lookup"><span data-stu-id="3159c-238">**wszFormulaLength**: WORD (2 bytes), the number of elements in the **wszFormulaLength** array.</span></span>
    
- <span data-ttu-id="3159c-239">**wszFormulaLength**: una matriz de WCHAR.</span><span class="sxs-lookup"><span data-stu-id="3159c-239">**wszFormulaLength**: An array of WCHAR.</span></span> <span data-ttu-id="3159c-240">Esta es la representación Unicode (UTF-16) de la cadena de fórmulas del campo en su formato estándar.</span><span class="sxs-lookup"><span data-stu-id="3159c-240">This is the Unicode (UTF-16) representation of the field's formula string in its standard format.</span></span> <span data-ttu-id="3159c-241">Vea la segunda nota siguiente para obtener la descripción de los formatos estándar y de interfaz de usuario de la fórmula de un campo.</span><span class="sxs-lookup"><span data-stu-id="3159c-241">See the second following Note for the description of the standard and UI formats of a field's formula.</span></span> <span data-ttu-id="3159c-242">El recuento de esta matriz es igual a **wszFormulaLength**.</span><span class="sxs-lookup"><span data-stu-id="3159c-242">The count of this array is equal to **wszFormulaLength**.</span></span> <span data-ttu-id="3159c-243">La cadena de fórmula debe ser una cadena vacía a menos que el tipo de campo sea **ftCalc**, **ftSwitch** o **ftConcat**.</span><span class="sxs-lookup"><span data-stu-id="3159c-243">The formula string must be an empty string unless the field type is **ftCalc**, **ftSwitch** or **ftConcat**.</span></span>
    
> [!NOTE]
> <span data-ttu-id="3159c-244">Aunque los valores de **dwString**, **dwBitmap**y **dwDisplay** se determinan de forma exclusiva en función del valor de **FldType** y el valor de **iFmt** , que son redundantes, los valores correctos siguen siendo necesarios para las correcciones correctas. procesamiento de la definición del campo por parte de Outlook.</span><span class="sxs-lookup"><span data-stu-id="3159c-244">Although the values of **dwString**, **dwBitmap**, and **dwDisplay** are uniquely determined based on the **FldType** value and the **iFmt** value, which are redundant, their correct values are still necessary for correct processing of the field definition by Outlook.</span></span> <span data-ttu-id="3159c-245">No hay ninguna descripción sencilla del algoritmo que realice esta determinación.</span><span class="sxs-lookup"><span data-stu-id="3159c-245">There is no simple description of the algorithm that performs this determination.</span></span> 
> 
> <span data-ttu-id="3159c-246">Por lo tanto, para averiguar qué valores de **dwString**, **dwBitmap**y **dwDisplay** corresponden a un valor de **FldType** y un valor de **iFmt** dados, realice una prueba creando un campo definido por el usuario de ese tipo y con ese formato seleccionado. en el cuadro combinado **formato** , asumiendo su aplicabilidad, inspeccione la secuencia **FolderUserFields** resultante que Outlook crea para el campo definido por el usuario.</span><span class="sxs-lookup"><span data-stu-id="3159c-246">Therefore, to find out which **dwString**, **dwBitmap**, and **dwDisplay** values correspond to a given **FldType** value and **iFmt** value, perform a test by creating a user-defined field of that type, and with that format selected in the **Format** combo box, assuming its applicability, inspect the resulting **FolderUserFields** stream that Outlook creates for that user-defined field.</span></span> 
  
<span data-ttu-id="3159c-247">La fórmula del campo en su formato de interfaz de usuario se modifica en el cuadro de texto **fórmula** de los cuadros de diálogo **nuevo campo**, **Editar campo**y **propiedades de campo** para el campo definido por el usuario.</span><span class="sxs-lookup"><span data-stu-id="3159c-247">The field's formula in its UI format is edited in the **Formula** text box of the **New Field**, **Edit Field**, and **Field Properties** dialogs for the user-defined field.</span></span> <span data-ttu-id="3159c-248">El algoritmo para convertir una fórmula del formato de la interfaz de usuario al formato estándar depende del tipo de campo, tal y como se describe en lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="3159c-248">The algorithm to convert a formula from the UI format to the standard format depends on the field type as described in the following:</span></span> 
- <span data-ttu-id="3159c-249">Para los campos de tipos **ftCalc** y **ftSwitch**, el formato estándar para campos integrados, las propiedades MAPI correspondientes no se denominan propiedades de la cadena Kind\_MNID, se obtienen reemplazando los fragmentos de nombre de campo `[<field_name>]` , que es con fragmentos `[_<field_dispid_decimal>]`.</span><span class="sxs-lookup"><span data-stu-id="3159c-249">For fields of types **ftCalc** and **ftSwitch**, the standard format for built-in fields, which corresponding MAPI properties are not named properties of the kind MNID\_STRING, is obtained by replacing field name fragments, that is `[<field_name>]` with fragments `[_<field_dispid_decimal>]`.</span></span> 

  <span data-ttu-id="3159c-250">Por ejemplo, si el formato de interfaz de usuario de una fórmula para un campo de la **fórmula**de tipo, que es **ftCalc**, el idioma de la interfaz de `[Business Phone] & [My custom field]`usuario de `My custom field` Office que va a ser inglés norteamericano es, donde es el nombre de un campo definido por el usuario, el formato estándar de dicha fórmula sería `[_14856] & [My custom field]`.</span><span class="sxs-lookup"><span data-stu-id="3159c-250">For example, if the UI format of a formula for a field of the type **Formula**, that is **ftCalc**, with the Office UI language being US English, is `[Business Phone] & [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format of such a formula would be `[_14856] & [My custom field]`.</span></span>

- <span data-ttu-id="3159c-251">Para los campos de tipo **ftConcat**, el formato estándar se obtiene al realizar lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="3159c-251">For fields of the type **ftConcat**, the standard format is obtained by performing the following:</span></span>

  1. <span data-ttu-id="3159c-252">Truncar espacios en blanco iniciales y finales.</span><span class="sxs-lookup"><span data-stu-id="3159c-252">Truncate leading and trailing whitespace.</span></span> 
  2. <span data-ttu-id="3159c-253">Analice la fórmula en una secuencia de fragmentos de los dos tipos siguientes:</span><span class="sxs-lookup"><span data-stu-id="3159c-253">Parse the formula into a sequence of fragments of the following two kinds:</span></span> 
     - <span data-ttu-id="3159c-254">Un nombre de campo entre corchetes, es decir `[<field_name>]`,.</span><span class="sxs-lookup"><span data-stu-id="3159c-254">A field name in square brackets, that is, `[<field_name>]`.</span></span> 
     - <span data-ttu-id="3159c-255">Una subcadena que no contiene corchetes.</span><span class="sxs-lookup"><span data-stu-id="3159c-255">A substring not containing any square brackets.</span></span>   
      <span data-ttu-id="3159c-256">Asegúrese de que no hay dos fragmentos del segundo tipo adyacentes en la secuencia.</span><span class="sxs-lookup"><span data-stu-id="3159c-256">Assure that no two fragments of the second kind are adjacent in the sequence.</span></span> <span data-ttu-id="3159c-257">Si la fórmula no se puede analizar de esta manera, se considera no válida.</span><span class="sxs-lookup"><span data-stu-id="3159c-257">If the formula cannot be parsed this way, it is considered invalid.</span></span> 
  3. <span data-ttu-id="3159c-258">Realice el mismo reemplazo para los fragmentos del primer tipo de los campos **ftCalc** y **ftSwitch** .</span><span class="sxs-lookup"><span data-stu-id="3159c-258">Perform the same replacement for fragments of the first kind as for the **ftCalc** and **ftSwitch** fields.</span></span> 
  4. <span data-ttu-id="3159c-259">Para cada fragmento del segundo tipo, tiene que escapar todos los caracteres de comillas dobles ("" "), si los hay, con dos caracteres de comillas dobles consecutivos y encerrarla entre comillas dobles.</span><span class="sxs-lookup"><span data-stu-id="3159c-259">For each fragment of the second kind, escape all double-quote (""") characters, if any, with two consecutive double-quote characters, and enclose it in double quotes.</span></span> 
  5. <span data-ttu-id="3159c-260">Inserta una cadena de y`&`comercial () entre cada par de fragmentos adyacentes.</span><span class="sxs-lookup"><span data-stu-id="3159c-260">Insert an ampersand string (`&`) between each pair of adjacent fragments.</span></span>
 
  <span data-ttu-id="3159c-261">Por ejemplo, con el idioma de la interfaz de usuario de Office inglés (Estados Unidos), si el formato de la interfaz de `text1 [Business Phone] "text2" [My custom field]`usuario de `My custom field` una fórmula para un campo del tipo **ftConcat** es, donde es el nombre de un campo definido por `""text1" & [_14856] & """text2""" & [My custom field]"`el usuario, el formato estándar de dicha fórmula sería.</span><span class="sxs-lookup"><span data-stu-id="3159c-261">For example, using the Office UI language US English, if the UI format of a formula for a field of the type **ftConcat** is `text1 [Business Phone] "text2" [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format for such a formula would be `""text1" & [_14856] & """text2""" & [My custom field]"`.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="3159c-262">Vea también</span><span class="sxs-lookup"><span data-stu-id="3159c-262">See also</span></span>

- [<span data-ttu-id="3159c-263">Ejemplo de secuencia FolderUserFields</span><span class="sxs-lookup"><span data-stu-id="3159c-263">FolderUserFields Stream Sample</span></span>](folderuserfields-stream-sample.md)
- [<span data-ttu-id="3159c-264">Agregar una definición para un nuevo campo definido por el usuario</span><span class="sxs-lookup"><span data-stu-id="3159c-264">Add a Definition for a New User-Defined Field</span></span>](how-to-add-a-definition-for-a-new-user-defined-field.md)

