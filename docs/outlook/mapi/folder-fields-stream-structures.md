---
title: Estructuras de la secuencia de campos de carpeta
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: edbc9e6c-008c-4c13-9a0c-cb47ac0f3686
description: 'Última modificación: 09 de marzo de 2015'
ms.openlocfilehash: d6724914896fe7c40e9a456785aa5c92b84532fe
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19816835"
---
# <a name="folder-fields-stream-structures"></a><span data-ttu-id="010c8-103">Estructuras de la secuencia de campos de carpeta</span><span class="sxs-lookup"><span data-stu-id="010c8-103">Folder Fields Stream Structures</span></span>

<span data-ttu-id="010c8-104">**Hace referencia a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="010c8-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="010c8-105">Propiedad de [PidTagUserFields](pidtaguserfields-canonical-property.md) de un mensaje contiene una secuencia binaria, FolderUserFields, que contiene las definiciones de campo definido por el usuario de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="010c8-105">A message's [PidTagUserFields](pidtaguserfields-canonical-property.md) property contains a binary stream, FolderUserFields, which contains the folder user-defined field definitions.</span></span> <span data-ttu-id="010c8-106">En este tema se describe las estructuras de secuencia para las definiciones de campo definido por el usuario de carpeta.</span><span class="sxs-lookup"><span data-stu-id="010c8-106">This topic describes the stream structures for folder user-defined field definitions.</span></span> 

<span data-ttu-id="010c8-107">Una estructura de secuencia FolderUserFields consta de una estructura FolderUserFieldsA o una estructura FolderUserFieldsA seguido de una estructura FolderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="010c8-107">A FolderUserFields stream structure consists of either a FolderUserFieldsA structure or a FolderUserFieldsA structure followed by a FolderUserFieldsW structure.</span></span>
  
<span data-ttu-id="010c8-108">Elementos de datos en esta secuencia se almacenan inmediatamente después de cada uno de los otros en el siguiente orden especificado:</span><span class="sxs-lookup"><span data-stu-id="010c8-108">Data elements in this stream are stored immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="010c8-109">**FolderUserFieldsAnsi**: estructura en secuencia de un FolderUserFieldsA.</span><span class="sxs-lookup"><span data-stu-id="010c8-109">**FolderUserFieldsAnsi**: A FolderUserFieldsA stream structure.</span></span>
    
- <span data-ttu-id="010c8-110">**FolderUserFieldsUnicode** (opcional): estructura en secuencia de un FolderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="010c8-110">**FolderUserFieldsUnicode** (optional): A FolderUserFieldsW stream structure.</span></span>
    
<span data-ttu-id="010c8-111">Se detecta la presencia de FolderUserFieldsUnicode por la longitud total de la FolderUserFields es mayor que la longitud de FolderUserFieldsAnsi.</span><span class="sxs-lookup"><span data-stu-id="010c8-111">The presence of FolderUserFieldsUnicode is detected by the total length of the FolderUserFields being greater than the length of FolderUserFieldsAnsi.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="010c8-112">FolderUserFieldsAnsi se usa para la compatibilidad con los más antiguo, no Unicode, las versiones de los clientes MAPI, por lo tanto, si FolderUserFieldsUnicode está presente, se omite el contenido de FolderUserFieldsAnsi.</span><span class="sxs-lookup"><span data-stu-id="010c8-112">FolderUserFieldsAnsi is used for compatibility with older, non-Unicode, versions of MAPI clients, therefore if FolderUserFieldsUnicode is present, the contents of FolderUserFieldsAnsi is ignored.</span></span> <span data-ttu-id="010c8-113">Para evitar datos posibles pérdidas de paquetes en la conversión de ANSI, al crear una secuencia de FolderUserFields siempre incluyen el elemento FolderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="010c8-113">To avoid possible data loss in ANSI conversion, when creating a FolderUserFields stream always include the FolderUserFieldsW part.</span></span> 
  
## <a name="folderuserfieldsa-stream-structure"></a><span data-ttu-id="010c8-114">Estructura de la secuencia de FolderUserFieldsA</span><span class="sxs-lookup"><span data-stu-id="010c8-114">FolderUserFieldsA Stream Structure</span></span>

<span data-ttu-id="010c8-115">Una estructura de secuencia de FolderUserFieldsA es una matriz de las estructuras de secuencia de FolderFieldDefinitionA que contienen definiciones para todos los campos definidos por el usuario en una carpeta de Outlook, a menos que se reemplaza por el elemento FolderUserFieldsW de la estructura FolderUserFields.</span><span class="sxs-lookup"><span data-stu-id="010c8-115">A FolderUserFieldsA stream structure is an array of FolderFieldDefinitionA stream structures that contain definitions for all user-defined fields in an Outlook folder, unless overridden by the FolderUserFieldsW part of the FolderUserFields structure.</span></span>
  
<span data-ttu-id="010c8-116">Elementos de datos en esta secuencia se almacenan en el orden de bytes little-endian, inmediatamente después de cada uno de los otros en el siguiente orden especificado:</span><span class="sxs-lookup"><span data-stu-id="010c8-116">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="010c8-117">**FieldDefinitionCount**: DWORD (4 bytes), el número de definiciones de campo en esta secuencia.</span><span class="sxs-lookup"><span data-stu-id="010c8-117">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="010c8-118">Éste es el recuento de elementos de la matriz **FieldDefinitions** .</span><span class="sxs-lookup"><span data-stu-id="010c8-118">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="010c8-119">**FieldDefinitions**: una matriz de FolderFieldDefinitionA en secuencia de estructuras.</span><span class="sxs-lookup"><span data-stu-id="010c8-119">**FieldDefinitions**: An array of FolderFieldDefinitionA stream structures.</span></span> <span data-ttu-id="010c8-120">El recuento de esta matriz es igual al elemento de datos de **FieldDefinitionCount** .</span><span class="sxs-lookup"><span data-stu-id="010c8-120">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="010c8-121">A menos que este FolderUserFieldsA se reemplaza por el elemento FolderUserFieldsW de la estructura de FolderUserFields, la matriz **FieldDefinitions** debe ser "terminada en null" al campo de Common.FieldType de su última FolderFieldDefinitionA elemento igual de tener para ftNull.</span><span class="sxs-lookup"><span data-stu-id="010c8-121">Unless this FolderUserFieldsA is overridden by the FolderUserFieldsW part of the FolderUserFields structure, the **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionA element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderuserfieldsw-stream-structure"></a><span data-ttu-id="010c8-122">Estructura de la secuencia de FolderUserFieldsW</span><span class="sxs-lookup"><span data-stu-id="010c8-122">FolderUserFieldsW Stream Structure</span></span>

<span data-ttu-id="010c8-123">Una estructura de secuencia de FolderUserFieldsW es una matriz de las estructuras de secuencia de FolderFieldDefinitionW que contienen definiciones para todos los campos definidos por el usuario en una carpeta de Outlook.</span><span class="sxs-lookup"><span data-stu-id="010c8-123">A FolderUserFieldsW stream structure is an array of FolderFieldDefinitionW stream structures that contain definitions for all user-defined fields in an Outlook folder.</span></span>
  
<span data-ttu-id="010c8-124">Elementos de datos en esta secuencia se almacenan en el orden de bytes little-endian, inmediatamente después de cada uno de los otros en el siguiente orden especificado:</span><span class="sxs-lookup"><span data-stu-id="010c8-124">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="010c8-125">**FieldDefinitionCount**: DWORD (4 bytes), el número de definiciones de campo en esta secuencia.</span><span class="sxs-lookup"><span data-stu-id="010c8-125">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="010c8-126">Éste es el recuento de elementos de la matriz **FieldDefinitions** .</span><span class="sxs-lookup"><span data-stu-id="010c8-126">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="010c8-127">**FieldDefinitions**: una matriz de FolderFieldDefinitionW en secuencia de estructuras.</span><span class="sxs-lookup"><span data-stu-id="010c8-127">**FieldDefinitions**: An array of FolderFieldDefinitionW stream structures.</span></span> <span data-ttu-id="010c8-128">El recuento de esta matriz es igual al elemento de datos de **FieldDefinitionCount** .</span><span class="sxs-lookup"><span data-stu-id="010c8-128">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="010c8-129">La matriz de **FieldDefinitions** debe ser "terminada en null" haciendo que el campo de Common.FieldType de su última FolderFieldDefinitionW elemento igual a ftNull.</span><span class="sxs-lookup"><span data-stu-id="010c8-129">The **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionW element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderfielddefinitiona-stream-structure"></a><span data-ttu-id="010c8-130">Estructura de la secuencia de FolderFieldDefinitionA</span><span class="sxs-lookup"><span data-stu-id="010c8-130">FolderFieldDefinitionA Stream Structure</span></span>

<span data-ttu-id="010c8-131">Una estructura de secuencia FolderFieldDefinitionA contiene una definición de un campo definido por el usuario con el nombre de campo que se almacenan en ANSI.</span><span class="sxs-lookup"><span data-stu-id="010c8-131">A FolderFieldDefinitionA stream structure contains a definition of a user-defined field with the field name stored in ANSI.</span></span>
  
<span data-ttu-id="010c8-132">Elementos de datos en esta secuencia se almacenan en el orden de bytes little-endian, inmediatamente después de cada uno de los otros en el siguiente orden especificado:</span><span class="sxs-lookup"><span data-stu-id="010c8-132">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="010c8-133">**FieldType**: FldType (4 bytes), el tipo de este campo.</span><span class="sxs-lookup"><span data-stu-id="010c8-133">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="010c8-134">**FieldNameLength**: palabra (2 bytes), el número de elementos de la matriz **FieldName** .</span><span class="sxs-lookup"><span data-stu-id="010c8-134">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="010c8-135">**FieldName**: una matriz de CHAR.</span><span class="sxs-lookup"><span data-stu-id="010c8-135">**FieldName**: An array of CHAR.</span></span> <span data-ttu-id="010c8-136">Ésta es la representación de página de códigos de ANSI CP_ACP del nombre del campo.</span><span class="sxs-lookup"><span data-stu-id="010c8-136">This is the ANSI CP_ACP codepage representation of the field name.</span></span> <span data-ttu-id="010c8-137">El recuento de esta matriz es igual a **FieldNameLength**.</span><span class="sxs-lookup"><span data-stu-id="010c8-137">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="010c8-138">El nombre de campo debe cumplir las restricciones en el parámetro Name tal como se especifica en el método [UserProperties.Add](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.userproperties.add.aspx) .</span><span class="sxs-lookup"><span data-stu-id="010c8-138">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="010c8-139">Por motivos de compatibilidad heredada, Outlook podrá controlar algunos valores de **FieldName** no se ajusten a estas restricciones, sin embargo tales casos no se incluyen en este tema.</span><span class="sxs-lookup"><span data-stu-id="010c8-139">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="010c8-140">**Común**: estructura en secuencia de un FolderFieldDefinitionCommon.</span><span class="sxs-lookup"><span data-stu-id="010c8-140">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="folderfielddefinitionw-stream-structure"></a><span data-ttu-id="010c8-141">Estructura de la secuencia de FolderFieldDefinitionW</span><span class="sxs-lookup"><span data-stu-id="010c8-141">FolderFieldDefinitionW Stream Structure</span></span>

<span data-ttu-id="010c8-142">Una estructura de secuencia FolderFieldDefinitionW contiene una definición de un campo definido por el usuario con el nombre de campo que se almacenan en Unicode.</span><span class="sxs-lookup"><span data-stu-id="010c8-142">A FolderFieldDefinitionW stream structure contains a definition of a user-defined field with the field name stored in Unicode.</span></span>
  
<span data-ttu-id="010c8-143">Elementos de datos en esta secuencia se almacenan en el orden de bytes little-endian, inmediatamente después de cada uno de los otros en el siguiente orden especificado:</span><span class="sxs-lookup"><span data-stu-id="010c8-143">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="010c8-144">**FieldType**: FldType (4 bytes), el tipo de este campo.</span><span class="sxs-lookup"><span data-stu-id="010c8-144">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="010c8-145">**FieldNameLength**: palabra (2 bytes), el número de elementos de la matriz **FieldName** .</span><span class="sxs-lookup"><span data-stu-id="010c8-145">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="010c8-146">**FieldName**: una matriz de WCHAR.</span><span class="sxs-lookup"><span data-stu-id="010c8-146">**FieldName**: An array of WCHAR.</span></span> <span data-ttu-id="010c8-147">Ésta es la representación de Unicode (UTF-16) del nombre del campo.</span><span class="sxs-lookup"><span data-stu-id="010c8-147">This is the Unicode (UTF-16) representation of the field name.</span></span> <span data-ttu-id="010c8-148">El recuento de esta matriz es igual a **FieldNameLength**.</span><span class="sxs-lookup"><span data-stu-id="010c8-148">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="010c8-149">El nombre de campo debe cumplir las restricciones en el parámetro Name tal como se especifica en el método [UserProperties.Add](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.userproperties.add.aspx) .</span><span class="sxs-lookup"><span data-stu-id="010c8-149">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="010c8-150">Por motivos de compatibilidad heredada, Outlook puede ser capaz de controlar algunos valores de **FieldName** no se ajusten a estas restricciones, pero estos casos no se incluyen en este tema.</span><span class="sxs-lookup"><span data-stu-id="010c8-150">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, but such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="010c8-151">**Común**: estructura en secuencia de un FolderFieldDefinitionCommon.</span><span class="sxs-lookup"><span data-stu-id="010c8-151">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="fldtype-enumeration"></a><span data-ttu-id="010c8-152">FldType (enumeración)</span><span class="sxs-lookup"><span data-stu-id="010c8-152">FldType Enumeration</span></span>

<span data-ttu-id="010c8-153">Valores de la enumeración **FldType** se enumeran en la siguiente tabla.</span><span class="sxs-lookup"><span data-stu-id="010c8-153">**FldType** enumeration values are listed in the following table.</span></span> 
  
|<span data-ttu-id="010c8-154">Nombre</span><span class="sxs-lookup"><span data-stu-id="010c8-154">Name</span></span>|<span data-ttu-id="010c8-155">Valor</span><span class="sxs-lookup"><span data-stu-id="010c8-155">Value</span></span>|<span data-ttu-id="010c8-156">Significado</span><span class="sxs-lookup"><span data-stu-id="010c8-156">Meaning</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="010c8-157">ftNull</span><span class="sxs-lookup"><span data-stu-id="010c8-157">ftNull</span></span>  <br/> |<span data-ttu-id="010c8-158">0 x 0</span><span class="sxs-lookup"><span data-stu-id="010c8-158">0x0</span></span>  <br/> |<span data-ttu-id="010c8-159">Este tipo de campo se usa para una matriz de definiciones de campo termine en null.</span><span class="sxs-lookup"><span data-stu-id="010c8-159">This field type is used to null-terminate an array of field definitions.</span></span>  <br/> |
|<span data-ttu-id="010c8-160">ftString</span><span class="sxs-lookup"><span data-stu-id="010c8-160">ftString</span></span>  <br/> |<span data-ttu-id="010c8-161">0 x 1</span><span class="sxs-lookup"><span data-stu-id="010c8-161">0x1</span></span>  <br/> |<span data-ttu-id="010c8-162">Texto</span><span class="sxs-lookup"><span data-stu-id="010c8-162">Text</span></span>  <br/> |
|<span data-ttu-id="010c8-163">ftInteger</span><span class="sxs-lookup"><span data-stu-id="010c8-163">ftInteger</span></span>  <br/> |<span data-ttu-id="010c8-164">0 x 3</span><span class="sxs-lookup"><span data-stu-id="010c8-164">0x3</span></span>  <br/> |<span data-ttu-id="010c8-165">Entero</span><span class="sxs-lookup"><span data-stu-id="010c8-165">Integer</span></span>  <br/> |
|<span data-ttu-id="010c8-166">ftTime</span><span class="sxs-lookup"><span data-stu-id="010c8-166">ftTime</span></span>  <br/> |<span data-ttu-id="010c8-167">0 x 5</span><span class="sxs-lookup"><span data-stu-id="010c8-167">0x5</span></span>  <br/> |<span data-ttu-id="010c8-168">Fecha y hora</span><span class="sxs-lookup"><span data-stu-id="010c8-168">Date/Time</span></span>  <br/> |
|<span data-ttu-id="010c8-169">ftBoolean</span><span class="sxs-lookup"><span data-stu-id="010c8-169">ftBoolean</span></span>  <br/> |<span data-ttu-id="010c8-170">0 x 6</span><span class="sxs-lookup"><span data-stu-id="010c8-170">0x6</span></span>  <br/> |<span data-ttu-id="010c8-171">Sí/No</span><span class="sxs-lookup"><span data-stu-id="010c8-171">Yes/No</span></span>  <br/> |
|<span data-ttu-id="010c8-172">ftDuration</span><span class="sxs-lookup"><span data-stu-id="010c8-172">ftDuration</span></span>  <br/> |<span data-ttu-id="010c8-173">0 x 7</span><span class="sxs-lookup"><span data-stu-id="010c8-173">0x7</span></span>  <br/> |<span data-ttu-id="010c8-174">Duración</span><span class="sxs-lookup"><span data-stu-id="010c8-174">Duration</span></span>  <br/> |
|<span data-ttu-id="010c8-175">ftMultiString</span><span class="sxs-lookup"><span data-stu-id="010c8-175">ftMultiString</span></span>  <br/> |<span data-ttu-id="010c8-176">0xB</span><span class="sxs-lookup"><span data-stu-id="010c8-176">0xB</span></span>  <br/> |<span data-ttu-id="010c8-177">Keywords</span><span class="sxs-lookup"><span data-stu-id="010c8-177">Keywords</span></span>  <br/> |
|<span data-ttu-id="010c8-178">ftFloat</span><span class="sxs-lookup"><span data-stu-id="010c8-178">ftFloat</span></span>  <br/> |<span data-ttu-id="010c8-179">0xC</span><span class="sxs-lookup"><span data-stu-id="010c8-179">0xC</span></span>  <br/> |<span data-ttu-id="010c8-180">Número o porcentaje</span><span class="sxs-lookup"><span data-stu-id="010c8-180">Number or Percent</span></span>  <br/> |
|<span data-ttu-id="010c8-181">ftCurrency</span><span class="sxs-lookup"><span data-stu-id="010c8-181">ftCurrency</span></span>  <br/> |<span data-ttu-id="010c8-182">0xE</span><span class="sxs-lookup"><span data-stu-id="010c8-182">0xE</span></span>  <br/> |<span data-ttu-id="010c8-183">Moneda</span><span class="sxs-lookup"><span data-stu-id="010c8-183">Currency</span></span>  <br/> |
|<span data-ttu-id="010c8-184">ftCalc</span><span class="sxs-lookup"><span data-stu-id="010c8-184">ftCalc</span></span>  <br/> |<span data-ttu-id="010c8-185">0 x 12</span><span class="sxs-lookup"><span data-stu-id="010c8-185">0x12</span></span>  <br/> |<span data-ttu-id="010c8-186">Fórmula</span><span class="sxs-lookup"><span data-stu-id="010c8-186">Formula</span></span>  <br/> |
|<span data-ttu-id="010c8-187">ftSwitch</span><span class="sxs-lookup"><span data-stu-id="010c8-187">ftSwitch</span></span>  <br/> |<span data-ttu-id="010c8-188">0 x 13</span><span class="sxs-lookup"><span data-stu-id="010c8-188">0x13</span></span>  <br/> |<span data-ttu-id="010c8-189">Combinación de tipo mostrando sólo el primer campo que contenga datos-omitiendo el resto.</span><span class="sxs-lookup"><span data-stu-id="010c8-189">Combination of type showing only the first non-empty field - ignoring subsequent ones.</span></span>  <br/> |
|<span data-ttu-id="010c8-190">ftConcat</span><span class="sxs-lookup"><span data-stu-id="010c8-190">ftConcat</span></span>  <br/> |<span data-ttu-id="010c8-191">0 x 17</span><span class="sxs-lookup"><span data-stu-id="010c8-191">0x17</span></span>  <br/> |<span data-ttu-id="010c8-192">Combinación de tipo uniendo los campos y los fragmentos de texto entre sí.</span><span class="sxs-lookup"><span data-stu-id="010c8-192">Combination of type joining fields and any text fragments to each other.</span></span>  <br/> |
   
## <a name="folderfielddefinitioncommon-stream-structure"></a><span data-ttu-id="010c8-193">Estructura de la secuencia de FolderFieldDefinitionCommon</span><span class="sxs-lookup"><span data-stu-id="010c8-193">FolderFieldDefinitionCommon Stream Structure</span></span>

<span data-ttu-id="010c8-194">Una estructura de secuencia FolderFieldDefinitionCommon contiene los datos de una definición de campo definido por el usuario que es común a un FolderFieldDefinitionA y un FolderFieldDefinitionW.</span><span class="sxs-lookup"><span data-stu-id="010c8-194">A FolderFieldDefinitionCommon stream structure contains the data of a user-defined field definition that is common to both a FolderFieldDefinitionA and a FolderFieldDefinitionW.</span></span>
  
<span data-ttu-id="010c8-195">Elementos de datos en esta secuencia se almacenan en el orden de bytes little-endian, inmediatamente después de cada uno de los otros en el siguiente orden especificado:</span><span class="sxs-lookup"><span data-stu-id="010c8-195">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="010c8-196">**PropSetGuid**: GUID (16 bytes), la propiedad GUID del nombre de propiedad MAPI correspondiente del campo de la carpeta del conjunto.</span><span class="sxs-lookup"><span data-stu-id="010c8-196">**PropSetGuid**: GUID (16 bytes), the property set GUID of the folder field's corresponding MAPI property name.</span></span> <span data-ttu-id="010c8-197">Valor de este campo debe ser igual a PS_PUBLIC_STRINGS, a menos que el tipo de campo es **ftNone** , en cuyo caso el valor de este campo debe ser igual a GUID_NULL.</span><span class="sxs-lookup"><span data-stu-id="010c8-197">This field's value must be equal to PS_PUBLIC_STRINGS, unless the field type is **ftNone** in which case this field's value must be equal to GUID_NULL.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="010c8-198">Por motivos de compatibilidad heredada, Outlook podrá controlar algunos valores de **PropSetGuid** no se ajusten a esta restricción, sin embargo tales casos no se incluyen en este tema.</span><span class="sxs-lookup"><span data-stu-id="010c8-198">For reasons of legacy compatibility, Outlook may be able to handle some **PropSetGuid** values not satisfying this restriction, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="010c8-199">**fcapm**: DWORD (4 bytes), una combinación de cero o más indicadores de los valores de que y significados se enumeran en la siguiente tabla.</span><span class="sxs-lookup"><span data-stu-id="010c8-199">**fcapm**: DWORD (4 bytes), a combination of zero or more flags the values of which and meanings are listed in the following table.</span></span> <span data-ttu-id="010c8-200">Marcas con el mismo valor tienen significados dependientes en el tipo del campo, es decir, el valor de FldType.</span><span class="sxs-lookup"><span data-stu-id="010c8-200">Flags with the same value have meanings dependent on the field's type, that is, FldType value.</span></span>
    
    |<span data-ttu-id="010c8-201">Nombre de indicador</span><span class="sxs-lookup"><span data-stu-id="010c8-201">Flag name</span></span>|<span data-ttu-id="010c8-202">Valor</span><span class="sxs-lookup"><span data-stu-id="010c8-202">Value</span></span>|<span data-ttu-id="010c8-203">Significado</span><span class="sxs-lookup"><span data-stu-id="010c8-203">Meaning</span></span>|
    |:-----|:-----|:-----|
    |<span data-ttu-id="010c8-204">FCAPM_CAN_EDIT</span><span class="sxs-lookup"><span data-stu-id="010c8-204">FCAPM_CAN_EDIT</span></span>  <br/> |<span data-ttu-id="010c8-205">0x00000001</span><span class="sxs-lookup"><span data-stu-id="010c8-205">0x00000001</span></span>  <br/> |<span data-ttu-id="010c8-206">El campo es modificable.</span><span class="sxs-lookup"><span data-stu-id="010c8-206">The field is editable.</span></span>  <br/> |
    |<span data-ttu-id="010c8-207">FCAPM_CAN_SORT</span><span class="sxs-lookup"><span data-stu-id="010c8-207">FCAPM_CAN_SORT</span></span>  <br/> |<span data-ttu-id="010c8-208">0x00000002</span><span class="sxs-lookup"><span data-stu-id="010c8-208">0x00000002</span></span>  <br/> |<span data-ttu-id="010c8-209">El campo es se puede ordenar.</span><span class="sxs-lookup"><span data-stu-id="010c8-209">The field is sortable.</span></span>  <br/> |
    |<span data-ttu-id="010c8-210">FCAPM_CAN_GROUP</span><span class="sxs-lookup"><span data-stu-id="010c8-210">FCAPM_CAN_GROUP</span></span>  <br/> |<span data-ttu-id="010c8-211">0 x 00000004</span><span class="sxs-lookup"><span data-stu-id="010c8-211">0x00000004</span></span>  <br/> |<span data-ttu-id="010c8-212">El campo es agrupable.</span><span class="sxs-lookup"><span data-stu-id="010c8-212">The field is groupable.</span></span>  <br/> |
    |<span data-ttu-id="010c8-213">FCAPM_MULTILINE_TEXT</span><span class="sxs-lookup"><span data-stu-id="010c8-213">FCAPM_MULTILINE_TEXT</span></span>  <br/> |<span data-ttu-id="010c8-214">0 x 00000100</span><span class="sxs-lookup"><span data-stu-id="010c8-214">0x00000100</span></span>  <br/> |<span data-ttu-id="010c8-215">El campo puede contener varias líneas de texto.</span><span class="sxs-lookup"><span data-stu-id="010c8-215">The field can hold multiple lines of text.</span></span>  <br/> |
    |<span data-ttu-id="010c8-216">FCAPM_PERCENT</span><span class="sxs-lookup"><span data-stu-id="010c8-216">FCAPM_PERCENT</span></span>  <br/> |<span data-ttu-id="010c8-217">0 x 01000000</span><span class="sxs-lookup"><span data-stu-id="010c8-217">0x01000000</span></span>  <br/> |<span data-ttu-id="010c8-218">En este campo de la ftFloat de tipo es un campo de porcentaje.</span><span class="sxs-lookup"><span data-stu-id="010c8-218">This field of the type ftFloat is a percentage field.</span></span>  <br/> |
    |<span data-ttu-id="010c8-219">FCAPM_DATEONLY</span><span class="sxs-lookup"><span data-stu-id="010c8-219">FCAPM_DATEONLY</span></span>  <br/> |<span data-ttu-id="010c8-220">0 x 01000000</span><span class="sxs-lookup"><span data-stu-id="010c8-220">0x01000000</span></span>  <br/> |<span data-ttu-id="010c8-221">En este campo de la ftTime de tipo es un campo de tiempo sólo de fecha.</span><span class="sxs-lookup"><span data-stu-id="010c8-221">This field of the type ftTime is a date-only time field.</span></span>  <br/> |
    |<span data-ttu-id="010c8-222">FCAPM_UNITLESS</span><span class="sxs-lookup"><span data-stu-id="010c8-222">FCAPM_UNITLESS</span></span>  <br/> |<span data-ttu-id="010c8-223">0 x 01000000</span><span class="sxs-lookup"><span data-stu-id="010c8-223">0x01000000</span></span>  <br/> |<span data-ttu-id="010c8-224">Para este campo de la ftInteger de tipo, no hay ninguna unidad está permitida en formato de presentación; Por ejemplo formatos como "Computer - K. 640..."</span><span class="sxs-lookup"><span data-stu-id="010c8-224">For this field of the type ftInteger, no unit is allowed in display format; for example such formats as "Computer - 640 K…"</span></span> <span data-ttu-id="010c8-225">no se permiten.</span><span class="sxs-lookup"><span data-stu-id="010c8-225">are not allowed.</span></span>  <br/> |
    |<span data-ttu-id="010c8-226">FCAPM_CAN_EDIT_IN_ITEM</span><span class="sxs-lookup"><span data-stu-id="010c8-226">FCAPM_CAN_EDIT_IN_ITEM</span></span>  <br/> |<span data-ttu-id="010c8-227">0 x 80000000</span><span class="sxs-lookup"><span data-stu-id="010c8-227">0x80000000</span></span>  <br/> |<span data-ttu-id="010c8-228">Se puede editar el campo en el elemento: se trata específicamente de formularios personalizados.</span><span class="sxs-lookup"><span data-stu-id="010c8-228">The field can be edited in the item: This is specifically for custom forms.</span></span>  <br/> |
   
- <span data-ttu-id="010c8-229">**dwString**: DWORD (4 bytes).</span><span class="sxs-lookup"><span data-stu-id="010c8-229">**dwString**: DWORD (4 bytes).</span></span> <span data-ttu-id="010c8-230">Vea la primera nota siguiente.</span><span class="sxs-lookup"><span data-stu-id="010c8-230">See the first following Note.</span></span>
    
- <span data-ttu-id="010c8-231">**dwBitmap**: DWORD (4 bytes).</span><span class="sxs-lookup"><span data-stu-id="010c8-231">**dwBitmap**: DWORD (4 bytes).</span></span> <span data-ttu-id="010c8-232">Vea la primera nota siguiente.</span><span class="sxs-lookup"><span data-stu-id="010c8-232">See the first following Note.</span></span>
    
- <span data-ttu-id="010c8-233">**dwDisplay**: DWORD (4 bytes).</span><span class="sxs-lookup"><span data-stu-id="010c8-233">**dwDisplay**: DWORD (4 bytes).</span></span> <span data-ttu-id="010c8-234">Vea la primera nota siguiente.</span><span class="sxs-lookup"><span data-stu-id="010c8-234">See the first following Note.</span></span>
    
- <span data-ttu-id="010c8-235">**iFmt**: INT (4 bytes).</span><span class="sxs-lookup"><span data-stu-id="010c8-235">**iFmt**: INT (4 bytes).</span></span> <span data-ttu-id="010c8-236">Para los tipos de campo que tienen el "formato:" cuadro combinado en el "nuevo campo de", "Editar campo" y "Propiedades de campo" cuadros de diálogo, el índice basado en 0 del formato seleccionado en dicho cuadro combinado.</span><span class="sxs-lookup"><span data-stu-id="010c8-236">For the field types that have the "Format:" combo box in the "New Field", "Edit Field", and "Field Properties" dialogs, the 0-based index of the format selected in that combo box.</span></span> <span data-ttu-id="010c8-237">Para los tipos de campo sin dicho cuadro combinado, este debe ser 0.</span><span class="sxs-lookup"><span data-stu-id="010c8-237">For the field types without that combo box, this must be 0.</span></span> <span data-ttu-id="010c8-238">El valor del campo junto con el tipo de campo identifica de forma exclusiva determinar los valores de la **dwString**, **dwBitmap**, y campos de **dwDisplay** , vea la primera nota siguiente.</span><span class="sxs-lookup"><span data-stu-id="010c8-238">The field's value together with the field type uniquely determine the values of the **dwString**, **dwBitmap**, and **dwDisplay** fields, see the first following Note.</span></span>
    
- <span data-ttu-id="010c8-239">**wszFormulaLength**: palabra (2 bytes), el número de elementos de la matriz **wszFormulaLength** .</span><span class="sxs-lookup"><span data-stu-id="010c8-239">**wszFormulaLength**: WORD (2 bytes), the number of elements in the **wszFormulaLength** array.</span></span>
    
- <span data-ttu-id="010c8-240">**wszFormulaLength**: una matriz de WCHAR.</span><span class="sxs-lookup"><span data-stu-id="010c8-240">**wszFormulaLength**: An array of WCHAR.</span></span> <span data-ttu-id="010c8-241">Ésta es la representación de Unicode (UTF-16) de la cadena de fórmula del campo en su formato estándar.</span><span class="sxs-lookup"><span data-stu-id="010c8-241">This is the Unicode (UTF-16) representation of the field's formula string in its standard format.</span></span> <span data-ttu-id="010c8-242">Vea la nota siguiente segundo para la descripción del estándar y los formatos de la interfaz de usuario de fórmula de un campo.</span><span class="sxs-lookup"><span data-stu-id="010c8-242">See the second following Note for the description of the standard and UI formats of a field's formula.</span></span> <span data-ttu-id="010c8-243">El recuento de esta matriz es igual a **wszFormulaLength**.</span><span class="sxs-lookup"><span data-stu-id="010c8-243">The count of this array is equal to **wszFormulaLength**.</span></span> <span data-ttu-id="010c8-244">La cadena de fórmula debe ser una cadena vacía a menos que el tipo de campo es **ftCalc**, **ftSwitch** o **ftConcat**.</span><span class="sxs-lookup"><span data-stu-id="010c8-244">The formula string must be an empty string unless the field type is **ftCalc**, **ftSwitch** or **ftConcat**.</span></span>
    
> [!NOTE]
> <span data-ttu-id="010c8-245">Aunque los valores de **dwString**, **dwBitmap**y **dwDisplay** identifica de forma exclusiva se determina según el valor de **FldType** y el valor **iFmt** , que son redundantes, sus valores correctos siguen siendo necesarios para correcta procesamiento de la definición de campo por Outlook.</span><span class="sxs-lookup"><span data-stu-id="010c8-245">Although the values of **dwString**, **dwBitmap**, and **dwDisplay** are uniquely determined based on the **FldType** value and the **iFmt** value, which are redundant, their correct values are still necessary for correct processing of the field definition by Outlook.</span></span> <span data-ttu-id="010c8-246">No hay ninguna descripción sencilla del algoritmo que lleva a cabo esta determinación.</span><span class="sxs-lookup"><span data-stu-id="010c8-246">There is no simple description of the algorithm that performs this determination.</span></span> 
> 
> <span data-ttu-id="010c8-247">Por lo tanto, para averiguar qué valores **dwString**, **dwBitmap**y **dwDisplay** corresponden a un determinado valor de **FldType** y un valor de **iFmt** , realizar una prueba mediante la creación de un campo definido por el usuario de ese tipo y con ese formato seleccionado en el cuadro combinado de **formato** , suponiendo que su aplicación, inspeccionar la secuencia **FolderUserFields** resultante que crea Outlook para ese campo definido por el usuario.</span><span class="sxs-lookup"><span data-stu-id="010c8-247">Therefore, to find out which **dwString**, **dwBitmap**, and **dwDisplay** values correspond to a given **FldType** value and **iFmt** value, perform a test by creating a user-defined field of that type, and with that format selected in the **Format** combo box, assuming its applicability, inspect the resulting **FolderUserFields** stream that Outlook creates for that user-defined field.</span></span> 
  
<span data-ttu-id="010c8-248">Se edita la fórmula del campo en su formato de la interfaz de usuario en el cuadro de texto de la **fórmula** del **Campo nuevo**, **Editar campo**y cuadros de diálogo de **Propiedades de campo** para el campo definido por el usuario.</span><span class="sxs-lookup"><span data-stu-id="010c8-248">The field's formula in its UI format is edited in the **Formula** text box of the **New Field**, **Edit Field**, and **Field Properties** dialogs for the user-defined field.</span></span> <span data-ttu-id="010c8-249">El algoritmo para convertir una fórmula desde el formato de la interfaz de usuario en el formato estándar depende del tipo de campo tal como se describe en el siguiente:</span><span class="sxs-lookup"><span data-stu-id="010c8-249">The algorithm to convert a formula from the UI format to the standard format depends on the field type as described in the following:</span></span> 
- <span data-ttu-id="010c8-250">Para los campos de tipos **ftCalc** y **ftSwitch**, el formato estándar para los campos integrados, ya que las propiedades MAPI correspondientes no son las propiedades con nombre de la MNID kind\_cadena, se obtiene mediante el reemplazo de fragmentos de nombre de campo, es decir `[<field_name>]` con fragmentos de `[_<field_dispid_decimal>]`.</span><span class="sxs-lookup"><span data-stu-id="010c8-250">For fields of types **ftCalc** and **ftSwitch**, the standard format for built-in fields, which corresponding MAPI properties are not named properties of the kind MNID\_STRING, is obtained by replacing field name fragments, that is `[<field_name>]` with fragments `[_<field_dispid_decimal>]`.</span></span> 

  <span data-ttu-id="010c8-251">Por ejemplo, si el formato de la interfaz de usuario de una fórmula para un campo del tipo de **fórmula**, que es **ftCalc**, con el idioma de la interfaz de usuario de Office que se va a inglés de Estados Unidos, es `[Business Phone] & [My custom field]`, donde `My custom field` es el nombre de un campo definido por el usuario, el formato estándar de una fórmula de este tipo sería `[_14856] & [My custom field]`.</span><span class="sxs-lookup"><span data-stu-id="010c8-251">For example, if the UI format of a formula for a field of the type **Formula**, that is **ftCalc**, with the Office UI language being US English, is `[Business Phone] & [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format of such a formula would be `[_14856] & [My custom field]`.</span></span>

- <span data-ttu-id="010c8-252">Para los campos de la de tipo **ftConcat**, se obtiene el formato estándar, realice lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="010c8-252">For fields of the type **ftConcat**, the standard format is obtained by performing the following:</span></span>

  1. <span data-ttu-id="010c8-253">Truncar el espacio en blanco inicial y final.</span><span class="sxs-lookup"><span data-stu-id="010c8-253">Truncate leading and trailing whitespace.</span></span> 
  2. <span data-ttu-id="010c8-254">Analizar la fórmula en una secuencia de fragmentos de los dos tipos siguientes:</span><span class="sxs-lookup"><span data-stu-id="010c8-254">Parse the formula into a sequence of fragments of the following two kinds:</span></span> 
     - <span data-ttu-id="010c8-255">Un nombre de campo entre corchetes, es decir, `[<field_name>]`.</span><span class="sxs-lookup"><span data-stu-id="010c8-255">A field name in square brackets, that is, `[<field_name>]`.</span></span> 
     - <span data-ttu-id="010c8-256">Una subcadena que no contiene ningún corchetes.</span><span class="sxs-lookup"><span data-stu-id="010c8-256">A substring not containing any square brackets.</span></span>   
      <span data-ttu-id="010c8-257">Asegurarse de que no hay dos fragmentos del segundo tipo son adyacentes en la secuencia.</span><span class="sxs-lookup"><span data-stu-id="010c8-257">Assure that no two fragments of the second kind are adjacent in the sequence.</span></span> <span data-ttu-id="010c8-258">Si la fórmula no se puede analizar de este modo, se considera no válido.</span><span class="sxs-lookup"><span data-stu-id="010c8-258">If the formula cannot be parsed this way, it is considered invalid.</span></span> 
  3. <span data-ttu-id="010c8-259">Lleve a cabo la sustitución de la misma para los fragmentos del primer tipo en cuanto a los campos **ftCalc** y **ftSwitch** .</span><span class="sxs-lookup"><span data-stu-id="010c8-259">Perform the same replacement for fragments of the first kind as for the **ftCalc** and **ftSwitch** fields.</span></span> 
  4. <span data-ttu-id="010c8-260">Para cada fragmento del segundo tipo, escape todas las comillas dobles ("" ") caracteres, si lo hay, con dos caracteres de comillas dobles consecutivos y escríbalo entre comillas dobles.</span><span class="sxs-lookup"><span data-stu-id="010c8-260">For each fragment of the second kind, escape all double-quote (""") characters, if any, with two consecutive double-quote characters, and enclose it in double quotes.</span></span> 
  5. <span data-ttu-id="010c8-261">Insertar una cadena de y comercial (`&`) entre cada par de fragmentos adyacentes.</span><span class="sxs-lookup"><span data-stu-id="010c8-261">Insert an ampersand string (`&`) between each pair of adjacent fragments.</span></span>
 
  <span data-ttu-id="010c8-262">Por ejemplo, con el idioma de la interfaz de usuario de Office inglés de Estados Unidos, si el formato de la interfaz de usuario de una fórmula para un campo del tipo **ftConcat** es `text1 [Business Phone] "text2" [My custom field]`, donde `My custom field` es el nombre de un campo definido por el usuario, el formato estándar para una fórmula de este tipo sería `""text1" & [_14856] & """text2""" & [My custom field]"`.</span><span class="sxs-lookup"><span data-stu-id="010c8-262">For example, using the Office UI language US English, if the UI format of a formula for a field of the type **ftConcat** is `text1 [Business Phone] "text2" [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format for such a formula would be `""text1" & [_14856] & """text2""" & [My custom field]"`.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="010c8-263">Vea también</span><span class="sxs-lookup"><span data-stu-id="010c8-263">See also</span></span>

- [<span data-ttu-id="010c8-264">Muestra de la secuencia FolderUserFields</span><span class="sxs-lookup"><span data-stu-id="010c8-264">FolderUserFields Stream Sample</span></span>](folderuserfields-stream-sample.md)
- [<span data-ttu-id="010c8-265">Agregar una definición para un nuevo campo definido por el usuario</span><span class="sxs-lookup"><span data-stu-id="010c8-265">Add a Definition for a New User-Defined Field</span></span>](how-to-add-a-definition-for-a-new-user-defined-field.md)

