---
title: Actuar como proveedor de libreta de direcciones de host
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f06a1034-ee49-4a09-831e-9752713228a8
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: 202d4b4391de7553e39e50dc527df5502ebcefb3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406468"
---
# <a name="acting-as-a-host-address-book-provider"></a><span data-ttu-id="3a155-103">Actuar como proveedor de libreta de direcciones de host</span><span class="sxs-lookup"><span data-stu-id="3a155-103">Acting as a Host Address Book Provider</span></span>

  
  
<span data-ttu-id="3a155-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="3a155-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="3a155-105">Un proveedor de host es un proveedor de libreta de direcciones que incluye destinatarios de otros proveedores en sus contenedores y se basa en la implementación de los destinatarios por parte de los demás proveedores para controlar parcialmente su mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="3a155-105">A host provider is an address book provider that includes recipients from other providers in its containers and relies on the implementation of the recipients by the other providers to partially control their maintenance.</span></span> <span data-ttu-id="3a155-106">Un proveedor de host usa los identificadores de plantilla de estos destinatarios externos para enlazar los datos de estos destinatarios al código en el proveedor externo.</span><span class="sxs-lookup"><span data-stu-id="3a155-106">A host provider uses the template identifiers of these foreign recipients to bind the data for these recipients to code in the foreign provider.</span></span> <span data-ttu-id="3a155-107">Este proceso de enlace se inicia cuando el proveedor recupera la propiedad **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) de un destinatario y la pasa en una llamada a [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span><span class="sxs-lookup"><span data-stu-id="3a155-107">This binding process is initiated when your provider retrieves the **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property of a recipient and passes it in a call to [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span></span> 
  
<span data-ttu-id="3a155-108">Cuando el proveedor llama a **IMAPISupport::OpenTemplateID**, MAPI coincide con **MAPIUID** dentro del identificador de plantilla con un **MAPIUID** registrado por un proveedor y llama al método [IABLogon::OpenTemplateID](iablogon-opentemplateid.md) del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3a155-108">When your provider calls **IMAPISupport::OpenTemplateID**, MAPI matches the **MAPIUID** within the template identifier with a **MAPIUID** registered by a provider and calls the provider's [IABLogon::OpenTemplateID](iablogon-opentemplateid.md) method.</span></span> <span data-ttu-id="3a155-109">El proveedor externo puede devolver un puntero al objeto de propiedad del proveedor, a su propia implementación de objeto de propiedad o a una implementación que encapsula el objeto del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3a155-109">The foreign provider might return a pointer to your provider's property object, to its own property object implementation, or to an implementation that wraps your provider's object.</span></span> <span data-ttu-id="3a155-110">El puntero devuelto se coloca en el contenido del parámetro _lppMAPIPropNew._</span><span class="sxs-lookup"><span data-stu-id="3a155-110">The returned pointer is placed in the contents of the  _lppMAPIPropNew_ parameter.</span></span> 
  
<span data-ttu-id="3a155-111">El proveedor puede elegir si se llama o no a **IMAPISupport::OpenTemplateID** con el FILL_ENTRY marca.</span><span class="sxs-lookup"><span data-stu-id="3a155-111">Your provider can choose whether or not to call **IMAPISupport::OpenTemplateID** with the FILL_ENTRY flag set.</span></span> <span data-ttu-id="3a155-112">Establezca esta marca cuando se cree el destinatario o cuando haya transcurrido mucho tiempo desde que el proveedor haya actualizado las propiedades del destinatario.</span><span class="sxs-lookup"><span data-stu-id="3a155-112">Set this flag when the recipient is being created or when a long time has passed since your provider has refreshed the recipient's properties.</span></span> <span data-ttu-id="3a155-113">Un uso común de la marca FILL_ENTRY es mantener un destinatario en el proveedor sincronizado con el original.</span><span class="sxs-lookup"><span data-stu-id="3a155-113">A common use of the FILL_ENTRY flag is to keep a recipient in your provider synchronized with the original.</span></span> <span data-ttu-id="3a155-114">La implementación de este tipo de programación de sincronización mejora el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="3a155-114">Implementing this type of synchronization schedule enhances performance.</span></span> 
  
 <span data-ttu-id="3a155-115">**Para mantener sincronizado un destinatario externo**</span><span class="sxs-lookup"><span data-stu-id="3a155-115">**To keep a foreign recipient synchronized**</span></span>
  
1. <span data-ttu-id="3a155-116">Determine un intervalo adecuado para las actualizaciones periódicas.</span><span class="sxs-lookup"><span data-stu-id="3a155-116">Determine an appropriate interval for periodic updates.</span></span> 
    
2. <span data-ttu-id="3a155-117">Marca de tiempo cada llamada [a IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span><span class="sxs-lookup"><span data-stu-id="3a155-117">Timestamp each call to [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span></span> 
    
3. <span data-ttu-id="3a155-118">Evalúe si es necesario realizar una actualización completa en función de la cantidad de tiempo que ha expirado desde la última llamada.</span><span class="sxs-lookup"><span data-stu-id="3a155-118">Evaluate whether or not it is necessary to perform a full update based on the amount of time that has expired since the last call.</span></span> <span data-ttu-id="3a155-119">Si es necesaria una actualización completa, llame a **IMAPISupport::OpenTemplateID** con la marca FILL_ENTRY.</span><span class="sxs-lookup"><span data-stu-id="3a155-119">If a full update is necessary, call **IMAPISupport::OpenTemplateID** with the FILL_ENTRY flag.</span></span> <span data-ttu-id="3a155-120">Si no es necesario, no establezca la marca en la llamada.</span><span class="sxs-lookup"><span data-stu-id="3a155-120">If it is not necessary, do not set the flag on the call.</span></span> 
    
<span data-ttu-id="3a155-121">Cuando un cliente realiza una solicitud para una de las propiedades del destinatario copiado, el proveedor puede elegir entre controlar la solicitud en sí o usar el código proporcionado por el proveedor externo.</span><span class="sxs-lookup"><span data-stu-id="3a155-121">When a client makes a request for one of the copied recipient's properties, your provider can choose whether to handle the request itself or use the code supplied by the foreign provider.</span></span> <span data-ttu-id="3a155-122">El proveedor puede esperar que el proveedor externo intercepte la mayoría de las llamadas, si no todas, a **IMAPIProp** excepto [IMAPIProp::OpenProperty](imapiprop-openproperty.md).</span><span class="sxs-lookup"><span data-stu-id="3a155-122">Your provider can expect the foreign provider to intercept most, if not all, calls to **IMAPIProp** except for [IMAPIProp::OpenProperty](imapiprop-openproperty.md).</span></span> <span data-ttu-id="3a155-123">Una llamada **a OpenProperty** que solicita **la propiedad PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) siempre se reenvía al proveedor.</span><span class="sxs-lookup"><span data-stu-id="3a155-123">A call to **OpenProperty** requesting the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property is always forwarded to your provider.</span></span>
  
 <span data-ttu-id="3a155-124">**Para obtener acceso al código de identificador de plantilla**</span><span class="sxs-lookup"><span data-stu-id="3a155-124">**To access template identifier code**</span></span>
  
1. <span data-ttu-id="3a155-125">Abra el destinatario y llame a su [método IMAPIProp::GetProps](imapiprop-getprops.md) para recuperar la **propiedad PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="3a155-125">Open the recipient and call its [IMAPIProp::GetProps](imapiprop-getprops.md) method to retrieve the **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property.</span></span> <span data-ttu-id="3a155-126">Si Se produce un error en **GetProps** **PR_TEMPLATEID** no está disponible, el proveedor externo no admite un identificador de plantilla y código relacionado para este destinatario.</span><span class="sxs-lookup"><span data-stu-id="3a155-126">If **GetProps** fails because **PR_TEMPLATEID** is unavailable, the foreign provider does not support a template identifier and related code for this recipient.</span></span> <span data-ttu-id="3a155-127">El proveedor tendrá que usar su implementación del destinatario para todo el mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="3a155-127">Your provider will need to use its implementation of the recipient for all maintenance.</span></span> 
    
2. <span data-ttu-id="3a155-128">Si el identificador de plantilla se devuelve de **GetProps**, pásalo y un puntero a la implementación **imapiprop** del destinatario en una llamada al método **IMAPISupport::OpenTemplateID.**</span><span class="sxs-lookup"><span data-stu-id="3a155-128">If the template identifier is returned from **GetProps**, pass it and a pointer to the recipient's **IMAPIProp** implementation in a call to the **IMAPISupport::OpenTemplateID** method.</span></span> <span data-ttu-id="3a155-129">Establezca la marca FILL_ENTRY si la mayoría o todas las propiedades del destinatario necesitan actualizarse, como en el momento de la creación o si no se han actualizado durante un tiempo.</span><span class="sxs-lookup"><span data-stu-id="3a155-129">Set the FILL_ENTRY flag if most or all of the recipient's properties need to be updated, such as at creation time or if they have not been updated for a while.</span></span> 
    
3. <span data-ttu-id="3a155-130">Si **OpenTemplateID** devuelve la implementación **IMAPIProp** del proveedor externo, devuelva al cliente un puntero a esta implementación.</span><span class="sxs-lookup"><span data-stu-id="3a155-130">If **OpenTemplateID** returns the foreign provider's **IMAPIProp** implementation, return to the client a pointer to this implementation.</span></span> 
    
4. <span data-ttu-id="3a155-131">Si **OpenTemplateID** no devuelve una implementación, normalmente porque el proveedor externo no está en el perfil, devuelva al cliente un puntero a la implementación **imapiprop** del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3a155-131">If **OpenTemplateID** does not return an implementation, typically because the foreign provider is not in the profile, return to the client a pointer to your provider's **IMAPIProp** implementation.</span></span> <span data-ttu-id="3a155-132">El cliente debe poder trabajar con las propiedades del objeto mediante cualquiera de las dos interfaces.</span><span class="sxs-lookup"><span data-stu-id="3a155-132">The client should be able to work with the object's properties using either interface.</span></span> 
    

