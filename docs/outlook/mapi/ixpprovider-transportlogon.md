---
title: IXPProviderTransportLogon
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IXPProvider.TransportLogon
api_type:
- COM
ms.assetid: 534929f2-36a2-463d-8c4c-d86060cde127
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: 96e81442125ae49e0c2856a1cf3a97a16d3453cf
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/23/2018
ms.locfileid: "22583340"
---
# <a name="ixpprovidertransportlogon"></a><span data-ttu-id="c22e6-103">IXPProvider::TransportLogon</span><span class="sxs-lookup"><span data-stu-id="c22e6-103">IXPProvider::TransportLogon</span></span>

<span data-ttu-id="c22e6-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="c22e6-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="c22e6-105">Establece una sesión en el que una aplicación cliente inicia sesión en un proveedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="c22e6-105">Establishes a session in which a client application logs on to a transport provider.</span></span> 
  
```cpp
HRESULT TransportLogon(
  LPMAPISUP lpMAPISup,
  ULONG_PTR ulUIParam,
  LPSTR lpszProfileName,
  ULONG FAR * lpulFlags,
  LPMAPIERROR FAR * lppMAPIError,
  LPXPLOGON FAR * lppXPLogon
);
```

## <a name="parameters"></a><span data-ttu-id="c22e6-106">Parámetros</span><span class="sxs-lookup"><span data-stu-id="c22e6-106">Parameters</span></span>

<span data-ttu-id="c22e6-107">_lpMAPISup_: [entrada] puntero al objeto de soporte técnico del proveedor de transporte para las funciones de devolución de llamada dentro de MAPI para esta sesión.</span><span class="sxs-lookup"><span data-stu-id="c22e6-107">_lpMAPISup_: [in] Pointer to the transport provider's support object for callback functions within MAPI for this session.</span></span> <span data-ttu-id="c22e6-108">Este objeto sigue siendo válida hasta que el proveedor de transporte lo libera.</span><span class="sxs-lookup"><span data-stu-id="c22e6-108">This object remains valid until the transport provider releases it.</span></span>
    
<span data-ttu-id="c22e6-109">_ulUIParam_: [entrada] identificador de la ventana principal de los cuadros de diálogo o windows muestra este método.</span><span class="sxs-lookup"><span data-stu-id="c22e6-109">_ulUIParam_: [in] Handle to the parent window of any dialog boxes or windows this method displays.</span></span> <span data-ttu-id="c22e6-110">El parámetro _ulUIParam_ puede ser distintos de null, por ejemplo, cuando se marca el LOGON_SETUP se establece en el parámetro _lpulFlags_ .</span><span class="sxs-lookup"><span data-stu-id="c22e6-110">The  _ulUIParam_ parameter can be non-null, for example when the LOGON_SETUP flag is set in the  _lpulFlags_ parameter.</span></span> 
    
<span data-ttu-id="c22e6-111">_lpszProfileName_: [entrada] puntero al nombre de perfil del usuario.</span><span class="sxs-lookup"><span data-stu-id="c22e6-111">_lpszProfileName_: [in] Pointer to the profile name of the user.</span></span> <span data-ttu-id="c22e6-112">El parámetro _lpszProfileName_ se usa principalmente cuando un cuadro de diálogo debe presentarse.</span><span class="sxs-lookup"><span data-stu-id="c22e6-112">The  _lpszProfileName_ parameter is primarily used when a dialog box must be presented.</span></span> 
    
<span data-ttu-id="c22e6-113">_lpulFlags_: [en, out] máscara de bits de indicadores que controla cómo se establece la sesión de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="c22e6-113">_lpulFlags_: [in, out] Bitmask of flags that controls how the logon session is established.</span></span> <span data-ttu-id="c22e6-114">Las siguientes marcas se pueden establecer en los datos proporcionados por la cola MAPI:</span><span class="sxs-lookup"><span data-stu-id="c22e6-114">The following flags can be set on input by the MAPI spooler:</span></span>
    
  - <span data-ttu-id="c22e6-115">LOGON_NO_CONNECT: La cuenta de usuario está iniciando sesión con este proveedor de transporte para fines distintos de transmisión y recepción de mensajes.</span><span class="sxs-lookup"><span data-stu-id="c22e6-115">LOGON_NO_CONNECT: The user account is logging on to this transport provider for purposes other than transmission and reception of messages.</span></span> <span data-ttu-id="c22e6-116">El proveedor de transporte no debe intentar establecer las conexiones con otros sistemas de mensajería.</span><span class="sxs-lookup"><span data-stu-id="c22e6-116">The transport provider should not attempt to make any connections to other messaging systems.</span></span>
        
  - <span data-ttu-id="c22e6-117">LOGON_NO_DIALOG: Ningún cuadro de diálogo debe mostrarse incluso si las credenciales del usuario actualmente guardada no son válidas o suficientes para el inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="c22e6-117">LOGON_NO_DIALOG: No dialog box should be displayed even if the currently saved user credentials are invalid or insufficient for logon.</span></span>
        
  - <span data-ttu-id="c22e6-118">LOGON_NO_INBOUND: El proveedor de transporte no tiene que inicializar para la recepción de mensajes y no debe aceptar los mensajes entrantes.</span><span class="sxs-lookup"><span data-stu-id="c22e6-118">LOGON_NO_INBOUND: The transport provider does not have to initialize for reception of messages and should not accept incoming messages.</span></span> <span data-ttu-id="c22e6-119">La cola MAPI puede utilizar el método [IXPLogon::TransportNotify](ixplogon-transportnotify.md) más adelante para señalar el proveedor de transporte para habilitar el procesamiento de mensajes entrantes.</span><span class="sxs-lookup"><span data-stu-id="c22e6-119">The MAPI spooler can use the [IXPLogon::TransportNotify](ixplogon-transportnotify.md) method later to signal the transport provider to enable incoming message processing.</span></span> 
        
  - <span data-ttu-id="c22e6-120">LOGON_NO_OUTBOUND: El proveedor de transporte no se tiene que inicializar para el envío de mensajes, como la cola MAPI no proporciona.</span><span class="sxs-lookup"><span data-stu-id="c22e6-120">LOGON_NO_OUTBOUND: The transport provider does not have to initialize for sending messages, as the MAPI spooler does not provide any.</span></span> <span data-ttu-id="c22e6-121">Si una aplicación cliente requiere una conexión a un proveedor remoto durante la composición de un mensaje para que pueden realizar llamadas al método [IXPLogon::AddressTypes](ixplogon-addresstypes.md) , el proveedor de transporte debe realizar la conexión.</span><span class="sxs-lookup"><span data-stu-id="c22e6-121">If a client application requires a connection to a remote provider during the composition of a message so that it can make [IXPLogon::AddressTypes](ixplogon-addresstypes.md) method calls, the transport provider should make the connection.</span></span> <span data-ttu-id="c22e6-122">La cola MAPI puede utilizar **TransportNotify** para indicar el proveedor de transporte cuando puedan comenzar las operaciones realizadas.</span><span class="sxs-lookup"><span data-stu-id="c22e6-122">The MAPI spooler can use **TransportNotify** to signal the transport provider when outgoing operations can begin.</span></span> 
      
  - <span data-ttu-id="c22e6-123">MAPI_UNICODE.: La cadena pasada para el nombre del perfil que se encuentra en formato Unicode.</span><span class="sxs-lookup"><span data-stu-id="c22e6-123">MAPI_UNICODE: The passed-in string for the profile name is in Unicode format.</span></span> <span data-ttu-id="c22e6-124">Si la MAPI\_no está establecido el indicador UNICODE, la cadena está en formato ANSI.</span><span class="sxs-lookup"><span data-stu-id="c22e6-124">If the MAPI\_UNICODE flag is not set, the string is in ANSI format.</span></span>
      
    <span data-ttu-id="c22e6-125">Pueden establecer los siguientes indicadores en la salida por el proveedor de transporte:</span><span class="sxs-lookup"><span data-stu-id="c22e6-125">The following flags can be set on output by the transport provider:</span></span>
      
  - <span data-ttu-id="c22e6-126">LOGON_SP_IDLE: Solicitudes que la cola MAPI llama con frecuencia (método [IXPLogon::Idle](ixplogon-idle.md) ) del proveedor de transporte para el procesamiento de tiempo de inactividad.</span><span class="sxs-lookup"><span data-stu-id="c22e6-126">LOGON_SP_IDLE: Requests that the MAPI spooler frequently call the transport provider's [IXPLogon::Idle](ixplogon-idle.md) method for idle-time processing.</span></span> 
      
  - <span data-ttu-id="c22e6-127">LOGON_SP_POLL: Las solicitudes que con frecuencia la cola MAPI llamar al método [IXPLogon::Poll](ixplogon-poll.md) en el objeto devuelto de inicio de sesión para comprobar para nuevos mensajes.</span><span class="sxs-lookup"><span data-stu-id="c22e6-127">LOGON_SP_POLL: Requests that the MAPI spooler frequently call the [IXPLogon::Poll](ixplogon-poll.md) method on the returned logon object to check for new messages.</span></span> <span data-ttu-id="c22e6-128">Si no se establece este marcador, la cola MAPI sólo se comprueba para nuevos mensajes cuando el proveedor de transporte que usa el método [SpoolerNotify](imapisupport-spoolernotify.md) para notificar a la cola de impresión que no hay mensajes nuevos para procesar.</span><span class="sxs-lookup"><span data-stu-id="c22e6-128">If this flag is not set, the MAPI spooler only checks for new messages when the transport provider uses the [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) method to notify the spooler that there are new messages to process.</span></span> <span data-ttu-id="c22e6-129">Un proveedor de transporte eficazmente se convierte en solo envío estableciendo esta marca no y no se informa a la cola MAPI de recepción de mensaje.</span><span class="sxs-lookup"><span data-stu-id="c22e6-129">A transport provider effectively becomes send-only by not setting this flag and by not notifying the MAPI spooler of message receipt.</span></span> 
      
  - <span data-ttu-id="c22e6-130">LOGON_SP_RESOLVE: Las solicitudes de la cola MAPI resolverse en total direcciones de todas las direcciones de mensaje para los destinatarios no admitidas por este proveedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="c22e6-130">LOGON_SP_RESOLVE: Requests that the MAPI spooler resolve to full addresses all message addresses for recipients not supported by this transport provider.</span></span> <span data-ttu-id="c22e6-131">Por lo tanto, que el proveedor de transporte puede construir una ruta de acceso de respuesta para todos los destinatarios.</span><span class="sxs-lookup"><span data-stu-id="c22e6-131">Therefore that the transport provider can construct a reply path for all recipients.</span></span>
      
  - <span data-ttu-id="c22e6-132">MAPI_UNICODE.: Las cadenas devueltas en la estructura [MAPIERROR](mapierror.md) , si hay alguna, se encuentran en formato Unicode.</span><span class="sxs-lookup"><span data-stu-id="c22e6-132">MAPI_UNICODE: The returned strings in the [MAPIERROR](mapierror.md) structure, if any, are in Unicode format.</span></span> <span data-ttu-id="c22e6-133">Si no está establecido el indicador MAPI_UNICODE., las cadenas están en formato ANSI.</span><span class="sxs-lookup"><span data-stu-id="c22e6-133">If the MAPI_UNICODE flag is not set, the strings are in ANSI format.</span></span> 
    
<span data-ttu-id="c22e6-134">_lppMAPIError_: [salida] puntero a un puntero a la estructura **MAPIERROR** devuelta, si hay alguna, que contiene información de versión, el componente y el contexto para el error.</span><span class="sxs-lookup"><span data-stu-id="c22e6-134">_lppMAPIError_: [out] Pointer to a pointer to the returned **MAPIERROR** structure, if any, that contains version, component, and context information for the error.</span></span> <span data-ttu-id="c22e6-135">El parámetro _lppMAPIError_ se puede establecer en NULL si no hay ninguna estructura **MAPIERROR** para devolver.</span><span class="sxs-lookup"><span data-stu-id="c22e6-135">The  _lppMAPIError_ parameter can be set to NULL if there is no **MAPIERROR** structure to return.</span></span> 
    
<span data-ttu-id="c22e6-136">_lppXPLogon_: [salida] puntero al puntero para el objeto de inicio de sesión del proveedor de transporte devuelto.</span><span class="sxs-lookup"><span data-stu-id="c22e6-136">_lppXPLogon_: [out] Pointer to the pointer to the returned transport provider logon object.</span></span>
    
## <a name="return-value"></a><span data-ttu-id="c22e6-137">Valor devuelto</span><span class="sxs-lookup"><span data-stu-id="c22e6-137">Return value</span></span>

<span data-ttu-id="c22e6-138">S_OK: La llamada se ha realizado correctamente y devuelva el valor esperado o los valores.</span><span class="sxs-lookup"><span data-stu-id="c22e6-138">S_OK: The call succeeded and has returned the expected value or values.</span></span>
    
<span data-ttu-id="c22e6-139">MAPI_E_FAILONEPROVIDER: Este proveedor no puede iniciar sesión, pero este error debe deshabilitar el servicio.</span><span class="sxs-lookup"><span data-stu-id="c22e6-139">MAPI_E_FAILONEPROVIDER: This provider cannot log on, but this error should not disable the service.</span></span> 
    
<span data-ttu-id="c22e6-140">MAPI_E_UNCONFIGURED: El perfil no contiene información suficiente para el inicio de sesión para completarse.</span><span class="sxs-lookup"><span data-stu-id="c22e6-140">MAPI_E_UNCONFIGURED: The profile does not contain enough information for the logon to be completed.</span></span> <span data-ttu-id="c22e6-141">MAPI llama a la función de punto de entrada de servicio de mensajes del proveedor.</span><span class="sxs-lookup"><span data-stu-id="c22e6-141">MAPI calls the provider's message service entry point function.</span></span>
    
<span data-ttu-id="c22e6-142">MAPI_E_UNKNOWN_CPID: El proveedor no admite la página de códigos del cliente.</span><span class="sxs-lookup"><span data-stu-id="c22e6-142">MAPI_E_UNKNOWN_CPID: The provider cannot support the client's code page.</span></span>
    
<span data-ttu-id="c22e6-143">MAPI_E_UNKNOWN_LCID: El proveedor no admite la información de configuración regional del cliente.</span><span class="sxs-lookup"><span data-stu-id="c22e6-143">MAPI_E_UNKNOWN_LCID: The provider cannot support the client's locale information.</span></span>
    
<span data-ttu-id="c22e6-144">MAPI_E_USER_CANCEL: El usuario ha cancelado la operación, normalmente haciendo clic en el botón **Cancelar** en un cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="c22e6-144">MAPI_E_USER_CANCEL: The user canceled the operation, typically by clicking the **Cancel** button in a dialog box.</span></span> 
    
## <a name="remarks"></a><span data-ttu-id="c22e6-145">Comentarios</span><span class="sxs-lookup"><span data-stu-id="c22e6-145">Remarks</span></span>

<span data-ttu-id="c22e6-146">La cola MAPI llama al método de **IXPProvider::TransportLogon** para establecer una sesión de inicio de sesión de un usuario.</span><span class="sxs-lookup"><span data-stu-id="c22e6-146">The MAPI spooler calls the **IXPProvider::TransportLogon** method to establish a logon session for a user.</span></span> 
  
<span data-ttu-id="c22e6-147">Mayoría de los proveedores de transporte use el método [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) que se proporcionan con el objeto de soporte técnico que apunta el parámetro _lpMAPISup_ para guardar y recuperar información de identidad de usuario, las direcciones del servidor y las credenciales.</span><span class="sxs-lookup"><span data-stu-id="c22e6-147">Most transport providers use the [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) method provided with the support object pointed to by the  _lpMAPISup_ parameter for saving and retrieving user identity information, server addresses, and credentials.</span></span> <span data-ttu-id="c22e6-148">Mediante el uso de **OpenProfileSection**, un proveedor de transporte puede guardar información arbitraria y asociarlo con un inicio de sesión a un recurso determinado.</span><span class="sxs-lookup"><span data-stu-id="c22e6-148">By using **OpenProfileSection**, a transport provider can save arbitrary information and associate it with a logon to a particular resource.</span></span> <span data-ttu-id="c22e6-149">Por ejemplo, un proveedor puede usar **OpenProfileSection** para guardar el nombre de cuenta y la contraseña asociada a una sesión determinada y los nombres de servidor u otra información necesaria que se requieren acceso a los recursos para esa sesión.</span><span class="sxs-lookup"><span data-stu-id="c22e6-149">For example, a provider can use **OpenProfileSection** to save the account name and password associated with a particular session and any server names or other necessary information that are required to access resources for that session.</span></span> <span data-ttu-id="c22e6-150">MAPI oculta información asociada con un recurso desde fuera de access.</span><span class="sxs-lookup"><span data-stu-id="c22e6-150">MAPI hides information associated with a resource from outside access.</span></span> <span data-ttu-id="c22e6-151">La sección de perfil disponible a través de _lpMAPISup_ está administrada por la cola de MAPI para que datos relacionados con el contexto de usuario están separados de datos para otros contextos.</span><span class="sxs-lookup"><span data-stu-id="c22e6-151">The profile section made available through  _lpMAPISup_ is managed by the MAPI spooler so data related to this user context is separated from data for other contexts.</span></span> 
  
<span data-ttu-id="c22e6-152">El proveedor de transporte debe llamar al método **IUnknown:: AddRef** en el objeto de soporte técnico y mantener una copia del puntero a este objeto como parte del objeto de proveedor de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="c22e6-152">The transport provider must call the **IUnknown::AddRef** method on the support object and keep a copy of the pointer to this object as part of the provider logon object.</span></span> 
  
<span data-ttu-id="c22e6-153">El nombre para mostrar del perfil en _lpszProfileName_ se proporciona para que el proveedor de transporte puede usar en los mensajes de error o cuadros de diálogo de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="c22e6-153">The profile display name in  _lpszProfileName_ is provided so the transport provider can use it in error messages or logon dialog boxes.</span></span> <span data-ttu-id="c22e6-154">Si el proveedor mantiene este nombre, se debe copiar almacenamiento asignado por el proveedor.</span><span class="sxs-lookup"><span data-stu-id="c22e6-154">If the provider retains this name, it must be copied to storage allocated by the provider.</span></span> 
  
<span data-ttu-id="c22e6-155">Los proveedores de transporte que estén asociados estrechamente con otros proveedores de servicios que tenga que realizar trabajo adicional en el inicio de sesión para establecer las credenciales de una buena necesarias para las operaciones entre proveedores complementarios.</span><span class="sxs-lookup"><span data-stu-id="c22e6-155">Transport providers that are tightly coupled with other service providers may have to do additional work at logon to establish the good credentials required for operations between companion providers.</span></span>
  
<span data-ttu-id="c22e6-156">Normalmente, los proveedores de transporte se abren cuando el usuario inicia sesión en primer lugar en un perfil.</span><span class="sxs-lookup"><span data-stu-id="c22e6-156">Usually, transport providers are opened when the user first logs on to a profile.</span></span> <span data-ttu-id="c22e6-157">Debido a que el primer inicio de sesión a un perfil por lo tanto, generalmente viene antes de iniciar sesión en cualquier almacén de mensajes, la cola MAPI llama normalmente **TransportLogon** con el LOGON_NO_INBOUND y el LOGON_NO_OUTBOUND indicadores establecidos en _lpulFlags_.</span><span class="sxs-lookup"><span data-stu-id="c22e6-157">Because the first logon to a profile therefore generally comes before logon to any message store, the MAPI spooler usually calls **TransportLogon** with both the LOGON_NO_INBOUND and LOGON_NO_OUTBOUND flags set in  _lpulFlags_.</span></span> <span data-ttu-id="c22e6-158">Más adelante, cuando los almacenes de mensaje adecuado están disponibles en la sesión de perfiles, la cola MAPI llama **TransportNotify** para iniciar operaciones entrantes y salientes para el proveedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="c22e6-158">Later, when the appropriate message stores are available in the profile session, the MAPI spooler calls **TransportNotify** to initiate incoming and outgoing operations for the transport provider.</span></span> 
  
<span data-ttu-id="c22e6-159">Se pasa el indicador LOGON_NO_CONNECT en _lpulFlags_ señales operación sin conexión del proveedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="c22e6-159">Passing the LOGON_NO_CONNECT flag in  _lpulFlags_ signals offline operation of the transport provider.</span></span> <span data-ttu-id="c22e6-160">Esta marca indica que no deben realizarse conexiones externas; Si el proveedor de transporte no puede establecer una sesión sin una conexión externa, debe devolver un valor de error para el inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="c22e6-160">This flag indicates no external connections should be made; if the transport provider cannot establish a session without an external connection, it should return an error value for the logon.</span></span> 
  
<span data-ttu-id="c22e6-161">Un proveedor de transporte debe establecer la marca LOGON_SP_IDLE en _lpulFlags_ en tiempo de inicialización si está diseñado para usar el tiempo que emplea el sistema en caso contrario, inactivo.</span><span class="sxs-lookup"><span data-stu-id="c22e6-161">A transport provider should set the LOGON_SP_IDLE flag in  _lpulFlags_ at initialization time if it is designed to use time that the system otherwise spends idle.</span></span> <span data-ttu-id="c22e6-162">Tal vez a menudo se usa para controlar operaciones automáticas, como automática de mensajes descargar el archivo, agotaba el tiempo de descarga de mensaje o superó el tiempo de envío de mensajes.</span><span class="sxs-lookup"><span data-stu-id="c22e6-162">Such time is often used to handle automatic operations, such as automatic message downloading, timed message downloading, or timed message submission.</span></span> <span data-ttu-id="c22e6-163">Si se establece este marcador, la cola MAPI llama a **inactivo** cuando se produzca el tiempo de inactividad del sistema iniciar dichas operaciones.</span><span class="sxs-lookup"><span data-stu-id="c22e6-163">If this flag is set, the MAPI spooler calls **Idle** when system idle time occurs to initiate such operations.</span></span> <span data-ttu-id="c22e6-164">La cola MAPI no llame a **inactivo** al establecer los intervalos; en su lugar, se invoca sólo durante un tiempo de inactividad es true.</span><span class="sxs-lookup"><span data-stu-id="c22e6-164">The MAPI spooler does not call **Idle** at set intervals; rather, it is called only during true idle time.</span></span> <span data-ttu-id="c22e6-165">Por lo tanto, los proveedores no deberían funcionar en cualquier suposición sobre ¿con qué frecuencia se llamará a sus métodos **inactivo** .</span><span class="sxs-lookup"><span data-stu-id="c22e6-165">Therefore, providers should not work on any assumption about how frequently their **Idle** methods will be called.</span></span> <span data-ttu-id="c22e6-166">Los proveedores que admiten operaciones de tiempo de inactividad deben proporcionar una interfaz de usuario de configuración en su hoja de propiedades del proveedor.</span><span class="sxs-lookup"><span data-stu-id="c22e6-166">Providers that support idle-time operations should supply a configuration user interface for it in their provider property sheet.</span></span> 
  
<span data-ttu-id="c22e6-167">Si el inicio de sesión del proveedor de transporte se realiza correctamente, el proveedor debe devolver en el parámetro _lppXPLogon_ un puntero a un objeto de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="c22e6-167">If the transport provider logon succeeds, the provider should return in the  _lppXPLogon_ parameter a pointer to a logon object.</span></span> <span data-ttu-id="c22e6-168">La cola MAPI usará este objeto para el acceso de proveedor adicionales.</span><span class="sxs-lookup"><span data-stu-id="c22e6-168">The MAPI spooler will use this object for additional provider access.</span></span> <span data-ttu-id="c22e6-169">Si **TransportLogon** muestra un cuadro de diálogo de inicio de sesión y el usuario cancela el inicio de sesión normalmente haciendo clic en el botón **Cancelar** en el cuadro de diálogo el proveedor debe devolver MAPI_E_USER_CANCEL.</span><span class="sxs-lookup"><span data-stu-id="c22e6-169">If **TransportLogon** displays a logon dialog box and the user cancels logon typically by clicking the **Cancel** button in the dialog box the provider should return MAPI_E_USER_CANCEL.</span></span> 
  
<span data-ttu-id="c22e6-170">Para la mayoría de los valores de error devuelta por **TransportLogon**, MAPI deshabilita los servicios de mensaje a la que pertenece el proveedor.</span><span class="sxs-lookup"><span data-stu-id="c22e6-170">For most error values returned from **TransportLogon**, MAPI disables the message services to which the provider belongs.</span></span> <span data-ttu-id="c22e6-171">MAPI no llamará a todos los proveedores que pertenecen a ese servicio para el resto de la sesión MAPI.</span><span class="sxs-lookup"><span data-stu-id="c22e6-171">MAPI will not call any providers that belong to that service for the rest of the MAPI session.</span></span> <span data-ttu-id="c22e6-172">Por el contrario, cuando **TransportLogon** devuelve el valor de error MAPI_E_FAILONEPROVIDER desde su inicio de sesión, MAPI deshabilitar el servicio de mensajes a la que pertenece el proveedor.</span><span class="sxs-lookup"><span data-stu-id="c22e6-172">In contrast, when **TransportLogon** returns the MAPI_E_FAILONEPROVIDER error value from its logon, MAPI does not disable the message service to which the provider belongs.</span></span> <span data-ttu-id="c22e6-173">**TransportLogon** debe devolver MAPI_E_FAILONEPROVIDER si encuentra un error que no merece la pena la deshabilitación del servicio para el resto de la sesión.</span><span class="sxs-lookup"><span data-stu-id="c22e6-173">**TransportLogon** should return MAPI_E_FAILONEPROVIDER if it encounters an error that does not warrant disabling the service for the rest of the session.</span></span> 
  
<span data-ttu-id="c22e6-174">Si un proveedor devuelve MAPI_E_UNCONFIGURED desde su inicio de sesión, MAPI llamar a la función de entrada de servicio de mensajes del proveedor y, a continuación, vuelva a intentar el inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="c22e6-174">If a provider returns MAPI_E_UNCONFIGURED from its logon, MAPI will call the provider's message service entry function and then retry the logon.</span></span> <span data-ttu-id="c22e6-175">MAPI pasa MSG_SERVICE_CONFIGURE como el contexto, para conceder a una oportunidad para que se configure el servicio.</span><span class="sxs-lookup"><span data-stu-id="c22e6-175">MAPI passes MSG_SERVICE_CONFIGURE as the context, to give the service a chance to configure itself.</span></span> <span data-ttu-id="c22e6-176">Si el cliente ha elegido permitir una interfaz de usuario en el inicio de sesión, el servicio puede presentar su hoja de propiedades de configuración para que el usuario pueda escribir información de configuración.</span><span class="sxs-lookup"><span data-stu-id="c22e6-176">If the client has chosen to allow a user interface on the logon, the service can present its configuration property sheet so that the user can enter configuration information.</span></span> 
  
<span data-ttu-id="c22e6-177">Si el proveedor busca todas la información necesaria no está en el perfil, debe devolver MAPI_E_UNCONFIGURED para que MAPI llama a la función de punto de entrada de servicio de mensajes del proveedor.</span><span class="sxs-lookup"><span data-stu-id="c22e6-177">If the provider finds that all the required information is not in the profile, it should return MAPI_E_UNCONFIGURED so that MAPI calls the provider's message service entry point function.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="c22e6-178">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="c22e6-178">See also</span></span>

- [<span data-ttu-id="c22e6-179">IXPProvider : IUnknown</span><span class="sxs-lookup"><span data-stu-id="c22e6-179">IXPProvider : IUnknown</span></span>](ixpprovideriunknown.md)  
- [<span data-ttu-id="c22e6-180">IMAPISupport::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="c22e6-180">IMAPISupport::OpenProfileSection</span></span>](imapisupport-openprofilesection.md)  
- [<span data-ttu-id="c22e6-181">IMAPISupport::SpoolerNotify</span><span class="sxs-lookup"><span data-stu-id="c22e6-181">IMAPISupport::SpoolerNotify</span></span>](imapisupport-spoolernotify.md)  
- [<span data-ttu-id="c22e6-182">IXPLogon::AddressTypes</span><span class="sxs-lookup"><span data-stu-id="c22e6-182">IXPLogon::AddressTypes</span></span>](ixplogon-addresstypes.md)  
- [<span data-ttu-id="c22e6-183">IXPLogon::Idle</span><span class="sxs-lookup"><span data-stu-id="c22e6-183">IXPLogon::Idle</span></span>](ixplogon-idle.md)  
- [<span data-ttu-id="c22e6-184">IXPLogon::Poll</span><span class="sxs-lookup"><span data-stu-id="c22e6-184">IXPLogon::Poll</span></span>](ixplogon-poll.md)  
- [<span data-ttu-id="c22e6-185">IXPLogon::TransportNotify</span><span class="sxs-lookup"><span data-stu-id="c22e6-185">IXPLogon::TransportNotify</span></span>](ixplogon-transportnotify.md) 
- [<span data-ttu-id="c22e6-186">MAPIERROR</span><span class="sxs-lookup"><span data-stu-id="c22e6-186">MAPIERROR</span></span>](mapierror.md)

