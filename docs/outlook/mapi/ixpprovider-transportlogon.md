---
title: IXPProviderTransportLogon
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IXPProvider.TransportLogon
api_type:
- COM
ms.assetid: 534929f2-36a2-463d-8c4c-d86060cde127
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: 53b2733dbf38d680027dc00ecf5513f384e46660
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33417311"
---
# <a name="ixpprovidertransportlogon"></a><span data-ttu-id="8b4a9-103">IXPProvider::TransportLogon</span><span class="sxs-lookup"><span data-stu-id="8b4a9-103">IXPProvider::TransportLogon</span></span>

<span data-ttu-id="8b4a9-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="8b4a9-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="8b4a9-105">Establece una sesión en la que una aplicación cliente inicia sesión en un proveedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-105">Establishes a session in which a client application logs on to a transport provider.</span></span> 
  
```cpp
HRESULT TransportLogon(
  LPMAPISUP lpMAPISup,
  ULONG_PTR ulUIParam,
  LPSTR lpszProfileName,
  ULONG FAR * lpulFlags,
  LPMAPIERROR FAR * lppMAPIError,
  LPXPLOGON FAR * lppXPLogon
);
```

## <a name="parameters"></a><span data-ttu-id="8b4a9-106">Parameters</span><span class="sxs-lookup"><span data-stu-id="8b4a9-106">Parameters</span></span>

<span data-ttu-id="8b4a9-107">_lpMAPISup_: [in] Puntero al objeto de soporte del proveedor de transporte para funciones de devolución de llamada dentro de MAPI para esta sesión.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-107">_lpMAPISup_: [in] Pointer to the transport provider's support object for callback functions within MAPI for this session.</span></span> <span data-ttu-id="8b4a9-108">Este objeto permanece válido hasta que el proveedor de transporte lo libere.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-108">This object remains valid until the transport provider releases it.</span></span>
    
<span data-ttu-id="8b4a9-109">_ulUIParam_: [in] Controlar en la ventana principal de los cuadros de diálogo o ventanas que muestra este método.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-109">_ulUIParam_: [in] Handle to the parent window of any dialog boxes or windows this method displays.</span></span> <span data-ttu-id="8b4a9-110">El _parámetro ulUIParam_ puede ser distinto de null, por ejemplo, cuando la marca LOGON_SETUP se establece en el parámetro _lpulFlags._</span><span class="sxs-lookup"><span data-stu-id="8b4a9-110">The  _ulUIParam_ parameter can be non-null, for example when the LOGON_SETUP flag is set in the  _lpulFlags_ parameter.</span></span> 
    
<span data-ttu-id="8b4a9-111">_lpszProfileName_: [in] Puntero al nombre del perfil del usuario.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-111">_lpszProfileName_: [in] Pointer to the profile name of the user.</span></span> <span data-ttu-id="8b4a9-112">El  _parámetro lpszProfileName_ se usa principalmente cuando se debe presentar un cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-112">The  _lpszProfileName_ parameter is primarily used when a dialog box must be presented.</span></span> 
    
<span data-ttu-id="8b4a9-113">_lpulFlags_: [in, out] Máscara de bits de marcas que controla cómo se establece la sesión de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-113">_lpulFlags_: [in, out] Bitmask of flags that controls how the logon session is established.</span></span> <span data-ttu-id="8b4a9-114">La cola MAPI puede establecer las siguientes marcas en la entrada:</span><span class="sxs-lookup"><span data-stu-id="8b4a9-114">The following flags can be set on input by the MAPI spooler:</span></span>
    
  - <span data-ttu-id="8b4a9-115">LOGON_NO_CONNECT: la cuenta de usuario inicia sesión en este proveedor de transporte para fines distintos de la transmisión y recepción de mensajes.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-115">LOGON_NO_CONNECT: The user account is logging on to this transport provider for purposes other than transmission and reception of messages.</span></span> <span data-ttu-id="8b4a9-116">El proveedor de transporte no debe intentar realizar conexiones a otros sistemas de mensajería.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-116">The transport provider should not attempt to make any connections to other messaging systems.</span></span>
        
  - <span data-ttu-id="8b4a9-117">LOGON_NO_DIALOG: no se debe mostrar ningún cuadro de diálogo incluso si las credenciales de usuario guardadas actualmente no son válidas o insuficientes para el inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-117">LOGON_NO_DIALOG: No dialog box should be displayed even if the currently saved user credentials are invalid or insufficient for logon.</span></span>
        
  - <span data-ttu-id="8b4a9-118">LOGON_NO_INBOUND: el proveedor de transporte no tiene que inicializarse para recibir mensajes y no debe aceptar mensajes entrantes.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-118">LOGON_NO_INBOUND: The transport provider does not have to initialize for reception of messages and should not accept incoming messages.</span></span> <span data-ttu-id="8b4a9-119">La cola MAPI puede usar el método [IXPLogon::TransportNotify](ixplogon-transportnotify.md) más adelante para indicar al proveedor de transporte que habilite el procesamiento de mensajes entrantes.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-119">The MAPI spooler can use the [IXPLogon::TransportNotify](ixplogon-transportnotify.md) method later to signal the transport provider to enable incoming message processing.</span></span> 
        
  - <span data-ttu-id="8b4a9-120">LOGON_NO_OUTBOUND: el proveedor de transporte no tiene que inicializarse para enviar mensajes, ya que la cola MAPI no proporciona ninguna.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-120">LOGON_NO_OUTBOUND: The transport provider does not have to initialize for sending messages, as the MAPI spooler does not provide any.</span></span> <span data-ttu-id="8b4a9-121">Si una aplicación cliente requiere una conexión con un proveedor remoto durante la composición de un mensaje para que pueda realizar llamadas al método [IXPLogon::AddressTypes,](ixplogon-addresstypes.md) el proveedor de transporte debe realizar la conexión.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-121">If a client application requires a connection to a remote provider during the composition of a message so that it can make [IXPLogon::AddressTypes](ixplogon-addresstypes.md) method calls, the transport provider should make the connection.</span></span> <span data-ttu-id="8b4a9-122">La cola MAPI puede usar **TransportNotify** para indicar al proveedor de transporte cuándo pueden comenzar las operaciones salientes.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-122">The MAPI spooler can use **TransportNotify** to signal the transport provider when outgoing operations can begin.</span></span> 
      
  - <span data-ttu-id="8b4a9-123">MAPI_UNICODE: la cadena pasada para el nombre del perfil está en formato Unicode.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-123">MAPI_UNICODE: The passed-in string for the profile name is in Unicode format.</span></span> <span data-ttu-id="8b4a9-124">Si no se establece \_ la marca UNICODE MAPI, la cadena tiene el formato ANSI.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-124">If the MAPI\_UNICODE flag is not set, the string is in ANSI format.</span></span>
      
    <span data-ttu-id="8b4a9-125">El proveedor de transporte puede establecer las siguientes marcas en la salida:</span><span class="sxs-lookup"><span data-stu-id="8b4a9-125">The following flags can be set on output by the transport provider:</span></span>
      
  - <span data-ttu-id="8b4a9-126">LOGON_SP_IDLE: solicita que la cola MAPI llame con frecuencia al método [IXPLogon::Idle](ixplogon-idle.md) del proveedor de transporte para procesar el tiempo de inactividad.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-126">LOGON_SP_IDLE: Requests that the MAPI spooler frequently call the transport provider's [IXPLogon::Idle](ixplogon-idle.md) method for idle-time processing.</span></span> 
      
  - <span data-ttu-id="8b4a9-127">LOGON_SP_POLL: solicita que la cola MAPI llame con frecuencia al método [IXPLogon::P oll](ixplogon-poll.md) en el objeto de inicio de sesión devuelto para buscar mensajes nuevos.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-127">LOGON_SP_POLL: Requests that the MAPI spooler frequently call the [IXPLogon::Poll](ixplogon-poll.md) method on the returned logon object to check for new messages.</span></span> <span data-ttu-id="8b4a9-128">Si no se establece esta marca, la cola MAPI solo comprueba si hay mensajes nuevos cuando el proveedor de transporte usa el método [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) para notificar al colador que hay nuevos mensajes que procesar.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-128">If this flag is not set, the MAPI spooler only checks for new messages when the transport provider uses the [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) method to notify the spooler that there are new messages to process.</span></span> <span data-ttu-id="8b4a9-129">Un proveedor de transporte se convierte efectivamente en solo envío al no establecer esta marca y no notificar a la cola MAPI de la recepción de mensajes.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-129">A transport provider effectively becomes send-only by not setting this flag and by not notifying the MAPI spooler of message receipt.</span></span> 
      
  - <span data-ttu-id="8b4a9-130">LOGON_SP_RESOLVE: solicitudes que la cola MAPI resuelve en direcciones completa todas las direcciones de mensaje para destinatarios no admitidos por este proveedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-130">LOGON_SP_RESOLVE: Requests that the MAPI spooler resolve to full addresses all message addresses for recipients not supported by this transport provider.</span></span> <span data-ttu-id="8b4a9-131">Por lo tanto, el proveedor de transporte puede crear una ruta de respuesta para todos los destinatarios.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-131">Therefore that the transport provider can construct a reply path for all recipients.</span></span>
      
  - <span data-ttu-id="8b4a9-132">MAPI_UNICODE: las cadenas devueltas en la estructura [MAPIERROR,](mapierror.md) si las hay, están en formato Unicode.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-132">MAPI_UNICODE: The returned strings in the [MAPIERROR](mapierror.md) structure, if any, are in Unicode format.</span></span> <span data-ttu-id="8b4a9-133">Si la MAPI_UNICODE no está establecida, las cadenas tienen el formato ANSI.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-133">If the MAPI_UNICODE flag is not set, the strings are in ANSI format.</span></span> 
    
<span data-ttu-id="8b4a9-134">_lppMAPIError_: [out] Puntero a un puntero a la estructura **MAPIERROR** devuelta, si la hubiera, que contiene información de versión, componente y contexto del error.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-134">_lppMAPIError_: [out] Pointer to a pointer to the returned **MAPIERROR** structure, if any, that contains version, component, and context information for the error.</span></span> <span data-ttu-id="8b4a9-135">El  _parámetro lppMAPIError_ se puede establecer en NULL si no hay ninguna **estructura MAPIERROR** que devolver.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-135">The  _lppMAPIError_ parameter can be set to NULL if there is no **MAPIERROR** structure to return.</span></span> 
    
<span data-ttu-id="8b4a9-136">_lppXPLogon_: [out] Puntero al puntero al objeto de inicio de sesión del proveedor de transporte devuelto.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-136">_lppXPLogon_: [out] Pointer to the pointer to the returned transport provider logon object.</span></span>
    
## <a name="return-value"></a><span data-ttu-id="8b4a9-137">Valor devuelto</span><span class="sxs-lookup"><span data-stu-id="8b4a9-137">Return value</span></span>

<span data-ttu-id="8b4a9-138">S_OK: la llamada se ha hecho correctamente y ha devuelto el valor o los valores esperados.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-138">S_OK: The call succeeded and has returned the expected value or values.</span></span>
    
<span data-ttu-id="8b4a9-139">MAPI_E_FAILONEPROVIDER: este proveedor no puede iniciar sesión, pero este error no debe deshabilitar el servicio.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-139">MAPI_E_FAILONEPROVIDER: This provider cannot log on, but this error should not disable the service.</span></span> 
    
<span data-ttu-id="8b4a9-140">MAPI_E_UNCONFIGURED: el perfil no contiene suficiente información para que se complete el inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-140">MAPI_E_UNCONFIGURED: The profile does not contain enough information for the logon to be completed.</span></span> <span data-ttu-id="8b4a9-141">MAPI llama a la función de punto de entrada del servicio de mensajes del proveedor.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-141">MAPI calls the provider's message service entry point function.</span></span>
    
<span data-ttu-id="8b4a9-142">MAPI_E_UNKNOWN_CPID: el proveedor no puede admitir la página de códigos del cliente.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-142">MAPI_E_UNKNOWN_CPID: The provider cannot support the client's code page.</span></span>
    
<span data-ttu-id="8b4a9-143">MAPI_E_UNKNOWN_LCID: el proveedor no puede admitir la información de configuración regional del cliente.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-143">MAPI_E_UNKNOWN_LCID: The provider cannot support the client's locale information.</span></span>
    
<span data-ttu-id="8b4a9-144">MAPI_E_USER_CANCEL: el usuario canceló la operación, normalmente haciendo clic en el **botón Cancelar** de un cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-144">MAPI_E_USER_CANCEL: The user canceled the operation, typically by clicking the **Cancel** button in a dialog box.</span></span> 
    
## <a name="remarks"></a><span data-ttu-id="8b4a9-145">Comentarios</span><span class="sxs-lookup"><span data-stu-id="8b4a9-145">Remarks</span></span>

<span data-ttu-id="8b4a9-146">La cola MAPI llama al método **IXPProvider::TransportLogon** para establecer una sesión de inicio de sesión para un usuario.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-146">The MAPI spooler calls the **IXPProvider::TransportLogon** method to establish a logon session for a user.</span></span> 
  
<span data-ttu-id="8b4a9-147">La mayoría de los proveedores de transporte usan el método [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) proporcionado con el objeto de soporte al que apunta el parámetro  _lpMAPISup_ para guardar y recuperar información de identidad de usuario, direcciones de servidor y credenciales.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-147">Most transport providers use the [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) method provided with the support object pointed to by the  _lpMAPISup_ parameter for saving and retrieving user identity information, server addresses, and credentials.</span></span> <span data-ttu-id="8b4a9-148">Mediante **OpenProfileSection,** un proveedor de transporte puede guardar información arbitraria y asociarla con un inicio de sesión a un recurso determinado.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-148">By using **OpenProfileSection**, a transport provider can save arbitrary information and associate it with a logon to a particular resource.</span></span> <span data-ttu-id="8b4a9-149">Por ejemplo, un proveedor puede usar **OpenProfileSection** para guardar el nombre de cuenta y la contraseña asociados con una sesión determinada y cualquier nombre de servidor u otra información necesaria que sea necesaria para tener acceso a los recursos de esa sesión.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-149">For example, a provider can use **OpenProfileSection** to save the account name and password associated with a particular session and any server names or other necessary information that are required to access resources for that session.</span></span> <span data-ttu-id="8b4a9-150">MAPI oculta la información asociada a un recurso desde el acceso externo.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-150">MAPI hides information associated with a resource from outside access.</span></span> <span data-ttu-id="8b4a9-151">La sección de perfil disponible a través de  _lpMAPISup_ se administra mediante la cola MAPI para que los datos relacionados con este contexto de usuario estén separados de los datos de otros contextos.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-151">The profile section made available through  _lpMAPISup_ is managed by the MAPI spooler so data related to this user context is separated from data for other contexts.</span></span> 
  
<span data-ttu-id="8b4a9-152">El proveedor de transporte debe llamar al método **IUnknown::AddRef** en el objeto de soporte técnico y mantener una copia del puntero a este objeto como parte del objeto de inicio de sesión del proveedor.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-152">The transport provider must call the **IUnknown::AddRef** method on the support object and keep a copy of the pointer to this object as part of the provider logon object.</span></span> 
  
<span data-ttu-id="8b4a9-153">El nombre para mostrar del perfil  _en lpszProfileName_ se proporciona para que el proveedor de transporte pueda usarlo en mensajes de error o cuadros de diálogo de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-153">The profile display name in  _lpszProfileName_ is provided so the transport provider can use it in error messages or logon dialog boxes.</span></span> <span data-ttu-id="8b4a9-154">Si el proveedor conserva este nombre, debe copiarse en el almacenamiento asignado por el proveedor.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-154">If the provider retains this name, it must be copied to storage allocated by the provider.</span></span> 
  
<span data-ttu-id="8b4a9-155">Los proveedores de transporte estrechamente combinados con otros proveedores de servicios pueden tener que realizar un trabajo adicional durante el inicio de sesión para establecer las buenas credenciales necesarias para las operaciones entre proveedores complementarios.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-155">Transport providers that are tightly coupled with other service providers may have to do additional work at logon to establish the good credentials required for operations between companion providers.</span></span>
  
<span data-ttu-id="8b4a9-156">Normalmente, los proveedores de transporte se abren cuando el usuario inicia sesión por primera vez en un perfil.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-156">Usually, transport providers are opened when the user first logs on to a profile.</span></span> <span data-ttu-id="8b4a9-157">Dado que el primer inicio de sesión en un perfil por lo general se produce antes de iniciar sesión en cualquier almacén de mensajes, la cola MAPI normalmente llama a **TransportLogon** con las marcas LOGON_NO_INBOUND y LOGON_NO_OUTBOUND establecidas en  _lpulFlags_.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-157">Because the first logon to a profile therefore generally comes before logon to any message store, the MAPI spooler usually calls **TransportLogon** with both the LOGON_NO_INBOUND and LOGON_NO_OUTBOUND flags set in  _lpulFlags_.</span></span> <span data-ttu-id="8b4a9-158">Más adelante, cuando los almacenes de mensajes adecuados están disponibles en la sesión de perfil, la cola MAPI llama a **TransportNotify** para iniciar operaciones entrantes y salientes para el proveedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-158">Later, when the appropriate message stores are available in the profile session, the MAPI spooler calls **TransportNotify** to initiate incoming and outgoing operations for the transport provider.</span></span> 
  
<span data-ttu-id="8b4a9-159">Pasar la LOGON_NO_CONNECT en  _lpulFlags_ indica el funcionamiento sin conexión del proveedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-159">Passing the LOGON_NO_CONNECT flag in  _lpulFlags_ signals offline operation of the transport provider.</span></span> <span data-ttu-id="8b4a9-160">Esta marca indica que no se deben realizar conexiones externas; si el proveedor de transporte no puede establecer una sesión sin una conexión externa, debe devolver un valor de error para el inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-160">This flag indicates no external connections should be made; if the transport provider cannot establish a session without an external connection, it should return an error value for the logon.</span></span> 
  
<span data-ttu-id="8b4a9-161">Un proveedor de transporte debe establecer la marca LOGON_SP_IDLE en  _lpulFlags_ en el momento de la inicialización si está diseñado para usar el tiempo que el sistema de otro modo pasa inactivo.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-161">A transport provider should set the LOGON_SP_IDLE flag in  _lpulFlags_ at initialization time if it is designed to use time that the system otherwise spends idle.</span></span> <span data-ttu-id="8b4a9-162">Este tiempo suele usarse para controlar las operaciones automáticas, como la descarga automática de mensajes, la descarga de mensajes con tiempo o el envío de mensajes con tiempo.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-162">Such time is often used to handle automatic operations, such as automatic message downloading, timed message downloading, or timed message submission.</span></span> <span data-ttu-id="8b4a9-163">Si se establece esta marca, la cola MAPI llama a **Idle** cuando se produce el tiempo de inactividad del sistema para iniciar dichas operaciones.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-163">If this flag is set, the MAPI spooler calls **Idle** when system idle time occurs to initiate such operations.</span></span> <span data-ttu-id="8b4a9-164">La cola MAPI no llama a **Idle** a intervalos establecidos; en su lugar, se llama solo durante el tiempo de inactividad real.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-164">The MAPI spooler does not call **Idle** at set intervals; rather, it is called only during true idle time.</span></span> <span data-ttu-id="8b4a9-165">Por lo tanto, los proveedores no deben trabajar en ninguna suposición sobre la frecuencia con la que se llamará a sus **métodos** Idle.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-165">Therefore, providers should not work on any assumption about how frequently their **Idle** methods will be called.</span></span> <span data-ttu-id="8b4a9-166">Los proveedores que admiten operaciones de tiempo de inactividad deben proporcionar una interfaz de usuario de configuración para ella en su hoja de propiedades de proveedor.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-166">Providers that support idle-time operations should supply a configuration user interface for it in their provider property sheet.</span></span> 
  
<span data-ttu-id="8b4a9-167">Si el inicio de sesión del proveedor de transporte se realiza correctamente, el proveedor debe devolver en el parámetro  _lppXPLogon_ un puntero a un objeto de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-167">If the transport provider logon succeeds, the provider should return in the  _lppXPLogon_ parameter a pointer to a logon object.</span></span> <span data-ttu-id="8b4a9-168">La cola MAPI usará este objeto para obtener acceso adicional al proveedor.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-168">The MAPI spooler will use this object for additional provider access.</span></span> <span data-ttu-id="8b4a9-169">Si **TransportLogon** muestra un cuadro de diálogo de inicio  de sesión y el usuario cancela el inicio de sesión normalmente haciendo clic en el botón Cancelar del cuadro de diálogo, el proveedor debe devolver MAPI_E_USER_CANCEL.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-169">If **TransportLogon** displays a logon dialog box and the user cancels logon typically by clicking the **Cancel** button in the dialog box the provider should return MAPI_E_USER_CANCEL.</span></span> 
  
<span data-ttu-id="8b4a9-170">Para la mayoría de los valores de error devueltos de **TransportLogon**, MAPI deshabilita los servicios de mensajes a los que pertenece el proveedor.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-170">For most error values returned from **TransportLogon**, MAPI disables the message services to which the provider belongs.</span></span> <span data-ttu-id="8b4a9-171">MAPI no llamará a ningún proveedor que pertenezca a ese servicio durante el resto de la sesión MAPI.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-171">MAPI will not call any providers that belong to that service for the rest of the MAPI session.</span></span> <span data-ttu-id="8b4a9-172">En cambio, cuando **TransportLogon** devuelve el valor de error MAPI_E_FAILONEPROVIDER desde su inicio de sesión, MAPI no deshabilita el servicio de mensajes al que pertenece el proveedor.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-172">In contrast, when **TransportLogon** returns the MAPI_E_FAILONEPROVIDER error value from its logon, MAPI does not disable the message service to which the provider belongs.</span></span> <span data-ttu-id="8b4a9-173">**TransportLogon** debe devolver MAPI_E_FAILONEPROVIDER si encuentra un error que no garantiza deshabilitar el servicio durante el resto de la sesión.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-173">**TransportLogon** should return MAPI_E_FAILONEPROVIDER if it encounters an error that does not warrant disabling the service for the rest of the session.</span></span> 
  
<span data-ttu-id="8b4a9-174">Si un proveedor devuelve MAPI_E_UNCONFIGURED desde su inicio de sesión, MAPI llamará a la función de entrada del servicio de mensajes del proveedor y, a continuación, reintentará el inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-174">If a provider returns MAPI_E_UNCONFIGURED from its logon, MAPI will call the provider's message service entry function and then retry the logon.</span></span> <span data-ttu-id="8b4a9-175">MAPI pasa MSG_SERVICE_CONFIGURE como contexto, para dar al servicio la oportunidad de configurarse a sí mismo.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-175">MAPI passes MSG_SERVICE_CONFIGURE as the context, to give the service a chance to configure itself.</span></span> <span data-ttu-id="8b4a9-176">Si el cliente ha elegido permitir una interfaz de usuario en el inicio de sesión, el servicio puede presentar su hoja de propiedades de configuración para que el usuario pueda escribir información de configuración.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-176">If the client has chosen to allow a user interface on the logon, the service can present its configuration property sheet so that the user can enter configuration information.</span></span> 
  
<span data-ttu-id="8b4a9-177">Si el proveedor encuentra que toda la información necesaria no está en el perfil, debe devolver MAPI_E_UNCONFIGURED para que MAPI llame a la función de punto de entrada del servicio de mensajes del proveedor.</span><span class="sxs-lookup"><span data-stu-id="8b4a9-177">If the provider finds that all the required information is not in the profile, it should return MAPI_E_UNCONFIGURED so that MAPI calls the provider's message service entry point function.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="8b4a9-178">Vea también</span><span class="sxs-lookup"><span data-stu-id="8b4a9-178">See also</span></span>

- [<span data-ttu-id="8b4a9-179">IXPProvider : IUnknown</span><span class="sxs-lookup"><span data-stu-id="8b4a9-179">IXPProvider : IUnknown</span></span>](ixpprovideriunknown.md)  
- [<span data-ttu-id="8b4a9-180">IMAPISupport::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="8b4a9-180">IMAPISupport::OpenProfileSection</span></span>](imapisupport-openprofilesection.md)  
- [<span data-ttu-id="8b4a9-181">IMAPISupport::SpoolerNotify</span><span class="sxs-lookup"><span data-stu-id="8b4a9-181">IMAPISupport::SpoolerNotify</span></span>](imapisupport-spoolernotify.md)  
- [<span data-ttu-id="8b4a9-182">IXPLogon::AddressTypes</span><span class="sxs-lookup"><span data-stu-id="8b4a9-182">IXPLogon::AddressTypes</span></span>](ixplogon-addresstypes.md)  
- [<span data-ttu-id="8b4a9-183">IXPLogon::Idle</span><span class="sxs-lookup"><span data-stu-id="8b4a9-183">IXPLogon::Idle</span></span>](ixplogon-idle.md)  
- [<span data-ttu-id="8b4a9-184">IXPLogon::Poll</span><span class="sxs-lookup"><span data-stu-id="8b4a9-184">IXPLogon::Poll</span></span>](ixplogon-poll.md)  
- [<span data-ttu-id="8b4a9-185">IXPLogon::TransportNotify</span><span class="sxs-lookup"><span data-stu-id="8b4a9-185">IXPLogon::TransportNotify</span></span>](ixplogon-transportnotify.md) 
- [<span data-ttu-id="8b4a9-186">MAPIERROR</span><span class="sxs-lookup"><span data-stu-id="8b4a9-186">MAPIERROR</span></span>](mapierror.md)

