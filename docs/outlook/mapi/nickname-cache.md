---
title: Caché de sobrenombre
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 2813c102-6778-4443-ab4b-b573f3568705
description: 'Última modificación: 30 de enero de 2013'
ms.openlocfilehash: 1ea1d3e6f636cf6a3ad47b6fdfe88d0f7130a5f3
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19818415"
---
# <a name="nickname-cache"></a><span data-ttu-id="1d365-103">Caché de sobrenombre</span><span class="sxs-lookup"><span data-stu-id="1d365-103">Nickname cache</span></span>

 
  
<span data-ttu-id="1d365-104">**Hace referencia a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="1d365-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="1d365-105">Microsoft Office Outlook 2007, Microsoft Outlook 2010 y Microsoft Outlook 2013 interactúan con la caché de sobrenombres, también conocida como la "Autocompletar secuencia."</span><span class="sxs-lookup"><span data-stu-id="1d365-105">Microsoft Office Outlook 2007, Microsoft Outlook 2010, and Microsoft Outlook 2013 interact with the nickname cache, also known as the "autocomplete stream."</span></span> <span data-ttu-id="1d365-106">La secuencia de Autocompletar es donde Outlook persiste la lista de Autocompletar, que es la lista de nombres que se muestra en el cuadro **para**, **Cc**, **CCO** cuadros de edición y mientras un usuario está redactando un correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="1d365-106">The autocomplete stream is where Outlook persists the autocomplete list, which is the list of names that displays in the **To**, **Cc**, and **Bcc** edit boxes while a user is composing an email.</span></span> <span data-ttu-id="1d365-107">En este tema se describe cómo Outlook 2007, Outlook 2010 y Outlook 2013 interactúan con la secuencia de Autocompletar y también se describe el formato binario del archivo y los métodos recomendados para interactuar con la secuencia de Autocompletar.</span><span class="sxs-lookup"><span data-stu-id="1d365-107">This topic describes how Outlook 2007, Outlook 2010, and Outlook 2013 interact with the autocomplete stream and also discusses the binary format of the file and the recommended ways for interacting with the autocomplete stream.</span></span> 
  
<span data-ttu-id="1d365-108">Para las aplicaciones que interactúan con Outlook 2010 o Outlook 2013, la secuencia de Autocompletar se almacena como una propiedad MAPI y puede modificarse mediante el objeto **PropertyAccessor** del mensaje o la MAPI.</span><span class="sxs-lookup"><span data-stu-id="1d365-108">For applications that interact with Outlook 2010 or Outlook 2013, the autocomplete stream is stored as a MAPI property and can be modified using the MAPI or the **PropertyAccessor** object of the message.</span></span> <span data-ttu-id="1d365-109">El objeto **PropertyAccessor** se expone en los modelos de objetos de Outlook 2010 o Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="1d365-109">The **PropertyAccessor** object is exposed in the Outlook 2010 or Outlook 2013 object models.</span></span> 
  
<span data-ttu-id="1d365-110">No hay ninguna dependencia en el modelo de objetos de Outlook 2007 o las API de MAPI.</span><span class="sxs-lookup"><span data-stu-id="1d365-110">There are no dependencies on the Outlook 2007 object model or MAPI APIs.</span></span> <span data-ttu-id="1d365-111">Por lo tanto, se pueden escribir aplicaciones que realizar cambios en la secuencia de Autocompletar en Outlook 2007 utilizando cualquier lenguaje de programación.</span><span class="sxs-lookup"><span data-stu-id="1d365-111">Therefore, applications that make changes to the autocomplete stream within Outlook 2007 can be written using any programming language.</span></span>
  
## <a name="interacting-with-the-autocomplete-stream"></a><span data-ttu-id="1d365-112">Interactuar con la secuencia de Autocompletar</span><span class="sxs-lookup"><span data-stu-id="1d365-112">Interacting with the Autocomplete Stream</span></span>

<span data-ttu-id="1d365-113">Cuando se tiene acceso a los cuadros de edición **para**, **Cc**o **CCO** de un mensaje, se carga la secuencia de Autocompletar y se muestra la lista de nombres de usuario.</span><span class="sxs-lookup"><span data-stu-id="1d365-113">When the **To**, **Cc**, or **Bcc** edit boxes are accessed on a message, the autocomplete stream is loaded and the list of user names is displayed.</span></span> <span data-ttu-id="1d365-114">Outlook interactúa con la secuencia de Autocompletar de dos maneras:</span><span class="sxs-lookup"><span data-stu-id="1d365-114">Outlook interacts with the autocomplete stream in two ways:</span></span> 
  
1. <span data-ttu-id="1d365-115">Carga de la secuencia de Autocompletar</span><span class="sxs-lookup"><span data-stu-id="1d365-115">Loading the autocomplete stream</span></span> 
    
2. <span data-ttu-id="1d365-116">Guardar los cambios a los datos de la secuencia de Autocompletar</span><span class="sxs-lookup"><span data-stu-id="1d365-116">Saving changes to the data in the autocomplete stream</span></span>
    
<span data-ttu-id="1d365-117">Los medios de almacenamiento de los datos de Autocompletar difiere entre Outlook 2007 y Outlook 2010 o Outlook 2013 como sigue:</span><span class="sxs-lookup"><span data-stu-id="1d365-117">The means of storing the autocomplete data differs between Outlook 2007 and Outlook 2010 or Outlook 2013 as follows:</span></span> 
  
 <span data-ttu-id="1d365-118">**Outlook 2007**</span><span class="sxs-lookup"><span data-stu-id="1d365-118">**Outlook 2007**</span></span>
  
<span data-ttu-id="1d365-119">Para Outlook 2007, la secuencia de Autocompletar se almacena en un archivo con el mismo nombre que el perfil y una extensión. nk2.</span><span class="sxs-lookup"><span data-stu-id="1d365-119">For Outlook 2007, the autocomplete stream is stored in a file with the same name as the profile and an extension of .nk2.</span></span> <span data-ttu-id="1d365-120">Por ejemplo, si se usa el perfil predeterminado de "outlook", el archivo se llamará "outlook.nk2".</span><span class="sxs-lookup"><span data-stu-id="1d365-120">For example, if the default profile of "outlook" is used, the file will be called "outlook.nk2".</span></span> <span data-ttu-id="1d365-121">El archivo. nk2 se almacena en % APPDATA%\Microsoft\Outlook.</span><span class="sxs-lookup"><span data-stu-id="1d365-121">The .nk2 file is stored in %APPDATA%\Microsoft\Outlook.</span></span> <span data-ttu-id="1d365-122">Para obtener más información sobre el formato de archivo binario de la memoria caché de alias, vea [formato de archivo de Outlook 2003/2007 NK2 y las directrices del desarrollador](http://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf).</span><span class="sxs-lookup"><span data-stu-id="1d365-122">For more information about the nickname cache binary file format, see [Outlook 2003/2007 NK2 File Format and Developer Guidelines](http://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf).</span></span>
  
 <span data-ttu-id="1d365-123">**Outlook 2010 y Outlook 2013**</span><span class="sxs-lookup"><span data-stu-id="1d365-123">**Outlook 2010 and Outlook 2013**</span></span>
  
<span data-ttu-id="1d365-124">Outlook 2010 o Outlook 2013 lee la secuencia de Autocompletar de un mensaje en la tabla de contenido asociados de la Bandeja de entrada del almacén de entrega de la cuenta de correo.</span><span class="sxs-lookup"><span data-stu-id="1d365-124">Outlook 2010 or Outlook 2013 reads the autocomplete stream from a message in the Associated Contents table of the Inbox of the mail account's delivery store.</span></span> <span data-ttu-id="1d365-125">Este mensaje oculto tiene una clase de mensaje y el asunto de IPM. Configuration.Autocomplete.</span><span class="sxs-lookup"><span data-stu-id="1d365-125">This hidden message has a message class and subject of IPM.Configuration.Autocomplete.</span></span> <span data-ttu-id="1d365-126">La secuencia de Autocompletar se almacena en este mensaje en la propiedad PR_ROAMING_BINARYSTREAM ([Propiedad canónico PidTagRoamingBinary](pidtagroamingbinary-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="1d365-126">The autocomplete stream is stored on this message in the PR_ROAMING_BINARYSTREAM property ([PidTagRoamingBinary Canonical Property](pidtagroamingbinary-canonical-property.md)).</span></span> <span data-ttu-id="1d365-127">Los datos de Autocompletar es posible que se almacenan temporalmente en caché en un archivo .dat de Autocompletar que se encuentra en % USERPROFILE%\AppData\Local\Microsoft\Outlook\RoamCache.</span><span class="sxs-lookup"><span data-stu-id="1d365-127">The autocomplete data may be temporarily cached in an autocomplete .dat file located in %USERPROFILE%\AppData\Local\Microsoft\Outlook\RoamCache.</span></span> <span data-ttu-id="1d365-128">Sin embargo, el archivo .dat es sólo una memoria caché y no se usa para escribir en el almacén de entrega cuando el usuario sale de Outlook 2010 o Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="1d365-128">However, the .dat file is only a cache and is not used to write back to the delivery store when the user exits Outlook 2010 or Outlook 2013.</span></span>
  
## <a name="loading-the-autocomplete-stream"></a><span data-ttu-id="1d365-129">Carga de la secuencia de Autocompletar</span><span class="sxs-lookup"><span data-stu-id="1d365-129">Loading the Autocomplete Stream</span></span>

<span data-ttu-id="1d365-130">Outlook carga la secuencia de Autocompletar siempre que se inicializa un elemento con la funcionalidad de asignación de direcciones.</span><span class="sxs-lookup"><span data-stu-id="1d365-130">Outlook loads the autocomplete stream whenever an item with addressing functionality is initialized.</span></span> <span data-ttu-id="1d365-131">Por ejemplo, direcciones de correo electrónico se usan en un nuevo correo, una respuesta de correo, un elemento de contacto, una convocatoria de reunión y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="1d365-131">For example, email addresses are used in a new mail, a mail reply, a contact item, a meeting request, and so on.</span></span> <span data-ttu-id="1d365-132">Para cargar los datos, Outlook lee todo el contenido de la secuencia en la memoria.</span><span class="sxs-lookup"><span data-stu-id="1d365-132">To load the data, Outlook reads all of the contents of the stream into memory.</span></span>
  
<span data-ttu-id="1d365-133">Para las operaciones de Autocompletar, Outlook interactúa exclusivamente con esta estructura en la memoria para la duración de la duración del proceso outlook.exe.</span><span class="sxs-lookup"><span data-stu-id="1d365-133">For autocomplete operations, Outlook interacts exclusively with this in-memory structure for the duration of the outlook.exe process lifetime.</span></span> <span data-ttu-id="1d365-134">Outlook guarda únicamente la estructura en el cierre.</span><span class="sxs-lookup"><span data-stu-id="1d365-134">Outlook only saves the structure on shutdown.</span></span> <span data-ttu-id="1d365-135">Vea la siguiente sección "Guardar la secuencia de Autocompletar" para obtener más información acerca de este proceso.</span><span class="sxs-lookup"><span data-stu-id="1d365-135">See the following section "Saving the Autocomplete Stream" for more information on this process.</span></span>
  
## <a name="saving-the-autocomplete-stream"></a><span data-ttu-id="1d365-136">Guardar la secuencia de Autocompletar</span><span class="sxs-lookup"><span data-stu-id="1d365-136">Saving the Autocomplete Stream</span></span>

<span data-ttu-id="1d365-137">Outlook guarda la secuencia de Autocompletar en el cierre si ha cambiado la lista de Autocompletar en cualquiera de las siguientes maneras:</span><span class="sxs-lookup"><span data-stu-id="1d365-137">Outlook saves the autocomplete stream on shutdown if the autocomplete list has changed in any of the following ways:</span></span>
  
- <span data-ttu-id="1d365-138">Se agrega una nueva entrada de alias a través de resolución de un nombre, selección de un destinatario desde el cuadro de diálogo de la libreta de direcciones o enviar correo a un destinatario que no estaba ya en la lista.</span><span class="sxs-lookup"><span data-stu-id="1d365-138">A new nickname entry is added through resolving a name, picking a recipient from the address book dialog, or sending mail to a recipient that was not already in the list.</span></span>
    
- <span data-ttu-id="1d365-139">Se modifica una entrada mediante el envío de correo a un destinatario existente en la lista.</span><span class="sxs-lookup"><span data-stu-id="1d365-139">An entry is modified by sending mail to an existing recipient in the list.</span></span>
    
- <span data-ttu-id="1d365-140">Una entrada se ha quitado el usuario a través de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="1d365-140">An entry is removed by the user through the UI.</span></span>
    
- <span data-ttu-id="1d365-141">Otros escenarios secundarias no se ajusten a este tema.</span><span class="sxs-lookup"><span data-stu-id="1d365-141">Other minor scenarios not relevant to this topic.</span></span>
    
<span data-ttu-id="1d365-142">Guardar los cambios a los datos de Autocompletar implica la escritura de la estructura en la memoria en una [secuencia de Autocompletar](autocomplete-stream.md).</span><span class="sxs-lookup"><span data-stu-id="1d365-142">Saving changes to the autocomplete data involves writing the in-memory structure back to an [Autocomplete Stream](autocomplete-stream.md).</span></span> <span data-ttu-id="1d365-143">Al interactuar con Outlook 2007, la secuencia se guarda en un archivo. nk2 local.</span><span class="sxs-lookup"><span data-stu-id="1d365-143">When interacting with Outlook 2007, the stream is saved to a local .nk2 file.</span></span> <span data-ttu-id="1d365-144">Para Outlook 2010 o Outlook 2013, la secuencia de Autocompletar vuelve a escribe en la tabla de contenido asociados de la Bandeja de entrada del almacén de entrega de la cuenta de correo.</span><span class="sxs-lookup"><span data-stu-id="1d365-144">For Outlook 2010 or Outlook 2013, the autocomplete stream writes back to the Associated Contents table of the Inbox of the mail account's delivery store.</span></span>
  
## <a name="recommendations"></a><span data-ttu-id="1d365-145">Recomendaciones</span><span class="sxs-lookup"><span data-stu-id="1d365-145">Recommendations</span></span>

- <span data-ttu-id="1d365-146">Nunca parcialmente, modifique la secuencia de Autocompletar.</span><span class="sxs-lookup"><span data-stu-id="1d365-146">Never partially modify the autocomplete stream.</span></span> <span data-ttu-id="1d365-147">La interacción compatible es (1) lee la secuencia de Autocompletar todo en la memoria, (2) modificar la estructura de memoria y (3) escribir toda la secuencia en uno en la tabla de contenido asociados de la Bandeja de entrada del almacén de entrega de la cuenta de correo (para Outlook 2010 o Outlook 2013) o en el archivo. nk2 local (Outlook 2007).</span><span class="sxs-lookup"><span data-stu-id="1d365-147">The supported interaction is to 1) read the entire autocomplete stream into memory, 2) modify the memory structure, and 3) write the entire stream back to either the Associated Contents table of the Inbox of the mail account's delivery store (for Outlook 2010 or Outlook 2013) or to the local .nk2 file (Outlook 2007).</span></span>
    
- <span data-ttu-id="1d365-148">No interactúan con la secuencia de Autocompletar mientras se está ejecutando Outlook.</span><span class="sxs-lookup"><span data-stu-id="1d365-148">Do not interact with the autocomplete stream while Outlook is running.</span></span> <span data-ttu-id="1d365-149">Si Outlook se está ejecutando mientras modifica la secuencia, es probable que se sobrescribirán los cambios cuando se apaga.</span><span class="sxs-lookup"><span data-stu-id="1d365-149">If Outlook is running while you modify the stream, it will likely overwrite your changes when it shuts down.</span></span>
    
- <span data-ttu-id="1d365-150">Escriba no propiedades de escritura de PT_MV_UNICODE y PR_MV_STRING8 en una secuencia de Autocompletar para ser consumido por Microsoft Outlook 2003.</span><span class="sxs-lookup"><span data-stu-id="1d365-150">Do not write properties of type PT_MV_UNICODE and PR_MV_STRING8 into an autocomplete stream to be consumed by Microsoft Outlook 2003.</span></span> <span data-ttu-id="1d365-151">Estas propiedades sólo se entienden por Outlook 2007, Outlook 2010 y Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="1d365-151">These properties are only understood by Outlook 2007, Outlook 2010, and Outlook 2013.</span></span>
    
- <span data-ttu-id="1d365-152">Al desarrollar código que interactúe con Outlook 2007, se recomienda bloquear el archivo. nk2 de modificación por otros procesos mientras están de lectura y escritura mediante las API (por ejemplo, **archivo de bloqueo** en C o C++ y **de bloqueo de archivos estándar FileStream.Lock** en C#).</span><span class="sxs-lookup"><span data-stu-id="1d365-152">When developing code that interacts with Outlook 2007, we recommend that you lock the .nk2 file from modification by other processes while you are reading and writing it using standard file locking APIs (for example, **LockFile** in C/C++ and **FileStream.Lock** in C#).</span></span> 
    
- <span data-ttu-id="1d365-153">Sólo modificar las propiedades de los tipos que están en el conjunto de filas de la secuencia de Autocompletar.</span><span class="sxs-lookup"><span data-stu-id="1d365-153">Only modify the properties of types that are from the row-set of the autocomplete stream.</span></span> <span data-ttu-id="1d365-154">Para obtener más información acerca de las propiedades de la secuencia de Autocompletar y tipos de propiedades, vea [secuencia de Autocompletar](autocomplete-stream.md).</span><span class="sxs-lookup"><span data-stu-id="1d365-154">For more information about the autocomplete stream properties and property types, see [Autocomplete Stream](autocomplete-stream.md).</span></span>
    
## <a name="see-also"></a><span data-ttu-id="1d365-155">Vea también</span><span class="sxs-lookup"><span data-stu-id="1d365-155">See also</span></span>



[<span data-ttu-id="1d365-156">Secuencia de Autocompletar</span><span class="sxs-lookup"><span data-stu-id="1d365-156">Autocomplete Stream</span></span>](autocomplete-stream.md)
  
[<span data-ttu-id="1d365-157">Perfiles de MAPI</span><span class="sxs-lookup"><span data-stu-id="1d365-157">MAPI Profiles</span></span>](mapi-profiles.md)


[<span data-ttu-id="1d365-158">Formato de archivo de Outlook 2003/2007 NK2 y directrices para desarrolladores</span><span class="sxs-lookup"><span data-stu-id="1d365-158">Outlook 2003/2007 NK2 File Format and Developer Guidelines</span></span>](http://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)

