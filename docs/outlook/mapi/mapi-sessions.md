---
title: Sesiones MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: c5a7c137-393e-40ff-a2b9-afe02da2435a
description: '�ltima modificaci�n: s�bado, 23 de julio de 2011'
ms.openlocfilehash: 45dc993c337249ed7d4dffbd5324267de82981d0
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19818213"
---
# <a name="mapi-sessions"></a><span data-ttu-id="83954-103">Sesiones MAPI</span><span class="sxs-lookup"><span data-stu-id="83954-103">MAPI sessions</span></span>

<span data-ttu-id="83954-104">**Se aplica a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="83954-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="83954-105">Antes de la aplicaci�n cliente puede llamar a un sistema de mensajer�a subyacente, debe establecer una conexi�n con el subsistema MAPI o sesi�n.</span><span class="sxs-lookup"><span data-stu-id="83954-105">Before the client application can call an underlying messaging system, it must establish a session, or connection, with the MAPI subsystem.</span></span>
  
<span data-ttu-id="83954-p101">Sessions are initiated when a user logs on, a process that accesses a valid profile and validates the messaging system and the message service credentials. Then, the process ensures that all of the profile's message services are correctly configured. The client interface you use determines the logon call. MAPI clients call the [MAPILogonEx](mapilogonex.md) function.</span><span class="sxs-lookup"><span data-stu-id="83954-p101">Sessions are initiated when a user logs on, a process that accesses a valid profile and validates the messaging system and the message service credentials. Then, the process ensures that all of the profile's message services are correctly configured. The client interface you use determines the logon call. MAPI clients call the [MAPILogonEx](mapilogonex.md) function.</span></span> 
  
<span data-ttu-id="83954-p102">Configuraci�n del servicio de mensajes es uno de los elementos m�s importantes del proceso de inicio de sesi�n. El perfil es el origen para la informaci�n de configuraci�n. Si falta informaci�n de un servicio de mensaje en particular, el proceso de inicio de sesi�n intenta pedir al usuario que suministrar. No siempre es correcta por dos motivos: en primer lugar, preguntar al usuario requiere la presentaci�n de un cuadro de di�logo. Es posible que los clientes no permitir la presentaci�n de una interfaz de usuario pasando una marca a la llamada de inicio de sesi�n. En segundo lugar, el usuario puede cancelar el cuadro de di�logo antes de poder agregar la informaci�n necesaria.</span><span class="sxs-lookup"><span data-stu-id="83954-p102">Message service configuration is one of the most important parts of the logon process. The profile is the initial source for configuration information. If information for a particular message service is missing, the logon process tries to prompt the user to supply it. This is not always successful for two reasons: First, prompting the user requires the display of a dialog box. It is possible for clients to disallow the display of a user interface by passing a flag into the logon call. Second, the user could cancel the dialog box before the needed information can be added.</span></span>
  
<span data-ttu-id="83954-p103">Cuando un proceso de inicio de sesi�n falla una vez, el usuario est� informado del error y se le ofrece la posibilidad de volver a intentar o corregir la condici�n de error. Una vez m�s, una interfaz de usuario se mostrar�, si permite que el cliente y el usuario le pedir� que especifique los datos que sean que faltan. Si este segundo intento se realiza correctamente, MAPI deshabilita a todos los proveedores de servicio en el servicio de mensajes para la duraci�n de la sesi�n. En efecto, se deshabilita el servicio de mensaje entero. Esto significa que ninguno de los proveedores de servicios en el servicio de mensajes pueden trabajar. Esto se hace porque si un proveedor se produce un error de inicio de sesi�n, los dem�s proveedores normalmente tambi�n producir� un error. El proceso de inicio de sesi�n puede producirse un error debido a una ruta de acceso no v�lida para un recurso es necesario, una versi�n incompatible de MAPI, un servidor de mensajer�a no disponible o da�os en los datos.</span><span class="sxs-lookup"><span data-stu-id="83954-p103">When a logon process fails one time, the user is informed of the failure and given the chance to retry or correct the error condition. Once again, a user interface will be displayed, if the client allows it, and the user will be prompted to enter whatever data is missing. If this second try is unsuccessful, MAPI disables all service providers in the message service for the duration of the session. In effect, the whole message service is disabled. This means that none of the service providers in the message service can work. This is done because if one provider fails logon, the other providers usually also fail. The logon process can fail due to an invalid path for a necessary resource, an incompatible version of MAPI, an unavailable messaging server, or data corruption.</span></span> 
  
<span data-ttu-id="83954-p104">Los clientes pueden especificar uno de los dos tipos de sesiones establecerse en la llamada de inicio de sesi�n: una sesi�n individual o una sesi�n compartida. Sesiones individuales son conexiones privadas; hay una relaci�n uno a uno entre una aplicaci�n cliente y la sesi�n que est� usando. Como consecuencia, las aplicaciones de cliente que comparten una sesi�n tambi�n compartan un perfil. Sesiones compartidas se establecen una vez, pero pueden usar otras aplicaciones cliente que necesitan usarlos. El perfil y las credenciales se especifican s�lo con el inicio de sesi�n inicial.</span><span class="sxs-lookup"><span data-stu-id="83954-p104">Clients can specify one of two types of sessions to be established in the logon call: an individual session or a shared session. Individual sessions are private connections; there is a one-to-one relationship between a client application and the session it is using. As a consequence, client applications that share a session also share a profile. Shared sessions are established once but can be used by other client applications that need to use them. The profile and credentials are specified only with the initial logon.</span></span> 
  
<span data-ttu-id="83954-p105">Los clientes pueden iniciar sesi�n varias veces como el mismo usuario o varios usuarios. MAPI no evitarlo. Algunos proveedores de servicios, sin embargo, podr�an no ser tan flexibles, devuelve el valor de error MAPI_E_SESSION_LIMIT en los intentos de inicio de sesi�n subsiguientes. Proveedores de servicios con limitaciones de hardware subyacentes pueden necesitar para aplicar un l�mite de sesi�n.</span><span class="sxs-lookup"><span data-stu-id="83954-p105">Clients can log on multiple times as the same user or as multiple users. MAPI does not prevent this. Some service providers, however, might not be as flexible, returning the error value MAPI_E_SESSION_LIMIT on subsequent logon attempts. Service providers with underlying hardware limitations can be required to enforce a session limit.</span></span>
  
<span data-ttu-id="83954-p106">Las llamadas de funci�n para establecer una sesi�n tienen una colecci�n de par�metros y los indicadores que controlan c�mo se crea la sesi�n. El cliente especifica un nombre de perfil opcional y un identificador de ventana que act�a como la ventana principal de los cuadros de di�logo que se muestran. Las marcas son MAPI_NEW_SESSION, que solicita que se puede establecer una sesi�n nueva, individual (en lugar de una sesi�n compartida), y el indicador de interfaz de usuario MAPI_LOGON_UI. El indicador de la interfaz de usuario se establece para solicitar un cuadro de di�logo de inicio de sesi�n.</span><span class="sxs-lookup"><span data-stu-id="83954-p106">The function calls for establishing a session have a collection of flags and parameters that control how the session is created. The client specifies an optional profile name and a window handle that acts as the parent window for any dialog boxes that are displayed. The flags include MAPI_NEW_SESSION, which requests that a new, individual session (rather than a shared session) be established, and the MAPI_LOGON_UI user interface flag. The user interface flag is set to request a logon dialog box.</span></span>
  
<span data-ttu-id="83954-136">En la siguiente ilustraci�n muestra c�mo estos diversos par�metros y marcas de establecen una sesi�n MAPI.</span><span class="sxs-lookup"><span data-stu-id="83954-136">The following illustration shows how these various parameters and flags establish a MAPI session.</span></span>
  
<span data-ttu-id="83954-137">**Diagrama de flujo de sesi�n de MAPI**</span><span class="sxs-lookup"><span data-stu-id="83954-137">**MAPI session flowchart**</span></span>
  
<span data-ttu-id="83954-138">![Diagrama de flujo de sesión MAPI] (media/amapi_47.gif "Diagrama de flujo de sesión MAPI")</span><span class="sxs-lookup"><span data-stu-id="83954-138">![MAPI session flowchart](media/amapi_47.gif "MAPI session flowchart")</span></span>
  
<span data-ttu-id="83954-139">For information about handling sessions from within a client application, see [Control de sesi�n MAPI](mapi-session-handling.md)</span><span class="sxs-lookup"><span data-stu-id="83954-139">For information about handling sessions from within a client application, see [MAPI Session Handling](mapi-session-handling.md)</span></span>
  
## <a name="see-also"></a><span data-ttu-id="83954-140">Vea tambi�n</span><span class="sxs-lookup"><span data-stu-id="83954-140">See also</span></span>

- [<span data-ttu-id="83954-141">MAPILogonEx</span><span class="sxs-lookup"><span data-stu-id="83954-141">MAPILogonEx</span></span>](mapilogonex.md)  
- [<span data-ttu-id="83954-142">IMAPISession: IUnknown</span><span class="sxs-lookup"><span data-stu-id="83954-142">IMAPISession : IUnknown</span></span>](imapisessioniunknown.md)
- [<span data-ttu-id="83954-143">Control de sesi�n MAPI</span><span class="sxs-lookup"><span data-stu-id="83954-143">MAPI Session Handling</span></span>](mapi-session-handling.md)  
- [<span data-ttu-id="83954-144">Informaci�n general sobre programaci�n de MAPI</span><span class="sxs-lookup"><span data-stu-id="83954-144">MAPI Programming Overview</span></span>](mapi-programming-overview.md)

