---
title: Administrar las notificaciones de almacén de mensajes
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3e0cc2f9-a88d-4cec-bef5-b60f2ec80f1c
description: 'Última modificación: 09 de marzo de 2015'
ms.openlocfilehash: d370603dc7cfc015fe7b2757d1cf0525b3092c5e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428028"
---
# <a name="handling-message-store-notification"></a><span data-ttu-id="4b50d-103">Administrar las notificaciones de almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="4b50d-103">Handling message store notification</span></span>
  
<span data-ttu-id="4b50d-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="4b50d-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="4b50d-105">Para registrarse en las notificaciones del almacén de mensajes, llame al método [IMAPISession:: Advise](imapisession-advise.md) o [IMsgStore:: Advise](imsgstore-advise.md) y especifique un almacén de mensajes, una carpeta o un identificador de entrada de mensaje en el contenido del parámetro _lpEntryID_ .</span><span class="sxs-lookup"><span data-stu-id="4b50d-105">To register for message store notifications, call either the [IMAPISession::Advise](imapisession-advise.md) or [IMsgStore::Advise](imsgstore-advise.md) method and specify a message store, folder, or message entry identifier in the contents of the  _lpEntryID_ parameter.</span></span> <span data-ttu-id="4b50d-106">Los proveedores de almacenamiento de mensajes admiten notificaciones de objetos y tablas.</span><span class="sxs-lookup"><span data-stu-id="4b50d-106">Message store providers support both object and table notifications.</span></span> <span data-ttu-id="4b50d-107">Tanto si se registra con objetos de almacén de mensajes concretos, como en las tablas de contenido y jerarquía de carpetas que describen estos objetos, o con objetos y tablas, depende de las notificaciones que se espera ver, las llamadas que se realizan para realizar operaciones y cómo el proveedor de almacenamiento de mensajes admite la notificación.</span><span class="sxs-lookup"><span data-stu-id="4b50d-107">Whether you register with particular message store objects, with the folder hierarchy and contents tables that describe these objects, or with both objects and tables depends on the notifications you expect to see, the calls you make to perform operations, and how the message store provider supports notification.</span></span> 
  
<span data-ttu-id="4b50d-108">Como MAPI permite flexibilidad en el modo en que los proveedores admiten las notificaciones, tenga en cuenta que no siempre recibirá el mismo tipo de notificación en respuesta a un evento concreto de todos los proveedores de almacenamiento de mensajes.</span><span class="sxs-lookup"><span data-stu-id="4b50d-108">Because MAPI allows flexibility in how providers support notifications, be aware that you will not always receive the same type of notification in response to a particular event from all message store providers.</span></span> <span data-ttu-id="4b50d-109">Algunos proveedores de almacenamiento de mensajes no admiten notificaciones en absoluto.</span><span class="sxs-lookup"><span data-stu-id="4b50d-109">Some message store providers do not support notifications at all.</span></span> <span data-ttu-id="4b50d-110">Para determinar si el almacén de mensajes que está usando admite la notificación, busque el bit STORE_NOTIFY_OK en su propiedad **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="4b50d-110">To determine if the message store you are using supports notification, look for the STORE_NOTIFY_OK bit in its **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="4b50d-111">En un extremo del espectro de proveedores de almacenamiento de mensajes que admiten notificaciones se encuentran los proveedores que generan notificaciones "enriquecidas"; estos proveedores envían notificaciones descriptivas para todos los orígenes de avisos registrados.</span><span class="sxs-lookup"><span data-stu-id="4b50d-111">At one end of the spectrum of message store providers that support notification are the providers that generate "rich" notifications; these providers send descriptive notifications for all registered advise sources.</span></span> <span data-ttu-id="4b50d-112">En el otro extremo están los proveedores de almacenamiento de mensajes que admiten notificaciones limitadas; estos proveedores envían notificaciones generales para un número restringido de orígenes de notificaciones.</span><span class="sxs-lookup"><span data-stu-id="4b50d-112">At the other end are the message store providers that support limited notifications; these providers send general notifications for a restricted number of advise sources.</span></span> 
  
<span data-ttu-id="4b50d-113">Por ejemplo, si copia un mensaje en una carpeta con la que ha registrado para recibir notificaciones de objetos copiados y movidos de objetos, es posible que no reciba la notificación copiada del objeto.</span><span class="sxs-lookup"><span data-stu-id="4b50d-113">For example, if you copy a message to a folder with which you have registered to receive both object copied and object moved notifications, you may or may not receive the object copied notification.</span></span> <span data-ttu-id="4b50d-114">Si lo recibe depende de:</span><span class="sxs-lookup"><span data-stu-id="4b50d-114">Whether or not you receive it depends on:</span></span>
  
- <span data-ttu-id="4b50d-115">El método al que ha llamado para realizar la copia.</span><span class="sxs-lookup"><span data-stu-id="4b50d-115">The method that you called to perform the copy.</span></span> <span data-ttu-id="4b50d-116">Puede ser [IMAPIFolder:: CopyMessages](imapifolder-copymessages.md), [IMAPIProp:: CopyTo](imapiprop-copyto.md)o [IMAPIProp:: CopyProps](imapiprop-copyprops.md).</span><span class="sxs-lookup"><span data-stu-id="4b50d-116">This could be [IMAPIFolder::CopyMessages](imapifolder-copymessages.md), [IMAPIProp::CopyTo](imapiprop-copyto.md), or [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span>
    
- <span data-ttu-id="4b50d-117">Cómo el proveedor de almacenamiento de mensajes implementa el método de copia.</span><span class="sxs-lookup"><span data-stu-id="4b50d-117">How the message store provider implements the copy method.</span></span>
    
- <span data-ttu-id="4b50d-118">Si el proveedor de almacenamiento de mensajes admite o no notificaciones copiadas de objetos en las carpetas.</span><span class="sxs-lookup"><span data-stu-id="4b50d-118">Whether or not the message store provider supports object copied notifications on folders.</span></span>
    
<span data-ttu-id="4b50d-119">Debido a que no hay instrucciones estrictas que describan cómo implementar la notificación de eventos para los proveedores de almacenamiento de mensajes, los clientes no pueden esperar un comportamiento coherente.</span><span class="sxs-lookup"><span data-stu-id="4b50d-119">Because there are no strict guidelines that describe how to implement event notification for message store providers, clients cannot expect consistent behavior.</span></span> <span data-ttu-id="4b50d-120">MAPI hace recomendaciones en cuanto a cómo implementan los proveedores de almacenamiento de mensajes la notificación de eventos y en la tabla siguiente se describen estas recomendaciones.</span><span class="sxs-lookup"><span data-stu-id="4b50d-120">MAPI does make recommendations as to how message store providers implement event notification and the following table outlines these recommendations.</span></span> <span data-ttu-id="4b50d-121">Lea la tabla de la siguiente manera: después de realizar la operación en la primera columna, espere recibir una notificación del tipo enumerado en la segunda columna si se ha registrado para ese tipo con el objeto que aparece en la tercera columna.</span><span class="sxs-lookup"><span data-stu-id="4b50d-121">Read the table as follows: after you perform the operation in the first column, expect to receive a notification of the type listed in the second column if you have registered for that type with the object listed in the third column.</span></span> <span data-ttu-id="4b50d-122">Por ejemplo, una vez que haya creado una carpeta, recibirá una notificación de _fnevObjectCreated_ solo si se ha registrado para notificaciones de _fnevObjectCreated_ con el almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="4b50d-122">For example, after you have created a folder, you will receive an  _fnevObjectCreated_ notification only if you have registered for  _fnevObjectCreated_ notifications with the message store.</span></span> 
  
|<span data-ttu-id="4b50d-123">**Operación**</span><span class="sxs-lookup"><span data-stu-id="4b50d-123">**Operation**</span></span>|<span data-ttu-id="4b50d-124">**Tipo de evento**</span><span class="sxs-lookup"><span data-stu-id="4b50d-124">**Event type**</span></span>|<span data-ttu-id="4b50d-125">**Informar al origen**</span><span class="sxs-lookup"><span data-stu-id="4b50d-125">**Advise source**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="4b50d-126">Crear una carpeta</span><span class="sxs-lookup"><span data-stu-id="4b50d-126">Create a folder</span></span>  <br/> | <span data-ttu-id="4b50d-127">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="4b50d-127">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="4b50d-128">Almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="4b50d-128">Message store</span></span>  <br/> |
|<span data-ttu-id="4b50d-129">Eliminar una carpeta</span><span class="sxs-lookup"><span data-stu-id="4b50d-129">Delete a folder</span></span>  <br/> | <span data-ttu-id="4b50d-130">_fnevObjectDeleted_</span><span class="sxs-lookup"><span data-stu-id="4b50d-130">_fnevObjectDeleted_</span></span> <br/> |<span data-ttu-id="4b50d-131">Carpeta eliminada del almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="4b50d-131">Message store Deleted folder</span></span>  <br/> |
|<span data-ttu-id="4b50d-132">Mover una carpeta de una carpeta a otra</span><span class="sxs-lookup"><span data-stu-id="4b50d-132">Move a folder from one folder to another</span></span>  <br/> | <span data-ttu-id="4b50d-133">_fnevObjectMoved_</span><span class="sxs-lookup"><span data-stu-id="4b50d-133">_fnevObjectMoved_</span></span> <br/> |<span data-ttu-id="4b50d-134">Carpeta movida del almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="4b50d-134">Message store Moved folder</span></span>  <br/> |
|<span data-ttu-id="4b50d-135">Copiar una carpeta de una carpeta a otra</span><span class="sxs-lookup"><span data-stu-id="4b50d-135">Copy a folder from one folder to another</span></span>  <br/> | <span data-ttu-id="4b50d-136">_fnevObjectCopied_</span><span class="sxs-lookup"><span data-stu-id="4b50d-136">_fnevObjectCopied_</span></span> <br/> |<span data-ttu-id="4b50d-137">Almacén de mensajes y carpeta copiada (no se ha enviado ninguna notificación _fnevObjectCreated_ para la nueva copia de la carpeta)</span><span class="sxs-lookup"><span data-stu-id="4b50d-137">Message store and copied folder (no  _fnevObjectCreated_ notification sent for the new copy of the folder)</span></span>  <br/> |
|<span data-ttu-id="4b50d-138">Cambio en una propiedad de carpeta calculada (**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md)) **, PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md)), **PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="4b50d-138">Change in a computed folder property (**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md)), **PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md)), **PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span></span>  <br/> | <span data-ttu-id="4b50d-139">_fnevObjectModified_</span><span class="sxs-lookup"><span data-stu-id="4b50d-139">_fnevObjectModified_</span></span> <br/> |<span data-ttu-id="4b50d-140">Carpeta modificada del almacén de mensajes (sin notificación a la carpeta principal)</span><span class="sxs-lookup"><span data-stu-id="4b50d-140">Message store Changed folder (No notification to parent folder)</span></span>  <br/> |
|<span data-ttu-id="4b50d-141">Crear un mensaje</span><span class="sxs-lookup"><span data-stu-id="4b50d-141">Create a message</span></span>  <br/> | <span data-ttu-id="4b50d-142">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="4b50d-142">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="4b50d-143">Almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="4b50d-143">Message store</span></span>  <br/> |
|<span data-ttu-id="4b50d-144">Eliminar un mensaje, lo que provoca un cambio en la propiedad **PR_CONTENT_COUNT** de la carpeta principal</span><span class="sxs-lookup"><span data-stu-id="4b50d-144">Delete a message, causing a change in the parent folder's **PR_CONTENT_COUNT** property</span></span>  <br/> | <span data-ttu-id="4b50d-145">_fnevObjectDeleted_</span><span class="sxs-lookup"><span data-stu-id="4b50d-145">_fnevObjectDeleted_</span></span> <br/> |<span data-ttu-id="4b50d-146">Mensaje eliminado del almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="4b50d-146">Message store Deleted message</span></span>  <br/> |
|<span data-ttu-id="4b50d-147">Mover un mensaje de una carpeta a otra</span><span class="sxs-lookup"><span data-stu-id="4b50d-147">Move a message from one folder to another</span></span>  <br/> | <span data-ttu-id="4b50d-148">_fnevObjectMoved_</span><span class="sxs-lookup"><span data-stu-id="4b50d-148">_fnevObjectMoved_</span></span> <br/> |<span data-ttu-id="4b50d-149">Mensaje movido al almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="4b50d-149">Message store Moved message</span></span>  <br/> |
|<span data-ttu-id="4b50d-150">Copiar un mensaje de una carpeta a otra</span><span class="sxs-lookup"><span data-stu-id="4b50d-150">Copy a message from one folder to another</span></span>  <br/> | <span data-ttu-id="4b50d-151">_fnevObjectCopied_</span><span class="sxs-lookup"><span data-stu-id="4b50d-151">_fnevObjectCopied_</span></span> <br/> |<span data-ttu-id="4b50d-152">Mensaje copiado del almacén de mensajes (sin notificación de _fnevObjectCreated_ para una nueva copia del mensaje)</span><span class="sxs-lookup"><span data-stu-id="4b50d-152">Message store Copied message (No  _fnevObjectCreated_ notification for new copy of the message)</span></span>  <br/> |
|<span data-ttu-id="4b50d-153">Guardar un mensaje, lo que provoca un cambio en la propiedad **PR_CONTENT_COUNT** de la carpeta principal</span><span class="sxs-lookup"><span data-stu-id="4b50d-153">Save a message, causing a change in the parent folder's **PR_CONTENT_COUNT** property</span></span>  <br/> | <span data-ttu-id="4b50d-154">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="4b50d-154">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="4b50d-155">Almacén de mensajes en el primer solo guardado</span><span class="sxs-lookup"><span data-stu-id="4b50d-155">Message store on first save only</span></span>  <br/> |
|<span data-ttu-id="4b50d-156">Guardar un mensaje</span><span class="sxs-lookup"><span data-stu-id="4b50d-156">Save a message</span></span>  <br/> | <span data-ttu-id="4b50d-157">_fnevObjectModified_</span><span class="sxs-lookup"><span data-stu-id="4b50d-157">_fnevObjectModified_</span></span> <br/> |<span data-ttu-id="4b50d-158">Almacén de mensajes al guardar después de la primera vez que ha cambiado el mensaje (sin notificación a la carpeta principal)</span><span class="sxs-lookup"><span data-stu-id="4b50d-158">Message store on saves after the first save Changed message (No notification to parent folder)</span></span>  <br/> |
|<span data-ttu-id="4b50d-159">Completar una operación de búsqueda</span><span class="sxs-lookup"><span data-stu-id="4b50d-159">Complete a search operation</span></span>  <br/> | <span data-ttu-id="4b50d-160">_fnevSearchComplete_</span><span class="sxs-lookup"><span data-stu-id="4b50d-160">_fnevSearchComplete_</span></span> <br/> |<span data-ttu-id="4b50d-161">Carpeta de búsqueda del almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="4b50d-161">Message store Search folder</span></span>  <br/> |
|<span data-ttu-id="4b50d-162">Nuevo mensaje</span><span class="sxs-lookup"><span data-stu-id="4b50d-162">New message</span></span>  <br/> | <span data-ttu-id="4b50d-163">_fnevNewMail_</span><span class="sxs-lookup"><span data-stu-id="4b50d-163">_fnevNewMail_</span></span> <br/> |<span data-ttu-id="4b50d-164">Almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="4b50d-164">Message store</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="4b50d-165">Cuando recibe una notificación de modificación de objeto, recuerde que la parte de matriz de etiquetas de propiedad de la estructura [OBJECT_NOTIFICATION](object_notification.md) apuntado por el parámetro _lpNotifications_ en la llamada a la función de la función **Notify** puede o no ser null.</span><span class="sxs-lookup"><span data-stu-id="4b50d-165">When you receive an object modified notification, remember that the property tag array portion of the [OBJECT_NOTIFICATION](object_notification.md) structure pointed to by the  _lpNotifications_ parameter in the **OnNotify** call may or may not be NULL.</span></span> <span data-ttu-id="4b50d-166">No es necesario que los proveedores de almacenamiento de mensajes inserten información de propiedades en esta matriz y la mayoría no lo son.</span><span class="sxs-lookup"><span data-stu-id="4b50d-166">Message store providers are not required to insert property information in this array and most do not.</span></span> <span data-ttu-id="4b50d-167">Asegúrese de que \*\*\*\* el método alnotify puede controlar el caso en el que el puntero _lpPropTagArray_ es NULL.</span><span class="sxs-lookup"><span data-stu-id="4b50d-167">Make sure your **OnNotify** method can handle the case where the  _lpPropTagArray_ pointer is NULL.</span></span> 
  
<span data-ttu-id="4b50d-168">Para la mayoría de las notificaciones de objeto, si no todas, actualice la vista de la carpeta o carpetas afectadas.</span><span class="sxs-lookup"><span data-stu-id="4b50d-168">For most, if not all object notifications, update the view of the affected folder or folders.</span></span>
  

