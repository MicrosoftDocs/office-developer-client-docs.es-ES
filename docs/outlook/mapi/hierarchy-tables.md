---
title: Tablas de jerarquía
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b8aa6b36-d6e5-4e1f-8ac5-5d6a78a70bf8
description: 'Última modificación: 09 de marzo de 2015'
ms.openlocfilehash: 2a1461f0c7196cd425d9736f5837b742bedd4fb5
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428371"
---
# <a name="hierarchy-tables"></a><span data-ttu-id="39ca4-103">Tablas de jerarquía</span><span class="sxs-lookup"><span data-stu-id="39ca4-103">Hierarchy Tables</span></span>

  
  
<span data-ttu-id="39ca4-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="39ca4-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="39ca4-105">Una tabla de jerarquía contiene información sobre las carpetas de un almacén de mensajes o los contenedores de un contenedor de libreta de direcciones.</span><span class="sxs-lookup"><span data-stu-id="39ca4-105">A hierarchy table contains information about the folders in a message store or the containers in an address book container.</span></span> <span data-ttu-id="39ca4-106">Cada fila de una tabla de jerarquía contiene un conjunto de columnas con información sobre una carpeta o contenedor de libreta de direcciones.</span><span class="sxs-lookup"><span data-stu-id="39ca4-106">Each row of a hierarchy table contains a set of columns with information about one folder or address book container.</span></span> <span data-ttu-id="39ca4-107">Los clientes usan principalmente las tablas de jerarquía e las implementan los proveedores de almacenes de mensajes para mostrar un árbol de carpetas y subcarpetas e implementado por los proveedores de libreta de direcciones para mostrar un árbol de contenedores en la libreta de direcciones.</span><span class="sxs-lookup"><span data-stu-id="39ca4-107">Hierarchy tables are primarily used by clients and implemented by message store providers to show a tree of folders and subfolders and implemented by address book providers to show a tree of containers in the address book.</span></span> <span data-ttu-id="39ca4-108">Los contenedores que no pueden contener subcontenedores, como se indica por la ausencia de la marca AB_SUBCONTAINERS en su propiedad **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)), no implementan una tabla de jerarquía.</span><span class="sxs-lookup"><span data-stu-id="39ca4-108">Containers that cannot hold subcontainers, as indicated by the absence of the AB_SUBCONTAINERS flag in their **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)) property, do not implement a hierarchy table.</span></span>
  
<span data-ttu-id="39ca4-109">Se puede obtener acceso a una tabla de jerarquía llamando a:</span><span class="sxs-lookup"><span data-stu-id="39ca4-109">A hierarchy table can be accessed by calling:</span></span>
  
- <span data-ttu-id="39ca4-110">[IMAPIContainer::GetHierarchyTable](imapicontainer-gethierarchytable.md).</span><span class="sxs-lookup"><span data-stu-id="39ca4-110">[IMAPIContainer::GetHierarchyTable](imapicontainer-gethierarchytable.md).</span></span>
    
    - <span data-ttu-id="39ca4-111">O -</span><span class="sxs-lookup"><span data-stu-id="39ca4-111">Or -</span></span>
    
- <span data-ttu-id="39ca4-112">[IMAPIProp::OpenProperty](imapiprop-openproperty.md) pasando **PR_CONTAINER_HIERARCHY** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) como etiqueta de propiedad y IID_IMAPITable como identificador de interfaz.</span><span class="sxs-lookup"><span data-stu-id="39ca4-112">[IMAPIProp::OpenProperty](imapiprop-openproperty.md) passing **PR_CONTAINER_HIERARCHY** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) as the property tag and IID_IMAPITable as the interface identifier.</span></span>
    
<span data-ttu-id="39ca4-113">Los contenedores y carpetas deben admitir ambas técnicas para recuperar propiedades de tabla.</span><span class="sxs-lookup"><span data-stu-id="39ca4-113">Containers and folders must support both techniques for retrieving table properties.</span></span> <span data-ttu-id="39ca4-114">Es inaceptable que los proveedores de servicios admitan solo una forma de obtener acceso a estas tablas porque los clientes esperan tener la opción.</span><span class="sxs-lookup"><span data-stu-id="39ca4-114">It is unacceptable for service providers to support only one way to access these tables because clients expect to have the choice.</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="39ca4-115">No se garantiza que los proveedores de almacén respetan el conjunto de criterio de ordenación especificado para las tablas de jerarquía.</span><span class="sxs-lookup"><span data-stu-id="39ca4-115">Store providers are not guaranteed to honor the sort order set specified for hierarchy tables.</span></span> 
  
<span data-ttu-id="39ca4-116">La llamada a **IMAPIProp::OpenProperty** implica tener acceso a la tabla de jerarquía abriendo su propiedad correspondiente, **PR_CONTAINER_HIERARCHY**.</span><span class="sxs-lookup"><span data-stu-id="39ca4-116">The call to **IMAPIProp::OpenProperty** involves accessing the hierarchy table by opening its corresponding property, **PR_CONTAINER_HIERARCHY**.</span></span> <span data-ttu-id="39ca4-117">Aunque **PR_CONTAINER_HIERARCHY** puede recuperarse a través del método [IMAPIProp::GetProps](imapiprop-getprops.md) de una carpeta o contenedor, se incluye en la matriz de etiquetas de propiedad que devuelve el método [IMAPIProp::GetPropList.](imapiprop-getproplist.md)</span><span class="sxs-lookup"><span data-stu-id="39ca4-117">Although **PR_CONTAINER_HIERARCHY** cannot be retrieved through a folder or container's [IMAPIProp::GetProps](imapiprop-getprops.md) method, it is included in the property tag array that is returned by the [IMAPIProp::GetPropList](imapiprop-getproplist.md) method.</span></span> 
  
 <span data-ttu-id="39ca4-118">**PR_CONTAINER_HIERARCHY** también se puede usar para incluir o excluir una tabla de jerarquía de una operación de copia.</span><span class="sxs-lookup"><span data-stu-id="39ca4-118">**PR_CONTAINER_HIERARCHY** can also be used to include or exclude a hierarchy table from a copy operation.</span></span> <span data-ttu-id="39ca4-119">Si un cliente especifica **PR_CONTAINER_HIERARCHY** en el parámetro  *lpExcludeProps*  para [IMAPIProp::CopyTo](imapiprop-copyto.md) en una operación de copia, la nueva carpeta o contenedor no admitirá la tabla de jerarquía de la carpeta o contenedor original.</span><span class="sxs-lookup"><span data-stu-id="39ca4-119">If a client specifies **PR_CONTAINER_HIERARCHY** in the  *lpExcludeProps*  parameter for [IMAPIProp::CopyTo](imapiprop-copyto.md) in a copy operation, the new folder or container will not support the hierarchy table of the original folder or container.</span></span> 
  
<span data-ttu-id="39ca4-120">Las siguientes propiedades son la columna necesaria establecida en una tabla de jerarquía:</span><span class="sxs-lookup"><span data-stu-id="39ca4-120">The following properties make up the required column set in a hierarchy table:</span></span>
  
|||
|:-----|:-----|
|<span data-ttu-id="39ca4-121">**PR_COMMENT** ([PidTagComment](pidtagcomment-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="39ca4-121">**PR_COMMENT** ([PidTagComment](pidtagcomment-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="39ca4-122">**PR_DEPTH** ([PidTagDepth](pidtagdepth-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="39ca4-122">**PR_DEPTH** ([PidTagDepth](pidtagdepth-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="39ca4-123">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="39ca4-123">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="39ca4-124">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="39ca4-124">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="39ca4-125">**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="39ca4-125">**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="39ca4-126">**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="39ca4-126">**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="39ca4-127">**PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="39ca4-127">**PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="39ca4-128">**PR_STATUS** ([PidTagStatus](pidtagstatus-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="39ca4-128">**PR_STATUS** ([PidTagStatus](pidtagstatus-canonical-property.md))</span></span>  <br/> |
   
 <span data-ttu-id="39ca4-129">**PR_DISPLAY_NAME** contiene el nombre del contenedor o carpeta que debe aparecer en la presentación de la jerarquía.</span><span class="sxs-lookup"><span data-stu-id="39ca4-129">**PR_DISPLAY_NAME** contains the name for the container or folder that should appear in the display of the hierarchy.</span></span> 
  
 <span data-ttu-id="39ca4-130">**PR_ENTRYID** es el identificador de entrada asociado a este contenedor o carpeta.</span><span class="sxs-lookup"><span data-stu-id="39ca4-130">**PR_ENTRYID** is the entry identifier associated with this container or folder.</span></span> <span data-ttu-id="39ca4-131">Se espera que sea un identificador de entrada a largo plazo.</span><span class="sxs-lookup"><span data-stu-id="39ca4-131">It is expected to be a long-term entry identifier.</span></span> <span data-ttu-id="39ca4-132">Los clientes y MAPI pueden pasar este identificador de entrada a **OpenEntry** para abrir el contenedor o carpeta y ver su contenido llamando a [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md).</span><span class="sxs-lookup"><span data-stu-id="39ca4-132">Clients and MAPI can pass this entry identifier to **OpenEntry** to open the container or folder and view its contents by calling [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md).</span></span> 
  
 <span data-ttu-id="39ca4-133">**PR_DEPTH** es un valor numérico que indica el nivel de sangría de este contenedor o carpeta con cero siendo el nivel superior.</span><span class="sxs-lookup"><span data-stu-id="39ca4-133">**PR_DEPTH** is a numeric value that indicates the level of indentation for this container or folder with zero being the top level.</span></span> <span data-ttu-id="39ca4-134">Cuanto más profunda sea la jerarquía en la que resida un contenedor o carpeta, mayor será el valor de su **PR_DEPTH** propiedad.</span><span class="sxs-lookup"><span data-stu-id="39ca4-134">The deeper in the hierarchy a container or folder resides, the higher the value for its **PR_DEPTH** property.</span></span> <span data-ttu-id="39ca4-135">Los clientes usan **la PR_DEPTH** para mostrar una tabla de jerarquía adecuadamente para que los usuarios puedan ver claramente las relaciones primarias y secundarias.</span><span class="sxs-lookup"><span data-stu-id="39ca4-135">Clients use the **PR_DEPTH** property to display a hierarchy table appropriately so that users can clearly see parent and child relationships.</span></span> <span data-ttu-id="39ca4-136">La profundidad de contenedor o carpeta siempre es relativa al contenedor o carpeta que implementa la tabla de jerarquía.</span><span class="sxs-lookup"><span data-stu-id="39ca4-136">Container or folder depth is always relative to the container or folder implementing the hierarchy table.</span></span> 
  
 <span data-ttu-id="39ca4-137">**PR_OBJECT_TYPE** siempre se establece en MAPI_ABCONT para las tablas de jerarquía de libretas de direcciones y MAPI_FOLDER para las tablas de jerarquía de carpetas.</span><span class="sxs-lookup"><span data-stu-id="39ca4-137">**PR_OBJECT_TYPE** is always set to MAPI_ABCONT for address book hierarchy tables and MAPI_FOLDER for folder hierarchy tables.</span></span> 
  
 <span data-ttu-id="39ca4-138">**PR_DISPLAY_TYPE** es un valor numérico que se relaciona con la forma en que se muestra un contenedor o carpeta en la tabla de jerarquía.</span><span class="sxs-lookup"><span data-stu-id="39ca4-138">**PR_DISPLAY_TYPE** is a numeric value that relates to how a container or folder is displayed in the hierarchy table.</span></span> <span data-ttu-id="39ca4-139">Se usa principalmente con fines de presentación, para diferenciar visualmente entre tipos de contenedores o carpetas.</span><span class="sxs-lookup"><span data-stu-id="39ca4-139">It is mainly used for display purposes, to differentiate visually between types of containers or folders.</span></span> <span data-ttu-id="39ca4-140">Muchos proveedores de libreta de direcciones y almacén de mensajes usan iconos para los distintos tipos de presentación.</span><span class="sxs-lookup"><span data-stu-id="39ca4-140">Many message store and address book providers use icons for the different display types.</span></span> <span data-ttu-id="39ca4-141">El proveedor debe proporcionar estos iconos; MAPI no proporciona valores predeterminados.</span><span class="sxs-lookup"><span data-stu-id="39ca4-141">It is up to the provider to supply these icons; MAPI does not supply defaults.</span></span> 
  
<span data-ttu-id="39ca4-142">MAPI define muchos valores para **PR_DISPLAY_TYPE**, algunos que son válidos para carpetas y otros que se usan con las tablas de jerarquía de contenedores de libreta de direcciones.</span><span class="sxs-lookup"><span data-stu-id="39ca4-142">MAPI defines many values for **PR_DISPLAY_TYPE**, some that are valid for folders and others that are used with the hierarchy tables of address book containers.</span></span> <span data-ttu-id="39ca4-143">Normalmente, el PR_DISPLAY_TYPE  de una carpeta se establece en DT_FOLDER para indicar un icono de carpeta predeterminado, DT_FOLDER_LINK para indicar un icono que representa un vínculo a otra carpeta o DT_FOLDER_SPECIAL para indicar un icono específico de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="39ca4-143">Typically, a folder's **PR_DISPLAY_TYPE** is set to DT_FOLDER to indicate a default folder icon, DT_FOLDER_LINK to indicate an icon that represents a link to another folder, or DT_FOLDER_SPECIAL to indicate an icon that is application-specific.</span></span> <span data-ttu-id="39ca4-144">DT_FOLDER_LINK se usa con carpetas de resultados de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="39ca4-144">DT_FOLDER_LINK is used with search-results folders.</span></span> 
  
<span data-ttu-id="39ca4-145">Además de estas columnas necesarias, las tablas de jerarquía de libreta de direcciones deben incluir **la PR_CONTAINER_FLAGS** propiedad.</span><span class="sxs-lookup"><span data-stu-id="39ca4-145">In addition to these required columns, address book hierarchy tables must include the **PR_CONTAINER_FLAGS** property.</span></span> <span data-ttu-id="39ca4-146">**PR_CONTAINER_FLAGS** indica varios atributos sobre un contenedor de la jerarquía y se usa para distinguir un contenedor de otro.</span><span class="sxs-lookup"><span data-stu-id="39ca4-146">**PR_CONTAINER_FLAGS** indicates various attributes about a container in the hierarchy and is used to distinguish one container from another.</span></span> 
  
<span data-ttu-id="39ca4-147">Una propiedad opcional para las tablas de jerarquía de libreta de direcciones **es PR_AB_PROVIDER_ID** ([PidTagAbProviderId](pidtagabproviderid-canonical-property.md)) propiedad.</span><span class="sxs-lookup"><span data-stu-id="39ca4-147">An optional property for address book hierarchy tables is the **PR_AB_PROVIDER_ID** ([PidTagAbProviderId](pidtagabproviderid-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="39ca4-148">Las tablas de jerarquía de almacén de mensajes incluyen estas propiedades en su conjunto de columnas requerido:</span><span class="sxs-lookup"><span data-stu-id="39ca4-148">Message-store hierarchy tables include these properties in their required column set:</span></span>
  
- <span data-ttu-id="39ca4-149">**PR_FOLDER_TYPE** ([PidTagFolderType](pidtagfoldertype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="39ca4-149">**PR_FOLDER_TYPE** ([PidTagFolderType](pidtagfoldertype-canonical-property.md))</span></span>
    
- <span data-ttu-id="39ca4-150">**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="39ca4-150">**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md))</span></span>
    
- <span data-ttu-id="39ca4-151">**PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="39ca4-151">**PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span></span>
    
- <span data-ttu-id="39ca4-152">**PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="39ca4-152">**PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md))</span></span>
    
<span data-ttu-id="39ca4-153">Los proveedores de libreta de direcciones deben admitir los siguientes métodos **IMAPITable** en sus implementaciones de tabla de jerarquía porque la libreta de direcciones integrada MAPI los requiere:</span><span class="sxs-lookup"><span data-stu-id="39ca4-153">Address book providers must support the following **IMAPITable** methods in their hierarchy table implementations because they are required by the MAPI integrated address book:</span></span> 
  
|||
|:-----|:-----|
|[<span data-ttu-id="39ca4-154">IMAPITable::QueryColumns</span><span class="sxs-lookup"><span data-stu-id="39ca4-154">IMAPITable::QueryColumns</span></span>](imapitable-querycolumns.md) <br/> |[<span data-ttu-id="39ca4-155">IMAPITable::QueryPosition</span><span class="sxs-lookup"><span data-stu-id="39ca4-155">IMAPITable::QueryPosition</span></span>](imapitable-queryposition.md) <br/> |
|[<span data-ttu-id="39ca4-156">IMAPITable::SeekRow</span><span class="sxs-lookup"><span data-stu-id="39ca4-156">IMAPITable::SeekRow</span></span>](imapitable-seekrow.md) <br/> |[<span data-ttu-id="39ca4-157">IMAPITable::SeekRowApprox</span><span class="sxs-lookup"><span data-stu-id="39ca4-157">IMAPITable::SeekRowApprox</span></span>](imapitable-seekrowapprox.md) <br/> |
|[<span data-ttu-id="39ca4-158">IMAPITable::FindRow</span><span class="sxs-lookup"><span data-stu-id="39ca4-158">IMAPITable::FindRow</span></span>](imapitable-findrow.md) <br/> |[<span data-ttu-id="39ca4-159">IMAPITable::Restrict</span><span class="sxs-lookup"><span data-stu-id="39ca4-159">IMAPITable::Restrict</span></span>](imapitable-restrict.md) <br/> |
|[<span data-ttu-id="39ca4-160">IMAPITable::CreateBookmark</span><span class="sxs-lookup"><span data-stu-id="39ca4-160">IMAPITable::CreateBookmark</span></span>](imapitable-createbookmark.md) <br/> |[<span data-ttu-id="39ca4-161">IMAPITable::FreeBookmark</span><span class="sxs-lookup"><span data-stu-id="39ca4-161">IMAPITable::FreeBookmark</span></span>](imapitable-freebookmark.md) <br/> |
|[<span data-ttu-id="39ca4-162">IMAPITable::QueryRows</span><span class="sxs-lookup"><span data-stu-id="39ca4-162">IMAPITable::QueryRows</span></span>](imapitable-queryrows.md) <br/> | <br/> |
   
## <a name="see-also"></a><span data-ttu-id="39ca4-163">Vea también</span><span class="sxs-lookup"><span data-stu-id="39ca4-163">See also</span></span>



[<span data-ttu-id="39ca4-164">Tablas MAPI</span><span class="sxs-lookup"><span data-stu-id="39ca4-164">MAPI Tables</span></span>](mapi-tables.md)

