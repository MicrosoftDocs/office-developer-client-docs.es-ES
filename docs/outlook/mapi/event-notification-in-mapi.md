---
title: Notificación de eventos en MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7b3b625b-6dea-4b12-99a9-152935bdfe39
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: 9c1fd58a31481d8666ca931408c16bd73aaba660
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19816787"
---
# <a name="event-notification-in-mapi"></a><span data-ttu-id="c52b9-103">Notificación de eventos en MAPI</span><span class="sxs-lookup"><span data-stu-id="c52b9-103">Event notification in MAPI</span></span>

<span data-ttu-id="c52b9-104">**Hace referencia a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="c52b9-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="c52b9-105">Notificación de eventos es la comunicación de la información entre dos objetos MAPI.</span><span class="sxs-lookup"><span data-stu-id="c52b9-105">Event notification is the communication of information between two MAPI objects.</span></span> <span data-ttu-id="c52b9-106">A través de uno de los objetos, un proveedor de servicio o cliente se registra para la notificación de un cambio o error, llamado a un evento, que es posible que tienen lugar en el otro objeto.</span><span class="sxs-lookup"><span data-stu-id="c52b9-106">Through one of the objects, a client or service provider registers for notification of a change or error, called an event, which may take place in the other object.</span></span> <span data-ttu-id="c52b9-107">Una vez que se produce el evento, el primer objeto se notifica el cambio o error.</span><span class="sxs-lookup"><span data-stu-id="c52b9-107">After the event occurs, the first object is notified of the change or error.</span></span> <span data-ttu-id="c52b9-108">Objeto que recibe la notificación se denomina el receptor de notificaciones; el objeto responsable de la notificación se denomina el origen advise.</span><span class="sxs-lookup"><span data-stu-id="c52b9-108">The object receiving the notification is called the advise sink; the object responsible for the notification is called the advise source.</span></span>
  
<span data-ttu-id="c52b9-109">Hay tres tipos de advise objetos del receptor (todos los tipos son objetos estándar de MAPI):</span><span class="sxs-lookup"><span data-stu-id="c52b9-109">There are three types of advise sink objects (all types are standard MAPI objects):</span></span>
  
- <span data-ttu-id="c52b9-110">Objetos del receptor de aviso.</span><span class="sxs-lookup"><span data-stu-id="c52b9-110">Advise sink objects.</span></span>   
- <span data-ttu-id="c52b9-111">Formulario de aviso objetos del receptor.</span><span class="sxs-lookup"><span data-stu-id="c52b9-111">Form advise sink objects.</span></span>  
- <span data-ttu-id="c52b9-112">Vista de aviso objetos del receptor.</span><span class="sxs-lookup"><span data-stu-id="c52b9-112">View advise sink objects.</span></span>
    
<span data-ttu-id="c52b9-113">Objetos de receptor son el tipo más común de aviso.</span><span class="sxs-lookup"><span data-stu-id="c52b9-113">Advise sink objects are the most common type.</span></span> <span data-ttu-id="c52b9-114">Aviso receptores normalmente se implementan por las aplicaciones de cliente para recibir la libreta de direcciones y las notificaciones del almacén de mensajes y compatibilidad con el [IMAPIAdviseSink: IUnknown](imapiadvisesinkiunknown.md) interfaz.</span><span class="sxs-lookup"><span data-stu-id="c52b9-114">Advise sinks are typically implemented by client applications to receive address book and message store notifications and support the [IMAPIAdviseSink : IUnknown](imapiadvisesinkiunknown.md) interface.</span></span> <span data-ttu-id="c52b9-115">**IMAPIAdviseSink** contiene un método único, [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md).</span><span class="sxs-lookup"><span data-stu-id="c52b9-115">**IMAPIAdviseSink** contains a single method, [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md).</span></span> <span data-ttu-id="c52b9-116">Formularios y vistas de aviso receptores son menos comunes; se implementan para recibir notificaciones sobre cambios en los formularios personalizados.</span><span class="sxs-lookup"><span data-stu-id="c52b9-116">Form and view advise sinks are less common; they are implemented to receive notifications about changes to custom forms.</span></span> <span data-ttu-id="c52b9-117">Formulario de aviso compatibilidad con receptores de la [IMAPIFormAdviseSink: IUnknown](imapiformadvisesinkiunknown.md) interfaz y vista de aviso compatibilidad con receptores de la [IMAPIViewAdviseSink: IUnknown](imapiviewadvisesinkiunknown.md) interfaz.</span><span class="sxs-lookup"><span data-stu-id="c52b9-117">Form advise sinks support the [IMAPIFormAdviseSink : IUnknown](imapiformadvisesinkiunknown.md) interface and view advise sinks support the [IMAPIViewAdviseSink : IUnknown](imapiviewadvisesinkiunknown.md) interface.</span></span> <span data-ttu-id="c52b9-118">Debido a que los objetos del receptor de aviso estándar de implementar la mayoría de los clientes, se supone que las discusiones de notificaciones se relacionan con la libreta de direcciones y las notificaciones del almacén de mensajes en lugar de las notificaciones de formularios.</span><span class="sxs-lookup"><span data-stu-id="c52b9-118">Because most clients implement standard advise sink objects, assume that discussions of notifications relate to address book and message store notifications rather than forms notifications.</span></span> <span data-ttu-id="c52b9-119">Para obtener más información acerca de las notificaciones de formularios, vea [Las notificaciones de formularios de MAPI](mapi-forms-notifications.md) y la [Escritura de código de servidor de formulario](writing-form-server-code.md).</span><span class="sxs-lookup"><span data-stu-id="c52b9-119">For more information about forms notifications, see [MAPI Forms Notifications](mapi-forms-notifications.md) and [Writing Form Server Code](writing-form-server-code.md).</span></span>
  
<span data-ttu-id="c52b9-120">Origen de objetos se implementan por proveedores de servicio y por MAPI de aviso.</span><span class="sxs-lookup"><span data-stu-id="c52b9-120">Advise source objects are implemented by service providers and by MAPI.</span></span> <span data-ttu-id="c52b9-121">No todos los proveedores de servicio admiten la notificación de evento; es opcional, pero se recomienda encarecidamente.</span><span class="sxs-lookup"><span data-stu-id="c52b9-121">Not all service providers support event notification; it is optional, but strongly recommended.</span></span> <span data-ttu-id="c52b9-122">Dirección y el almacén de mensajes del libro a proveedores normalmente las notificaciones del objeto de soporte técnico en varios de sus objetos y las notificaciones de tabla en su contenido y las tablas de jerarquía.</span><span class="sxs-lookup"><span data-stu-id="c52b9-122">Message store and address book providers usually support object notifications on several of their objects and table notifications on their contents and hierarchy tables.</span></span> <span data-ttu-id="c52b9-123">Los proveedores de transporte no admiten notificaciones directamente; se basan en los métodos alternativos de comunicación con los clientes.</span><span class="sxs-lookup"><span data-stu-id="c52b9-123">Transport providers do not support notifications directly; they rely on alternative methods of communication with clients.</span></span>
  
<span data-ttu-id="c52b9-124">A diferencia de los receptores de advise, aviso de objetos de origen no son un único tipo de objeto MAPI.</span><span class="sxs-lookup"><span data-stu-id="c52b9-124">Unlike advise sinks, advise source objects are not a unique type of MAPI object.</span></span> <span data-ttu-id="c52b9-125">Muchos de los objetos MAPI, como almacenes de mensajes y tablas, pueden realizar en la función de origen advise.</span><span class="sxs-lookup"><span data-stu-id="c52b9-125">Many MAPI objects, such as message stores and tables, can take on the role of advise source.</span></span> <span data-ttu-id="c52b9-126">Un origen de advise es cualquier objeto MAPI que hace lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="c52b9-126">An advise source is any MAPI object that does the following:</span></span>
  
- <span data-ttu-id="c52b9-127">Implementa un método **Advise** para recibir los registros de notificación.</span><span class="sxs-lookup"><span data-stu-id="c52b9-127">Implements an **Advise** method to receive notification registrations.</span></span> 
    
- <span data-ttu-id="c52b9-128">Implementa un método **Unadvise** para recibir cancelaciones de notificación.</span><span class="sxs-lookup"><span data-stu-id="c52b9-128">Implements an **Unadvise** method to receive notification cancellations.</span></span> 
    
- <span data-ttu-id="c52b9-129">Genera las notificaciones del tipo adecuado a los objetos del receptor advise adecuados que se hayan registrado mediante una llamada a sus métodos **IMAPIAdviseSink::OnNotify** .</span><span class="sxs-lookup"><span data-stu-id="c52b9-129">Generates notifications of the appropriate type to the appropriate advise sink objects that have registered by calling their **IMAPIAdviseSink::OnNotify** methods.</span></span> 
    
<span data-ttu-id="c52b9-130">Los clientes que implementan de aviso receptor objetos llamen **Advise** cuando desea registrarse para una notificación, en la mayoría de los casos pasando el identificador de entrada del objeto con el que debe producirse el registro y **Unadvise** cuando desean cancelar la en el registro.</span><span class="sxs-lookup"><span data-stu-id="c52b9-130">Clients that implement advise sink objects call **Advise** when they want to register for a notification, in most cases passing in the entry identifier of the object with which registration should occur, and **Unadvise** when they want to cancel the registration.</span></span> <span data-ttu-id="c52b9-131">Los clientes pasan un parámetro a **Advise** que indica cuál de los varios tipos de eventos que desean supervisar.</span><span class="sxs-lookup"><span data-stu-id="c52b9-131">Clients pass a parameter to **Advise** that indicates which of the several types of events they want to monitor.</span></span> <span data-ttu-id="c52b9-132">**Advise** devuelve un número distinto de cero que representa una conexión entre el receptor de notificaciones y el origen de advise correctamente.</span><span class="sxs-lookup"><span data-stu-id="c52b9-132">**Advise** returns a nonzero number that represents a successful connection between the advise sink and advise source.</span></span> 
  
<span data-ttu-id="c52b9-133">Antes de llamar a **Advise**, los clientes pueden determinar si un proveedor de almacén de mensajes es compatible con la notificación mediante la comprobación de que el indicador STORE_NOTIFY_OK se establece en **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) del almacén de mensajes propiedad.</span><span class="sxs-lookup"><span data-stu-id="c52b9-133">Before calling **Advise**, clients can determine whether a message store provider supports notification by checking that the STORE_NOTIFY_OK flag is set in the message store's **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property.</span></span> <span data-ttu-id="c52b9-134">Hay ninguna forma para que los clientes determinar de antemano o no un proveedor de la libreta de direcciones es compatible con las notificaciones.</span><span class="sxs-lookup"><span data-stu-id="c52b9-134">There is no way for clients to determine ahead of time whether or not an address book provider supports notifications.</span></span> <span data-ttu-id="c52b9-135">Los clientes deben intentar registrar y si se produce un error en el intento, puede asumir las notificaciones no son compatibles.</span><span class="sxs-lookup"><span data-stu-id="c52b9-135">Clients must attempt to register and if the attempt fails, they can assume notifications are unsupported.</span></span>
  
<span data-ttu-id="c52b9-136">Cuando se produce un evento para el que se ha registrado un cliente, el origen de advise notifica el receptor de notificaciones mediante una llamada a su método [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) con una estructura de datos de notificación que contiene información sobre el evento.</span><span class="sxs-lookup"><span data-stu-id="c52b9-136">When an event for which a client has registered occurs, the advise source notifies the advise sink by calling its [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) method with a notification data structure that contains information about the event.</span></span> <span data-ttu-id="c52b9-137">Implementación de un receptor de notificaciones de **OnNotify** puede realizar tareas en respuesta a la notificación, como actualizar datos en la memoria o actualizar una presentación de la pantalla.</span><span class="sxs-lookup"><span data-stu-id="c52b9-137">An advise sink's implementation of **OnNotify** can perform tasks in response to the notification, such as updating data in memory or refreshing a screen display.</span></span> 
  
<span data-ttu-id="c52b9-138">Proveedores de servicios pueden implementar la compatibilidad con las notificaciones de forma manual o aprovechar las ventajas de la ayuda proporcionada en tres métodos **IMAPISupport** : [IMAPISupport::Subscribe](imapisupport-subscribe.md), [IMAPISupport::Unsubscribe](imapisupport-unsubscribe.md)y [IMAPISupport::Notify ](imapisupport-notify.md).</span><span class="sxs-lookup"><span data-stu-id="c52b9-138">Service providers can implement support for notifications manually or take advantage of the help provided in three **IMAPISupport** methods: [IMAPISupport::Subscribe](imapisupport-subscribe.md), [IMAPISupport::Unsubscribe](imapisupport-unsubscribe.md), and [IMAPISupport::Notify](imapisupport-notify.md).</span></span> <span data-ttu-id="c52b9-139">Los métodos ** **Subscribe** y** controlen el registro de notificación y anulación de registro para los proveedores; el método **Notify** controla las notificaciones de envía cuando sea apropiado.</span><span class="sxs-lookup"><span data-stu-id="c52b9-139">The **Subscribe** and **Unsubscribe** methods handle notification registration and deregistration for providers; the **Notify** method handles sending notifications when appropriate.</span></span> 
  
<span data-ttu-id="c52b9-140">Para usar los métodos del objeto compatibilidad con registro de notificaciones, proveedores de servicios de llamada [IMAPISupport::Subscribe](imapisupport-subscribe.md) en sus métodos **Advise** y pasan a **suscribir** el puntero de receptor de advise que los clientes pasan a **Advise**.</span><span class="sxs-lookup"><span data-stu-id="c52b9-140">To use the support object methods for notification registration, service providers call [IMAPISupport::Subscribe](imapisupport-subscribe.md) in their **Advise** methods and pass to **Subscribe** the advise sink pointer that clients pass to **Advise**.</span></span> <span data-ttu-id="c52b9-141">Si un identificador de entrada se pasa como un parámetro de entrada para especificar un origen de advise, proveedores de servicios de conversión a una clave de binaria.</span><span class="sxs-lookup"><span data-stu-id="c52b9-141">If an entry identifier is passed as an input parameter to specify an advise source, service providers convert it to a binary key.</span></span> <span data-ttu-id="c52b9-142">**SUBSCRIBE** crea un número único de conexión y es este número que devuelven los proveedores de servicios a los clientes.</span><span class="sxs-lookup"><span data-stu-id="c52b9-142">**Subscribe** creates a unique connection number and it is this number that service providers return to clients.</span></span> <span data-ttu-id="c52b9-143">Proveedores de servicios pueden liberar el cliente puntero de objeto de receptor de aviso en cualquier momento después de que haya finalizado la llamada **Advise** .</span><span class="sxs-lookup"><span data-stu-id="c52b9-143">Service providers can release the client's advise sink object pointer at any time after the **Advise** call has completed.</span></span> 
  
<span data-ttu-id="c52b9-144">Cuando los clientes llaman **Unadvise** para cancelar un registro, los proveedores de servicios puede ser disminuir el recuento de referencia en el cliente puntero receptor de aviso o llame al **Cancelar suscripción** para hacer lo mismo.</span><span class="sxs-lookup"><span data-stu-id="c52b9-144">When clients call **Unadvise** to cancel a registration, service providers either decrement the reference count on the client's advise sink pointer or call **Unsubscribe** to do the same.</span></span> 
  
<span data-ttu-id="c52b9-145">Si es el momento de generar una notificación, proveedores de servicios de llevar a cabo cualquier procesamiento interno que se relaciona con la notificación e inicializa una estructura de [notificación](notification.md) mediante la configuración de todos sus miembros no usados en cero.</span><span class="sxs-lookup"><span data-stu-id="c52b9-145">When it is time to generate a notification, service providers perform any internal processing that relates to the notification and initializes a [NOTIFICATION](notification.md) structure by setting all of its unused members to zero.</span></span> <span data-ttu-id="c52b9-146">Esta técnica para inicializar la estructura de **notificación** puede ayudar a los clientes a crear más pequeños, con mayor rapidez y menos propensas a errores implementaciones de **OnNotify** .</span><span class="sxs-lookup"><span data-stu-id="c52b9-146">This technique for initializing the **NOTIFICATION** structure can help clients create smaller, faster, and less error-prone **OnNotify** implementations.</span></span> 
  
<span data-ttu-id="c52b9-147">En la siguiente ilustración se muestra la comunicación entre objetos del receptor de aviso, objetos de origen y MAPI de aviso.</span><span class="sxs-lookup"><span data-stu-id="c52b9-147">The following illustration shows the communication between advise sink objects, advise source objects, and MAPI.</span></span> <span data-ttu-id="c52b9-148">MAPI está implicada sólo cuando el origen de advise llama a los métodos **IMAPISupport** para soporte técnico de notificación.</span><span class="sxs-lookup"><span data-stu-id="c52b9-148">MAPI is involved only when the advise source calls the **IMAPISupport** methods for notification support.</span></span> 
  
<span data-ttu-id="c52b9-149">**Llamadas de notificación de eventos**</span><span class="sxs-lookup"><span data-stu-id="c52b9-149">**Event notification calls**</span></span>
  
<span data-ttu-id="c52b9-150">![Llamadas de notificación de eventos] (media/amapi_51.gif "Llamadas de notificación de eventos")</span><span class="sxs-lookup"><span data-stu-id="c52b9-150">![Event notification calls](media/amapi_51.gif "Event notification calls")</span></span>
  
<span data-ttu-id="c52b9-151">La clase MFCMAPI **CAdviseSink** (con los archivos AdviseSink.h y AdviseSink.cpp) implementa el objeto de receptor advise para todas las llamadas a **Advise**.</span><span class="sxs-lookup"><span data-stu-id="c52b9-151">The MFCMAPI **CAdviseSink** class (using the AdviseSink.h and AdviseSink.cpp files) implements the advise sink object for all calls to **Advise**.</span></span> <span data-ttu-id="c52b9-152">Para obtener más información sobre MFCMAPI, consulte [MFCMAPI como un ejemplo de código](mfcmapi-as-a-code-sample.md) y [MFCMAPI](http://go.microsoft.com/fwlink/?LinkId=124154).</span><span class="sxs-lookup"><span data-stu-id="c52b9-152">For more information about MFCMAPI, see [MFCMAPI as a Code Sample](mfcmapi-as-a-code-sample.md) and [MFCMAPI](http://go.microsoft.com/fwlink/?LinkId=124154).</span></span>
  

