---
title: Objetos de progreso MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e446004e-1ef2-4e58-b764-de7b4dcefaf1
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: 73d905028f8f62ad8cbb9da9b1ad61b8cab1065e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33422029"
---
# <a name="mapi-progress-objects"></a><span data-ttu-id="8128f-103">Objetos de progreso MAPI</span><span class="sxs-lookup"><span data-stu-id="8128f-103">MAPI Progress Objects</span></span>

  
  
<span data-ttu-id="8128f-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="8128f-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="8128f-105">Con los métodos y los datos de un objeto Progress, puede controlar cómo el indicador informa del progreso.</span><span class="sxs-lookup"><span data-stu-id="8128f-105">With the methods and data of a progress object, you can control how the indicator reports progress.</span></span> <span data-ttu-id="8128f-106">Aunque un cliente o MAPI implementa el objeto Progress, la mayor parte de la carga de garantizar la corrección de la presentación del progreso recae en los proveedores de servicios.</span><span class="sxs-lookup"><span data-stu-id="8128f-106">Although a client or MAPI implements the progress object, most of the burden of ensuring the correctness of the progress display falls on service providers.</span></span> <span data-ttu-id="8128f-107">Puede garantizar su precisión especificando un orden y un valor determinados para los parámetros que se pasan a los métodos del objeto Progress.</span><span class="sxs-lookup"><span data-stu-id="8128f-107">You can guarantee its accuracy by specifying a particular order and value for the parameters that are passed to progress object methods.</span></span>
  
<span data-ttu-id="8128f-108">Los siguientes parámetros se pasan a objetos de progreso:</span><span class="sxs-lookup"><span data-stu-id="8128f-108">The following parameters are passed to progress objects:</span></span>
  
- <span data-ttu-id="8128f-109">Una máscara de máscara de indicadores, establecida con [método imapiprogress:: SetLimits](imapiprogress-setlimits.md) y recuperada con [método imapiprogress:: GetFlags](imapiprogress-getflags.md).</span><span class="sxs-lookup"><span data-stu-id="8128f-109">A bitmask of flags, set with [IMAPIProgress::SetLimits](imapiprogress-setlimits.md) and retrieved with [IMAPIProgress::GetFlags](imapiprogress-getflags.md).</span></span>
    
- <span data-ttu-id="8128f-110">Un valor mínimo (local y global), establecido con **SetLimits** y recuperado con [método imapiprogress:: GetMin](imapiprogress-getmin.md).</span><span class="sxs-lookup"><span data-stu-id="8128f-110">A minimum value (local and global), set with **SetLimits** and retrieved with [IMAPIProgress::GetMin](imapiprogress-getmin.md).</span></span>
    
- <span data-ttu-id="8128f-111">Un valor máximo (local y global), establecido con **SetLimits** y recuperado con [método imapiprogress:: GetMax](imapiprogress-getmax.md).</span><span class="sxs-lookup"><span data-stu-id="8128f-111">A maximum value (local and global), set with **SetLimits** and retrieved with [IMAPIProgress::GetMax](imapiprogress-getmax.md).</span></span>
    
- <span data-ttu-id="8128f-112">Un valor que indica el porcentaje actual de finalización de la operación pasado a [método imapiprogress::P rogress](imapiprogress-progress.md).</span><span class="sxs-lookup"><span data-stu-id="8128f-112">A value that indicates the current percentage of completion of the operation, passed to [IMAPIProgress::Progress](imapiprogress-progress.md).</span></span>
    
- <span data-ttu-id="8128f-113">Recuento del número de objetos que se han procesado hasta el momento y que se pasan al **progreso**.</span><span class="sxs-lookup"><span data-stu-id="8128f-113">A count of the number of objects that have so far been processed, passed to **Progress**.</span></span>
    
- <span data-ttu-id="8128f-114">Un recuento del número total de objetos involucrados en la operación, pasado al **progreso**.</span><span class="sxs-lookup"><span data-stu-id="8128f-114">A count of the total number of objects involved in the operation, passed to **Progress**.</span></span>
    
<span data-ttu-id="8128f-115">Todos los proveedores de servicios comienzan su procesamiento de presentación de progreso con una llamada a **método imapiprogress:: GetFlags** para recuperar la configuración actual de Flags.</span><span class="sxs-lookup"><span data-stu-id="8128f-115">All service providers begin their progress display processing with a call to **IMAPIProgress::GetFlags** to retrieve the present flags setting.</span></span> <span data-ttu-id="8128f-116">Actualmente, los marcadores solo se pueden establecer en MAPI_TOP_LEVEL.</span><span class="sxs-lookup"><span data-stu-id="8128f-116">Currently, the flags can be set only to MAPI_TOP_LEVEL.</span></span> <span data-ttu-id="8128f-117">Los clientes e MAPI inicializan la marca en MAPI_TOP_LEVEL, confiando en los proveedores de servicios para borrarlas cuando corresponda.</span><span class="sxs-lookup"><span data-stu-id="8128f-117">Clients and MAPI initialize the flag to MAPI_TOP_LEVEL, relying on service providers to clear it when appropriate.</span></span> 
  
<span data-ttu-id="8128f-118">El valor de flags se establece en MAPI_TOP_LEVEL mientras se trabaja con el objeto de nivel superior en la operación.</span><span class="sxs-lookup"><span data-stu-id="8128f-118">The flags value is set to MAPI_TOP_LEVEL while you are working with the top-level object in the operation.</span></span> <span data-ttu-id="8128f-119">El objeto de nivel superior es el objeto al que llama el cliente para comenzar una operación.</span><span class="sxs-lookup"><span data-stu-id="8128f-119">The top-level object is the object that is called by the client to begin an operation.</span></span> <span data-ttu-id="8128f-120">En una operación de copia de carpeta, esta es la carpeta que se va a copiar.</span><span class="sxs-lookup"><span data-stu-id="8128f-120">In a folder copy operation, this is the folder being copied.</span></span> <span data-ttu-id="8128f-121">En una operación de eliminación de carpeta, esta es la carpeta que se va a eliminar.</span><span class="sxs-lookup"><span data-stu-id="8128f-121">In a folder delete operation, this is the folder being deleted.</span></span> <span data-ttu-id="8128f-122">Cuando realice una llamada al proceso de un objeto o subobjeto de nivel inferior, borre el valor de marcas.</span><span class="sxs-lookup"><span data-stu-id="8128f-122">When you make a call to process a lower level object, or subobject, clear the flags value.</span></span> <span data-ttu-id="8128f-123">En una operación de copia de carpetas, los subobjetos son las subcarpetas que se encuentran en la carpeta que se está copiando.</span><span class="sxs-lookup"><span data-stu-id="8128f-123">In a folder copy operation, subobjects are the subfolders that are in the folder being copied.</span></span> 
  
<span data-ttu-id="8128f-124">MAPI permite diferenciar entre objetos de nivel superior y subobjetos con la marca MAPI_TOP_LEVEL de modo que todos los objetos que participan en una operación puedan usar la misma implementación de [método imapiprogress](imapiprogressiunknown.md) para mostrar el progreso, lo que provoca que el indicador muestre ir con suavidad en una sola dirección positiva.</span><span class="sxs-lookup"><span data-stu-id="8128f-124">MAPI allows you to differentiate between top-level objects and subobjects with the MAPI_TOP_LEVEL flag so that all objects involved in an operation can use the same [IMAPIProgress](imapiprogressiunknown.md) implementation to show progress, thereby causing the indicator display to proceed smoothly in a single positive direction.</span></span> <span data-ttu-id="8128f-125">El hecho de que se establezca o no la marca MAPI_TOP_LEVEL afecta a la configuración de los otros parámetros en llamadas posteriores al objeto Progress.</span><span class="sxs-lookup"><span data-stu-id="8128f-125">Whether or not the MAPI_TOP_LEVEL flag is set affects the settings of the other parameters in subsequent calls to the progress object.</span></span> 
  
<span data-ttu-id="8128f-126">Debido a que no es trivial establecer los valores de parámetro adecuados para una presentación de progreso en todos los niveles de una operación multinivel, algunos proveedores de servicios optan por no mostrar el progreso de los subobjetos.</span><span class="sxs-lookup"><span data-stu-id="8128f-126">Because it can be nontrivial to set appropriate parameter values for a progress display at all levels of a multilevel operation, some service providers elect not to show progress for subobjects.</span></span> 
  
 <span data-ttu-id="8128f-127">**Para evitar mostrar el progreso de los objetos subobjetos**</span><span class="sxs-lookup"><span data-stu-id="8128f-127">**To avoid showing progress for subobjects**</span></span>
  
- <span data-ttu-id="8128f-128">Pase NULL para el parámetro _lpProgress_ en la llamada al proceso de un subobjeto.</span><span class="sxs-lookup"><span data-stu-id="8128f-128">Pass NULL for the  _lpProgress_ parameter in the call to process a subobject.</span></span> <span data-ttu-id="8128f-129">Por ejemplo, si va a copiar carpetas, esta es la llamada al método [IMAPIFolder:: CopyFolder](imapifolder-copyfolder.md) de una subcarpeta.</span><span class="sxs-lookup"><span data-stu-id="8128f-129">For example, if you are copying folders, this is the call to a subfolder's [IMAPIFolder::CopyFolder](imapifolder-copyfolder.md) method.</span></span> 
    
- <span data-ttu-id="8128f-130">Escribir código especial para determinar cómo interpretar el parámetro _lpProgress_ .</span><span class="sxs-lookup"><span data-stu-id="8128f-130">Write special code to determine how to interpret the  _lpProgress_ parameter.</span></span> <span data-ttu-id="8128f-131">Como un valor NULL para el parámetro _lpProgress_ también puede significar que el cliente debe mostrar el progreso mediante la implementación de MAPI, el código especial es necesario para determinar cuándo omitir el parámetro _lpProgress_ y cuándo llamar [a IMAPISupport::D oProgressDialog](imapisupport-doprogressdialog.md).</span><span class="sxs-lookup"><span data-stu-id="8128f-131">Because a NULL value for the  _lpProgress_ parameter can also mean that the client should display progress by using the MAPI implementation, special code is necessary to determine when to ignore the  _lpProgress_ parameter and when to call [IMAPISupport::DoProgressDialog](imapisupport-doprogressdialog.md).</span></span>
    
<span data-ttu-id="8128f-132">Llamar a **método imapiprogress:: SetLimits** para establecer o borrar la marca MAPI_TOP_LEVEL y establecer los valores mínimos y máximos locales y globales.</span><span class="sxs-lookup"><span data-stu-id="8128f-132">Call **IMAPIProgress::SetLimits** to set or clear the MAPI_TOP_LEVEL flag and to set local and global minimum and maximum values.</span></span> <span data-ttu-id="8128f-133">El valor de la configuración Flags determina si el objeto Progress entiende los valores mínimos y máximos locales o globales.</span><span class="sxs-lookup"><span data-stu-id="8128f-133">The value of the flags setting affects whether the progress object understands the minimum and maximum values to be local or global.</span></span> <span data-ttu-id="8128f-134">Cuando se establece la marca MAPI_TOP_LEVEL, estos valores se consideran globales y se usan para calcular el progreso de toda la operación.</span><span class="sxs-lookup"><span data-stu-id="8128f-134">When the MAPI_TOP_LEVEL flag is set, these values are considered global and are used to calculate progress for the entire operation.</span></span> <span data-ttu-id="8128f-135">Los objetos de progreso inicializan el valor mínimo global en 0 y el valor máximo global en 1000.</span><span class="sxs-lookup"><span data-stu-id="8128f-135">Progress objects initialize the global minimum value to 0 and the global maximum value to 1000.</span></span> 
  
<span data-ttu-id="8128f-136">Cuando MAPI_TOP_LEVEL no se establece, los valores mínimos y máximos se consideran locales y los proveedores los usan internamente para mostrar el progreso de los subobjetos de nivel inferior.</span><span class="sxs-lookup"><span data-stu-id="8128f-136">When MAPI_TOP_LEVEL is not set, the minimum and maximum values are considered local and are used internally by providers to display progress for lower level subobjects.</span></span> <span data-ttu-id="8128f-137">Los objetos de progreso guardan los valores mínimos y máximos locales solo para que se puedan devolver a los proveedores cuando se llama a **GetMin** y **GetMax** .</span><span class="sxs-lookup"><span data-stu-id="8128f-137">Progress objects save the local minimum and maximum values only so that they can be returned to providers when **GetMin** and **GetMax** are called.</span></span> 
  
<span data-ttu-id="8128f-138">El valor, el recuento de objetos y los parámetros de totales de objeto se introducen en el método **método imapiprogress::P rogress** .</span><span class="sxs-lookup"><span data-stu-id="8128f-138">The value, object count, and object total parameters are input to the **IMAPIProgress::Progress** method.</span></span> <span data-ttu-id="8128f-139">El parámetro value, un número que indica el porcentaje de progreso, es obligatorio.</span><span class="sxs-lookup"><span data-stu-id="8128f-139">The value parameter, a number that indicates the percentage of progress, is required.</span></span> <span data-ttu-id="8128f-140">Si se establece la marca MAPI_TOP_LEVEL, también puede pasar un recuento de objetos y un total de objetos.</span><span class="sxs-lookup"><span data-stu-id="8128f-140">If the MAPI_TOP_LEVEL flag is set, you can also pass an object count and an object total.</span></span> <span data-ttu-id="8128f-141">Algunos clientes usan estos valores para mostrar una frase como "5 elementos completados de 10" con el indicador de progreso.</span><span class="sxs-lookup"><span data-stu-id="8128f-141">Some clients use these values to display a phrase such as "5 items completed out of 10" with the progress indicator.</span></span> <span data-ttu-id="8128f-142">El progreso en una operación se puede notificar estrictamente como un porcentaje o como un porcentaje y en términos del número de elementos que se han procesado fuera del total que se va a procesar.</span><span class="sxs-lookup"><span data-stu-id="8128f-142">Progress on an operation can be reported strictly as a percentage or as a percentage and in terms of the number of items that have been processed out of the total to be processed.</span></span> <span data-ttu-id="8128f-143">Por ejemplo, si es un proveedor de almacenamiento de mensajes y va a realizar una operación de copia que copia 10 carpetas, el indicador de progreso puede proporcionar al usuario información adicional mostrando una frase como "1 de 10", "2 de 10", "3 de 10" y así sucesivamente hasta que se complete la operación.</span><span class="sxs-lookup"><span data-stu-id="8128f-143">For example, if you are a message store provider and you are performing a copy operation that is copying 10 folders, the progress indicator can supply the user with additional information by displaying a phrase such as "1 of 10", "2 of 10", "3 of 10", and so on until the operation is complete.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="8128f-144">Ver también</span><span class="sxs-lookup"><span data-stu-id="8128f-144">See also</span></span>



[<span data-ttu-id="8128f-145">Indicadores de progreso de MAPI</span><span class="sxs-lookup"><span data-stu-id="8128f-145">MAPI Progress Indicators</span></span>](mapi-progress-indicators.md)

