---
title: Escribir un visor remoto
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f4d7d42f-688a-4199-b972-dd42528c0cdf
description: 'Última modificación: 09 de marzo de 2015'
ms.openlocfilehash: 1d7fea7f92a315b9671d17c82a82d5d7d180f4bb
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/23/2019
ms.locfileid: "32325665"
---
# <a name="writing-a-remote-viewer"></a><span data-ttu-id="9ced2-103">Escribir un visor remoto</span><span class="sxs-lookup"><span data-stu-id="9ced2-103">Writing a remote viewer</span></span>

<span data-ttu-id="9ced2-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="9ced2-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="9ced2-105">Un visor remoto es una ventana de una aplicación cliente que proporciona acceso controlado a los mensajes almacenados en otro equipo.</span><span class="sxs-lookup"><span data-stu-id="9ced2-105">A remote viewer is a window in a client application that provides controlled access to messages stored on another computer.</span></span> <span data-ttu-id="9ced2-106">Este acceso controlado puede funcionar en un vínculo de comunicaciones lentas.</span><span class="sxs-lookup"><span data-stu-id="9ced2-106">This controlled access might operate on a slow communications link.</span></span> <span data-ttu-id="9ced2-107">En lugar de recuperar una selección completa de los mensajes disponibles cada vez que un usuario abre una carpeta, el visor remoto muestra primero sólo los encabezados.</span><span class="sxs-lookup"><span data-stu-id="9ced2-107">Rather than retrieve a complete selection of available messages every time a user opens a folder, the remote viewer first displays only the headers.</span></span> <span data-ttu-id="9ced2-108">A continuación, el usuario selecciona de los encabezados los mensajes para mostrar en su totalidad.</span><span class="sxs-lookup"><span data-stu-id="9ced2-108">The user then selects from the headers which of the messages to display in full.</span></span> <span data-ttu-id="9ced2-109">Los clientes del visor remoto pueden permitir que los usuarios eliminen mensajes antes de que se descarguen.</span><span class="sxs-lookup"><span data-stu-id="9ced2-109">Remote viewer clients can allow their users to delete messages before they are ever downloaded.</span></span> 
  
## <a name="to-retrieve-the-headers-of-messages-stored-remotely"></a><span data-ttu-id="9ced2-110">Para recuperar los encabezados de los mensajes almacenados de forma remota</span><span class="sxs-lookup"><span data-stu-id="9ced2-110">To retrieve the headers of messages stored remotely</span></span>
  
1. <span data-ttu-id="9ced2-111">Llame a [IMAPISession:: GetStatusTable](imapisession-getstatustable.md) para obtener acceso a la tabla de estado.</span><span class="sxs-lookup"><span data-stu-id="9ced2-111">Call [IMAPISession::GetStatusTable](imapisession-getstatustable.md) to access the status table.</span></span> 
    
2. <span data-ttu-id="9ced2-112">Llame [al IMAPITable:: Restrict](imapitable-restrict.md) para limitar la tabla de estado a solo aquellas filas que tienen la columna **tipo de\_recurso\_RP** ([PidTagResourceType](pidtagresourcetype-canonical-property.md))\_establecida\_en el proveedor de transporte MAPI.</span><span class="sxs-lookup"><span data-stu-id="9ced2-112">Call [IMAPITable::Restrict](imapitable-restrict.md) to limit the status table to only those rows that have their **PR\_RESOURCE\_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md)) column set to MAPI\_TRANSPORT\_PROVIDER.</span></span> 
    
3. <span data-ttu-id="9ced2-113">Llame al [IMAPITable:: SetColumns](imapitable-setcolumns.md) para incluir las siguientes columnas en la tabla de estado:</span><span class="sxs-lookup"><span data-stu-id="9ced2-113">Call [IMAPITable::SetColumns](imapitable-setcolumns.md) to include the following columns in the status table:</span></span> 
   - <span data-ttu-id="9ced2-114">**EntryID\_de PR** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-114">**PR\_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span></span>
   - <span data-ttu-id="9ced2-115">**Métodos\_de\_recursos de PR** ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-115">**PR\_RESOURCE\_METHODS** ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md))</span></span>
   - <span data-ttu-id="9ced2-116">**Tipo\_de\_recurso PR**, **presentación del\_\_proveedor de PR** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-116">**PR\_RESOURCE\_TYPE**, **PR\_PROVIDER\_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md))</span></span>
   - <span data-ttu-id="9ced2-117">**Código\_de\_estado de PR** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="9ced2-117">**PR\_STATUS\_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md)).</span></span>
    
4. <span data-ttu-id="9ced2-118">Llame a [HrQueryAllRows](hrqueryallrows.md) para recuperar todas las filas de la tabla de estado.</span><span class="sxs-lookup"><span data-stu-id="9ced2-118">Call [HrQueryAllRows](hrqueryallrows.md) to retrieve all the rows in the status table.</span></span> 
    
5. <span data-ttu-id="9ced2-119">Pase el identificador de entrada para cada fila de la tabla en una llamada a [IMAPISession:: OpenEntry](imapisession-openentry.md).</span><span class="sxs-lookup"><span data-stu-id="9ced2-119">Pass the entry identifier for each row in the table in a call to [IMAPISession::OpenEntry](imapisession-openentry.md).</span></span> <span data-ttu-id="9ced2-120">Debido a que se calculan las referencias de esta interfaz desde el contexto del proceso del administrador de trabajos de la cola MAPI hasta el contexto del proceso del cliente (a diferencia de las interfaces que normalmente se obtienen de la libreta de direcciones o los proveedores de almacenamiento de mensajes), los problemas relacionados con el subprocesamiento</span><span class="sxs-lookup"><span data-stu-id="9ced2-120">Because this interface is marshaled from the MAPI spooler's process context to the client's process context — unlike interfaces typically obtained from address book or message store providers — issues concerning multithreading are of more importance.</span></span> 
    
6. <span data-ttu-id="9ced2-121">Llame al método [IUnknown:: QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d.aspx) del objeto status, pasando IID_IMAPIFolder como identificador de interfaz, para recuperar la carpeta remota.</span><span class="sxs-lookup"><span data-stu-id="9ced2-121">Call the status object's [IUnknown::QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d.aspx) method, passing IID_IMAPIFolder as the interface identifier, to retrieve the remote folder.</span></span> <span data-ttu-id="9ced2-122">La carpeta remota no es una implementación completa de la carpeta; admite sólo un subconjunto de propiedades y métodos de carpeta.</span><span class="sxs-lookup"><span data-stu-id="9ced2-122">The remote folder is not a complete folder implementation; it supports only a subset of folder methods and properties.</span></span> <span data-ttu-id="9ced2-123">Uno de los métodos obligatorios, [IMAPIProp:: GetProps](imapiprop-getprops.md), admite la recuperación de las siguientes propiedades:</span><span class="sxs-lookup"><span data-stu-id="9ced2-123">One of the required methods, [IMAPIProp::GetProps](imapiprop-getprops.md), supports the retrieval of the following properties:</span></span>
    
    |||
    |:-----|:-----|
    |<span data-ttu-id="9ced2-124">**Acceso\_de PR** ([PidTagAccess](pidtagaccess-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-124">**PR\_ACCESS** ([PidTagAccess](pidtagaccess-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="9ced2-125">**PR_ACCESS_LEVEL** ([PidTagAccessLevel](pidtagaccesslevel-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-125">**PR_ACCESS_LEVEL** ([PidTagAccessLevel](pidtagaccesslevel-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="9ced2-126">**PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-126">**PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="9ced2-127">**PR_ASSOC_CONTENT_COUNT** ([PidTagAssociatedContentCount](pidtagassociatedcontentcount-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-127">**PR_ASSOC_CONTENT_COUNT** ([PidTagAssociatedContentCount](pidtagassociatedcontentcount-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="9ced2-128">**PR_FOLDER_TYPE** ([PidTagFolderType](pidtagfoldertype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-128">**PR_FOLDER_TYPE** ([PidTagFolderType](pidtagfoldertype-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="9ced2-129">**PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-129">**PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="9ced2-130">**SubCARPETAs PR\_** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-130">**PR\_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="9ced2-131">**PR_CREATION_TIME** ([PidTagCreationTime](pidtagcreationtime-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-131">**PR_CREATION_TIME** ([PidTagCreationTime](pidtagcreationtime-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="9ced2-132">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-132">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="9ced2-133">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-133">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span></span>  <br/> |
    
    <span data-ttu-id="9ced2-134">Las carpetas remotas también deben admitir los métodos [IMAPIProp:: GetPropList](imapiprop-getproplist.md), [IMAPIContainer:: GetContentsTable](imapicontainer-getcontentstable.md)y [IMAPIFolder:: SetMessageStatus](imapifolder-setmessagestatus.md) .</span><span class="sxs-lookup"><span data-stu-id="9ced2-134">Remote folders must also support the [IMAPIProp::GetPropList](imapiprop-getproplist.md), [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md), and [IMAPIFolder::SetMessageStatus](imapifolder-setmessagestatus.md) methods.</span></span> <span data-ttu-id="9ced2-135">Las tablas de contenido de carpetas remotas suelen ser compatibles con las siguientes columnas:</span><span class="sxs-lookup"><span data-stu-id="9ced2-135">Remote folder contents tables typically support the following columns:</span></span> 
        
    |||
    |:-----|:-----|
    |<span data-ttu-id="9ced2-136">**\_Mostrar\_PR a** ([PidTagDisplayTo](pidtagdisplayto-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-136">**PR\_DISPLAY\_TO** ([PidTagDisplayTo](pidtagdisplayto-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="9ced2-137">**EntryID\_de PR**</span><span class="sxs-lookup"><span data-stu-id="9ced2-137">**PR\_ENTRYID**</span></span> <br/> |
    |<span data-ttu-id="9ced2-138">**PR\_HASATTACH** ([PidTagHasAttachments](pidtaghasattachments-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-138">**PR\_HASATTACH** ([PidTagHasAttachments](pidtaghasattachments-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="9ced2-139">**PR_IMPORTANCE** ([PidTagImportance](pidtagimportance-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-139">**PR_IMPORTANCE** ([PidTagImportance](pidtagimportance-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="9ced2-140">**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-140">**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="9ced2-141">**PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-141">**PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="9ced2-142">**PR\_MESSAGE_DELIVERY_TIME** ([PidTagMessageDeliveryTime](pidtagmessagedeliverytime-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-142">**PR\_MESSAGE_DELIVERY_TIME** ([PidTagMessageDeliveryTime](pidtagmessagedeliverytime-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="9ced2-143">**PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-143">**PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="9ced2-144">**PR\_MESSAGE_DOWNLOAD_TIME** ([PidTagMessageDownloadTime](pidtagmessagedownloadtime-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-144">**PR\_MESSAGE_DOWNLOAD_TIME** ([PidTagMessageDownloadTime](pidtagmessagedownloadtime-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="9ced2-145">**PR_MESSAGE_SIZE** ([PidTagMessageSize](pidtagmessagesize-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-145">**PR_MESSAGE_SIZE** ([PidTagMessageSize](pidtagmessagesize-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="9ced2-146">**PR_MSG_STATUS** ([PidTagMessageStatus](pidtagmessagestatus-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-146">**PR_MSG_STATUS** ([PidTagMessageStatus](pidtagmessagestatus-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="9ced2-147">**PR_OBJECT_TYPE**</span><span class="sxs-lookup"><span data-stu-id="9ced2-147">**PR_OBJECT_TYPE**</span></span> <br/> |
    |<span data-ttu-id="9ced2-148">**PR_NORMALIZED_SUBJECT** ([PidTagNormalizedSubject](pidtagnormalizedsubject-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-148">**PR_NORMALIZED_SUBJECT** ([PidTagNormalizedSubject](pidtagnormalizedsubject-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="9ced2-149">**PR_PRIORITY** ([PidTagPriority](pidtagpriority-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-149">**PR_PRIORITY** ([PidTagPriority](pidtagpriority-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="9ced2-150">**PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-150">**PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="9ced2-151">**PR_SENSITIVITY** ([PidTagSensitivity](pidtagsensitivity-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-151">**PR_SENSITIVITY** ([PidTagSensitivity](pidtagsensitivity-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="9ced2-152">**PR\_SENT_REPRESENTING_NAME** ([PidTagSentRepresentingName](pidtagsentrepresentingname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-152">**PR\_SENT_REPRESENTING_NAME** ([PidTagSentRepresentingName](pidtagsentrepresentingname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="9ced2-153">**PR_SUBJECT** ([PidTagSubject](pidtagsubject-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="9ced2-153">**PR_SUBJECT** ([PidTagSubject](pidtagsubject-canonical-property.md))</span></span>  <br/> |
   
7. <span data-ttu-id="9ced2-154">Llame al método [IMAPIStatus:: ValidateState](imapistatus-validatestate.md) del proveedor de transporte la primera vez que se selecciona una de las opciones de transferencia.</span><span class="sxs-lookup"><span data-stu-id="9ced2-154">Call the transport provider's [IMAPIStatus::ValidateState](imapistatus-validatestate.md) method the first time that one of the transfer options is picked.</span></span> <span data-ttu-id="9ced2-155">Se debe establecer la marca de proceso REFRESH_XP_HEADER_CACHE o PROCESS_XP_HEADER_CACHE, así como la marca SHOW_XP_SSESSION_UI para permitir que se muestre la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="9ced2-155">Either the REFRESH_XP_HEADER_CACHE or PROCESS_XP_HEADER_CACHE process flag should be set as well as the SHOW_XP_SSESSION_UI flag to allow the user interface to be shown.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="9ced2-156">Para marcar un encabezado de mensaje determinado para la descarga o la eliminación, un cliente llama a [IMAPIFolder:: SetMessageStatus](imapifolder-setmessagestatus.md) y establece la marca MSGSTATUS_REMOTE_DOWNLOAD o MSGSTATUS_REMOTE_DELETE.</span><span class="sxs-lookup"><span data-stu-id="9ced2-156">To mark a particular message header for downloading or deletion, a client calls [IMAPIFolder::SetMessageStatus](imapifolder-setmessagestatus.md) and sets either the MSGSTATUS_REMOTE_DOWNLOAD or MSGSTATUS_REMOTE_DELETE flag.</span></span> 
  

