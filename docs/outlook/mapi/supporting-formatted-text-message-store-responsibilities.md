---
title: Compatibilidad con responsabilidades del almacén de mensajes de texto con formato
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a97993c2-52e4-4b71-ac03-2c02d82447d8
description: 'Última modificación: 09 de marzo de 2015'
ms.openlocfilehash: 502ba82279664638c8e7e4ae68f74df74758918d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33435519"
---
# <a name="supporting-formatted-text-message-store-responsibilities"></a><span data-ttu-id="e3e91-103">Compatibilidad con texto con formato: responsabilidades del almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="e3e91-103">Supporting Formatted Text: Message Store Responsibilities</span></span>

  
  
<span data-ttu-id="e3e91-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="e3e91-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="e3e91-105">Los proveedores de almacenamiento de mensajes usan la propiedad **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) para publicar si pueden o no controlar el formato de texto enriquecido (RTF), el texto HTML y, si son compatibles con RTF, si almacenan el texto con formato en un formato comprimido o sin comprimir.</span><span class="sxs-lookup"><span data-stu-id="e3e91-105">Message store providers use the **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property to publish whether or not they can handle Rich Text Format (RTF), HTML text and, if they are RTF-aware, whether they store the formatted text in a compressed or uncompressed format.</span></span> <span data-ttu-id="e3e91-106">Los proveedores de almacenamiento de mensajes indican que son rtf al establecer el bit STORE_RTF_OK y que almacenan el texto con formato en un formulario sin comprimir estableciendo el STORE_UNCOMPRESSED_RTF bits.</span><span class="sxs-lookup"><span data-stu-id="e3e91-106">Message store providers indicate that they are RTF-aware by setting the STORE_RTF_OK bit and that they store the formatted text in an uncompressed form by setting the STORE_UNCOMPRESSED_RTF bit.</span></span> <span data-ttu-id="e3e91-107">Los proveedores de al almacenamiento de mensajes indican que son conscientes de HTML mediante la configuración del STORE_HTML_OK bits.</span><span class="sxs-lookup"><span data-stu-id="e3e91-107">Message store providers indicate they are HTML-aware by setting the STORE_HTML_OK bit.</span></span>
  
<span data-ttu-id="e3e91-108">Aunque es importante que un cliente compatible con RTF compruebe el bit STORE_RTF_OK para determinar si un almacén de mensajes admite RTF, no es necesario que un cliente se preocupa por el formato del texto con formato de un almacén compatible con RTF.</span><span class="sxs-lookup"><span data-stu-id="e3e91-108">While it is important for an RTF-aware client to check for the STORE_RTF_OK bit to determine whether or not a message store supports RTF, it is not necessary for a client to be concerned with the format of an RTF-aware store's formatted text.</span></span> 
  
<span data-ttu-id="e3e91-109">Todos los almacenes de mensajes deben admitir clientes no compatibles con RTF.</span><span class="sxs-lookup"><span data-stu-id="e3e91-109">All message stores must support non-RTF-aware clients.</span></span> <span data-ttu-id="e3e91-110">Un almacén de mensajes no compatible con RTF debe eliminar la propiedad **PR_RTF_IN_SYNC** ([PidTagRtfInSync](pidtagrtfinsync-canonical-property.md)) durante una llamada al método [IMAPIProp::SaveChanges](imapiprop-savechanges.md) del mensaje si un cliente ha cambiado **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) sin actualizar **PR_RTF_IN_SYNC** o **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="e3e91-110">A non-RTF-aware message store must delete the **PR_RTF_IN_SYNC** ([PidTagRtfInSync](pidtagrtfinsync-canonical-property.md)) property during a call to the message's [IMAPIProp::SaveChanges](imapiprop-savechanges.md) method if a client has changed **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) without updating either **PR_RTF_IN_SYNC** or **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)).</span></span> <span data-ttu-id="e3e91-111">Al eliminar **PR_RTF_IN_SYNC** hace que **la** propiedad PR_RTF_COMPRESSED se vuelva **a** compilar desde la propiedad PR_BODY la próxima vez que un cliente compatible con RTF llame [a RTFSync](rtfsync.md).</span><span class="sxs-lookup"><span data-stu-id="e3e91-111">Deleting **PR_RTF_IN_SYNC** causes the **PR_RTF_COMPRESSED** property to be recomputed from the **PR_BODY** property the next time an RTF-aware client calls [RTFSync](rtfsync.md).</span></span> 
  
<span data-ttu-id="e3e91-112">La mayoría de los almacenes de mensajes con rtf no reciben el texto del mensaje por parte de los clientes; debe calcularse a petición.</span><span class="sxs-lookup"><span data-stu-id="e3e91-112">Most RTF-aware message stores are not given the message text by clients; it must be computed on request.</span></span> <span data-ttu-id="e3e91-113">Dado que este cálculo requiere mucho tiempo y es costoso, los clientes deben **usar PR_RTF_COMPRESSED** siempre que sea posible.</span><span class="sxs-lookup"><span data-stu-id="e3e91-113">Because this computation is time consuming and expensive, clients should use **PR_RTF_COMPRESSED** whenever possible.</span></span> <span data-ttu-id="e3e91-114">Para calcular la **PR_BODY,** el proveedor del almacén de mensajes debe descomprimir el contenido de la propiedad **PR_RTF_COMPRESSED** y quitar el formato de texto enriquecido.</span><span class="sxs-lookup"><span data-stu-id="e3e91-114">To compute the **PR_BODY** property, the message store provider must uncompress the contents of the **PR_RTF_COMPRESSED** property and remove the rich text formatting.</span></span> <span data-ttu-id="e3e91-115">Los clientes que no admiten **PR_RTF_COMPRESSED** propiedad requieren que este cálculo se realice para cada mensaje.</span><span class="sxs-lookup"><span data-stu-id="e3e91-115">Clients that do not support the **PR_RTF_COMPRESSED** property require this computation to take place for every message.</span></span> 
  
<span data-ttu-id="e3e91-116">Al copiar mensajes, los proveedores de almacenamiento de mensajes que no usan los métodos **IMAPISupport::D oCopyProps** o **IMAPISupport::D oCopyTo** ejecutan el riesgo de crear un mensaje sin contenido si su implementación excluye la propiedad **PR_BODY** y se basa en **PR_RTF_COMPRESSED**.</span><span class="sxs-lookup"><span data-stu-id="e3e91-116">When copying messages, message store providers that do not use the **IMAPISupport::DoCopyProps** or **IMAPISupport::DoCopyTo** methods run the risk of creating a message with no content if their implementation excludes the **PR_BODY** property and relies on **PR_RTF_COMPRESSED**.</span></span> <span data-ttu-id="e3e91-117">Es posible que los datos de la propiedad **PR_RTF_COMPRESSED** esté dañados.</span><span class="sxs-lookup"><span data-stu-id="e3e91-117">It is possible for the data in the **PR_RTF_COMPRESSED** property to be corrupt.</span></span> <span data-ttu-id="e3e91-118">Antes de excluir cualquiera de estas propiedades de contenido de mensajes en la operación de copia, compruebe si hay daños de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="e3e91-118">Before excluding either of these message content properties in the copy operation, check for corruption as follows:</span></span> 
  
1. <span data-ttu-id="e3e91-119">Si el valor de **PR_RTF_COMPRESSED** no es mayor que el RTF comprimido, la propiedad está dañada.</span><span class="sxs-lookup"><span data-stu-id="e3e91-119">If the value of **PR_RTF_COMPRESSED** is not larger than the compressed RTF, the property is corrupt.</span></span> 
    
2. <span data-ttu-id="e3e91-120">Si el valor mágico del encabezado RTF no es  _dwMagicCompressedRTF_ o  _dwMagicUncompressedRTF_, la propiedad está dañada.</span><span class="sxs-lookup"><span data-stu-id="e3e91-120">If the magic value in the RTF header is not  _dwMagicCompressedRTF_ or  _dwMagicUncompressedRTF_, the property is corrupt.</span></span>
    
<span data-ttu-id="e3e91-121">Los proveedores de al almacenamiento de mensajes que usan los métodos de soporte técnico no tienen que preocuparse por implementar una comprobación de PR_RTF_COMPRESSED **daños;** MAPI garantiza que las propiedades adecuadas existan y sean válidas.</span><span class="sxs-lookup"><span data-stu-id="e3e91-121">Message store providers using the support methods need not be concerned with implementing a check for **PR_RTF_COMPRESSED** corruption; MAPI ensures that the appropriate properties exist and are valid.</span></span> 
  
<span data-ttu-id="e3e91-122">Existen tres niveles diferentes de compatibilidad rtf que los proveedores de al almacenamiento de mensajes pueden implementar; MAPI recomienda que los proveedores de almacenamiento de mensajes compatibles con RTF implementen su compatibilidad en el nivel medio o superior.</span><span class="sxs-lookup"><span data-stu-id="e3e91-122">There are three different levels of RTF support that message store providers can implement; MAPI recommends that RTF-aware message store providers implement their support at the middle or highest level.</span></span> <span data-ttu-id="e3e91-123">Todos los proveedores de almacenamiento de  mensajes rtf-aware se encargan de generar PR_BODY a partir de los datos incluidos en **PR_RTF_COMPRESSED** en los mensajes salientes y realizar una llamada a **RTFSync** para sincronizar el texto y el formato de los mensajes entrantes.</span><span class="sxs-lookup"><span data-stu-id="e3e91-123">All RTF-aware message store providers take care of generating **PR_BODY** from the data included in **PR_RTF_COMPRESSED** on outgoing messages and make a call to **RTFSync** to synchronize text and formatting on incoming messages.</span></span> 
  
<span data-ttu-id="e3e91-124">Las diferencias entre estos tres niveles se describen en la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="e3e91-124">The differences between these three levels are described in the following table.</span></span> 
  
|<span data-ttu-id="e3e91-125">**Nivel de soporte**</span><span class="sxs-lookup"><span data-stu-id="e3e91-125">**Level of support**</span></span>|<span data-ttu-id="e3e91-126">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="e3e91-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="e3e91-127">Bajo</span><span class="sxs-lookup"><span data-stu-id="e3e91-127">Low</span></span>  <br/> |<span data-ttu-id="e3e91-128">El proveedor del almacén de mensajes llama a **RTFSync** siempre que se guardan los cambios en un mensaje y extrae los datos de la propiedad **PR_BODY** de **PR_RTF_COMPRESSED en** lugar de requerir que los clientes lo establezcan.</span><span class="sxs-lookup"><span data-stu-id="e3e91-128">Message store provider calls **RTFSync** whenever changes are saved to a message and extracts the data for the **PR_BODY** property from **PR_RTF_COMPRESSED** rather than requiring clients to set it.</span></span> <span data-ttu-id="e3e91-129">Tanto **PR_BODY** como **PR_RTF_COMPRESSED** se almacenan.</span><span class="sxs-lookup"><span data-stu-id="e3e91-129">Both **PR_BODY** and **PR_RTF_COMPRESSED** are stored.</span></span>  <br/> |
|<span data-ttu-id="e3e91-130">Middle</span><span class="sxs-lookup"><span data-stu-id="e3e91-130">Middle</span></span>  <br/> |<span data-ttu-id="e3e91-131">El proveedor del almacén de mensajes almacena **PR_RTF_COMPRESSED** propiedad, PR_BODY **cuando** sea necesario.</span><span class="sxs-lookup"><span data-stu-id="e3e91-131">Message store provider stores only the **PR_RTF_COMPRESSED** property, computing **PR_BODY** when necessary.</span></span>  <br/> |
|<span data-ttu-id="e3e91-132">Alto</span><span class="sxs-lookup"><span data-stu-id="e3e91-132">High</span></span>  <br/> |<span data-ttu-id="e3e91-133">El proveedor de almacenamiento de mensajes **no almacena PR_BODY** ni las propiedades RTF auxiliares.</span><span class="sxs-lookup"><span data-stu-id="e3e91-133">Message store provider stores neither **PR_BODY** or the auxiliary RTF properties.</span></span> <span data-ttu-id="e3e91-134">Se llama a **RTFSync** cuando el texto del mensaje ha cambiado y el formato no cambia o cuando un proveedor de transporte descarga un nuevo mensaje.</span><span class="sxs-lookup"><span data-stu-id="e3e91-134">**RTFSync** is called when the message text has changed and the formatting remains unchanged or when a new message is downloaded by a transport provider.</span></span>  <br/> |
   

