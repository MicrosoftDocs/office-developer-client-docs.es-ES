---
title: Iniciar sesión en MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 05bafe43-a78a-4659-92f0-0b4fe444c64f
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: 63f71066b1afc90c3e495ed4f9ba654bcbdfe558
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/23/2018
ms.locfileid: "22579931"
---
# <a name="logging-on-to-mapi"></a><span data-ttu-id="cccb0-103">Iniciar sesión en MAPI</span><span class="sxs-lookup"><span data-stu-id="cccb0-103">Logging on to MAPI</span></span>
 
<span data-ttu-id="cccb0-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="cccb0-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="cccb0-105">Las aplicaciones cliente inicie sesión en el subsistema MAPI mediante una llamada a la función **MAPILogonEx** .</span><span class="sxs-lookup"><span data-stu-id="cccb0-105">Client applications log on to the MAPI subsystem by calling the **MAPILogonEx** function.</span></span> <span data-ttu-id="cccb0-106">Para obtener más información, vea [MAPILogonEx](mapilogonex.md).</span><span class="sxs-lookup"><span data-stu-id="cccb0-106">For more information, see [MAPILogonEx](mapilogonex.md).</span></span> <span data-ttu-id="cccb0-107">**MAPILogonEx** valida la selección de perfiles y la configuración de cada proveedor de servicios en el perfil.</span><span class="sxs-lookup"><span data-stu-id="cccb0-107">**MAPILogonEx** validates the profile selection and the configuration of each service provider in the profile.</span></span> <span data-ttu-id="cccb0-108">Una vez configurado, MAPI inicia los proveedores de la libreta de direcciones antes de iniciar los proveedores de almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="cccb0-108">Once configured, MAPI starts the address book providers before starting the message store providers.</span></span> <span data-ttu-id="cccb0-109">Los proveedores de transporte se han iniciado cuando primero se requieren sus servicios.</span><span class="sxs-lookup"><span data-stu-id="cccb0-109">Transport providers are started when their services are first required.</span></span> 
  
## <a name="choose-a-profile"></a><span data-ttu-id="cccb0-110">Elija un perfil</span><span class="sxs-lookup"><span data-stu-id="cccb0-110">Choose a profile</span></span>
  
- <span data-ttu-id="cccb0-111">Pase una cadena de caracteres que representa el nombre del perfil en el parámetro _lpszProfileName_ a **MAPILogonEx**, o...</span><span class="sxs-lookup"><span data-stu-id="cccb0-111">Pass in a character string that represents the name of the profile in the  _lpszProfileName_ parameter to **MAPILogonEx**, or...</span></span>
    
- <span data-ttu-id="cccb0-112">Permitir que el usuario especificar el perfil pasando NULL en el parámetro _lpszProfileName_ y estableciendo el indicador MAPI_LOGON_UI, o...</span><span class="sxs-lookup"><span data-stu-id="cccb0-112">Allow the user to specify the profile by passing NULL in the  _lpszProfileName_ parameter and setting the MAPI_LOGON_UI flag, or...</span></span> 

- <span data-ttu-id="cccb0-113">Seleccione el perfil predeterminado pasando NULL en el parámetro _lpszProfileName_ y establecer el indicador MAPI_USE_DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="cccb0-113">Select the default profile by passing NULL in the  _lpszProfileName_ parameter and setting the MAPI_USE_DEFAULT flag.</span></span> 
    
<span data-ttu-id="cccb0-114">Si necesita un perfil específico que no sea el perfil predeterminado, debe guardar su nombre en su propia base de datos de configuración o utilizar una convención de nomenclatura específica.</span><span class="sxs-lookup"><span data-stu-id="cccb0-114">If you require a specific profile other than the default profile, you must save its name in your own configuration database or use a specific naming convention.</span></span> <span data-ttu-id="cccb0-115">MAPI no expone los atributos de perfil que no sean de la marca de nombre y un valor predeterminado en la tabla de perfil y el indicador de perfil predeterminado está reservado para la mensajería de cliente y las aplicaciones de IPM relacionadas.</span><span class="sxs-lookup"><span data-stu-id="cccb0-115">MAPI does not expose any profile attributes other than the name and default flag in the profile table, and the default profile flag is reserved for messaging client and related IPM applications.</span></span>
  
<span data-ttu-id="cccb0-116">Los clientes que proporcionan perfil parcial o información de configuración de proveedor a **MAPILogonEx** deben preguntar al usuario para los datos adicionales al permitir que se muestre un cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="cccb0-116">Clients that supply partial profile or provider configuration information to **MAPILogonEx** must prompt the user for the additional data by allowing a dialog box to be displayed.</span></span> <span data-ttu-id="cccb0-117">Si falta información y **MAPILogonEx** no se puede pedir al usuario que proporcionarla, se produce un error en el inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="cccb0-117">If information is missing and **MAPILogonEx** cannot prompt the user to supply it, the logon fails.</span></span> <span data-ttu-id="cccb0-118">Los clientes que realizan la entrada del usuario necesidad no pueden suprimir la visualización de cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="cccb0-118">Clients that do not need user input can suppress the dialog box display.</span></span> 
  
<span data-ttu-id="cccb0-119">Los indicadores que **MAPILogonEx** se usa para habilitar una interfaz de usuario son mutuamente excluyentes; se puede establecer sólo uno.</span><span class="sxs-lookup"><span data-stu-id="cccb0-119">The flags that **MAPILogonEx** uses to enable a user interface are mutually exclusive; only one can be set.</span></span> <span data-ttu-id="cccb0-120">Salir sin establecer estos marcadores, suprime la visualización de una interfaz de usuario, lo que provoca que **MAPILogonEx** provocarán un error si falta información necesaria.</span><span class="sxs-lookup"><span data-stu-id="cccb0-120">Leaving these flags unset suppresses the display of a user interface, causing **MAPILogonEx** to fail if necessary information is missing.</span></span> <span data-ttu-id="cccb0-121">Es decir, si deshabilita la interfaz de usuario y pase NULL para el parámetro _lpszProfileName_ y no se establece la marca MAPI_USE_DEFAULT, se producirá un error en **MAPILogonEx** porque no se puede recuperar un nombre de perfil.</span><span class="sxs-lookup"><span data-stu-id="cccb0-121">That is, if you disable the user interface and pass NULL for the  _lpszProfileName_ parameter and do not set the MAPI_USE_DEFAULT flag, **MAPILogonEx** will fail because it cannot retrieve a profile name.</span></span> 
  
<span data-ttu-id="cccb0-122">La sesión que establece la **MAPILogonEx** puede ser una sesión de mensajería individual, una sesión de mensajería compartida o una sesión de nonmessaging.</span><span class="sxs-lookup"><span data-stu-id="cccb0-122">The session that **MAPILogonEx** establishes can be an individual messaging session, a shared messaging session, or a nonmessaging session.</span></span> <span data-ttu-id="cccb0-123">Sesiones de mensajería individuales son conexiones privadas entre el cliente y el subsistema MAPI y pueden establecerse mediante la configuración de la marca MAPI_NEW_SESSION en la llamada a **MAPILogonEx**.</span><span class="sxs-lookup"><span data-stu-id="cccb0-123">Individual messaging sessions are private connections between your client and the MAPI subsystem and can be established by setting the MAPI_NEW_SESSION flag in the call to **MAPILogonEx**.</span></span>
  
<span data-ttu-id="cccb0-124">Sesiones de mensajería compartidas son las conexiones que pueden usar varios clientes de mensajería.</span><span class="sxs-lookup"><span data-stu-id="cccb0-124">Shared messaging sessions are connections that multiple messaging clients can use.</span></span> <span data-ttu-id="cccb0-125">Normalmente, se establecen las sesiones compartidas para los clientes usan el mismo perfil.</span><span class="sxs-lookup"><span data-stu-id="cccb0-125">Shared sessions are typically established for clients use the same profile.</span></span> <span data-ttu-id="cccb0-126">Para establecer una sesión de nuevo como una sesión compartida, establecer la marca MAPI_ALLOW_OTHERS.</span><span class="sxs-lookup"><span data-stu-id="cccb0-126">To establish a new session as a shared session, set the MAPI_ALLOW_OTHERS flag.</span></span> 
  
## <a name="use-an-existing-shared-session"></a><span data-ttu-id="cccb0-127">Usar una sesión compartida existente</span><span class="sxs-lookup"><span data-stu-id="cccb0-127">Use an existing shared session</span></span>
  
- <span data-ttu-id="cccb0-128">No se establece la marca MAPI_NEW_SESSION.</span><span class="sxs-lookup"><span data-stu-id="cccb0-128">Do not set the MAPI_NEW_SESSION flag.</span></span>
    
- <span data-ttu-id="cccb0-129">No se establece la marca MAPI_ALLOW_OTHERS.</span><span class="sxs-lookup"><span data-stu-id="cccb0-129">Do not set the MAPI_ALLOW_OTHERS flag.</span></span>
    
- <span data-ttu-id="cccb0-130">Pase NULL para el parámetro _lpszProfileName_ .</span><span class="sxs-lookup"><span data-stu-id="cccb0-130">Pass NULL for the  _lpszProfileName_ parameter.</span></span> 
    
- <span data-ttu-id="cccb0-131">Pase NULL para el parámetro _lpszPassword_ .</span><span class="sxs-lookup"><span data-stu-id="cccb0-131">Pass NULL for the  _lpszPassword_ parameter.</span></span> 
    
<span data-ttu-id="cccb0-132">Sesiones nonmessaging permitir que los clientes tener acceso el subsistema MAPI, pero no permitir los mensajes ser enviados o recibidos.</span><span class="sxs-lookup"><span data-stu-id="cccb0-132">Nonmessaging sessions allow clients to access the MAPI subsystem, but do not allow messages to be sent or received.</span></span> <span data-ttu-id="cccb0-133">Configuración o administración de aplicaciones son ejemplos de clientes que es posible que deba establecer sesiones nonmessaging.</span><span class="sxs-lookup"><span data-stu-id="cccb0-133">Configuration or administration applications are examples of clients that might need to establish nonmessaging sessions.</span></span> <span data-ttu-id="cccb0-134">Para solicitar una sesión de nonmessaging, establecer la marca MAPI_NO_MAIL.</span><span class="sxs-lookup"><span data-stu-id="cccb0-134">To request a nonmessaging session, set the MAPI_NO_MAIL flag.</span></span> <span data-ttu-id="cccb0-135">Al establecer este indicador los registros de su cliente sin informar a la cola de MAPI.</span><span class="sxs-lookup"><span data-stu-id="cccb0-135">Setting this flag logs your client on without informing the MAPI spooler.</span></span> <span data-ttu-id="cccb0-136">Los clientes que inicie sesión en MAPI con esta marca no puede esperar que nunca recibirá informes de estado de lectura.</span><span class="sxs-lookup"><span data-stu-id="cccb0-136">Clients that log on to MAPI with this flag cannot expect to ever receive read status reports.</span></span>
  
<span data-ttu-id="cccb0-137">Sólo se debe establecer la marca MAPI_NO_MAIL:</span><span class="sxs-lookup"><span data-stu-id="cccb0-137">The MAPI_NO_MAIL flag should only be set:</span></span>
  
- <span data-ttu-id="cccb0-138">Si el cliente no va a enviar o recibir mensajes durante la sesión.</span><span class="sxs-lookup"><span data-stu-id="cccb0-138">If your client will not send or receive messages during the session.</span></span>
    
- <span data-ttu-id="cccb0-139">Si su cliente tiene control total sobre el contenido del perfil y los mensajes se envían y reciben mediante acoplado almacén de mensajes y los proveedores, como los proveedores de Microsoft Exchange de transporte.</span><span class="sxs-lookup"><span data-stu-id="cccb0-139">If your client has complete control over the contents of the profile and messages are sent and received using tightly coupled message store and transport providers, such as the Microsoft Exchange providers.</span></span>
    
<span data-ttu-id="cccb0-140">Un cliente de mensajería puede compartir una sesión con un cliente nonmessaging.</span><span class="sxs-lookup"><span data-stu-id="cccb0-140">A messaging client can share a session with a nonmessaging client.</span></span> <span data-ttu-id="cccb0-141">Las características de un miembro de una sesión compartida no se ven afectadas por las características de otros miembros.</span><span class="sxs-lookup"><span data-stu-id="cccb0-141">The characteristics of one member of a shared session are not affected by the characteristics of other members.</span></span> <span data-ttu-id="cccb0-142">Es decir, si se inicia sesión con el conjunto de indicadores MAPI_NO_MAIL y MAPI_ALLOW_OTHERS, un cliente de mensajería de inicio de sesión para la sesión no tiene efecto en la operación de su cliente y viceversa.</span><span class="sxs-lookup"><span data-stu-id="cccb0-142">That is, if you log on with the MAPI_NO_MAIL and MAPI_ALLOW_OTHERS flags set, a messaging client logging on to your session has no affect on the operation of your client and vice versa.</span></span> <span data-ttu-id="cccb0-143">El cliente de mensajería aún podrá enviar y recibir mensajes y no el cliente.</span><span class="sxs-lookup"><span data-stu-id="cccb0-143">The messaging client will still be able to send and receive messages and your client will not.</span></span>
  
<span data-ttu-id="cccb0-144">**MAPILogonEx** define unos otros marcadores que puede establecer:</span><span class="sxs-lookup"><span data-stu-id="cccb0-144">**MAPILogonEx** defines a few other flags that you can set:</span></span> 
  
- <span data-ttu-id="cccb0-145">MAPI_FORCE_DOWNLOAD indica que los mensajes entrantes que deben descargarse antes de **MAPILogonEx** devuelve.</span><span class="sxs-lookup"><span data-stu-id="cccb0-145">MAPI_FORCE_DOWNLOAD indicates that incoming messages should be downloaded before **MAPILogonEx** returns.</span></span> <span data-ttu-id="cccb0-146">Si no se establece este indicador hace que los mensajes se descargan en segundo plano en un momento posterior.</span><span class="sxs-lookup"><span data-stu-id="cccb0-146">Not setting this flag causes messages to be downloaded in the background at a later time.</span></span> 
    
- <span data-ttu-id="cccb0-147">MAPI_SERVICE_UI_ALWAYS solicita que cada servicio de mensajes en el perfil de mostrar un cuadro de diálogo de configuración.</span><span class="sxs-lookup"><span data-stu-id="cccb0-147">MAPI_SERVICE_UI_ALWAYS requests that every message service in the profile display a configuration dialog box.</span></span>
    
- <span data-ttu-id="cccb0-148">MAPI_NT_SERVICE indica que el cliente se implementa como un servicio de Windows.</span><span class="sxs-lookup"><span data-stu-id="cccb0-148">MAPI_NT_SERVICE indicates that your client is implemented as a Windows service.</span></span> <span data-ttu-id="cccb0-149">Si el cliente es un servicio, se debe establecer este indicador.</span><span class="sxs-lookup"><span data-stu-id="cccb0-149">This flag must be set if your client is a service.</span></span>
    
<span data-ttu-id="cccb0-150">Con cada inicio de sesión correcto, **MAPILogonEx** devuelve un puntero a una sesión de MAPI.</span><span class="sxs-lookup"><span data-stu-id="cccb0-150">With every successful logon, **MAPILogonEx** returns a pointer to a MAPI session.</span></span> <span data-ttu-id="cccb0-151">Puede usar este puntero para llamar a los métodos de la interfaz **IMAPISession** .</span><span class="sxs-lookup"><span data-stu-id="cccb0-151">You can use this pointer to call the methods of the **IMAPISession** interface.</span></span> <span data-ttu-id="cccb0-152">Para obtener más información, vea [IMAPISession: IUnknown](imapisessioniunknown.md).</span><span class="sxs-lookup"><span data-stu-id="cccb0-152">For more information, see [IMAPISession : IUnknown](imapisessioniunknown.md).</span></span> <span data-ttu-id="cccb0-153">Punteros de sesión, independientemente del tipo de sesión, son exclusivos de los clientes que reciben y no son válidos a través de tareas.</span><span class="sxs-lookup"><span data-stu-id="cccb0-153">Session pointers, regardless of the type of session, are unique to the clients that receive them and are not valid across tasks.</span></span>
  

