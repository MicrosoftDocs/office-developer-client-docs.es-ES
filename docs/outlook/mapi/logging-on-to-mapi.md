---
title: Iniciar sesión en MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 05bafe43-a78a-4659-92f0-0b4fe444c64f
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: cce43301ac73a5646e263b2ab92700e57804637d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419712"
---
# <a name="logging-on-to-mapi"></a><span data-ttu-id="09a1b-103">Iniciar sesión en MAPI</span><span class="sxs-lookup"><span data-stu-id="09a1b-103">Logging on to MAPI</span></span>
 
<span data-ttu-id="09a1b-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="09a1b-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="09a1b-105">Las aplicaciones cliente inician sesión en el subsistema MAPI mediante una llamada a la función **MAPILogonEx** .</span><span class="sxs-lookup"><span data-stu-id="09a1b-105">Client applications log on to the MAPI subsystem by calling the **MAPILogonEx** function.</span></span> <span data-ttu-id="09a1b-106">Para obtener más información, vea [MAPILogonEx](mapilogonex.md).</span><span class="sxs-lookup"><span data-stu-id="09a1b-106">For more information, see [MAPILogonEx](mapilogonex.md).</span></span> <span data-ttu-id="09a1b-107">**MAPILogonEx** valida la selección de perfil y la configuración de cada proveedor de servicios en el perfil.</span><span class="sxs-lookup"><span data-stu-id="09a1b-107">**MAPILogonEx** validates the profile selection and the configuration of each service provider in the profile.</span></span> <span data-ttu-id="09a1b-108">Una vez configurado, MAPI inicia los proveedores de la libreta de direcciones antes de iniciar los proveedores de almacenamiento de mensajes.</span><span class="sxs-lookup"><span data-stu-id="09a1b-108">Once configured, MAPI starts the address book providers before starting the message store providers.</span></span> <span data-ttu-id="09a1b-109">Los proveedores de transporte se inician cuando sus servicios son los primeros necesarios.</span><span class="sxs-lookup"><span data-stu-id="09a1b-109">Transport providers are started when their services are first required.</span></span> 
  
## <a name="choose-a-profile"></a><span data-ttu-id="09a1b-110">Elegir un perfil</span><span class="sxs-lookup"><span data-stu-id="09a1b-110">Choose a profile</span></span>
  
- <span data-ttu-id="09a1b-111">Pase una cadena de caracteres que represente el nombre del perfil en el parámetro _lpszProfileName_ a **MAPILogonEx**, o...</span><span class="sxs-lookup"><span data-stu-id="09a1b-111">Pass in a character string that represents the name of the profile in the  _lpszProfileName_ parameter to **MAPILogonEx**, or...</span></span>
    
- <span data-ttu-id="09a1b-112">Permita que el usuario especifique el perfil pasando NULL en el parámetro _lpszProfileName_ y estableciendo la marca MAPI_LOGON_UI o...</span><span class="sxs-lookup"><span data-stu-id="09a1b-112">Allow the user to specify the profile by passing NULL in the  _lpszProfileName_ parameter and setting the MAPI_LOGON_UI flag, or...</span></span> 

- <span data-ttu-id="09a1b-113">Seleccione el perfil predeterminado pasando NULL en el parámetro _lpszProfileName_ y estableciendo la marca MAPI_USE_DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="09a1b-113">Select the default profile by passing NULL in the  _lpszProfileName_ parameter and setting the MAPI_USE_DEFAULT flag.</span></span> 
    
<span data-ttu-id="09a1b-114">Si requiere un perfil específico distinto del perfil predeterminado, debe guardar su nombre en su propia base de datos de configuración o usar una Convención de nomenclatura específica.</span><span class="sxs-lookup"><span data-stu-id="09a1b-114">If you require a specific profile other than the default profile, you must save its name in your own configuration database or use a specific naming convention.</span></span> <span data-ttu-id="09a1b-115">MAPI no expone ningún atributo de perfil que no sea el nombre y la marca predeterminada en la tabla de perfiles, y la marca de perfil predeterminada está reservada para el cliente de mensajería y las aplicaciones IPM relacionadas.</span><span class="sxs-lookup"><span data-stu-id="09a1b-115">MAPI does not expose any profile attributes other than the name and default flag in the profile table, and the default profile flag is reserved for messaging client and related IPM applications.</span></span>
  
<span data-ttu-id="09a1b-116">Los clientes que proporcionan información de configuración de proveedor o perfil parcial a **MAPILogonEx** deben solicitar al usuario los datos adicionales al permitir que se muestre un cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="09a1b-116">Clients that supply partial profile or provider configuration information to **MAPILogonEx** must prompt the user for the additional data by allowing a dialog box to be displayed.</span></span> <span data-ttu-id="09a1b-117">Si falta información y **MAPILogonEx** no puede solicitar al usuario que la suministre, se producirá un error en el inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="09a1b-117">If information is missing and **MAPILogonEx** cannot prompt the user to supply it, the logon fails.</span></span> <span data-ttu-id="09a1b-118">Los clientes que no necesitan la entrada del usuario pueden suprimir la presentación del cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="09a1b-118">Clients that do not need user input can suppress the dialog box display.</span></span> 
  
<span data-ttu-id="09a1b-119">Los indicadores que usa **MAPILogonEx** para habilitar una interfaz de usuario se excluyen mutuamente; solo se puede establecer un.</span><span class="sxs-lookup"><span data-stu-id="09a1b-119">The flags that **MAPILogonEx** uses to enable a user interface are mutually exclusive; only one can be set.</span></span> <span data-ttu-id="09a1b-120">Si se dejan estas marcas sin establecer, se suprime la presentación de una interfaz de usuario, lo que provoca un error en **MAPILogonEx** si falta información necesaria.</span><span class="sxs-lookup"><span data-stu-id="09a1b-120">Leaving these flags unset suppresses the display of a user interface, causing **MAPILogonEx** to fail if necessary information is missing.</span></span> <span data-ttu-id="09a1b-121">Es decir, si deshabilita la interfaz de usuario y pasa NULL para el parámetro _lpszProfileName_ y no establece la marca MAPI_USE_DEFAULT, se producirá un error en **MAPILogonEx** porque no puede recuperar un nombre de perfil.</span><span class="sxs-lookup"><span data-stu-id="09a1b-121">That is, if you disable the user interface and pass NULL for the  _lpszProfileName_ parameter and do not set the MAPI_USE_DEFAULT flag, **MAPILogonEx** will fail because it cannot retrieve a profile name.</span></span> 
  
<span data-ttu-id="09a1b-122">La sesión que establece **MAPILogonEx** puede ser una sesión de mensajería individual, una sesión de mensajería compartida o una sesión que no sea de mensajería.</span><span class="sxs-lookup"><span data-stu-id="09a1b-122">The session that **MAPILogonEx** establishes can be an individual messaging session, a shared messaging session, or a nonmessaging session.</span></span> <span data-ttu-id="09a1b-123">Las sesiones de mensajería individuales son conexiones privadas entre el cliente y el subsistema MAPI y se pueden establecer estableciendo la marca MAPI_NEW_SESSION en la llamada a **MAPILogonEx**.</span><span class="sxs-lookup"><span data-stu-id="09a1b-123">Individual messaging sessions are private connections between your client and the MAPI subsystem and can be established by setting the MAPI_NEW_SESSION flag in the call to **MAPILogonEx**.</span></span>
  
<span data-ttu-id="09a1b-124">Las sesiones de mensajería compartida son conexiones que pueden usar varios clientes de mensajería.</span><span class="sxs-lookup"><span data-stu-id="09a1b-124">Shared messaging sessions are connections that multiple messaging clients can use.</span></span> <span data-ttu-id="09a1b-125">Las sesiones comPartidas suelen establecerse para que los clientes usen el mismo perfil.</span><span class="sxs-lookup"><span data-stu-id="09a1b-125">Shared sessions are typically established for clients use the same profile.</span></span> <span data-ttu-id="09a1b-126">Para establecer una nueva sesión como sesión compartida, establezca la marca MAPI_ALLOW_OTHERS.</span><span class="sxs-lookup"><span data-stu-id="09a1b-126">To establish a new session as a shared session, set the MAPI_ALLOW_OTHERS flag.</span></span> 
  
## <a name="use-an-existing-shared-session"></a><span data-ttu-id="09a1b-127">Usar una sesión compartida existente</span><span class="sxs-lookup"><span data-stu-id="09a1b-127">Use an existing shared session</span></span>
  
- <span data-ttu-id="09a1b-128">No establezca la marca MAPI_NEW_SESSION.</span><span class="sxs-lookup"><span data-stu-id="09a1b-128">Do not set the MAPI_NEW_SESSION flag.</span></span>
    
- <span data-ttu-id="09a1b-129">No establezca la marca MAPI_ALLOW_OTHERS.</span><span class="sxs-lookup"><span data-stu-id="09a1b-129">Do not set the MAPI_ALLOW_OTHERS flag.</span></span>
    
- <span data-ttu-id="09a1b-130">Pase NULL para el parámetro _lpszProfileName_ .</span><span class="sxs-lookup"><span data-stu-id="09a1b-130">Pass NULL for the  _lpszProfileName_ parameter.</span></span> 
    
- <span data-ttu-id="09a1b-131">Pase NULL para el parámetro _lpszPassword_ .</span><span class="sxs-lookup"><span data-stu-id="09a1b-131">Pass NULL for the  _lpszPassword_ parameter.</span></span> 
    
<span data-ttu-id="09a1b-132">Las sesiones que no son de mensajería permiten que los clientes tengan acceso al subsistema MAPI, pero no permiten que se envíen o reciban mensajes.</span><span class="sxs-lookup"><span data-stu-id="09a1b-132">Nonmessaging sessions allow clients to access the MAPI subsystem, but do not allow messages to be sent or received.</span></span> <span data-ttu-id="09a1b-133">Las aplicaciones de configuración o administración son ejemplos de clientes que pueden tener que establecer sesiones que no son de mensajería.</span><span class="sxs-lookup"><span data-stu-id="09a1b-133">Configuration or administration applications are examples of clients that might need to establish nonmessaging sessions.</span></span> <span data-ttu-id="09a1b-134">Para solicitar una sesión que no es de mensajería, establezca la marca MAPI_NO_MAIL.</span><span class="sxs-lookup"><span data-stu-id="09a1b-134">To request a nonmessaging session, set the MAPI_NO_MAIL flag.</span></span> <span data-ttu-id="09a1b-135">Al establecer este indicador se registra el cliente en sin informar a la cola MAPI.</span><span class="sxs-lookup"><span data-stu-id="09a1b-135">Setting this flag logs your client on without informing the MAPI spooler.</span></span> <span data-ttu-id="09a1b-136">Los clientes que inicien sesión en MAPI con esta marca no pueden esperar nunca recibir informes de estado de lectura.</span><span class="sxs-lookup"><span data-stu-id="09a1b-136">Clients that log on to MAPI with this flag cannot expect to ever receive read status reports.</span></span>
  
<span data-ttu-id="09a1b-137">La marca MAPI_NO_MAIL solo debe establecerse:</span><span class="sxs-lookup"><span data-stu-id="09a1b-137">The MAPI_NO_MAIL flag should only be set:</span></span>
  
- <span data-ttu-id="09a1b-138">Si el cliente no va a enviar ni recibir mensajes durante la sesión.</span><span class="sxs-lookup"><span data-stu-id="09a1b-138">If your client will not send or receive messages during the session.</span></span>
    
- <span data-ttu-id="09a1b-139">Si el cliente tiene un control total sobre el contenido del perfil y los mensajes se envían y se reciben mediante proveedores de transporte y almacenamiento de mensajes estrechamente acoplados, como los proveedores de Microsoft Exchange.</span><span class="sxs-lookup"><span data-stu-id="09a1b-139">If your client has complete control over the contents of the profile and messages are sent and received using tightly coupled message store and transport providers, such as the Microsoft Exchange providers.</span></span>
    
<span data-ttu-id="09a1b-140">Un cliente de mensajería puede compartir una sesión con un cliente que no sea de mensajería.</span><span class="sxs-lookup"><span data-stu-id="09a1b-140">A messaging client can share a session with a nonmessaging client.</span></span> <span data-ttu-id="09a1b-141">Las características de un miembro de una sesión compartida no se ven afectadas por las características de otros miembros.</span><span class="sxs-lookup"><span data-stu-id="09a1b-141">The characteristics of one member of a shared session are not affected by the characteristics of other members.</span></span> <span data-ttu-id="09a1b-142">Es decir, si inicia sesión con los indicadores MAPI_NO_MAIL y MAPI_ALLOW_OTHERS, un cliente de mensajería que inicie sesión en la sesión no tendrá ningún efecto en el funcionamiento del cliente y viceversa.</span><span class="sxs-lookup"><span data-stu-id="09a1b-142">That is, if you log on with the MAPI_NO_MAIL and MAPI_ALLOW_OTHERS flags set, a messaging client logging on to your session has no affect on the operation of your client and vice versa.</span></span> <span data-ttu-id="09a1b-143">El cliente de mensajería podrá seguir enviando y recibiendo mensajes, y el cliente no.</span><span class="sxs-lookup"><span data-stu-id="09a1b-143">The messaging client will still be able to send and receive messages and your client will not.</span></span>
  
<span data-ttu-id="09a1b-144">**MAPILogonEx** define algunos otros marcadores que puede establecer:</span><span class="sxs-lookup"><span data-stu-id="09a1b-144">**MAPILogonEx** defines a few other flags that you can set:</span></span> 
  
- <span data-ttu-id="09a1b-145">MAPI_FORCE_DOWNLOAD indica que los mensajes entrantes deben descargarse antes de que **MAPILogonEx** vuelva.</span><span class="sxs-lookup"><span data-stu-id="09a1b-145">MAPI_FORCE_DOWNLOAD indicates that incoming messages should be downloaded before **MAPILogonEx** returns.</span></span> <span data-ttu-id="09a1b-146">Si no se establece esta marca, los mensajes se descargan en segundo plano en un momento posterior.</span><span class="sxs-lookup"><span data-stu-id="09a1b-146">Not setting this flag causes messages to be downloaded in the background at a later time.</span></span> 
    
- <span data-ttu-id="09a1b-147">MAPI_SERVICE_UI_ALWAYS solicita que cada servicio de mensajes en el perfil muestre un cuadro de diálogo de configuración.</span><span class="sxs-lookup"><span data-stu-id="09a1b-147">MAPI_SERVICE_UI_ALWAYS requests that every message service in the profile display a configuration dialog box.</span></span>
    
- <span data-ttu-id="09a1b-148">MAPI_NT_SERVICE indica que su cliente se ha implementado como un servicio de Windows.</span><span class="sxs-lookup"><span data-stu-id="09a1b-148">MAPI_NT_SERVICE indicates that your client is implemented as a Windows service.</span></span> <span data-ttu-id="09a1b-149">Esta marca debe establecerse si el cliente es un servicio.</span><span class="sxs-lookup"><span data-stu-id="09a1b-149">This flag must be set if your client is a service.</span></span>
    
<span data-ttu-id="09a1b-150">Con cada inicio de sesión correcto, **MAPILogonEx** devuelve un puntero a una sesión MAPI.</span><span class="sxs-lookup"><span data-stu-id="09a1b-150">With every successful logon, **MAPILogonEx** returns a pointer to a MAPI session.</span></span> <span data-ttu-id="09a1b-151">Puede utilizar este puntero para llamar a los métodos de la interfaz **IMAPISession** .</span><span class="sxs-lookup"><span data-stu-id="09a1b-151">You can use this pointer to call the methods of the **IMAPISession** interface.</span></span> <span data-ttu-id="09a1b-152">Para obtener más información, vea [IMAPISession: IUnknown](imapisessioniunknown.md).</span><span class="sxs-lookup"><span data-stu-id="09a1b-152">For more information, see [IMAPISession : IUnknown](imapisessioniunknown.md).</span></span> <span data-ttu-id="09a1b-153">Los punteros de sesión, independientemente del tipo de sesión, son únicos para los clientes que los reciben y no son válidos en todas las tareas.</span><span class="sxs-lookup"><span data-stu-id="09a1b-153">Session pointers, regardless of the type of session, are unique to the clients that receive them and are not valid across tasks.</span></span>
  

