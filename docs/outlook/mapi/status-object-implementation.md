---
title: Estado de implementación de objeto
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 48fd3e28-c2d2-474d-9487-5e2f08ca7319
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: e97efb70716ffbd7fa98f980ce8520cfcb988532
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/23/2019
ms.locfileid: "32336340"
---
# <a name="status-object-implementation"></a><span data-ttu-id="eabf2-103">Estado de implementación de objeto</span><span class="sxs-lookup"><span data-stu-id="eabf2-103">Status object implementation</span></span>

<span data-ttu-id="eabf2-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="eabf2-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="eabf2-105">Todos los proveedores de servicios deben implementar un objeto de estado y proporcionar sus propiedades a la tabla de estado de la sesión.</span><span class="sxs-lookup"><span data-stu-id="eabf2-105">All service providers must implement a status object and furnish properties from it to the session status table.</span></span> <span data-ttu-id="eabf2-106">Puede incluir una o más filas en la tabla de estado, en función del número de recursos que controle.</span><span class="sxs-lookup"><span data-stu-id="eabf2-106">You can include one or more rows in the status table, depending on the number of resources that you control.</span></span> <span data-ttu-id="eabf2-107">Un proveedor de transporte, por ejemplo, debe crear una fila en la tabla de estado para cada cola de mensajes que administra.</span><span class="sxs-lookup"><span data-stu-id="eabf2-107">A transport provider, for example, should create a row in the status table for each message queue it manages.</span></span> <span data-ttu-id="eabf2-108">Cuando se produzcan cambios, debe actualizarse la fila de tabla de estado correspondiente.</span><span class="sxs-lookup"><span data-stu-id="eabf2-108">When changes occur, the appropriate status table row must be updated.</span></span> <span data-ttu-id="eabf2-109">Los objetos de estado se implementan para proporcionar acceso a la información incluida en la tabla de estado y a información adicional que no se incluye en la tabla.</span><span class="sxs-lookup"><span data-stu-id="eabf2-109">Status objects are implemented to provide access both to the information included in the status table and to additional information not included in the table.</span></span>
  
### <a name="to-implement-a-status-object"></a><span data-ttu-id="eabf2-110">Para implementar un objeto de estado</span><span class="sxs-lookup"><span data-stu-id="eabf2-110">To implement a status object</span></span>

1. <span data-ttu-id="eabf2-111">Implemente el método **OpenStatusEntry** del objeto de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="eabf2-111">Implement the **OpenStatusEntry** method of your logon object.</span></span> <span data-ttu-id="eabf2-112">Cuando los clientes desean abrir el objeto de estado, llaman a [IMAPISession:: OpenEntry](imapisession-openentry.md).</span><span class="sxs-lookup"><span data-stu-id="eabf2-112">When clients want to open your status object, they call [IMAPISession::OpenEntry](imapisession-openentry.md).</span></span> <span data-ttu-id="eabf2-113">MAPI cumple la solicitud de apertura llamando al método **OpenStatusEntry** del proveedor, lo que hace que su proveedor Abra su objeto de estado y vuelva al cliente un puntero a su implementación de **IMAPIStatus** .</span><span class="sxs-lookup"><span data-stu-id="eabf2-113">MAPI fulfills the open request by calling your provider's **OpenStatusEntry** method, causing your provider to open its status object and return to the client a pointer to its **IMAPIStatus** implementation.</span></span> <span data-ttu-id="eabf2-114">En la implementación de **OpenStatusEntry** , complete los siguientes pasos:</span><span class="sxs-lookup"><span data-stu-id="eabf2-114">In your **OpenStatusEntry** implementation, complete the following steps:</span></span> 
    
   1. <span data-ttu-id="eabf2-115">Realice las siguientes tareas si el objeto de inicio de sesión no ha creado todavía un objeto status:</span><span class="sxs-lookup"><span data-stu-id="eabf2-115">Perform the following tasks if your logon object has not yet created a status object:</span></span>
    
      1. <span data-ttu-id="eabf2-116">Llame al método [IMAPISupport:: OpenProfileSection](imapisupport-openprofilesection.md) del objeto support para obtener acceso a la sección de perfil del proveedor.</span><span class="sxs-lookup"><span data-stu-id="eabf2-116">Call the support object's [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) method to access your provider's profile section.</span></span> 
          
      2. <span data-ttu-id="eabf2-117">Crea un nuevo objeto status.</span><span class="sxs-lookup"><span data-stu-id="eabf2-117">Create a new status object.</span></span>
          
      3. <span data-ttu-id="eabf2-118">Almacene una referencia a la sección de perfil en el objeto de estado del proveedor y llame al método [IUnknown:: AddRef](https://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx) de la sección de perfil para incrementar su recuento de referencia.</span><span class="sxs-lookup"><span data-stu-id="eabf2-118">Store a reference to the profile section in your provider's status object and call the profile section's [IUnknown::AddRef](https://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx) method to increment its reference count.</span></span> 
          
      4. <span data-ttu-id="eabf2-119">Almacene una referencia al objeto de inicio de sesión en el objeto de estado del proveedor y llame al método **IUnknown:: AddRef** del objeto de inicio de sesión para incrementar su recuento de referencia.</span><span class="sxs-lookup"><span data-stu-id="eabf2-119">Store a reference to the logon object in your provider's status object and call the logon object's **IUnknown::AddRef** method to increment its reference count.</span></span> 
          
      5. <span data-ttu-id="eabf2-120">Almacene una referencia al objeto status en el objeto de inicio de sesión del proveedor.</span><span class="sxs-lookup"><span data-stu-id="eabf2-120">Store a reference to the status object in your provider's logon object.</span></span>
    
   2. <span data-ttu-id="eabf2-121">Llame al método **IUnknown:: AddRef** del objeto de estado para incrementar su recuento de referencia en el objeto de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="eabf2-121">Call the status object's **IUnknown::AddRef** method to increment its reference count in the logon object.</span></span> 
    
   3. <span data-ttu-id="eabf2-122">Establezca la propiedad **PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md)) del objeto status en MAPI_STATUS.</span><span class="sxs-lookup"><span data-stu-id="eabf2-122">Set the status object's **PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md)) property to MAPI_STATUS.</span></span>
    
   4. <span data-ttu-id="eabf2-123">Establezca el parámetro de salida _lppMAPIStatus_ para que apunte al objeto status y vuelva.</span><span class="sxs-lookup"><span data-stu-id="eabf2-123">Set the  _lppMAPIStatus_ output parameter to point to the status object, and return.</span></span> 
    
   5. <span data-ttu-id="eabf2-124">Compruebe el parámetro de entrada _ulFlags_ .</span><span class="sxs-lookup"><span data-stu-id="eabf2-124">Check the  _ulFlags_ input parameter.</span></span> <span data-ttu-id="eabf2-125">Si se establece en MAPI_MODIFY y el proveedor admite el acceso de lectura y escritura a su objeto status, devuelva un objeto que se pueda escribir.</span><span class="sxs-lookup"><span data-stu-id="eabf2-125">If it is set to MAPI_MODIFY and your provider supports read/write access to its status object, return a writeable object.</span></span> <span data-ttu-id="eabf2-126">Sin embargo, si el proveedor no admite el acceso de lectura y escritura a su objeto status, no se produce ningún error.</span><span class="sxs-lookup"><span data-stu-id="eabf2-126">However, if your provider does not support read/write access to its status object, do not fail.</span></span> <span data-ttu-id="eabf2-127">Devuelve un objeto status que es de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="eabf2-127">Return a status object that is read-only.</span></span> <span data-ttu-id="eabf2-128">Los clientes que esperan recibir objetos de estado de lectura y escritura deben comprobar que se ha concedido el permiso de lectura y escritura antes de intentar realizar cualquier cambio.</span><span class="sxs-lookup"><span data-stu-id="eabf2-128">Clients that expect to receive read/write status objects should verify that read/write permission has been granted before attempting to make any changes.</span></span> 
    
2. <span data-ttu-id="eabf2-129">Establezca todas las propiedades de objeto status requerido y tabla de estado.</span><span class="sxs-lookup"><span data-stu-id="eabf2-129">Set all of the required status object and status table properties.</span></span> <span data-ttu-id="eabf2-130">Las propiedades que incluya en la fila de la tabla de estado deben estar disponibles a través del objeto status, excepto para las propiedades calculadas por MAPI.</span><span class="sxs-lookup"><span data-stu-id="eabf2-130">The properties that you include in your status table row should be available through your status object, except for the properties calculated by MAPI.</span></span> <span data-ttu-id="eabf2-131">Las propiedades necesarias son las siguientes:</span><span class="sxs-lookup"><span data-stu-id="eabf2-131">The required properties are as follows:</span></span>
    
   - <span data-ttu-id="eabf2-132">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="eabf2-132">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>
    
   - <span data-ttu-id="eabf2-133">**PR_PROVIDER_DLL_NAME** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="eabf2-133">**PR_PROVIDER_DLL_NAME** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md))</span></span>
    
   - <span data-ttu-id="eabf2-134">**PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="eabf2-134">**PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md))</span></span>
    
   - <span data-ttu-id="eabf2-135">**PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="eabf2-135">**PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md))</span></span>
    
   - <span data-ttu-id="eabf2-136">**PR_RESOURCE_METHODS** ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="eabf2-136">**PR_RESOURCE_METHODS** ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md))</span></span>
    
   - <span data-ttu-id="eabf2-137">**PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="eabf2-137">**PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md))</span></span>
    
   - <span data-ttu-id="eabf2-138">**PR_STATUS_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="eabf2-138">**PR_STATUS_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md))</span></span>
    
3. <span data-ttu-id="eabf2-139">Implemente los métodos [IMAPIStatus: IMAPIProp](imapistatusimapiprop.md) adecuados para su proveedor.</span><span class="sxs-lookup"><span data-stu-id="eabf2-139">Implement the [IMAPIStatus : IMAPIProp](imapistatusimapiprop.md) methods that are appropriate for your provider.</span></span> <span data-ttu-id="eabf2-140">En función de su proveedor, no es necesario que implemente todos los cuatro métodos de **IMAPIStatus**.</span><span class="sxs-lookup"><span data-stu-id="eabf2-140">Depending on your provider, you do not need to implement all of the four methods in **IMAPIStatus**.</span></span> <span data-ttu-id="eabf2-141">Cada proveedor debe implementar una versión de solo lectura de los métodos de la interfaz [IMAPIProp: IUnknown](imapipropiunknown.md) y el método [IMAPIStatus:: ValidateState](imapistatus-validatestate.md) .</span><span class="sxs-lookup"><span data-stu-id="eabf2-141">Every provider should implement a read-only version of the methods of the [IMAPIProp : IUnknown](imapipropiunknown.md) interface and the [IMAPIStatus::ValidateState](imapistatus-validatestate.md) method.</span></span> 

   <span data-ttu-id="eabf2-142">Los proveedores de transporte también deben implementar [IMAPIStatus:: FlushQueues](imapistatus-flushqueues.md)y todos los proveedores deben ser compatibles con [IMAPIStatus:: SettingsDialog](imapistatus-settingsdialog.md).</span><span class="sxs-lookup"><span data-stu-id="eabf2-142">Transport providers should also implement [IMAPIStatus::FlushQueues](imapistatus-flushqueues.md), and all providers should support [IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md).</span></span> <span data-ttu-id="eabf2-143">Sin embargo, la compatibilidad con [IMAPIStatus:: ChangePassword](imapistatus-changepassword.md) es opcional.</span><span class="sxs-lookup"><span data-stu-id="eabf2-143">However, support for [IMAPIStatus::ChangePassword](imapistatus-changepassword.md) is optional.</span></span> <span data-ttu-id="eabf2-144">Solo los proveedores de servicios que requieran contraseña y desean permitir a los usuarios cambiarlos mediante programación deben implementar este método.</span><span class="sxs-lookup"><span data-stu-id="eabf2-144">Only service providers that require passwords and want to allow users to change them programmatically need to implement this method.</span></span> <span data-ttu-id="eabf2-145">Para cada método que admita, establezca el bit correspondiente en la propiedad **PR_RESOURCE_METHODS** .</span><span class="sxs-lookup"><span data-stu-id="eabf2-145">For every method that you support, set the corresponding bit in the **PR_RESOURCE_METHODS** property.</span></span> <span data-ttu-id="eabf2-146">Por ejemplo, si solo admite **ValidateState** y **SettingsDialog** , establezca **PR_RESOURCE_METHODS** en lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="eabf2-146">For example, if you support **ValidateState** and **SettingsDialog** only, set **PR_RESOURCE_METHODS** to the following:</span></span> 
    
   `STATUS_VALIDATE_STATE | STATUS_SETTINGS_DIALOG`
    
   <span data-ttu-id="eabf2-147">Los clientes deben comprobar el valor de **PR_RESOURCE_METHODS** antes de intentar llamar al objeto de estado.</span><span class="sxs-lookup"><span data-stu-id="eabf2-147">Clients should check the value of **PR_RESOURCE_METHODS** before attempting to call your status object.</span></span> <span data-ttu-id="eabf2-148">Para controlar las llamadas a cualquiera de los métodos no admitidos, devuelva MAPI_E_NO_SUPPORT.</span><span class="sxs-lookup"><span data-stu-id="eabf2-148">Handle calls to any of your unsupported methods by returning MAPI_E_NO_SUPPORT.</span></span> 
    
4. <span data-ttu-id="eabf2-149">Llame a [IMAPISupport:: ModifyStatusRow](imapisupport-modifystatusrow.md) durante el inicio de sesión para agregar la fila o las filas a la tabla de estado.</span><span class="sxs-lookup"><span data-stu-id="eabf2-149">Call [IMAPISupport::ModifyStatusRow](imapisupport-modifystatusrow.md) during logon to add your row or rows to the status table.</span></span> <span data-ttu-id="eabf2-150">Pase una matriz de valores de propiedad que contenga la información de columna de la fila y 0 para el parámetro _ulFlags_ .</span><span class="sxs-lookup"><span data-stu-id="eabf2-150">Pass a property value array that contains the column information for the row and 0 for the  _ulFlags_ parameter.</span></span> <span data-ttu-id="eabf2-151">Si en algún momento más adelante en la sesión cambia el estado del proveedor y es necesario actualizar la información de la columna, vuelva a llamar a **ModifyStatusRow** con la marca STATUSROW_UPDATE establecida.</span><span class="sxs-lookup"><span data-stu-id="eabf2-151">If at some point later in the session your provider's status changes and it becomes necessary to update the column information, call **ModifyStatusRow** again with the STATUSROW_UPDATE flag set.</span></span> 
    
<span data-ttu-id="eabf2-152">Para obtener más información acerca de los objetos de estado, consulte [MAPI status Objects](mapi-status-objects.md).</span><span class="sxs-lookup"><span data-stu-id="eabf2-152">For more information about status objects, see [MAPI Status Objects](mapi-status-objects.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="eabf2-153">Vea también</span><span class="sxs-lookup"><span data-stu-id="eabf2-153">See also</span></span>

- [<span data-ttu-id="eabf2-154">Proveedores de servicios MAPI</span><span class="sxs-lookup"><span data-stu-id="eabf2-154">MAPI Service Providers</span></span>](mapi-service-providers.md)

