---
title: Almacenes de mensaje de s�lo lectura
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 752ff2d6-ca64-4507-adf1-4c054c321203
description: '�ltima modificaci�n: s�bado, 23 de julio de 2011'
ms.openlocfilehash: 957a7f92963b97e5421bc801a3b046f098d6a08e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33405341"
---
# <a name="read-only-message-stores"></a><span data-ttu-id="84f5d-103">Almacenes de mensaje de s�lo lectura</span><span class="sxs-lookup"><span data-stu-id="84f5d-103">Read-Only Message Stores</span></span>

  
  
<span data-ttu-id="84f5d-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="84f5d-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="84f5d-p101">Un almac�n de mensajes de solo lectura es uno en la que ni el cliente MAPI ni la cola MAPI puede crear, modificar o eliminar los objetos en el almac�n de mensajes. Hay muchas razones de por qu� es posible que desee implementar un almac�n de mensajes de s�lo lectura. Por ejemplo, una empresa informes de cr�dito podr�a utilizar un almac�n de s�lo lectura para permitir que sus clientes o empleados ver, pero no cambiar informes de cr�dito individual. Si se elige crear un mensaje de s�lo lectura almacenar tiene implicaciones para la estructura del proveedor de almacenamiento y para el propio almac�n. Por ejemplo, un almac�n de mensajes de solo lectura no puede tener una carpeta Bandeja de salida, ya que, a continuaci�n, los clientes MAPI debe solicitar la creaci�n de nuevos mensajes salientes en esa carpeta. De forma similar, es responsabilidad del proveedor de almacenamiento para garantizar la integridad del mecanismo de almacenamiento subyacente.</span><span class="sxs-lookup"><span data-stu-id="84f5d-p101">A read-only message store is one in which neither the MAPI client nor the MAPI spooler can create, modify, or delete the objects in the message store. There are many reasons why you might want to implement a read-only message store. For example, a credit reporting firm could use a read-only store to allow its customers or employees to see but not change individual credit reports. Choosing to make a read-only message store has implications for the structure of the store provider and for the store itself. For example, a read-only message store cannot have an Outbox folder, because then MAPI clients would request that new outgoing messages be created in that folder. Similarly, it is the store provider's responsibility to ensure the integrity of the underlying storage mechanism.</span></span>
  
<span data-ttu-id="84f5d-111">Hay tres marcas que se pueden establecer en la propiedad **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask)](pidtagstoresupportmask-canonical-property.md)del almacén de mensajes que admiten distintos niveles de acceso de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="84f5d-111">There are three flags that can be set in the message store's **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property that support different levels of read-only access.</span></span> <span data-ttu-id="84f5d-112">The STORE_READONLY flag indicates that all [IMAPIProp: IUnknown](imapipropiunknown.md) interfaces on objects in the message store are read-only.</span><span class="sxs-lookup"><span data-stu-id="84f5d-112">The STORE_READONLY flag indicates that all [IMAPIProp : IUnknown](imapipropiunknown.md) interfaces on objects in the message store are read-only.</span></span> <span data-ttu-id="84f5d-113">The STORE_MODIFY_OK flag indicates that existing messages in the message store may be modified, but new folders and messages may not be created.</span><span class="sxs-lookup"><span data-stu-id="84f5d-113">The STORE_MODIFY_OK flag indicates that existing messages in the message store may be modified, but new folders and messages may not be created.</span></span> <span data-ttu-id="84f5d-114">The STORE_CREATE_OK flag indicates that new messages and folders may be created, but indicates nothing about whether existing objects may be modified.</span><span class="sxs-lookup"><span data-stu-id="84f5d-114">The STORE_CREATE_OK flag indicates that new messages and folders may be created, but indicates nothing about whether existing objects may be modified.</span></span> 
  
<span data-ttu-id="84f5d-p103">El hecho de que los clientes MAPI y la cola MAPI no sea capaz de crear, modificar o eliminar los objetos en el almac�n de mensajes no significa que no cambie nunca el contenido del mecanismo de almacenamiento subyacente. Ni significa que el proveedor de almac�n nunca necesita permiso de escritura para el mecanismo de almacenamiento subyacente. En algunas circunstancias esas dos condiciones pueden aplicar, pero no en el caso de un mensaje de s�lo lectura general almac�n. El nivel de acceso que requiere su proveedor de almacenamiento y si su proveedor de almacenamiento cambia alguna vez datos en el mecanismo de almacenamiento subyacente depende principalmente de la naturaleza espec�fica de su proveedor de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="84f5d-p103">The fact that MAPI clients and the MAPI spooler may not be able to create, modify, or delete objects in the message store does not mean that the contents of the underlying storage mechanism never change. Nor does it mean that your store provider never needs write permission to the underlying storage mechanism. In some circumstances those two conditions may apply, but not in the general case of a read-only message store. The level of access that your store provider requires and whether or not your store provider ever changes data in the underlying storage mechanism depends mainly on the specific nature of your store provider.</span></span>
  
<span data-ttu-id="84f5d-p104">Por ejemplo, si est� escribiendo un proveedor de almacenamiento para dar a los clientes MAPI acceso a una base de datos almacenada en un dispositivo de CD-ROM, no se puede cambiar el mecanismo de almacenamiento subyacente y su proveedor de almacenamiento puede tener el permiso de solo lectura. Si, sin embargo, est� escribiendo un proveedor de almacenamiento para conceder acceso de solo lectura de los clientes MAPI a una base de datos de carpetas p�blicas, pero el proveedor de almacenamiento que se necesita para realizar un seguimiento del estado le�do o de los mensajes de cada usuario, el proveedor de almacenamiento tendr� que escribir nuevos datos en el mecanismo de almacenamiento subyacente. Sin embargo, en ning�n ejemplo es el proveedor de almacenamiento nunca necesario que crear, modificar o eliminar las carpetas o mensajes a petici�n de los clientes MAPI o de la cola MAPI.</span><span class="sxs-lookup"><span data-stu-id="84f5d-p104">For example, if you are writing a store provider to give MAPI clients access to a database stored on a CD-ROM device, the underlying storage mechanism cannot change and your store provider can have read-only permission for it. If, however, you are writing a store provider to give MAPI clients read-only access to a public folder database, but the store provider needs to keep track of the read/unread status of messages for each user, the store provider will need to write new data to the underlying storage mechanism. However, in neither example does the store provider ever have to create, modify, or delete folders or messages at the request of MAPI clients or the MAPI spooler.</span></span>
  
<span data-ttu-id="84f5d-122">La lista corta de motivos por los que un proveedor de almac�n ser�a necesario para escribir datos en un mecanismo de almacenamiento subyacente en caso contrario, es de s�lo lectura es el siguiente:</span><span class="sxs-lookup"><span data-stu-id="84f5d-122">The short list of reasons that a store provider would need to write data to an underlying storage mechanism that is otherwise read-only is as follows:</span></span>
  
- <span data-ttu-id="84f5d-123">Para almacenar el estado le�do o de los mensajes.</span><span class="sxs-lookup"><span data-stu-id="84f5d-123">To store the read/unread status of messages.</span></span>
    
- <span data-ttu-id="84f5d-124">Para implementar notificaciones de lectura/nonread.</span><span class="sxs-lookup"><span data-stu-id="84f5d-124">To implement read/nonread notifications.</span></span> 
    
- <span data-ttu-id="84f5d-125">Para almacenar las vistas.</span><span class="sxs-lookup"><span data-stu-id="84f5d-125">To store views.</span></span>
    
- <span data-ttu-id="84f5d-126">Para almacenar en cach� los �ndices persistentes para criterios de ordenaci�n de la carpeta definida por el usuario.</span><span class="sxs-lookup"><span data-stu-id="84f5d-126">To cache persistent indexes for user-defined folder sort orders.</span></span>
    
- <span data-ttu-id="84f5d-127">To store the sort order of a folder's contents (supporting [IMAPIFolder::SaveContentsSort](imapifolder-savecontentssort.md)).</span><span class="sxs-lookup"><span data-stu-id="84f5d-127">To store the sort order of a folder's contents (supporting [IMAPIFolder::SaveContentsSort](imapifolder-savecontentssort.md)).</span></span>
    
- <span data-ttu-id="84f5d-128">To store search criteria, search state, and results, if the message store provider supports searches (supporting [IMAPIContainer::SetSearchCriteria](imapicontainer-setsearchcriteria.md)).</span><span class="sxs-lookup"><span data-stu-id="84f5d-128">To store search criteria, search state, and results, if the message store provider supports searches (supporting [IMAPIContainer::SetSearchCriteria](imapicontainer-setsearchcriteria.md)).</span></span>
    
<span data-ttu-id="84f5d-p105">Si el proveedor de almac�n de mensajes nunca puede escribir datos en el mecanismo de almacenamiento subyacente, necesitar� implementar estas caracter�sticas mediante el uso de un mecanismo de almacenamiento independientes fuera el mecanismo de almacenamiento subyacente. Por ejemplo, un proveedor de almac�n de mensajes de s�lo lectura puede almacenar el estado le�do o de los mensajes en el almac�n en un archivo en el equipo del usuario. Esta estrategia presenta dificultades adicionales, pero puede ser los proveedores de almac�n para implementar algunas de las caracter�sticas de la manera de sea factible s�lo para el mensaje de s�lo lectura. Por ejemplo, mantener el contenido del mecanismo de almacenamiento independientes sincronizado con los objetos en el almac�n de mensajes es m�s dif�cil que almacenar el estado le�do o directamente en el propio almac�n de mensajes.</span><span class="sxs-lookup"><span data-stu-id="84f5d-p105">If your message store provider can never write data to the underlying storage mechanism, it will need to implement these features by using a separate storage mechanism outside of the underlying storage mechanism. For example, a read-only message store provider could store the read/unread status of messages in the store in a file on the user's computer. This strategy presents additional difficulties but may be the only feasable way for read-only message store providers to implement some features. For example, keeping the contents of the separate storage mechanism synchronized with the objects in the message store is more difficult than storing the read/unread status directly in the message store itself.</span></span>
  
<span data-ttu-id="84f5d-133">La búsqueda presenta una complicación adicional para los proveedores de almacenamiento de mensajes de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="84f5d-133">Searching presents an additional complication for read-only message store providers.</span></span> <span data-ttu-id="84f5d-134">Los clientes usan la carpeta especificada en la propiedad **PR_FINDER_ENTRYID** del objeto del almacén de mensajes ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md)) para buscar la carpeta usada para los resultados de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="84f5d-134">Clients use the folder specified in the message store object's **PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md)) property to locate the folder used for search results.</span></span> <span data-ttu-id="84f5d-135">Los proveedores de almacenamiento de mensajes de solo lectura a menudo no pueden instalar una carpeta de resultados de búsqueda permanente en el almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="84f5d-135">Read-only message store providers often cannot install a permanent search-results folder into the message store.</span></span> <span data-ttu-id="84f5d-136">En esa situación, el proveedor del almacén de mensajes debe almacenar un identificador de entrada en la propiedad **PR_FINDER_ENTRYID** que pueda reconocer cuando los clientes abren carpetas para que pueda crear dinámicamente una carpeta de resultados de búsqueda en lugar de leer uno del mecanismo de almacenamiento subyacente.</span><span class="sxs-lookup"><span data-stu-id="84f5d-136">In that situation, the message store provider should store an entry identifier in the **PR_FINDER_ENTRYID** property that it can recognize when clients open folders so that it can dynamically create a search-results folder instead of reading one from the underlying storage mechanism.</span></span> <span data-ttu-id="84f5d-137">Sin embargo, dado que muchos proveedores de almacenamiento de mensajes de solo lectura crean todas sus carpetas dinámicamente, esto no suele ser demasiado una carga.</span><span class="sxs-lookup"><span data-stu-id="84f5d-137">However, because many read-only message store providers create all their folders dynamically, this is usually not too much of a burden.</span></span> 
  
<span data-ttu-id="84f5d-138">El hecho de que el proveedor del almacén de mensajes es de solo lectura se anuncia en la propiedad del objeto del proveedor PR_STORE_SUPPORT_MASK **almacén.**</span><span class="sxs-lookup"><span data-stu-id="84f5d-138">The fact that your message store provider is read-only is advertised in the store provider object's **PR_STORE_SUPPORT_MASK** property.</span></span> <span data-ttu-id="84f5d-139">Sin embargo, no cuente con clientes para respetar esa propiedad; el código del proveedor de almacenamiento debe exigir el estado de solo lectura del mecanismo de almacenamiento subyacente.</span><span class="sxs-lookup"><span data-stu-id="84f5d-139">However, do not count on clients to respect that property; your store provider's code should enforce the read-only status of the underlying storage mechanism.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="84f5d-140">Vea también</span><span class="sxs-lookup"><span data-stu-id="84f5d-140">See also</span></span>



[<span data-ttu-id="84f5d-141">Desarrollar un proveedor de almacén de mensajes MAPI</span><span class="sxs-lookup"><span data-stu-id="84f5d-141">Developing a MAPI Message Store Provider</span></span>](developing-a-mapi-message-store-provider.md)

