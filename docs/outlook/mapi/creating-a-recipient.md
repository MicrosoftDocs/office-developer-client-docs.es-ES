---
title: Creación de un destinatario
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 586c901f-d9f9-44f2-a328-051775a81265
description: 'Última modificación: 09 de marzo de 2015'
ms.openlocfilehash: e14430d1539b90e089a9dabe1315384050f3dd5e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33429589"
---
# <a name="creating-a-recipient"></a><span data-ttu-id="e4a3e-103">Creación de un destinatario</span><span class="sxs-lookup"><span data-stu-id="e4a3e-103">Creating a Recipient</span></span>

  
  
<span data-ttu-id="e4a3e-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="e4a3e-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="e4a3e-105">Los clientes crean destinatarios cuando están direccionando mensajes y cuando agregan entradas a contenedores modificables de libreta de direcciones.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-105">Clients create recipients when they are addressing messages and when they are adding entries to modifiable address book containers.</span></span> <span data-ttu-id="e4a3e-106">MAPI proporciona tres métodos para crear destinatarios:</span><span class="sxs-lookup"><span data-stu-id="e4a3e-106">MAPI provides three methods for creating recipients:</span></span>
  
- [<span data-ttu-id="e4a3e-107">IAddrBook::CreateOneOff</span><span class="sxs-lookup"><span data-stu-id="e4a3e-107">IAddrBook::CreateOneOff</span></span>](iaddrbook-createoneoff.md)
    
- [<span data-ttu-id="e4a3e-108">IAddrBook::NewEntry</span><span class="sxs-lookup"><span data-stu-id="e4a3e-108">IAddrBook::NewEntry</span></span>](iaddrbook-newentry.md)
    
- [<span data-ttu-id="e4a3e-109">IABContainer::CreateEntry</span><span class="sxs-lookup"><span data-stu-id="e4a3e-109">IABContainer::CreateEntry</span></span>](iabcontainer-createentry.md)
    
<span data-ttu-id="e4a3e-110">Llama **a IAddrBook::CreateOneOff** cuando crees destinatarios que se usarán para dirigir mensajes.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-110">Call **IAddrBook::CreateOneOff** when you are creating recipients to be used to address messages.</span></span> <span data-ttu-id="e4a3e-111">**CreateOneOff** crea un identificador de entrada único con formato especial que se asociará a una dirección de un tipo de dirección determinado.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-111">**CreateOneOff** creates a specially formatted one-off entry identifier to be associated with an address of a particular address type.</span></span> <span data-ttu-id="e4a3e-112">Para obtener más información acerca de los identificadores de entrada de un solo uso y de un solo uso, vea [One-Off Addresses](one-off-addresses.md) and [One-Off Entry Identifiers](one-off-entry-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="e4a3e-112">For more information about one-offs and one-off entry identifiers, see [One-Off Addresses](one-off-addresses.md) and [One-Off Entry Identifiers](one-off-entry-identifiers.md).</span></span>
  
<span data-ttu-id="e4a3e-113">Llama **a IAddrBook::NewEntry** al crear destinatarios que se van a usar para dirigir mensajes o agregarlos a un contenedor.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-113">Call **IAddrBook::NewEntry** when you are creating recipients to be used either to address messages or to add to a container.</span></span> <span data-ttu-id="e4a3e-114">**NewEntry** tiene tres pares de parámetros que contienen identificadores de entrada.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-114">**NewEntry** has three pairs of parameters that contain entry identifiers.</span></span> <span data-ttu-id="e4a3e-115">Estos parámetros se describen de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="e4a3e-115">These parameters are described as follows:</span></span> 
  
|<span data-ttu-id="e4a3e-116">**Par de parámetros**</span><span class="sxs-lookup"><span data-stu-id="e4a3e-116">**Parameter pair**</span></span>|<span data-ttu-id="e4a3e-117">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="e4a3e-117">**Description**</span></span>|
|:-----|:-----|
| <span data-ttu-id="e4a3e-118">_cbEidContainer_ y  _lpEidContainer_</span><span class="sxs-lookup"><span data-stu-id="e4a3e-118">_cbEidContainer_ and  _lpEidContainer_</span></span> <br/> |<span data-ttu-id="e4a3e-119">Identificador de entrada del contenedor en el que se debe colocar la nueva entrada.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-119">Entry identifier for the container into which the new entry should be placed.</span></span>  <br/> |
| <span data-ttu-id="e4a3e-120">_cbEidNewEntryTpl_ y  _lpEidNewEntryTpl_</span><span class="sxs-lookup"><span data-stu-id="e4a3e-120">_cbEidNewEntryTpl_ and  _lpEidNewEntryTpl_</span></span> <br/> |<span data-ttu-id="e4a3e-121">Identificador de entrada de la plantilla que se usará para crear la nueva entrada.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-121">Entry identifier for the template to be used to create the new entry.</span></span>  <br/> |
| <span data-ttu-id="e4a3e-122">_lpcbEidNewEntry_ y  _lppEidNewEntry_</span><span class="sxs-lookup"><span data-stu-id="e4a3e-122">_lpcbEidNewEntry_ and  _lppEidNewEntry_</span></span> <br/> |<span data-ttu-id="e4a3e-123">Identificador de entrada de la nueva entrada.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-123">Entry identifier for the new entry.</span></span>  <br/> |
   
<span data-ttu-id="e4a3e-124">Para crear un destinatario para un mensaje saliente, establezca  _cbEidContainer_ en cero y  _lpEidContainer_ en NULL.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-124">To create a recipient for an outgoing message, set  _cbEidContainer_ to zero and  _lpEidContainer_ to NULL.</span></span> <span data-ttu-id="e4a3e-125">**NewEntry** crea un destinatario con un identificador de entrada que cumple con el formato único, el mismo tipo de destinatario que se produce mediante una llamada a **IAddrBook::CreateOneOff**.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-125">**NewEntry** creates a recipient with an entry identifier that conforms to the one-off format, the same type of recipient that is produced by a call to **IAddrBook::CreateOneOff**.</span></span> 
  
<span data-ttu-id="e4a3e-126">Para crear un destinatario que se va a insertar en un contenedor determinado, establezca  _lpEidContainer_ en el identificador de entrada del contenedor y  _cbEidContainer_ en el número de bytes del identificador de entrada del contenedor.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-126">To create a recipient to be inserted into a particular container, set  _lpEidContainer_ to the container's entry identifier and  _cbEidContainer_ to the number of bytes in the container's entry identifier.</span></span> 
  
<span data-ttu-id="e4a3e-127">Para usar una plantilla para crear un destinatario, establezca  _lpEidNewEntryTpl_ en el identificador de entrada de la plantilla que se va a usar y  _cbEidNewEntryTpl_ en el recuento de bytes de este identificador de entrada.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-127">To use a template to create a recipient, set  _lpEidNewEntryTpl_ to the entry identifier of the template to be used and  _cbEidNewEntryTpl_ to the count of bytes in this entry identifier.</span></span> <span data-ttu-id="e4a3e-128">La mayoría de los contenedores de libreta de direcciones modificables admiten una o más plantillas para crear entradas de un tipo determinado.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-128">Most modifiable address book containers support one or more templates for creating entries of a particular type.</span></span> <span data-ttu-id="e4a3e-129">Las plantillas únicas suelen ser cuadros de diálogo, pero no siempre.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-129">One-off templates are typically, but not always, dialog boxes.</span></span> <span data-ttu-id="e4a3e-130">Si se escribe información en la plantilla, se genera un destinatario con una dirección con el formato correcto para el tipo.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-130">Entering information into the template produces a recipient with an address that is correctly formatted for the type.</span></span> 
  
<span data-ttu-id="e4a3e-131">Obtenga el identificador de entrada de plantilla de:</span><span class="sxs-lookup"><span data-stu-id="e4a3e-131">Obtain the template entry identifier from either:</span></span>
  
- <span data-ttu-id="e4a3e-132">La **columna PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) de la tabla de uso único del contenedor, a la que se tiene acceso llamando al método [IMAPIProp::OpenProperty](imapiprop-openproperty.md) del contenedor y **especificando PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) como etiqueta de propiedad y IID_IMAPITable como identificador de interfaz.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-132">The **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) column in the container's one-off table, accessed by calling the container's [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method and specifying **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) as the property tag and IID_IMAPITable as the interface identifier.</span></span> 
    
- <span data-ttu-id="e4a3e-133">Las propiedades **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) y **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) de un proveedor de libreta de direcciones que contiene los identificadores de entrada para el objeto de usuario de mensajería del proveedor y las plantillas de lista de distribución.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-133">An address book provider's **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) and **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) properties which hold the entry identifiers for the provider's messaging user object and distribution list templates.</span></span> 
    
> [!NOTE]
> <span data-ttu-id="e4a3e-134">No confunda el identificador de entrada de una nueva plantilla de entrada con un tipo diferente de identificador de entrada denominado identificador de plantilla.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-134">Do not confuse a new entry template's entry identifier with a different type of entry identifier called a template identifier.</span></span> <span data-ttu-id="e4a3e-135">Los proveedores solo usan un identificador de plantilla para mantener entradas copiadas de otros proveedores; nunca la usan los clientes y no se usa para crear nuevas entradas.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-135">A template identifier is used only by providers to maintain entries copied from other providers; it is never used by clients and it is not used to create new entries.</span></span> 
  
<span data-ttu-id="e4a3e-136">Para permitir al usuario determinar el tipo de entrada que se va a crear, pase cero para  _cbEidNewEntryTpl_ y NULL para  _lpEidNewEntryTpl_.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-136">To enable the user to determine the type of entry to be created, pass zero for  _cbEidNewEntryTpl_ and NULL for  _lpEidNewEntryTpl_.</span></span> <span data-ttu-id="e4a3e-137">Cuando esto ocurre, **NewEntry** muestra un cuadro de diálogo común creado a partir de la tabla única de MAPI, una lista jerárquica de todas las plantillas admitidas por cada proveedor de libreta de direcciones del perfil.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-137">When this occurs, **NewEntry** displays a common dialog box built from MAPI's one-off table — a hierarchical list of all of the templates supported by each address book provider in the profile.</span></span> 
  
<span data-ttu-id="e4a3e-138">Cuando se ha determinado un tipo de dirección, ya sea mediante la configuración del parámetro  _lpEidNewEntryTpl_ o una selección por parte del usuario de la presentación de tabla única, **NewEntry** muestra la plantilla correspondiente mediante su tabla para mostrar.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-138">When an address type has been determined, either through the setting of the  _lpEidNewEntryTpl_ parameter or a selection by the user from the one-off table display, **NewEntry** displays the corresponding template using its display table.</span></span> <span data-ttu-id="e4a3e-139">Todas las nuevas plantillas de entrada **admiten la PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) propiedad.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-139">All new entry templates support the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property.</span></span> 
  
<span data-ttu-id="e4a3e-140">Para que **NewEntry** devuelva el identificador de entrada de la entrada creada, pase una dirección válida para los parámetros _lpcbEidNewEntry_ y _lppEidNewEntry._</span><span class="sxs-lookup"><span data-stu-id="e4a3e-140">To have **NewEntry** return the entry identifier of the created entry, pass a valid address for the  _lpcbEidNewEntry_ and  _lppEidNewEntry_ parameters.</span></span> <span data-ttu-id="e4a3e-141">MAPI coloca el nuevo identificador de entrada en la dirección señalada por  _lppEidNewEntry_ y el número de bytes del nuevo identificador de entrada en la dirección señalada por  _lpcbEidNewEntry_.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-141">MAPI places the new entry identifier at the address pointed to by  _lppEidNewEntry_ and the byte count of the new entry identifier at the address pointed to by  _lpcbEidNewEntry_.</span></span>
  
<span data-ttu-id="e4a3e-142">Llama a [IABContainer::CreateEntry](iabcontainer-createentry.md) para crear un destinatario y guardarlo en un contenedor de libreta de direcciones determinado.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-142">Call [IABContainer::CreateEntry](iabcontainer-createentry.md) to create a recipient and save it into a particular address book container.</span></span> <span data-ttu-id="e4a3e-143">Este método solo se puede usar con contenedores modificables, contenedores que tienen la marca de AB_MODIFIABLE establecida en su propiedad **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="e4a3e-143">You can use this method only with modifiable containers — containers that have the AB_MODIFIABLE flag set in their **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)) property.</span></span> <span data-ttu-id="e4a3e-144">Los proveedores de libreta de direcciones con contenedores no modificables no admiten este método.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-144">Address book providers with nonmodifiable containers do not support this method.</span></span> <span data-ttu-id="e4a3e-145">Especifique el identificador de entrada de la plantilla para crear una entrada del tipo deseado en el _parámetro lpEntryID._</span><span class="sxs-lookup"><span data-stu-id="e4a3e-145">Specify the entry identifier of the template for creating an entry of the desired type in the  _lpEntryID_ parameter.</span></span> 
  
<span data-ttu-id="e4a3e-146">En el  _parámetro ulCreateFlags,_ especifique el tipo de comprobación de entrada duplicada necesaria y si las entradas nuevas deben reemplazar a las existentes.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-146">In the  _ulCreateFlags_ parameter, specify the type of duplicate entry checking required and whether or not new entries should replace existing ones.</span></span> <span data-ttu-id="e4a3e-147">Si **CreateEntry** no puede crear un nuevo objeto debido a la comprobación de entrada duplicada impuesta por el proveedor, no espere que se devuelva un error o una advertencia.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-147">If **CreateEntry** fails to create a new object because of the duplicate entry checking imposed by the provider, do not expect to see an error or warning returned.</span></span> <span data-ttu-id="e4a3e-148">En estas condiciones, los proveedores devuelven un código de éxito.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-148">Under these conditions, providers return a success code.</span></span> 
  
<span data-ttu-id="e4a3e-149">Si está trabajando directamente con un contenedor y conoce exactamente los tipos de direcciones que puede crear el contenedor, puede llamar a **IABContainer::CreateEntry** y pasar el identificador de entrada de la plantilla adecuada.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-149">If you are working directly with a container and you know exactly the types of addresses that the container can create, you can call **IABContainer::CreateEntry** and pass the entry identifier for the appropriate template.</span></span> <span data-ttu-id="e4a3e-150">El proveedor de libreta de direcciones establece algunas propiedades predeterminadas iniciales; puede llamar a **SetProps para** establecer otros.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-150">The address book provider sets some initial default properties; you can call **SetProps** to set others.</span></span> <span data-ttu-id="e4a3e-151">El usuario nunca está implicado.</span><span class="sxs-lookup"><span data-stu-id="e4a3e-151">The user is never involved.</span></span> 
  

