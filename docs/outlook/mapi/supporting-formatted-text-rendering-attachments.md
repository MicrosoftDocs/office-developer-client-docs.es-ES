---
title: Compatibilidad con texto con formato Representaci�n de los datos adjuntos
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 68abe85b-5dc0-40d0-8917-30ea002aa816
description: '�ltima modificaci�n: s�bado, 23 de julio de 2011'
ms.openlocfilehash: 5f03530f994fd13e7dc4c7eaa4124900c28e613b
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33405299"
---
# <a name="supporting-formatted-text-rendering-attachments"></a><span data-ttu-id="1e1f1-103">Compatibilidad con texto con formato: representar datos adJuntos</span><span class="sxs-lookup"><span data-stu-id="1e1f1-103">Supporting Formatted Text: Rendering Attachments</span></span>

  
  
<span data-ttu-id="1e1f1-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="1e1f1-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="1e1f1-105">Una aplicación cliente que se refiere a dónde se representan los datos adjuntos en un mensaje establece la propiedad **PR_RENDERING_POSITION** ([PidTagRenderingPosition](pidtagrenderingposition-canonical-property.md)) para estos datos adjuntos durante la composición del mensaje.</span><span class="sxs-lookup"><span data-stu-id="1e1f1-105">A client application that cares about where in a message its attachments are rendered sets the **PR_RENDERING_POSITION** ([PidTagRenderingPosition](pidtagrenderingposition-canonical-property.md)) property for these attachments during message composition.</span></span> <span data-ttu-id="1e1f1-106">Un cliente que no necesita conocer la colocaci�n de representaci�n sale de esta propiedad no definidas.</span><span class="sxs-lookup"><span data-stu-id="1e1f1-106">A client that does not care about rendering placement leaves this property unset.</span></span>
  
<span data-ttu-id="1e1f1-p102">Cuando un cliente, abre un mensaje con datos adjuntos, intenta recuperar la propiedad de **PR_RENDERING_POSITION** de cada documento adjunto para determinar donde se deben representar los datos adjuntos en el texto del mensaje. Un cliente puede usar uno de los m�todos siguientes para recuperar **PR_RENDERING_POSITION**:</span><span class="sxs-lookup"><span data-stu-id="1e1f1-p102">When a client opens a message with attachments, it attempts to retrieve each attachment's **PR_RENDERING_POSITION** property to determine where in the message text the attachment should be rendered. A client can use one of the following methods to retrieve **PR_RENDERING_POSITION**:</span></span>
  
- <span data-ttu-id="1e1f1-109">[IMAPIProp::GetProps](imapiprop-getprops.md) on the open attachment to retrieve the **PR_RENDERING_POSITION** property.</span><span class="sxs-lookup"><span data-stu-id="1e1f1-109">[IMAPIProp::GetProps](imapiprop-getprops.md) on the open attachment to retrieve the **PR_RENDERING_POSITION** property.</span></span> 
    
- <span data-ttu-id="1e1f1-p103">[IMessage::GetAttachmentTable](imessage-getattachmenttable.md) on the open message to retrieve its attachment table. **PR_RENDERING_POSITION** is a required column in all attachment tables. This is the preferred method because it results in better performance.</span><span class="sxs-lookup"><span data-stu-id="1e1f1-p103">[IMessage::GetAttachmentTable](imessage-getattachmenttable.md) on the open message to retrieve its attachment table. **PR_RENDERING_POSITION** is a required column in all attachment tables. This is the preferred method because it results in better performance.</span></span> 
    
<span data-ttu-id="1e1f1-p104">Los almacenes de mensajes RTF compatible pueden elegir si se debe devolver un valor preciso o aproximado para **PR_RENDERING_POSITION**. Dado que los almacenes de mensajes volver a calcular el valor de **PR_RENDERING_POSITION** de datos adjuntos cuando se le pida la propiedad del mensaje **PR_BODY**, algunos mensajes RTF cuenta almacena s�lo se establece la posici�n de la precisi�n de representaci�n cuando un cliente solicita primero **PR_BODY**garant�a. Se permiten los almacenes de mensajes RTF para proporcionar a los clientes con los valores de posici�n de representaci�n aproximada para mejorar el rendimiento. Proporcionar un aproximado en lugar de una posici�n de representaci�n precisa ahorra tiempo y es suficiente para la mayor�a de las situaciones.</span><span class="sxs-lookup"><span data-stu-id="1e1f1-p104">RTF-aware message stores can choose whether to return an accurate or approximate value for **PR_RENDERING_POSITION**. Because message stores recalculate an attachment's **PR_RENDERING_POSITION** value when asked for the message's **PR_BODY** property, some RTF-aware message stores only guarantee the accuracy of rendering positions when a client asks first for **PR_BODY**. RTF-aware message stores are allowed to provide clients with approximate rendering position values to enhance performance. Providing an approximate rather than an accurate rendering position saves time and is sufficient for most situations.</span></span> 
  
<span data-ttu-id="1e1f1-p105">Los almacenes de mensajes RTF cuenta deben basar su aproximaci�n en el valor especificado por el cliente responsable de la creaci�n de los datos adjuntos. Aunque todos los clientes deben establecer **PR_RENDERING_POSITION**, los proveedores de almac�n de mensajes deben estar preparados para abordar los problemas con la posibilidad de que su ausencia. Cuando el cliente no establece **PR_RENDERING_POSITION**, un almac�n de mensajes puede establecer a -1 para indicar que la posici�n de representaci�n no est� comprendido en el texto del mensaje. En cualquier lugar dentro del mensaje seg�n el cliente se pueden mostrar los datos adjuntos con una posici�n de representaci�n de -1. Muchos clientes colocar estos tipos de datos adjuntos en la parte superior del mensaje.</span><span class="sxs-lookup"><span data-stu-id="1e1f1-p105">RTF-aware message stores should base their approximation on the value specified by the client responsible for creating the attachment. Although all clients should set **PR_RENDERING_POSITION**, message store providers should be prepared to deal with the possibility of its absence. When the client does not set **PR_RENDERING_POSITION**, a message store can set it to -1 to indicate that the rendering position is not within the message text. Attachments with a rendering position of -1 can be displayed at any place within the message depending on the client. Many clients position these types of attachments at the top of the message.</span></span>
  
<span data-ttu-id="1e1f1-122">El grado de precisión de una propiedad **PR_RENDERING_POSITION** depende de si un almacén de mensajes guarda o no las propiedades **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) y **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) de un mensaje o sólo **PR_RTF_COMPRESSED**.</span><span class="sxs-lookup"><span data-stu-id="1e1f1-122">The degree of accuracy for a **PR_RENDERING_POSITION** property depends on whether or not a message store saves both a message's **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) and **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) properties or only **PR_RTF_COMPRESSED**.</span></span> <span data-ttu-id="1e1f1-123">Si el cliente genera **PR_BODY** y guarda en el almac�n de mensajes junto con el texto con formato, las posiciones de representaci�n ser� precisas.</span><span class="sxs-lookup"><span data-stu-id="1e1f1-123">If the client generates **PR_BODY** and the message store saves it along with the formatted text, the rendering positions will be accurate.</span></span> <span data-ttu-id="1e1f1-124">Sin embargo, si el almac�n de mensajes debe generar su propia versi�n del **PR_BODY** porque s�lo guarda **PR_RTF_COMPRESSED**, es probable que las posiciones de representaci�n algo imprecisos.</span><span class="sxs-lookup"><span data-stu-id="1e1f1-124">However, if the message store must generate its own version of **PR_BODY** because it only saves **PR_RTF_COMPRESSED**, it is probable that the rendering positions will be somewhat inaccurate.</span></span> <span data-ttu-id="1e1f1-125">Esto es debido a las diferencias en la forma en que los clientes y los proveedores de almac�n de mensajes generan la propiedad **PR_BODY**.</span><span class="sxs-lookup"><span data-stu-id="1e1f1-125">This is because of the differences in the way that clients and message store providers generate the **PR_BODY** property.</span></span> 
  
<span data-ttu-id="1e1f1-p107">To calculate an accurate **PR_RENDERING_POSITION** value, an RTF-aware store uses a tag embedded in the formatted text. The utility function **RTFSync** can be called to perform this calculation and update an attachment's rendering position. Depending on the amount of state information available, the message store can pass either RTF_SYNC_BODY_CHANGED, RTF_SYNC_RTF_CHANGED, or both values to [RTFSync](rtfsync.md).</span><span class="sxs-lookup"><span data-stu-id="1e1f1-p107">To calculate an accurate **PR_RENDERING_POSITION** value, an RTF-aware store uses a tag embedded in the formatted text. The utility function **RTFSync** can be called to perform this calculation and update an attachment's rendering position. Depending on the amount of state information available, the message store can pass either RTF_SYNC_BODY_CHANGED, RTF_SYNC_RTF_CHANGED, or both values to [RTFSync](rtfsync.md).</span></span>
  

