---
title: Desarrollar un proveedor de almacén de mensajes MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83692674-0b5a-468d-9cd7-a2ac3d140bda
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: 36233d51f47c53d6a69494c0fcd799a7c83add29
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/23/2018
ms.locfileid: "22567877"
---
# <a name="developing-a-mapi-message-store-provider"></a><span data-ttu-id="ee366-103">Desarrollar un proveedor de almacén de mensajes MAPI</span><span class="sxs-lookup"><span data-stu-id="ee366-103">Developing a MAPI message store provider</span></span>
  
<span data-ttu-id="ee366-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="ee366-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="ee366-105">Al igual que otros proveedores de servicios MAPI, los almacenes de mensajes son bibliotecas de vínculos dinámicos (DLL) que presentan los servicios de un mecanismo de almacenamiento subyacente para las aplicaciones cliente MAPI y la cola de MAPI.</span><span class="sxs-lookup"><span data-stu-id="ee366-105">Like other MAPI service providers, message stores are dynamic-link libraries (DLLs) that present the services of an underlying storage mechanism to MAPI client applications and the MAPI spooler.</span></span> <span data-ttu-id="ee366-106">El proveedor de almacenamiento de mensaje presenta el mecanismo de almacenamiento subyacente como un conjunto jerárquico de carpetas y los mensajes que pueden usar los clientes MAPI y la cola de MAPI.</span><span class="sxs-lookup"><span data-stu-id="ee366-106">The message store provider presents the underlying storage mechanism as a hierarchical set of folders and messages that MAPI clients and the MAPI spooler can use.</span></span>
  
<span data-ttu-id="ee366-107">En la siguiente ilustración muestra la arquitectura básica de almacén de mensajes MAPI.</span><span class="sxs-lookup"><span data-stu-id="ee366-107">The following illustration shows the basic MAPI message store architecture.</span></span>
  
<span data-ttu-id="ee366-108">**Arquitectura del almacén de mensajes**</span><span class="sxs-lookup"><span data-stu-id="ee366-108">**Message store architecture**</span></span>
  
<span data-ttu-id="ee366-109">![Arquitectura del almacén de mensajes] (media/storearc.gif "Arquitectura del almacén de mensajes")</span><span class="sxs-lookup"><span data-stu-id="ee366-109">![Message store architecture](media/storearc.gif "Message store architecture")</span></span>
  
<span data-ttu-id="ee366-110">Puede implementar un proveedor de almacén de mensajes mediante el uso de cualquier tipo de le apetece un mecanismo de almacenamiento subyacente.</span><span class="sxs-lookup"><span data-stu-id="ee366-110">You can implement a message store provider by using any sort of underlying storage mechanism you like.</span></span> <span data-ttu-id="ee366-111">Sin embargo, debe tener en cuenta cuestiones de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="ee366-111">However, you need to be aware of performance concerns.</span></span> <span data-ttu-id="ee366-112">Además, el mecanismo de almacenamiento subyacente debe presentarse como una colección jerárquica de objetos MAPI.</span><span class="sxs-lookup"><span data-stu-id="ee366-112">In addition, the underlying storage mechanism must be presented as a hierarchical collection of MAPI objects.</span></span> <span data-ttu-id="ee366-113">Estos requerimientos significan que los almacenes de mensajes normalmente se implementan mediante el uso de un producto de base de datos existente que admite el almacenamiento jerárquico de objetos en la base de datos y que tiene una interfaz de programación o la estructura de archivos bien definido.</span><span class="sxs-lookup"><span data-stu-id="ee366-113">These requirements mean that message stores are typically implemented by using an existing database product that supports hierarchical storage of objects in the database and that has a programming interface or well-defined file structure.</span></span> <span data-ttu-id="ee366-114">Por ejemplo, las bases de datos de Microsoft Office Access, SQL y Oracle pueden usarse como el mecanismo de almacenamiento subyacente.</span><span class="sxs-lookup"><span data-stu-id="ee366-114">For example, Microsoft Office Access, SQL, and Oracle databases can be used as the underlying storage mechanism.</span></span> <span data-ttu-id="ee366-115">Algunos productos de la base de datos tienen conjuntos de características que hacen que sea más fácil implementar características MAPI, por lo que su elección de producto de la base de datos puede verse afectada por las características que debe admitir su proveedor de almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="ee366-115">Some database products have feature sets that make it easier to implement MAPI features, so your choice of database product may be affected by the features that your message store provider needs to support.</span></span>
  
<span data-ttu-id="ee366-116">Uso de una base de datos existente como el guarda de mecanismo de almacenamiento subyacente que funcionan porque es suele ser más fácil a los objetos de base de datos está presente a los clientes MAPI como objetos MAPI que implementar su propio mecanismo de almacenamiento de información jerárquico.</span><span class="sxs-lookup"><span data-stu-id="ee366-116">Using an existing database as the underlying storage mechanism saves you work because it is usually easier to present database objects to MAPI clients as MAPI objects than to implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="ee366-117">Esto permite tratar las operaciones de MAPI en un nivel superior si implementar su propio mecanismo de almacenamiento de información jerárquico.</span><span class="sxs-lookup"><span data-stu-id="ee366-117">Doing this enables you to treat MAPI operations at a higher level than if you implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="ee366-118">Por ejemplo, busca un mensaje con una línea de asunto concreto se convierte en una cuestión bastante sencilla de construcción y envío de una consulta de base de datos adecuada, en lugar de implementar complejas rutinas para buscar el mecanismo de almacenamiento de información jerárquico.</span><span class="sxs-lookup"><span data-stu-id="ee366-118">For example, searching for a message with a particular subject line becomes a fairly simple matter of constructing and submitting an appropriate database query, rather than implementing complex routines to search your hierarchical storage mechanism.</span></span>
  
<span data-ttu-id="ee366-119">Los proveedores de almacén de mensajes comunican con los clientes MAPI y la cola de MAPI para realizar operaciones en carpetas y los objetos.</span><span class="sxs-lookup"><span data-stu-id="ee366-119">Message store providers communicate with MAPI clients and the MAPI spooler to perform operations on folders and objects.</span></span> <span data-ttu-id="ee366-120">El proveedor de almacén de mensajes traduce estas operaciones en las operaciones de nivel inferiores en el mecanismo de almacenamiento subyacente.</span><span class="sxs-lookup"><span data-stu-id="ee366-120">The message store provider translates those operations into lower level operations on the underlying storage mechanism.</span></span> <span data-ttu-id="ee366-121">La cola MAPI normalmente se comunica con el proveedor de almacén de mensajes al enviar y recibir mensajes.</span><span class="sxs-lookup"><span data-stu-id="ee366-121">The MAPI spooler typically communicates with the message store provider while sending and receiving messages.</span></span> <span data-ttu-id="ee366-122">Normalmente, los clientes MAPI se comunican con los proveedores de almacén de mensajes para manipular la jerarquía de carpetas y para leer, editar, eliminar y enviar mensajes.</span><span class="sxs-lookup"><span data-stu-id="ee366-122">MAPI clients typically communicate with message store providers to manipulate the folder hierarchy and to read, edit, delete, and send messages.</span></span>
  
<span data-ttu-id="ee366-123">Tanto la cola MAPI y los clientes MAPI comunican con el proveedor de almacenamiento de mensaje para crear mensajes nuevos.</span><span class="sxs-lookup"><span data-stu-id="ee366-123">Both the MAPI spooler and MAPI clients communicate with the message store provider to create new messages.</span></span> <span data-ttu-id="ee366-124">Las aplicaciones cliente de hacerlo cuando los usuarios redacción un mensaje.</span><span class="sxs-lookup"><span data-stu-id="ee366-124">Client applications do this when users compose a message.</span></span> <span data-ttu-id="ee366-125">La cola MAPI hace cuando recibe un mensaje entrante.</span><span class="sxs-lookup"><span data-stu-id="ee366-125">The MAPI spooler does this when it receives an incoming message.</span></span> <span data-ttu-id="ee366-126">En cualquier caso, normalmente se crea el nuevo mensaje en la carpeta Bandeja de entrada del almacén de mensajes, si hay alguno.</span><span class="sxs-lookup"><span data-stu-id="ee366-126">In either case, the new message is usually created in the Inbox folder of the message store, if there is one.</span></span>
  
<span data-ttu-id="ee366-127">Los proveedores de almacén de mensajes realizar un uso intensivo de tablas, las carpetas, los mensajes y las propiedades MAPI.</span><span class="sxs-lookup"><span data-stu-id="ee366-127">Message store providers make heavy use of MAPI tables, folders, messages, and properties.</span></span> <span data-ttu-id="ee366-128">Los detalles de implementación para aquellos objetos que se documentan en [Tablas de MAPI](mapi-tables.md), [Las carpetas de MAPI](mapi-folders.md), [Los mensajes de MAPI](mapi-messages.md)e [Información general sobre la propiedad de MAPI](mapi-property-overview.md).</span><span class="sxs-lookup"><span data-stu-id="ee366-128">The implementation details for those objects are documented in [MAPI Tables](mapi-tables.md), [MAPI Folders](mapi-folders.md), [MAPI Messages](mapi-messages.md), and [MAPI Property Overview](mapi-property-overview.md).</span></span> <span data-ttu-id="ee366-129">Debe familiarizarse con la que el material antes de intentar implementar un proveedor de almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="ee366-129">You should familiarize yourself with that material before attempting to implement a message store provider.</span></span>
  
<span data-ttu-id="ee366-130">Hay dos tipos importantes de los proveedores de almacén de mensajes: aquellos que pueden actuar como valor predeterminado de un usuario de mensajes almacén y aquellos que no se puede.</span><span class="sxs-lookup"><span data-stu-id="ee366-130">There are two important types of message store providers: those that can act as a user's default message store and those that cannot.</span></span> <span data-ttu-id="ee366-131">Un almacén de mensajes predeterminado es uno en cliente que las aplicaciones y la cola MAPI pueden realizar cualquier tarea de mensajería, como recibir mensajes o la creación de carpetas.</span><span class="sxs-lookup"><span data-stu-id="ee366-131">A default message store is one in which client applications and the MAPI spooler can perform any messaging task, such as receiving messages or creating folders.</span></span> <span data-ttu-id="ee366-132">Un proveedor de almacén de mensajes predeterminado debe admitir varias características que el número mínimo necesario para todos los proveedores de almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="ee366-132">A default message store provider must support several more features than the minimum number required for all message store providers.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="ee366-133">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="ee366-133">See also</span></span>

- [<span data-ttu-id="ee366-134">Conceptos MAPI</span><span class="sxs-lookup"><span data-stu-id="ee366-134">MAPI concepts</span></span>](mapi-concepts.md)

