---
title: Adición o eliminación de proveedores en un servicio de mensajes
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 44bb4d34-ca96-4d5a-93fe-85e09bd7971d
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: ed5ea8bdfcbdaaa6b6abd81a39f0e8df50d3b314
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/23/2019
ms.locfileid: "32329564"
---
# <a name="adding-or-deleting-providers-in-a-message-service"></a><span data-ttu-id="0438e-103">Adición o eliminación de proveedores en un servicio de mensajes</span><span class="sxs-lookup"><span data-stu-id="0438e-103">Adding or Deleting Providers in a Message Service</span></span>

  
  
<span data-ttu-id="0438e-104">**Hace referencia a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="0438e-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="0438e-105">Para agregar o eliminar proveedores de servicios en un servicio de mensajes, use la interfaz [IProviderAdmin: IUnknown](iprovideradminiunknown.md) .</span><span class="sxs-lookup"><span data-stu-id="0438e-105">To add or delete service providers in a message service, use the [IProviderAdmin : IUnknown](iprovideradminiunknown.md) interface.</span></span> <span data-ttu-id="0438e-106">Puede recuperar un puntero **IProviderAdmin** llamando a [IMsgServiceAdmin:: AdminProviders](imsgserviceadmin-adminproviders.md).</span><span class="sxs-lookup"><span data-stu-id="0438e-106">You can retrieve an **IProviderAdmin** pointer by calling [IMsgServiceAdmin::AdminProviders](imsgserviceadmin-adminproviders.md).</span></span> <span data-ttu-id="0438e-107">La tabla de proveedores, a la que se puede obtener acceso a través de [IProviderAdmin:: GetProviderTable](iprovideradmin-getprovidertable.md), incluye información sobre los proveedores de servicios instalados actualmente en el servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="0438e-107">The provider table, accessable through [IProviderAdmin::GetProviderTable](iprovideradmin-getprovidertable.md), lists information about the service providers currently installed in the message service.</span></span> <span data-ttu-id="0438e-108">Los clientes y los proveedores de servicios pueden usar la tabla de proveedores para obtener acceso al nombre del archivo DLL del proveedor, por ejemplo, el **MAPIUID**, el nombre para mostrar y el tipo de proveedor, así como la información sobre el servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="0438e-108">Clients and service providers can use the provider table to access the name of the provider DLL file, for example, or the **MAPIUID**, display name, and type of the provider as well as information about the message service.</span></span> <span data-ttu-id="0438e-109">Para obtener más información, vea [tablas de proveedor](provider-tables.md).</span><span class="sxs-lookup"><span data-stu-id="0438e-109">For more information, see [Provider Tables](provider-tables.md).</span></span>
  
 <span data-ttu-id="0438e-110">**Para agregar o eliminar un proveedor de servicios en un servicio de mensajes**</span><span class="sxs-lookup"><span data-stu-id="0438e-110">**To add or delete a service provider in a message service**</span></span>
  
1. <span data-ttu-id="0438e-111">Llame al método **AdminServices** para tener acceso a un objeto de administración del servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="0438e-111">Call the **AdminServices** method to access a message service administration object.</span></span> 
    
2. <span data-ttu-id="0438e-112">Llame a [IMsgServiceAdmin:: GetMsgServiceTable](imsgserviceadmin-getmsgservicetable.md) para obtener acceso a la tabla de servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="0438e-112">Call [IMsgServiceAdmin::GetMsgServiceTable](imsgserviceadmin-getmsgservicetable.md) to access the message service table.</span></span> 
    
3. <span data-ttu-id="0438e-113">Cree una restricción de propiedad con una estructura [SPropertyRestriction](spropertyrestriction.md) que coincida con **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) o **PR_SERVICE_NAME** ([PidTagServiceName](pidtagservicename-canonical-property.md)) con el nombre del servicio de mensajes que se va a cambiado.</span><span class="sxs-lookup"><span data-stu-id="0438e-113">Build a property restriction using an [SPropertyRestriction](spropertyrestriction.md) structure that matches **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) or **PR_SERVICE_NAME** ([PidTagServiceName](pidtagservicename-canonical-property.md)) with the name of the message service to be modified.</span></span> 
    
4. <span data-ttu-id="0438e-114">Llame al método [IMAPITable:: FindRow](imapitable-findrow.md) de la tabla del servicio de mensajes para localizar la fila en la tabla que representa el servicio de mensajes de destino.</span><span class="sxs-lookup"><span data-stu-id="0438e-114">Call the message service table's [IMAPITable::FindRow](imapitable-findrow.md) method to locate the row in the table that represents the targeted message service.</span></span> 
    
5. <span data-ttu-id="0438e-115">Llamar a [IMsgServiceAdmin:: AdminProviders](imsgserviceadmin-adminproviders.md) para recuperar un puntero **IProviderAdmin** .</span><span class="sxs-lookup"><span data-stu-id="0438e-115">Call [IMsgServiceAdmin::AdminProviders](imsgserviceadmin-adminproviders.md) to retrieve an **IProviderAdmin** pointer.</span></span> <span data-ttu-id="0438e-116">Pase la columna **PR_SERVICE_UID** ([PidTagServiceUid](pidtagserviceuid-canonical-property.md)) de la fila de la tabla de servicios de mensajes como el parámetro _lpUID_ .</span><span class="sxs-lookup"><span data-stu-id="0438e-116">Pass the **PR_SERVICE_UID** ([PidTagServiceUid](pidtagserviceuid-canonical-property.md)) column from the message service table row as the  _lpUID_ parameter.</span></span> 
    
6. <span data-ttu-id="0438e-117">Llame a [IProviderAdmin:: GetProviderTable](iprovideradmin-getprovidertable.md) para obtener acceso a la tabla del proveedor.</span><span class="sxs-lookup"><span data-stu-id="0438e-117">Call [IProviderAdmin::GetProviderTable](iprovideradmin-getprovidertable.md) to access the provider table.</span></span> 
    
7. <span data-ttu-id="0438e-118">Cree una restricción de propiedad con una estructura SPropertyRestriction que coincida con **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) o **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)) con el nombre del proveedor de servicios que se va a Agregar o eliminar.</span><span class="sxs-lookup"><span data-stu-id="0438e-118">Build a property restriction using an SPropertyRestriction structure that matches **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) or **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)) with the name of the service provider to be added or deleted.</span></span> 
    
8. <span data-ttu-id="0438e-119">Llame al método [IMAPITable:: FindRow](imapitable-findrow.md) de la tabla del proveedor para localizar la fila en la tabla que representa al proveedor de servicios de destino.</span><span class="sxs-lookup"><span data-stu-id="0438e-119">Call the provider table's [IMAPITable::FindRow](imapitable-findrow.md) method to locate the row in the table that represents the targeted service provider.</span></span> 
    
9. <span data-ttu-id="0438e-120">Llame a [IProviderAdmin:: CreateProvider](iprovideradmin-createprovider.md) para agregar el proveedor o [IProviderAdmin::D eleteprovider](iprovideradmin-deleteprovider.md) para quitarlo del servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="0438e-120">Call [IProviderAdmin::CreateProvider](iprovideradmin-createprovider.md) to add the provider or [IProviderAdmin::DeleteProvider](iprovideradmin-deleteprovider.md) to remove it from the message service.</span></span> <span data-ttu-id="0438e-121">Para **CreateProvider**, pase la propiedad **PR_DISPLAY_NAME** del proveedor como el parámetro _lpszProvider_ .</span><span class="sxs-lookup"><span data-stu-id="0438e-121">For **CreateProvider**, pass the provider's **PR_DISPLAY_NAME** property as the  _lpszProvider_ parameter.</span></span> <span data-ttu-id="0438e-122">Para cualquiera de estos métodos, pase la propiedad **PR_SERVICE_UID** del proveedor como el parámetro _lpUID_ .</span><span class="sxs-lookup"><span data-stu-id="0438e-122">For either method, pass the provider's **PR_SERVICE_UID** property as the  _lpUID_ parameter.</span></span> <span data-ttu-id="0438e-123">Una vez que se ha agregado o eliminado el proveedor de servicios, el cambio no se apreciará hasta que se cree una nueva sesión.</span><span class="sxs-lookup"><span data-stu-id="0438e-123">After the service provider has been added or deleted, the change will not be apparent until a new session is created.</span></span> 
    
<span data-ttu-id="0438e-124">Otra técnica para agregar un proveedor de servicios, en concreto un proveedor de almacenamiento de mensajes, a un perfil implica crear un identificador de entrada para el proveedor.</span><span class="sxs-lookup"><span data-stu-id="0438e-124">Another technique for adding a service provider, specifically a message store provider, to a profile involves constructing an entry identifier for the provider.</span></span> <span data-ttu-id="0438e-125">Dado que la creación de un identificador de entrada requiere conocimientos de su formato, esta técnica solo se puede usar si el proveedor de servicios ha hecho público su formato de identificador de entrada.</span><span class="sxs-lookup"><span data-stu-id="0438e-125">Because constructing an entry identifier requires knowledge of its format, this technique can only be used if the service provider has made its entry identifier format public.</span></span> 
  
<span data-ttu-id="0438e-126">Con el identificador de entrada recién construido, un cliente puede llamar a [IMAPISession:: OpenMsgStore](imapisession-openmsgstore.md).</span><span class="sxs-lookup"><span data-stu-id="0438e-126">With the newly constructed entry identifier, a client can call [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md).</span></span> <span data-ttu-id="0438e-127">MAPI crea automáticamente una sección de perfil en el perfil del proveedor de servicios, pero no la agrega a un servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="0438e-127">MAPI automatically creates a profile section in the profile for the service provider, but does not add it to a message service.</span></span> 
  
<span data-ttu-id="0438e-128">Algunos servicios de mensajes no permiten este tipo de modificación dinámica; Si se admite o no es el servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="0438e-128">Some message services do not allow this type of dynamic modification; whether or not it is supported is up to the message service.</span></span> <span data-ttu-id="0438e-129">Otra característica que puede o no puede admitirse es la capacidad de tener acceso directamente a las secciones de perfil privado del servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="0438e-129">Another feature that may or may not be supported is the ability to directly access a message service's private profile sections.</span></span> <span data-ttu-id="0438e-130">Si el servicio de mensajes que está usando permite este tipo de acceso, publicará el **GUID** que representa la sección privada en el archivo MAPISVC. inf.</span><span class="sxs-lookup"><span data-stu-id="0438e-130">If the message service you are using permits such access, it will publish the **GUID** that represents the private section in MAPISVC.INF.</span></span> <span data-ttu-id="0438e-131">Puede pasar este **GUID** en una llamada a [IProviderAdmin:: OpenProfileSection](iprovideradmin-openprofilesection.md) para obtener acceso a la sección de perfil.</span><span class="sxs-lookup"><span data-stu-id="0438e-131">You can pass this **GUID** in a call to [IProviderAdmin::OpenProfileSection](iprovideradmin-openprofilesection.md) to access the profile section.</span></span> 
  

