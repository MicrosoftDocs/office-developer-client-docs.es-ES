---
title: Agregar o eliminar proveedores en un servicio de mensajes
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 44bb4d34-ca96-4d5a-93fe-85e09bd7971d
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: ed5ea8bdfcbdaaa6b6abd81a39f0e8df50d3b314
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33433426"
---
# <a name="adding-or-deleting-providers-in-a-message-service"></a><span data-ttu-id="40761-103">Agregar o eliminar proveedores en un servicio de mensajes</span><span class="sxs-lookup"><span data-stu-id="40761-103">Adding or Deleting Providers in a Message Service</span></span>

  
  
<span data-ttu-id="40761-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="40761-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="40761-105">Para agregar o eliminar proveedores de servicios en un servicio de mensajes, use la [interfaz IProviderAdmin : IUnknown.](iprovideradminiunknown.md)</span><span class="sxs-lookup"><span data-stu-id="40761-105">To add or delete service providers in a message service, use the [IProviderAdmin : IUnknown](iprovideradminiunknown.md) interface.</span></span> <span data-ttu-id="40761-106">Puede recuperar un puntero **IProviderAdmin** llamando a [IMsgServiceAdmin::AdminProviders](imsgserviceadmin-adminproviders.md).</span><span class="sxs-lookup"><span data-stu-id="40761-106">You can retrieve an **IProviderAdmin** pointer by calling [IMsgServiceAdmin::AdminProviders](imsgserviceadmin-adminproviders.md).</span></span> <span data-ttu-id="40761-107">La tabla del proveedor, a la que se puede obtener acceso a través [de IProviderAdmin::GetProviderTable,](iprovideradmin-getprovidertable.md)muestra información sobre los proveedores de servicios instalados actualmente en el servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="40761-107">The provider table, accessable through [IProviderAdmin::GetProviderTable](iprovideradmin-getprovidertable.md), lists information about the service providers currently installed in the message service.</span></span> <span data-ttu-id="40761-108">Los clientes y proveedores de servicios pueden usar la tabla de proveedores para obtener acceso al nombre del archivo DLL del proveedor, por ejemplo, o **mapiuid**, nombre para mostrar y tipo del proveedor, así como información sobre el servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="40761-108">Clients and service providers can use the provider table to access the name of the provider DLL file, for example, or the **MAPIUID**, display name, and type of the provider as well as information about the message service.</span></span> <span data-ttu-id="40761-109">Para obtener más información, vea [Tablas de proveedor](provider-tables.md).</span><span class="sxs-lookup"><span data-stu-id="40761-109">For more information, see [Provider Tables](provider-tables.md).</span></span>
  
 <span data-ttu-id="40761-110">**Para agregar o eliminar un proveedor de servicios en un servicio de mensajes**</span><span class="sxs-lookup"><span data-stu-id="40761-110">**To add or delete a service provider in a message service**</span></span>
  
1. <span data-ttu-id="40761-111">Llame al **método AdminServices** para obtener acceso a un objeto de administración del servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="40761-111">Call the **AdminServices** method to access a message service administration object.</span></span> 
    
2. <span data-ttu-id="40761-112">Llame [a IMsgServiceAdmin::GetMsgServiceTable para](imsgserviceadmin-getmsgservicetable.md) obtener acceso a la tabla de servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="40761-112">Call [IMsgServiceAdmin::GetMsgServiceTable](imsgserviceadmin-getmsgservicetable.md) to access the message service table.</span></span> 
    
3. <span data-ttu-id="40761-113">Cree una restricción de propiedad mediante una estructura [SPropertyRestriction](spropertyrestriction.md) que coincida con **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) o **PR_SERVICE_NAME** ([PidTagServiceName](pidtagservicename-canonical-property.md)) con el nombre del servicio de mensajes que se va a modificar.</span><span class="sxs-lookup"><span data-stu-id="40761-113">Build a property restriction using an [SPropertyRestriction](spropertyrestriction.md) structure that matches **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) or **PR_SERVICE_NAME** ([PidTagServiceName](pidtagservicename-canonical-property.md)) with the name of the message service to be modified.</span></span> 
    
4. <span data-ttu-id="40761-114">Llame al método [IMAPITable::FindRow](imapitable-findrow.md) de la tabla de servicio de mensajes para buscar la fila de la tabla que representa el servicio de mensajes de destino.</span><span class="sxs-lookup"><span data-stu-id="40761-114">Call the message service table's [IMAPITable::FindRow](imapitable-findrow.md) method to locate the row in the table that represents the targeted message service.</span></span> 
    
5. <span data-ttu-id="40761-115">Llama [a IMsgServiceAdmin::AdminProviders](imsgserviceadmin-adminproviders.md) para recuperar un **puntero IProviderAdmin.**</span><span class="sxs-lookup"><span data-stu-id="40761-115">Call [IMsgServiceAdmin::AdminProviders](imsgserviceadmin-adminproviders.md) to retrieve an **IProviderAdmin** pointer.</span></span> <span data-ttu-id="40761-116">Pase la **PR_SERVICE_UID** ([PidTagServiceUid](pidtagserviceuid-canonical-property.md)) de la fila de tabla de servicio de mensajes como parámetro _lpUID._</span><span class="sxs-lookup"><span data-stu-id="40761-116">Pass the **PR_SERVICE_UID** ([PidTagServiceUid](pidtagserviceuid-canonical-property.md)) column from the message service table row as the  _lpUID_ parameter.</span></span> 
    
6. <span data-ttu-id="40761-117">Llame [a IProviderAdmin::GetProviderTable para](iprovideradmin-getprovidertable.md) obtener acceso a la tabla del proveedor.</span><span class="sxs-lookup"><span data-stu-id="40761-117">Call [IProviderAdmin::GetProviderTable](iprovideradmin-getprovidertable.md) to access the provider table.</span></span> 
    
7. <span data-ttu-id="40761-118">Cree una restricción de propiedad mediante una estructura SPropertyRestriction que coincida con **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) o **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)) con el nombre del proveedor de servicios que se va a agregar o eliminar.</span><span class="sxs-lookup"><span data-stu-id="40761-118">Build a property restriction using an SPropertyRestriction structure that matches **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) or **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)) with the name of the service provider to be added or deleted.</span></span> 
    
8. <span data-ttu-id="40761-119">Llame al método [IMAPITable::FindRow](imapitable-findrow.md) de la tabla de proveedor para buscar la fila de la tabla que representa el proveedor de servicios de destino.</span><span class="sxs-lookup"><span data-stu-id="40761-119">Call the provider table's [IMAPITable::FindRow](imapitable-findrow.md) method to locate the row in the table that represents the targeted service provider.</span></span> 
    
9. <span data-ttu-id="40761-120">Llame [a IProviderAdmin::CreateProvider para](iprovideradmin-createprovider.md) agregar el proveedor o [IProviderAdmin::D eleteProvider](iprovideradmin-deleteprovider.md) para quitarlo del servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="40761-120">Call [IProviderAdmin::CreateProvider](iprovideradmin-createprovider.md) to add the provider or [IProviderAdmin::DeleteProvider](iprovideradmin-deleteprovider.md) to remove it from the message service.</span></span> <span data-ttu-id="40761-121">Para **CreateProvider,** pase la propiedad **PR_DISPLAY_NAME** del proveedor como el parámetro _lpszProvider._</span><span class="sxs-lookup"><span data-stu-id="40761-121">For **CreateProvider**, pass the provider's **PR_DISPLAY_NAME** property as the  _lpszProvider_ parameter.</span></span> <span data-ttu-id="40761-122">Para cualquiera de los dos métodos, pase la propiedad **PR_SERVICE_UID** del proveedor como parámetro _lpUID._</span><span class="sxs-lookup"><span data-stu-id="40761-122">For either method, pass the provider's **PR_SERVICE_UID** property as the  _lpUID_ parameter.</span></span> <span data-ttu-id="40761-123">Después de agregar o eliminar el proveedor de servicios, el cambio no será aparente hasta que se cree una nueva sesión.</span><span class="sxs-lookup"><span data-stu-id="40761-123">After the service provider has been added or deleted, the change will not be apparent until a new session is created.</span></span> 
    
<span data-ttu-id="40761-124">Otra técnica para agregar un proveedor de servicios, específicamente un proveedor de almacén de mensajes, a un perfil implica la construcción de un identificador de entrada para el proveedor.</span><span class="sxs-lookup"><span data-stu-id="40761-124">Another technique for adding a service provider, specifically a message store provider, to a profile involves constructing an entry identifier for the provider.</span></span> <span data-ttu-id="40761-125">Dado que la construcción de un identificador de entrada requiere conocimiento de su formato, esta técnica solo se puede usar si el proveedor de servicios ha hecho público su formato de identificador de entrada.</span><span class="sxs-lookup"><span data-stu-id="40761-125">Because constructing an entry identifier requires knowledge of its format, this technique can only be used if the service provider has made its entry identifier format public.</span></span> 
  
<span data-ttu-id="40761-126">Con el identificador de entrada recién construido, un cliente puede llamar a [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md).</span><span class="sxs-lookup"><span data-stu-id="40761-126">With the newly constructed entry identifier, a client can call [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md).</span></span> <span data-ttu-id="40761-127">MAPI crea automáticamente una sección de perfil en el perfil para el proveedor de servicios, pero no la agrega a un servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="40761-127">MAPI automatically creates a profile section in the profile for the service provider, but does not add it to a message service.</span></span> 
  
<span data-ttu-id="40761-128">Algunos servicios de mensajes no permiten este tipo de modificación dinámica; si se admite o no está en el servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="40761-128">Some message services do not allow this type of dynamic modification; whether or not it is supported is up to the message service.</span></span> <span data-ttu-id="40761-129">Otra característica que puede o no ser compatible es la capacidad de acceder directamente a las secciones de perfil privado de un servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="40761-129">Another feature that may or may not be supported is the ability to directly access a message service's private profile sections.</span></span> <span data-ttu-id="40761-130">Si el servicio de mensajes que está usando permite dicho acceso, publicará el **GUID** que representa la sección privada en MAPISVC.INF.</span><span class="sxs-lookup"><span data-stu-id="40761-130">If the message service you are using permits such access, it will publish the **GUID** that represents the private section in MAPISVC.INF.</span></span> <span data-ttu-id="40761-131">Puede pasar este **GUID en** una llamada a [IProviderAdmin::OpenProfileSection para](iprovideradmin-openprofilesection.md) obtener acceso a la sección de perfil.</span><span class="sxs-lookup"><span data-stu-id="40761-131">You can pass this **GUID** in a call to [IProviderAdmin::OpenProfileSection](iprovideradmin-openprofilesection.md) to access the profile section.</span></span> 
  

