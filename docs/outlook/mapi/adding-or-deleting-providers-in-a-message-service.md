---
title: Agregar o eliminar los proveedores de servicio de mensajes
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 44bb4d34-ca96-4d5a-93fe-85e09bd7971d
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: 569c9d8a7ed3f56d88d83ea6fdac4477d39e50a2
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/23/2018
ms.locfileid: "22569487"
---
# <a name="adding-or-deleting-providers-in-a-message-service"></a><span data-ttu-id="aa5bf-103">Agregar o eliminar los proveedores de servicio de mensajes</span><span class="sxs-lookup"><span data-stu-id="aa5bf-103">Adding or Deleting Providers in a Message Service</span></span>

  
  
<span data-ttu-id="aa5bf-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="aa5bf-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="aa5bf-105">Para agregar o eliminar proveedores de servicios en un servicio de mensajes, use el [IProviderAdmin: IUnknown](iprovideradminiunknown.md) interfaz.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-105">To add or delete service providers in a message service, use the [IProviderAdmin : IUnknown](iprovideradminiunknown.md) interface.</span></span> <span data-ttu-id="aa5bf-106">Puede recuperar un puntero **IProviderAdmin** mediante una llamada a [IMsgServiceAdmin::AdminProviders](imsgserviceadmin-adminproviders.md).</span><span class="sxs-lookup"><span data-stu-id="aa5bf-106">You can retrieve an **IProviderAdmin** pointer by calling [IMsgServiceAdmin::AdminProviders](imsgserviceadmin-adminproviders.md).</span></span> <span data-ttu-id="aa5bf-107">En la tabla de proveedor, puede tener acceso a través de [IProviderAdmin::GetProviderTable](iprovideradmin-getprovidertable.md), se muestra información acerca de los proveedores de servicios instalados actualmente en el servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-107">The provider table, accessable through [IProviderAdmin::GetProviderTable](iprovideradmin-getprovidertable.md), lists information about the service providers currently installed in the message service.</span></span> <span data-ttu-id="aa5bf-108">Los clientes y proveedores de servicios pueden usar la tabla de proveedor para tener acceso al nombre de proveedor archivo DLL, por ejemplo, o el **MAPIUID**, el nombre para mostrar y el tipo de proveedor así como información sobre el servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-108">Clients and service providers can use the provider table to access the name of the provider DLL file, for example, or the **MAPIUID**, display name, and type of the provider as well as information about the message service.</span></span> <span data-ttu-id="aa5bf-109">Para obtener más información, vea [Las tablas de proveedor](provider-tables.md).</span><span class="sxs-lookup"><span data-stu-id="aa5bf-109">For more information, see [Provider Tables](provider-tables.md).</span></span>
  
 <span data-ttu-id="aa5bf-110">**Para agregar o eliminar un proveedor de servicios en un servicio de mensajes**</span><span class="sxs-lookup"><span data-stu-id="aa5bf-110">**To add or delete a service provider in a message service**</span></span>
  
1. <span data-ttu-id="aa5bf-111">Llame al método **AdminServices** para obtener acceso a un objeto de administración del servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-111">Call the **AdminServices** method to access a message service administration object.</span></span> 
    
2. <span data-ttu-id="aa5bf-112">Llame a [IMsgServiceAdmin::GetMsgServiceTable](imsgserviceadmin-getmsgservicetable.md) para obtener acceso a la tabla de mensajes de servicio.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-112">Call [IMsgServiceAdmin::GetMsgServiceTable](imsgserviceadmin-getmsgservicetable.md) to access the message service table.</span></span> 
    
3. <span data-ttu-id="aa5bf-113">Crear una restricción de propiedad utilizando una estructura [SPropertyRestriction](spropertyrestriction.md) que coincide con **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) o **PR_SERVICE_NAME** ([PidTagServiceName](pidtagservicename-canonical-property.md)) con el nombre del servicio de mensaje que se va puede modificar.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-113">Build a property restriction using an [SPropertyRestriction](spropertyrestriction.md) structure that matches **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) or **PR_SERVICE_NAME** ([PidTagServiceName](pidtagservicename-canonical-property.md)) with the name of the message service to be modified.</span></span> 
    
4. <span data-ttu-id="aa5bf-114">Llamar al método [IMAPITable:: FindRow](imapitable-findrow.md) de la tabla de servicio de mensaje para buscar la fila en la tabla que representa el servicio de mensajes de destino.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-114">Call the message service table's [IMAPITable::FindRow](imapitable-findrow.md) method to locate the row in the table that represents the targeted message service.</span></span> 
    
5. <span data-ttu-id="aa5bf-115">Llame a [IMsgServiceAdmin::AdminProviders](imsgserviceadmin-adminproviders.md) para recuperar un puntero **IProviderAdmin** .</span><span class="sxs-lookup"><span data-stu-id="aa5bf-115">Call [IMsgServiceAdmin::AdminProviders](imsgserviceadmin-adminproviders.md) to retrieve an **IProviderAdmin** pointer.</span></span> <span data-ttu-id="aa5bf-116">Pasar la columna **PR_SERVICE_UID** ([PidTagServiceUid](pidtagserviceuid-canonical-property.md)) de la fila de tabla del servicio de mensajes como el parámetro _lpUID_ .</span><span class="sxs-lookup"><span data-stu-id="aa5bf-116">Pass the **PR_SERVICE_UID** ([PidTagServiceUid](pidtagserviceuid-canonical-property.md)) column from the message service table row as the  _lpUID_ parameter.</span></span> 
    
6. <span data-ttu-id="aa5bf-117">Llame a [IProviderAdmin::GetProviderTable](iprovideradmin-getprovidertable.md) para obtener acceso a la tabla de proveedores.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-117">Call [IProviderAdmin::GetProviderTable](iprovideradmin-getprovidertable.md) to access the provider table.</span></span> 
    
7. <span data-ttu-id="aa5bf-118">Crear una restricción de propiedad utilizando una estructura SPropertyRestriction que coincide con **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) o **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)) con el nombre del proveedor de servicios para que sea Agregar o eliminar.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-118">Build a property restriction using an SPropertyRestriction structure that matches **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) or **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)) with the name of the service provider to be added or deleted.</span></span> 
    
8. <span data-ttu-id="aa5bf-119">Llamar al método [IMAPITable:: FindRow](imapitable-findrow.md) de la tabla proveedor para buscar la fila en la tabla que representa el proveedor de servicio de destino.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-119">Call the provider table's [IMAPITable::FindRow](imapitable-findrow.md) method to locate the row in the table that represents the targeted service provider.</span></span> 
    
9. <span data-ttu-id="aa5bf-120">Llamar a [IProviderAdmin::CreateProvider](iprovideradmin-createprovider.md) para agregar el proveedor o [IProviderAdmin::DeleteProvider](iprovideradmin-deleteprovider.md) para quitar desde el servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-120">Call [IProviderAdmin::CreateProvider](iprovideradmin-createprovider.md) to add the provider or [IProviderAdmin::DeleteProvider](iprovideradmin-deleteprovider.md) to remove it from the message service.</span></span> <span data-ttu-id="aa5bf-121">Para **CreateProvider**, pase la propiedad del proveedor **PR_DISPLAY_NAME** como el parámetro _lpszProvider_ .</span><span class="sxs-lookup"><span data-stu-id="aa5bf-121">For **CreateProvider**, pass the provider's **PR_DISPLAY_NAME** property as the  _lpszProvider_ parameter.</span></span> <span data-ttu-id="aa5bf-122">Para cualquiera de los métodos, pase la propiedad del proveedor **PR_SERVICE_UID** como el parámetro _lpUID_ .</span><span class="sxs-lookup"><span data-stu-id="aa5bf-122">For either method, pass the provider's **PR_SERVICE_UID** property as the  _lpUID_ parameter.</span></span> <span data-ttu-id="aa5bf-123">Después de que se ha agregado o eliminado el proveedor de servicios, el cambio no será evidente hasta que se crea una nueva sesión.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-123">After the service provider has been added or deleted, the change will not be apparent until a new session is created.</span></span> 
    
<span data-ttu-id="aa5bf-124">Otra técnica para agregar un proveedor de servicios, específicamente un proveedor de almacén de mensajes, a un perfil implica la construcción de un identificador de entrada para el proveedor.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-124">Another technique for adding a service provider, specifically a message store provider, to a profile involves constructing an entry identifier for the provider.</span></span> <span data-ttu-id="aa5bf-125">Debido a que la construcción de un identificador de entrada requiere conocimientos de su formato, esta técnica sólo puede utilizarse si el proveedor de servicios realizados por su formato de identificador de entrada pública.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-125">Because constructing an entry identifier requires knowledge of its format, this technique can only be used if the service provider has made its entry identifier format public.</span></span> 
  
<span data-ttu-id="aa5bf-126">Con el identificador de entrada recién construido, un cliente puede llamar a [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md).</span><span class="sxs-lookup"><span data-stu-id="aa5bf-126">With the newly constructed entry identifier, a client can call [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md).</span></span> <span data-ttu-id="aa5bf-127">MAPI automáticamente crea una sección de perfil en el perfil para el proveedor de servicios, pero no lo agrega a un servicio de mensaje.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-127">MAPI automatically creates a profile section in the profile for the service provider, but does not add it to a message service.</span></span> 
  
<span data-ttu-id="aa5bf-128">Algunos servicios de mensajes no permitir a este tipo de modificación dinámica; Si no es compatible con es hasta el servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-128">Some message services do not allow this type of dynamic modification; whether or not it is supported is up to the message service.</span></span> <span data-ttu-id="aa5bf-129">Otra característica que puede o no es posible que se admite es la capacidad de tener acceso directamente a las secciones de perfil privado de un servicio de mensaje.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-129">Another feature that may or may not be supported is the ability to directly access a message service's private profile sections.</span></span> <span data-ttu-id="aa5bf-130">Si está utilizando el servicio de mensajes permite este tipo de acceso, publicará el **GUID** que representa la sección privada en MAPISVC.INF.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-130">If the message service you are using permits such access, it will publish the **GUID** that represents the private section in MAPISVC.INF.</span></span> <span data-ttu-id="aa5bf-131">Puede pasar este **GUID** en una llamada a [IProviderAdmin::OpenProfileSection](iprovideradmin-openprofilesection.md) para tener acceso a la sección de perfil.</span><span class="sxs-lookup"><span data-stu-id="aa5bf-131">You can pass this **GUID** in a call to [IProviderAdmin::OpenProfileSection](iprovideradmin-openprofilesection.md) to access the profile section.</span></span> 
  

