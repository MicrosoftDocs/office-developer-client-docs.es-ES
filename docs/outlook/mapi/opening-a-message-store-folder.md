---
title: Abrir una carpeta de almacén de mensajes
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d858e4fe-822e-4330-9ed3-4b7d22fa51dc
description: 'Última modificación: 09 de marzo de 2015'
ms.openlocfilehash: df7db013cb435484c721388abab51ab4ba43828f
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436541"
---
# <a name="opening-a-message-store-folder"></a><span data-ttu-id="dc89f-103">Abrir una carpeta de almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="dc89f-103">Opening a message store folder</span></span>

<span data-ttu-id="dc89f-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="dc89f-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="dc89f-105">Antes de que se pueda abrir cualquier carpeta, su identificador de entrada debe estar disponible.</span><span class="sxs-lookup"><span data-stu-id="dc89f-105">Before any folder can be opened, its entry identifier must be available.</span></span> <span data-ttu-id="dc89f-106">Para la mayoría de las carpetas, esto significa recuperar sus **PR_ENTRYID** propiedades.</span><span class="sxs-lookup"><span data-stu-id="dc89f-106">For most folders, this means retrieving their **PR_ENTRYID** properties.</span></span> <span data-ttu-id="dc89f-107">Para carpetas especiales, como algunas de las carpetas de subárbol IPM y otras carpetas raíz, MAPI define las propiedades de identificador de entrada especiales a las que se puede tener acceso llamando al método **IMAPIProp::GetProps** del almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="dc89f-107">For special folders, such as some of the IPM subtree folders and other root folders, MAPI defines special entry identifier properties that are accessible by calling the message store's **IMAPIProp::GetProps** method.</span></span> <span data-ttu-id="dc89f-108">Estos identificadores de entrada siempre son a largo plazo y se denominan de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="dc89f-108">These entry identifiers are always long-term and are named as follows:</span></span> 
  
|<span data-ttu-id="dc89f-109">**Folder**</span><span class="sxs-lookup"><span data-stu-id="dc89f-109">**Folder**</span></span>|<span data-ttu-id="dc89f-110">**Propiedad de identificador de entrada**</span><span class="sxs-lookup"><span data-stu-id="dc89f-110">**Entry identifier property**</span></span>|
|:-----|:-----|
|<span data-ttu-id="dc89f-111">Carpeta Bandeja de salida</span><span class="sxs-lookup"><span data-stu-id="dc89f-111">Outbox folder</span></span>  <br/> |<span data-ttu-id="dc89f-112">**PR_IPM_OUTBOX_ENTRYID** ([PidTagIpmOutboxEntryId](pidtagipmoutboxentryid-canonical-property.md)) (solo clase de mensaje IPM)</span><span class="sxs-lookup"><span data-stu-id="dc89f-112">**PR_IPM_OUTBOX_ENTRYID** ([PidTagIpmOutboxEntryId](pidtagipmoutboxentryid-canonical-property.md)) (IPM message class only)</span></span>  <br/> |
|<span data-ttu-id="dc89f-113">carpeta Elementos eliminados</span><span class="sxs-lookup"><span data-stu-id="dc89f-113">Deleted Items folder</span></span>  <br/> |<span data-ttu-id="dc89f-114">**PR_IPM_WASTEBASKET_ENTRYID** ([PidTagIpmWastebasketEntryId](pidtagipmwastebasketentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="dc89f-114">**PR_IPM_WASTEBASKET_ENTRYID** ([PidTagIpmWastebasketEntryId](pidtagipmwastebasketentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="dc89f-115">carpeta de elementos enviados</span><span class="sxs-lookup"><span data-stu-id="dc89f-115">Sent Items folder</span></span>  <br/> |<span data-ttu-id="dc89f-116">**PR_IPM_SENTMAIL_ENTRYID** ([PidTagIpmSentMailEntryId](pidtagipmsentmailentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="dc89f-116">**PR_IPM_SENTMAIL_ENTRYID** ([PidTagIpmSentMailEntryId](pidtagipmsentmailentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="dc89f-117">Carpeta ra�z IPM</span><span class="sxs-lookup"><span data-stu-id="dc89f-117">IPM root folder</span></span>  <br/> |<span data-ttu-id="dc89f-118">**PR_IPM_SUBTREE_ENTRYID** ([PidTagIpmSubtreeEntryId](pidtagipmsubtreeentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="dc89f-118">**PR_IPM_SUBTREE_ENTRYID** ([PidTagIpmSubtreeEntryId](pidtagipmsubtreeentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="dc89f-119">Carpeta ra�z de los resultados de b�squeda</span><span class="sxs-lookup"><span data-stu-id="dc89f-119">Search-results root folder</span></span>  <br/> |<span data-ttu-id="dc89f-120">**PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="dc89f-120">**PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="dc89f-121">Carpeta raíz de vistas comunes</span><span class="sxs-lookup"><span data-stu-id="dc89f-121">Common views root folder</span></span>  <br/> |<span data-ttu-id="dc89f-122">**PR_COMMON_VIEWS_ENTRYID** ([PidTagCommonViewsEntryId](pidtagcommonviewsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="dc89f-122">**PR_COMMON_VIEWS_ENTRYID** ([PidTagCommonViewsEntryId](pidtagcommonviewsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="dc89f-123">Carpeta raíz de vistas personales</span><span class="sxs-lookup"><span data-stu-id="dc89f-123">Personal views root folder</span></span>  <br/> |<span data-ttu-id="dc89f-124">**PR_VIEWS_ENTRYID** ([PidTagViewsEntryId](pidtagviewsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="dc89f-124">**PR_VIEWS_ENTRYID** ([PidTagViewsEntryId](pidtagviewsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="dc89f-125">Carpeta raíz de contactos</span><span class="sxs-lookup"><span data-stu-id="dc89f-125">Contacts root folder</span></span>  <br/> |<span data-ttu-id="dc89f-126">**PR_IPM_CONTACT_ENTRYID** ([PidTagIpmContactEntryId](pidtagipmcontactentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="dc89f-126">**PR_IPM_CONTACT_ENTRYID** ([PidTagIpmContactEntryId](pidtagipmcontactentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="dc89f-127">Carpeta raíz borradores</span><span class="sxs-lookup"><span data-stu-id="dc89f-127">Drafts root folder</span></span>  <br/> |<span data-ttu-id="dc89f-128">**PR_IPM_DRAFTS_ENTRYID** ([PidTagIpmDraftsEntryId](pidtagipmdraftsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="dc89f-128">**PR_IPM_DRAFTS_ENTRYID** ([PidTagIpmDraftsEntryId](pidtagipmdraftsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="dc89f-129">Carpeta raíz del diario</span><span class="sxs-lookup"><span data-stu-id="dc89f-129">Journal root folder</span></span>  <br/> |<span data-ttu-id="dc89f-130">**PR_IPM_JOURNAL_ENTRYID** ([PidTagIpmJournalEntryId](pidtagipmjournalentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="dc89f-130">**PR_IPM_JOURNAL_ENTRYID** ([PidTagIpmJournalEntryId](pidtagipmjournalentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="dc89f-131">Carpeta raíz del calendario</span><span class="sxs-lookup"><span data-stu-id="dc89f-131">Calendar root folder</span></span>  <br/> |<span data-ttu-id="dc89f-132">**PR_IPM_APPOINTMENT_ENTRYID** ([PidTagIpmAppointmentEntryId](pidtagipmappointmententryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="dc89f-132">**PR_IPM_APPOINTMENT_ENTRYID** ([PidTagIpmAppointmentEntryId](pidtagipmappointmententryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="dc89f-133">Carpeta raíz de notas</span><span class="sxs-lookup"><span data-stu-id="dc89f-133">Notes root folder</span></span>  <br/> |<span data-ttu-id="dc89f-134">**PR_IPM_NOTE_ENTRYID** ([PidTagIpmNoteEntryId](pidtagipmnoteentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="dc89f-134">**PR_IPM_NOTE_ENTRYID** ([PidTagIpmNoteEntryId](pidtagipmnoteentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="dc89f-135">Carpeta raíz de tareas</span><span class="sxs-lookup"><span data-stu-id="dc89f-135">Tasks root folder</span></span>  <br/> |<span data-ttu-id="dc89f-136">**PR_IPM_TASK_ENTRYID** ([PidTagIpmTaskEntryId](pidtagipmtaskentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="dc89f-136">**PR_IPM_TASK_ENTRYID** ([PidTagIpmTaskEntryId](pidtagipmtaskentryid-canonical-property.md))</span></span>  <br/> |
   
<span data-ttu-id="dc89f-137">Antes de intentar recuperar uno de estos identificadores de entrada especiales, recupere la propiedad **PR \_ VALID_FOLDER_MASK** ([PidTagValidFolderMask](pidtagvalidfoldermask-canonical-property.md)) del almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="dc89f-137">Before you try to retrieve one of these special entry identifiers, retrieve the **PR\_VALID_FOLDER_MASK** ([PidTagValidFolderMask](pidtagvalidfoldermask-canonical-property.md)) property of the message store.</span></span> <span data-ttu-id="dc89f-138">**PR \_ VALID_FOLDER_MASK** es una máscara de bits que identifica cuáles de los identificadores de entrada especiales existen.</span><span class="sxs-lookup"><span data-stu-id="dc89f-138">**PR\_VALID_FOLDER_MASK** is a bitmask that identifies which of the special entry identifiers exist.</span></span> <span data-ttu-id="dc89f-139">Hay un bit para cada una de las carpetas especiales.</span><span class="sxs-lookup"><span data-stu-id="dc89f-139">There is one bit for each of the special folders.</span></span> <span data-ttu-id="dc89f-140">Si se establece el bit, indica que la carpeta correspondiente es compatible y tiene un identificador de entrada válido.</span><span class="sxs-lookup"><span data-stu-id="dc89f-140">If the bit is set, it indicates that the corresponding folder is supported and has a valid entry identifier.</span></span> <span data-ttu-id="dc89f-141">Por ejemplo, si la carpeta Elementos eliminados existe y tiene un identificador de entrada válido, el bit folder IPM_WASTEBASKET_VALID se establecerá \_ en **PR_VALID_FOLDER_MASK**.</span><span class="sxs-lookup"><span data-stu-id="dc89f-141">For example, if the Deleted Items folder exists and has a valid entry identifier, the FOLDER\_IPM_WASTEBASKET_VALID bit will be set in **PR_VALID_FOLDER_MASK**.</span></span> 
  
## <a name="open-the-folder-where-all-incoming-messages-of-a-particular-class-are-placed"></a><span data-ttu-id="dc89f-142">Abra la carpeta donde se colocan todos los mensajes entrantes de una clase determinada</span><span class="sxs-lookup"><span data-stu-id="dc89f-142">Open the folder where all incoming messages of a particular class are placed</span></span>
  
1. <span data-ttu-id="dc89f-143">Llame a [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md) para recuperar su identificador de entrada, estableciendo el parámetro  _lpszMessageClass_ para que apunte a una cadena de caracteres que identifique la clase de mensaje.</span><span class="sxs-lookup"><span data-stu-id="dc89f-143">Call [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md) to retrieve its entry identifier, setting the  _lpszMessageClass_ parameter to point to a character string identifying the message class.</span></span> <span data-ttu-id="dc89f-144">Por ejemplo, si desea abrir la Bandeja de entrada del subárbol IPM, apunte  _lpszMessageClass_ a IPM.</span><span class="sxs-lookup"><span data-stu-id="dc89f-144">For example, if you want to open the Inbox for your IPM subtree, point  _lpszMessageClass_ to IPM.</span></span> <span data-ttu-id="dc89f-145">Si desea abrir la carpeta de recepción para los mensajes IPC, estafórpela para que apunte a IPC.</span><span class="sxs-lookup"><span data-stu-id="dc89f-145">If you want to open the receive folder for IPC messages, set it to point to IPC.</span></span> 

   <span data-ttu-id="dc89f-146">Si no hay ninguna carpeta de recepción registrada para la clase de mensaje, **GetReceiveFolder** elige la carpeta de recepción cuya clase de mensaje asociada coincide con el prefijo más largo posible de la clase de mensaje pasada.</span><span class="sxs-lookup"><span data-stu-id="dc89f-146">If there is no registered receive folder for the message class, **GetReceiveFolder** chooses the receive folder whose associated message class matches the longest possible prefix of the message class passed in.</span></span> <span data-ttu-id="dc89f-147">Para obtener más información, vea [Carpetas de recepción MAPI.](mapi-receive-folders.md)</span><span class="sxs-lookup"><span data-stu-id="dc89f-147">For more information, see [MAPI Receive Folders](mapi-receive-folders.md).</span></span> 
   
   <span data-ttu-id="dc89f-148">Tenga en cuenta **que PR_IPM_OUTBOX_ENTRYID** propiedad se usa para abrir la carpeta Bandeja de salida solo para los mensajes IPM.</span><span class="sxs-lookup"><span data-stu-id="dc89f-148">Note that the **PR_IPM_OUTBOX_ENTRYID** property is used to open the Outbox folder only for IPM messages.</span></span> <span data-ttu-id="dc89f-149">Si va a abrir la Bandeja de salida para los mensajes IPC, use en su lugar el identificador de entrada de su carpeta de recepción.</span><span class="sxs-lookup"><span data-stu-id="dc89f-149">If you are opening the Outbox for IPC messages, use instead the entry identifier for its receive folder.</span></span> <span data-ttu-id="dc89f-150">Los mensajes IPC entrantes y salientes se colocan en la carpeta de recepción.</span><span class="sxs-lookup"><span data-stu-id="dc89f-150">Both incoming and outgoing IPC messages are placed in the receive folder.</span></span> 
    
2. <span data-ttu-id="dc89f-151">Llame a uno de los cuatro **métodos OpenEntry** para abrir la carpeta y devolver un puntero de interfaz que pueda usar para obtener acceso a ella.</span><span class="sxs-lookup"><span data-stu-id="dc89f-151">Call one of four **OpenEntry** methods to open the folder and return an interface pointer that you can use to access it.</span></span> <span data-ttu-id="dc89f-152">Puede llamar a cualquiera de los métodos siguientes para abrir una carpeta:</span><span class="sxs-lookup"><span data-stu-id="dc89f-152">You can call any one of the following methods to open a folder:</span></span> 
    
   - [<span data-ttu-id="dc89f-153">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="dc89f-153">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md)
    
   - [<span data-ttu-id="dc89f-154">IMSLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="dc89f-154">IMSLogon::OpenEntry</span></span>](imslogon-openentry.md)
    
   - [<span data-ttu-id="dc89f-155">IMsgStore::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="dc89f-155">IMsgStore::OpenEntry</span></span>](imsgstore-openentry.md)
    
   - [<span data-ttu-id="dc89f-156">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="dc89f-156">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md)
    
   <span data-ttu-id="dc89f-157">El método específico que elija dependerá de la carpeta que se va a abrir y de los objetos que estén disponibles en ese momento.</span><span class="sxs-lookup"><span data-stu-id="dc89f-157">The specific method that you choose depends on the folder to be opened and the objects that are available at the time.</span></span> <span data-ttu-id="dc89f-158">Dado que **el método IMAPISession** puede abrir cualquier carpeta para cualquier almacén de mensajes en el perfil actual, llame a **este Objeto OpenEntry** cuando no sepa nada sobre la carpeta que se va a abrir.</span><span class="sxs-lookup"><span data-stu-id="dc89f-158">Because the **IMAPISession** method can open any folder for any message store in the current profile, call this **OpenEntry** when you do not know anything about the folder to be opened.</span></span> <span data-ttu-id="dc89f-159">Si sabe qué almacén de mensajes es el propietario de la carpeta y tiene un puntero al almacén de mensajes, llame a **IMsgStore::OpenEntry**.</span><span class="sxs-lookup"><span data-stu-id="dc89f-159">If you know which message store owns the folder and you have a pointer to the message store, call **IMsgStore::OpenEntry**.</span></span> 
    
   <span data-ttu-id="dc89f-160">Por ejemplo, use el **método IMsgStore** para abrir una carpeta de recepción.</span><span class="sxs-lookup"><span data-stu-id="dc89f-160">For example, use the **IMsgStore** method to open a receive folder.</span></span> <span data-ttu-id="dc89f-161">Si tiene un puntero al objeto de inicio de sesión del proveedor del almacén de mensajes, llame a **IMSLogon::OpenEntry**.</span><span class="sxs-lookup"><span data-stu-id="dc89f-161">If you have a pointer to the message store provider's logon object, call **IMSLogon::OpenEntry**.</span></span> <span data-ttu-id="dc89f-162">Dado que estas llamadas van directamente al proveedor del almacén de mensajes en lugar de a través de MAPI, el procesamiento es más rápido.</span><span class="sxs-lookup"><span data-stu-id="dc89f-162">Because these calls go directly to the message store provider rather than through MAPI, processing is faster.</span></span> <span data-ttu-id="dc89f-163">Si la carpeta que está abriendo es una subcarpeta de una carpeta que ya tiene abierta, llame al método **IMAPIContainer::OpenEntry** de la carpeta abierta.</span><span class="sxs-lookup"><span data-stu-id="dc89f-163">If the folder you are opening is a subfolder of a folder that you already have open, call the open folder's **IMAPIContainer::OpenEntry** method.</span></span> <span data-ttu-id="dc89f-164">El **método IMAPIContainer** solo abre subcarpetas de una carpeta abierta actualmente y es el único método que se garantiza que funcione con identificadores de entrada a corto plazo.</span><span class="sxs-lookup"><span data-stu-id="dc89f-164">The **IMAPIContainer** method only opens subfolders of a currently opened folder and is the only method guaranteed to work with short-term entry identifiers.</span></span> 
    
3. <span data-ttu-id="dc89f-165">Si desea poder realizar cambios en la carpeta que se va a abrir, especifique un nivel de acceso estableciendo la marca MAPI BEST ACCESS o MAPI MODIFY en la llamada \_ \_ a \_ **OpenEntry.**</span><span class="sxs-lookup"><span data-stu-id="dc89f-165">If you want to be able to make changes to the folder to be opened, specify an access level by setting either the MAPI\_BEST\_ACCESS or MAPI\_MODIFY flag in the **OpenEntry** call.</span></span> <span data-ttu-id="dc89f-166">Estas marcas son sugerencias al proveedor de al almacenamiento de mensajes para conceder el nivel más alto de acceso, para MAPI BEST ACCESS, o acceso de lectura y escritura, para MAPI MODIFY, al abrir la \_ \_ \_ carpeta.</span><span class="sxs-lookup"><span data-stu-id="dc89f-166">These flags are suggestions to the message store provider to grant the highest level of access, for MAPI\_BEST\_ACCESS, or read/write access, for MAPI\_MODIFY, when opening the folder.</span></span> 

   <span data-ttu-id="dc89f-167">Dado que estas marcas son solo sugerencias, la carpeta puede o no abrirse con el nivel de acceso esperado.</span><span class="sxs-lookup"><span data-stu-id="dc89f-167">Because these flags are only suggestions, the folder may or may not be opened with the access level you expect.</span></span> <span data-ttu-id="dc89f-168">Al recuperar **la** PR_ACCESS ([PidTagAccess](pidtagaccess-canonical-property.md)), puede determinar el intervalo de operaciones que se pueden realizar en la carpeta abierta.</span><span class="sxs-lookup"><span data-stu-id="dc89f-168">By retrieving the **PR_ACCESS** ([PidTagAccess](pidtagaccess-canonical-property.md)) property, you can determine the range of operations that can be performed on the open folder.</span></span> 
    
   <span data-ttu-id="dc89f-169">Sin embargo, dado que muchos proveedores de al almacenamiento de mensajes calculan el valor de esta propiedad a petición en lugar de admitirla como una propiedad de carpeta o como una columna en la tabla de jerarquía, recuperarla puede llevar mucho tiempo.</span><span class="sxs-lookup"><span data-stu-id="dc89f-169">However, because many message store providers calculate the value for this property on demand rather than supporting it as a folder property or as a column in their hierarchy table, retrieving it can be time-consuming.</span></span> <span data-ttu-id="dc89f-170">Una estrategia alternativa es intentar cualquier operación que necesite realizar y devolver un error si es necesario.</span><span class="sxs-lookup"><span data-stu-id="dc89f-170">An alternate strategy is to attempt whatever operation you need to perform and return an error if necessary.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="dc89f-171">Consulte también</span><span class="sxs-lookup"><span data-stu-id="dc89f-171">See also</span></span>

- [<span data-ttu-id="dc89f-172">Propiedad canónica PidTagEntryId</span><span class="sxs-lookup"><span data-stu-id="dc89f-172">PidTagEntryId Canonical Property</span></span>](pidtagentryid-canonical-property.md) 
- [<span data-ttu-id="dc89f-173">IMAPIProp::GetProps</span><span class="sxs-lookup"><span data-stu-id="dc89f-173">IMAPIProp::GetProps</span></span>](imapiprop-getprops.md)

