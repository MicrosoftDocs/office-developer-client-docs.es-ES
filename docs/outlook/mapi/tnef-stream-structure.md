---
title: Estructura de la secuencia TNEF
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 8eda1251-3858-4832-ac43-d817b4a7ea59
description: 'Última modificación: 09 de marzo de 2015'
ms.openlocfilehash: ebe10ae741975b33ee58e1e99032aaca64ef38d8
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/23/2018
ms.locfileid: "22569732"
---
# <a name="tnef-stream-structure"></a><span data-ttu-id="50612-103">Estructura de la secuencia TNEF</span><span class="sxs-lookup"><span data-stu-id="50612-103">TNEF Stream Structure</span></span>

  
  
<span data-ttu-id="50612-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="50612-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="50612-105">Una secuencia TNEF comienza con una firma de 32 bits que identifica la secuencia como una secuencia TNEF.</span><span class="sxs-lookup"><span data-stu-id="50612-105">A TNEF stream begins with a 32-bit signature that identifies the stream as a TNEF stream.</span></span> <span data-ttu-id="50612-106">Después de la firma son un entero sin signo de 16 bits que se usa como una clave para hacer referencias cruzadas a los datos adjuntos a su ubicación en el texto del mensaje con etiqueta.</span><span class="sxs-lookup"><span data-stu-id="50612-106">Following the signature is a 16-bit unsigned integer that is used as a key to cross-reference attachments to their location in the tagged message text.</span></span> <span data-ttu-id="50612-107">En el resto de la secuencia es una secuencia de atributos TNEF.</span><span class="sxs-lookup"><span data-stu-id="50612-107">The remainder of the stream is a sequence of TNEF attributes.</span></span> <span data-ttu-id="50612-108">Los atributos de mensaje aparezcan en primer lugar en la secuencia TNEF y siga los atributos de los datos adjuntos.</span><span class="sxs-lookup"><span data-stu-id="50612-108">Message attributes appear first in the TNEF stream, and attachment attributes follow.</span></span> <span data-ttu-id="50612-109">Los atributos que pertenecen a un dato adjunto determinado se agrupan juntos, comenzando con el atributo **attAttachRenddata** .</span><span class="sxs-lookup"><span data-stu-id="50612-109">Attributes that belong to a particular attachment are grouped together, beginning with the **attAttachRenddata** attribute.</span></span> 
  
<span data-ttu-id="50612-110">La mayoría de los valores de constantes utilizados en las secuencias TNEF se define en el TNEF. Archivo de encabezado H.</span><span class="sxs-lookup"><span data-stu-id="50612-110">Most of the constant values used in TNEF streams are defined in the TNEF.H header file.</span></span> <span data-ttu-id="50612-111">En particular, **TNEF_SIGNATURE**, **LVL_MESSAGE**, **LVL_ATTACHMENT**y todos los identificadores de atributo TNEF se definen en este archivo.</span><span class="sxs-lookup"><span data-stu-id="50612-111">Notably, **TNEF_SIGNATURE**, **LVL_MESSAGE**, **LVL_ATTACHMENT**, and all the TNEF attribute identifiers are defined in this file.</span></span> <span data-ttu-id="50612-112">Otras constantes tienen los valores indicados por su interpretación a un compilador de lenguaje C.</span><span class="sxs-lookup"><span data-stu-id="50612-112">Other constants have the values indicated by their interpretation to a C language compiler.</span></span> <span data-ttu-id="50612-113">Normalmente, esas constantes se utilizan para dar a los tamaños de los siguientes elementos.</span><span class="sxs-lookup"><span data-stu-id="50612-113">Typically, such constants are used to give the sizes of the following item.</span></span> <span data-ttu-id="50612-114">Por ejemplo, **sizeof (ulong)** en la definición de un elemento indica que debe haber un entero que representa el tamaño de la siguiente entero largo sin signo en ese lugar de la secuencia TNEF.</span><span class="sxs-lookup"><span data-stu-id="50612-114">For example, **sizeof(ULONG)** in an item's definition indicates that an integer representing the size of the following unsigned long integer should occur in that place in the TNEF stream.</span></span> 
  
<span data-ttu-id="50612-115">Todos los números enteros en una secuencia TNEF se almacenan en formato binario "little-endian", pero se muestran en formato hexadecimal a lo largo de esta sección.</span><span class="sxs-lookup"><span data-stu-id="50612-115">All integers in a TNEF stream are stored in little-endian binary form, but are shown in hexadecimal throughout this section.</span></span> <span data-ttu-id="50612-116">Los valores de suma de comprobación son enteros sin signo de 16 bits simplemente que son la suma de módulo 65536, de los bytes de datos que se aplica la suma de comprobación.</span><span class="sxs-lookup"><span data-stu-id="50612-116">Checksum values are simply 16-bit unsigned integers that are the sum, modulo 65536, of the bytes of data that the checksum applies to.</span></span> <span data-ttu-id="50612-117">Todas las longitudes de atributo son enteros largos sin signo, incluidos los caracteres de terminación null.</span><span class="sxs-lookup"><span data-stu-id="50612-117">All attribute lengths are unsigned long integers, including any terminating null characters.</span></span>
  
<span data-ttu-id="50612-118">La clave es un entero sin signo de distinto de cero, 16 bits que indica el valor inicial de las claves de referencia de los datos adjuntos.</span><span class="sxs-lookup"><span data-stu-id="50612-118">The key is a nonzero, 16-bit unsigned integer that signifies the initial value of the attachment reference keys.</span></span> <span data-ttu-id="50612-119">Las claves de referencia de los datos adjuntos se asignan a cada dato adjunto secuencialmente que comiencen por el valor inicial que se pasa a la función [OpenTnefStream](opentnefstream.md) por el proveedor de servicio que usa la codificación TNEF.</span><span class="sxs-lookup"><span data-stu-id="50612-119">The attachment reference keys are assigned to each attachment sequentially beginning with the initial value that is passed to the [OpenTnefStream](opentnefstream.md) function by the service provider that is using TNEF.</span></span> <span data-ttu-id="50612-120">El proveedor de servicios debe generar un valor aleatorio inicial para la clave reducir las posibilidades de que los dos mensajes utilizan la misma clave.</span><span class="sxs-lookup"><span data-stu-id="50612-120">The service provider should generate a random initial value for the key to minimize the chance that two messages use the same key.</span></span> 
  
<span data-ttu-id="50612-121">La implementación de TNEF usa los identificadores de atributo para asignar los atributos a las propiedades correspondientes de MAPI.</span><span class="sxs-lookup"><span data-stu-id="50612-121">The TNEF implementation uses attribute identifiers to map attributes to their corresponding MAPI properties.</span></span> <span data-ttu-id="50612-122">Un identificador de atributo es un entero de 32 bits sin signo formado por dos valores de word.</span><span class="sxs-lookup"><span data-stu-id="50612-122">An attribute identifier is a 32-bit unsigned integer made up of two word values.</span></span> <span data-ttu-id="50612-123">La palabra de orden superior indica el tipo de datos, como cadena o binario, y la palabra de orden inferior identifica el atributo concreto.</span><span class="sxs-lookup"><span data-stu-id="50612-123">The high-order word indicates the data type, such as string or binary, and the low-order word identifies the particular attribute.</span></span> <span data-ttu-id="50612-124">Los tipos de datos en la palabra de orden superior son:</span><span class="sxs-lookup"><span data-stu-id="50612-124">The data types in the high order word are:</span></span>
  
|<span data-ttu-id="50612-125">**Tipo**</span><span class="sxs-lookup"><span data-stu-id="50612-125">**Type**</span></span>|<span data-ttu-id="50612-126">**Valor**</span><span class="sxs-lookup"><span data-stu-id="50612-126">**Value**</span></span>|
|:-----|:-----|
|<span data-ttu-id="50612-127">atpTriples</span><span class="sxs-lookup"><span data-stu-id="50612-127">atpTriples</span></span>  <br/> |<span data-ttu-id="50612-128">0x0000</span><span class="sxs-lookup"><span data-stu-id="50612-128">0x0000</span></span>  <br/> |
|<span data-ttu-id="50612-129">atpString</span><span class="sxs-lookup"><span data-stu-id="50612-129">atpString</span></span>  <br/> |<span data-ttu-id="50612-130">0 x 0001</span><span class="sxs-lookup"><span data-stu-id="50612-130">0x0001</span></span>  <br/> |
|<span data-ttu-id="50612-131">atpText</span><span class="sxs-lookup"><span data-stu-id="50612-131">atpText</span></span>  <br/> |<span data-ttu-id="50612-132">0x0002</span><span class="sxs-lookup"><span data-stu-id="50612-132">0x0002</span></span>  <br/> |
|<span data-ttu-id="50612-133">atpDate</span><span class="sxs-lookup"><span data-stu-id="50612-133">atpDate</span></span>  <br/> |<span data-ttu-id="50612-134">0x0003</span><span class="sxs-lookup"><span data-stu-id="50612-134">0x0003</span></span>  <br/> |
|<span data-ttu-id="50612-135">atpShort</span><span class="sxs-lookup"><span data-stu-id="50612-135">atpShort</span></span>  <br/> |<span data-ttu-id="50612-136">0x0004</span><span class="sxs-lookup"><span data-stu-id="50612-136">0x0004</span></span>  <br/> |
|<span data-ttu-id="50612-137">atpLong</span><span class="sxs-lookup"><span data-stu-id="50612-137">atpLong</span></span>  <br/> |<span data-ttu-id="50612-138">0x0005</span><span class="sxs-lookup"><span data-stu-id="50612-138">0x0005</span></span>  <br/> |
|<span data-ttu-id="50612-139">atpByte</span><span class="sxs-lookup"><span data-stu-id="50612-139">atpByte</span></span>  <br/> |<span data-ttu-id="50612-140">0x0006</span><span class="sxs-lookup"><span data-stu-id="50612-140">0x0006</span></span>  <br/> |
|<span data-ttu-id="50612-141">atpWord</span><span class="sxs-lookup"><span data-stu-id="50612-141">atpWord</span></span>  <br/> |<span data-ttu-id="50612-142">0 x 0007</span><span class="sxs-lookup"><span data-stu-id="50612-142">0x0007</span></span>  <br/> |
|<span data-ttu-id="50612-143">atpDword</span><span class="sxs-lookup"><span data-stu-id="50612-143">atpDword</span></span>  <br/> |<span data-ttu-id="50612-144">0x0008</span><span class="sxs-lookup"><span data-stu-id="50612-144">0x0008</span></span>  <br/> |
|<span data-ttu-id="50612-145">atpMax</span><span class="sxs-lookup"><span data-stu-id="50612-145">atpMax</span></span>  <br/> |<span data-ttu-id="50612-146">0 x 0009</span><span class="sxs-lookup"><span data-stu-id="50612-146">0x0009</span></span>  <br/> |
   
<span data-ttu-id="50612-147">Los valores de la palabra de orden inferior para cada atributo se definen en el TNEF. Archivo de encabezado H.</span><span class="sxs-lookup"><span data-stu-id="50612-147">The low-order word values for each attribute are defined in the TNEF.H header file.</span></span>
  

