---
title: Compatibilidad con datos adjuntos de mensajes para proveedores de al almacenamiento de mensajes
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d5fabc40-71e8-4afa-9846-533da605ce6c
description: '�ltima modificaci�n: lunes, 7 de diciembre de 2015'
ms.openlocfilehash: 69d1df5bf206cddd0d25698665c9fd87b81e4ea5
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412138"
---
# <a name="supporting-message-attachments-for-message-store-providers"></a><span data-ttu-id="12543-103">Compatibilidad con datos adjuntos de mensajes para proveedores de al almacenamiento de mensajes</span><span class="sxs-lookup"><span data-stu-id="12543-103">Supporting Message Attachments for Message Store Providers</span></span>

 
  
<span data-ttu-id="12543-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="12543-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="12543-105">El proveedor de almacenamiento de mensajes no necesita admitir datos adjuntos de mensajes.</span><span class="sxs-lookup"><span data-stu-id="12543-105">Your message store provider does not need to support message attachments.</span></span> <span data-ttu-id="12543-106">Sin embargo, muchas aplicaciones cliente esperan poder agregar datos adjuntos a los mensajes.</span><span class="sxs-lookup"><span data-stu-id="12543-106">However, many client applications expect to be able to add attachments to messages.</span></span> <span data-ttu-id="12543-107">Si el almacén de mensajes se usará para crear o almacenar IPM. Tenga en cuenta los mensajes y, a continuación, debe admitir datos adjuntos de mensajes.</span><span class="sxs-lookup"><span data-stu-id="12543-107">If your message store will be used to create or store IPM.Note messages, then you should support message attachments.</span></span> <span data-ttu-id="12543-108">Los proveedores de almacenamiento de mensajes predeterminados también deben admitir datos adjuntos de mensajes.</span><span class="sxs-lookup"><span data-stu-id="12543-108">Default message store providers should also support message attachments.</span></span> <span data-ttu-id="12543-109">Para obtener más información, vea [Clases de mensajes MAPI](mapi-message-classes.md)y Almacenes de mensajes [predeterminados.](default-message-stores.md)</span><span class="sxs-lookup"><span data-stu-id="12543-109">For more information, see [MAPI Message Classes](mapi-message-classes.md), and [Default Message Stores](default-message-stores.md).</span></span>
  
<span data-ttu-id="12543-110">Hay cinco tipos de datos adjuntos compatibles con MAPI: archivos adjuntos, datos adjuntos de datos, datos adjuntos de mensajes, datos adjuntos de objetos OLE y vínculos.</span><span class="sxs-lookup"><span data-stu-id="12543-110">There are five types of attachments that MAPI supports: file attachments, data attachments, message attachments, OLE object attachments, and links.</span></span> <span data-ttu-id="12543-111">Los requisitos para admitir cada tipo son diferentes.</span><span class="sxs-lookup"><span data-stu-id="12543-111">The requirements for supporting each type are different.</span></span> <span data-ttu-id="12543-112">Los clientes diferencian entre los dos tipos de datos adjuntos mediante la propiedad **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) en objetos de datos adjuntos.</span><span class="sxs-lookup"><span data-stu-id="12543-112">Clients differentiate between the two types of attachments by means of the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property on attachment objects.</span></span>
  
<span data-ttu-id="12543-113">Admitir datos adjuntos significa implementar [la interfaz IAttach : IMAPIProp.](iattachimapiprop.md)</span><span class="sxs-lookup"><span data-stu-id="12543-113">Supporting attachments means implementing the [IAttach : IMAPIProp](iattachimapiprop.md) interface.</span></span> <span data-ttu-id="12543-114">La **interfaz IAttach** no tiene métodos propios; solo tiene métodos que se heredan de la [interfaz IMAPIProp.](imapipropiunknown.md)</span><span class="sxs-lookup"><span data-stu-id="12543-114">The **IAttach** interface has no methods of its own; it has only methods that are inherited from the [IMAPIProp](imapipropiunknown.md) interface.</span></span> <span data-ttu-id="12543-115">Dado que el proveedor de almacenamiento de mensajes ya debe implementar propiedades para objetos de mensaje, esto simplifica en gran medida la tarea de admitir datos adjuntos.</span><span class="sxs-lookup"><span data-stu-id="12543-115">Because your message store provider must already implement properties for message objects, this greatly simplifies the task of supporting attachments.</span></span> <span data-ttu-id="12543-116">La implementación **de IAttach básicamente** significa proporcionar una forma de que los clientes obtengan acceso a una tabla de propiedades para datos adjuntos concretos de los mensajes.</span><span class="sxs-lookup"><span data-stu-id="12543-116">Implementing **IAttach** basically means providing a way for clients to access a table of properties for particular attachments on messages.</span></span> 
  
<span data-ttu-id="12543-117">Los datos adjuntos son simplemente datos adjuntos para los que el contenido de los datos adjuntos se almacenan directamente en la propiedad PR_ATTACH_DATA_BIN **(** [PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) de un archivo adjunto.</span><span class="sxs-lookup"><span data-stu-id="12543-117">Data attachments are simply attachments for which the contents of the attachment are stored directly in an attachment's **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) property.</span></span> <span data-ttu-id="12543-118">Los datos adjuntos existen principalmente para permitir a los clientes adjuntar archivos a un mensaje cuando el remitente y el destinatario del mensaje no tienen acceso a un servidor de archivos común.</span><span class="sxs-lookup"><span data-stu-id="12543-118">Data attachments exist primarily to allow clients to attach files to a message when the sender and the recipient of the message do not have access to a common file server.</span></span> <span data-ttu-id="12543-119">Para obtener más información, vea **la PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="12543-119">For more information, see the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="12543-120">Los datos adjuntos del mensaje son datos adjuntos para los que el subobjeto de datos adjuntos es otro [objeto IMessage : MAPIProp](imessageimapiprop.md) .</span><span class="sxs-lookup"><span data-stu-id="12543-120">Message attachments are attachments for which the attachment subobject is another [IMessage : MAPIProp](imessageimapiprop.md) object.</span></span> <span data-ttu-id="12543-121">Dado que los proveedores de al almacenamiento de mensajes ya admiten **la interfaz IMessage,** la compatibilidad con datos adjuntos de mensajes no es difícil.</span><span class="sxs-lookup"><span data-stu-id="12543-121">Because message store providers already support the **IMessage** interface, supporting message attachments is not difficult.</span></span> 
  
<span data-ttu-id="12543-122">Admitir datos adjuntos de objetos OLE significa implementar las interfaces OLE **IStorage**, **IStream** e **IStreamDocfile.**</span><span class="sxs-lookup"><span data-stu-id="12543-122">Supporting OLE object attachments means implementing the OLE **IStorage**, **IStream**, and **IStreamDocfile** interfaces.</span></span> <span data-ttu-id="12543-123">El proveedor del almacén de mensajes debe poder convertir los datos de objeto OLE almacenados en el mensaje en un objeto OLE activo cuando un cliente abre el objeto.</span><span class="sxs-lookup"><span data-stu-id="12543-123">Your message store provider must be able to convert OLE object data stored in the message into an active OLE object when a client opens the object.</span></span> 
  
<span data-ttu-id="12543-124">Los vínculos se incluyen en dos tipos: vínculos a archivos y vínculos a otros mensajes.</span><span class="sxs-lookup"><span data-stu-id="12543-124">Links come in two types: links to files and links to other messages.</span></span> <span data-ttu-id="12543-125">Los vínculos a archivos usan el valor ATTACH_BY_REF_ONLY para la propiedad **PR_ATTACH_METHOD** junto con **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) o **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) para especificar la ubicación de un archivo.</span><span class="sxs-lookup"><span data-stu-id="12543-125">Links to files use the ATTACH_BY_REF_ONLY value for the **PR_ATTACH_METHOD** property along with **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) or **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) to specify the location of a file.</span></span>
  
<span data-ttu-id="12543-126">La forma en que se implementan los vínculos a los mensajes puede depender de aspectos del sistema de mensajería local y, como tal, no se puede documentar por completo aquí.</span><span class="sxs-lookup"><span data-stu-id="12543-126">How one implements links to messages may depend on aspects of the local messaging system and, as such, cannot be fully documented here.</span></span> <span data-ttu-id="12543-127">Por ejemplo, enviar un vínculo a un mensaje almacenado en un almacén de mensajes basado en servidor suele ser solo cuestión de enviar el identificador de entrada del mensaje vinculado, siempre que tanto el remitente como el destinatario tengan acceso a ese servidor.</span><span class="sxs-lookup"><span data-stu-id="12543-127">For example, sending a link to a message that is stored on a server-based message store is typically just a matter of sending the entry identifier of the linked message, providing that both the sender and recipient have access to that server.</span></span> <span data-ttu-id="12543-128">Otras configuraciones del sistema de mensajería presentan otros requisitos y desafíos para implementar vínculos a mensajes.</span><span class="sxs-lookup"><span data-stu-id="12543-128">Other messaging system configurations present other requirements and challenges for implementing links to messages.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="12543-129">Consulte también</span><span class="sxs-lookup"><span data-stu-id="12543-129">See also</span></span>



[<span data-ttu-id="12543-130">Caracter�sticas de almac�n de mensajes</span><span class="sxs-lookup"><span data-stu-id="12543-130">Message Store Features</span></span>](message-store-features.md)

