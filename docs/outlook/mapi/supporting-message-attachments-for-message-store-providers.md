---
title: Admitir datos adjuntos de mensajes para proveedores de almacenamiento de mensajes
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d5fabc40-71e8-4afa-9846-533da605ce6c
description: '�ltima modificaci�n: lunes, 7 de diciembre de 2015'
ms.openlocfilehash: e3d6844f8fe6121d6ea063a9594aaf1fed581ee5
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19820783"
---
# <a name="supporting-message-attachments-for-message-store-providers"></a><span data-ttu-id="ba8f0-103">Admitir datos adjuntos de mensajes para proveedores de almacenamiento de mensajes</span><span class="sxs-lookup"><span data-stu-id="ba8f0-103">Supporting Message Attachments for Message Store Providers</span></span>

 
  
<span data-ttu-id="ba8f0-104">**Hace referencia a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="ba8f0-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="ba8f0-105">El proveedor de almacén de mensajes no es necesario admitir los datos adjuntos del mensaje.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-105">Your message store provider does not need to support message attachments.</span></span> <span data-ttu-id="ba8f0-106">Sin embargo, muchas aplicaciones cliente esperan poder agregar datos adjuntos a los mensajes.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-106">However, many client applications expect to be able to add attachments to messages.</span></span> <span data-ttu-id="ba8f0-107">Si su almacén de mensajes se usará para crear o almacenar IPM. Tenga en cuenta los mensajes, a continuación, se deben admitir los datos adjuntos del mensaje.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-107">If your message store will be used to create or store IPM.Note messages, then you should support message attachments.</span></span> <span data-ttu-id="ba8f0-108">Los proveedores de almacén de mensajes predeterminado también deben admitir los datos adjuntos del mensaje.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-108">Default message store providers should also support message attachments.</span></span> <span data-ttu-id="ba8f0-109">Para obtener más información, vea [Clases de mensaje de MAPI](mapi-message-classes.md)y [Los almacenes de mensajes de forma predeterminada](default-message-stores.md).</span><span class="sxs-lookup"><span data-stu-id="ba8f0-109">For more information, see [MAPI Message Classes](mapi-message-classes.md), and [Default Message Stores](default-message-stores.md).</span></span>
  
<span data-ttu-id="ba8f0-110">Hay cinco tipos de datos adjuntos que es compatible con MAPI: archivo de datos adjuntos, datos adjuntos de datos, datos adjuntos de mensajes, datos adjuntos de objetos OLE y vínculos.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-110">There are five types of attachments that MAPI supports: file attachments, data attachments, message attachments, OLE object attachments, and links.</span></span> <span data-ttu-id="ba8f0-111">Los requisitos para admitir cada tipo son diferentes.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-111">The requirements for supporting each type are different.</span></span> <span data-ttu-id="ba8f0-112">Los clientes de diferencian entre los dos tipos de datos adjuntos por medio de la propiedad **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) en los objetos de datos adjuntos.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-112">Clients differentiate between the two types of attachments by means of the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property on attachment objects.</span></span>
  
<span data-ttu-id="ba8f0-113">Compatibilidad con datos adjuntos significa que la implementación de la [IAttach: IMAPIProp](iattachimapiprop.md) interfaz.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-113">Supporting attachments means implementing the [IAttach : IMAPIProp](iattachimapiprop.md) interface.</span></span> <span data-ttu-id="ba8f0-114">La interfaz **IAttach** no tiene métodos de su propio; tiene sólo los métodos que se heredan de la interfaz [IMAPIProp](imapipropiunknown.md) .</span><span class="sxs-lookup"><span data-stu-id="ba8f0-114">The **IAttach** interface has no methods of its own; it has only methods that are inherited from the [IMAPIProp](imapipropiunknown.md) interface.</span></span> <span data-ttu-id="ba8f0-115">Debido a que el proveedor de almacenes de mensaje ya debe implementar las propiedades de objetos de mensaje, se simplifica en gran medida la tarea de compatibilidad con los datos adjuntos.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-115">Because your message store provider must already implement properties for message objects, this greatly simplifies the task of supporting attachments.</span></span> <span data-ttu-id="ba8f0-116">Implementar **IAttach** básicamente significa que proporciona una manera para que los clientes tener acceso a una tabla de propiedades para determinados archivos adjuntos en los mensajes.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-116">Implementing **IAttach** basically means providing a way for clients to access a table of properties for particular attachments on messages.</span></span> 
  
<span data-ttu-id="ba8f0-117">Datos adjuntos de datos son simplemente datos adjuntos para que el contenido de los datos adjuntos se almacena directamente en la propiedad de **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) de un documento adjunto.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-117">Data attachments are simply attachments for which the contents of the attachment are stored directly in an attachment's **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) property.</span></span> <span data-ttu-id="ba8f0-118">Datos adjuntos de datos existen principalmente para permitir que los clientes adjuntar archivos a un mensaje cuando el remitente y el destinatario del mensaje no tienen acceso a un servidor de archivos comunes.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-118">Data attachments exist primarily to allow clients to attach files to a message when the sender and the recipient of the message do not have access to a common file server.</span></span> <span data-ttu-id="ba8f0-119">Para obtener más información, vea la propiedad **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="ba8f0-119">For more information, see the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="ba8f0-120">Datos adjuntos de mensajes son datos adjuntos para que los subobjetos de datos adjuntos es otro [IMessage: MAPIProp](imessageimapiprop.md) objeto.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-120">Message attachments are attachments for which the attachment subobject is another [IMessage : MAPIProp](imessageimapiprop.md) object.</span></span> <span data-ttu-id="ba8f0-121">Debido a que los proveedores de almacén de mensajes ya admiten **la interfaz** , la compatibilidad con datos adjuntos de mensajes no es difícil.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-121">Because message store providers already support the **IMessage** interface, supporting message attachments is not difficult.</span></span> 
  
<span data-ttu-id="ba8f0-122">Compatibilidad con datos adjuntos de objeto OLE significa que la implementación de las interfaces OLE **IStorage**, **IStream**y **IStreamDocfile** .</span><span class="sxs-lookup"><span data-stu-id="ba8f0-122">Supporting OLE object attachments means implementing the OLE **IStorage**, **IStream**, and **IStreamDocfile** interfaces.</span></span> <span data-ttu-id="ba8f0-123">El proveedor de almacén de mensajes debe ser capaz de convertir los datos de objetos OLE almacenados en el mensaje en un objeto OLE activo cuando un cliente abre el objeto.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-123">Your message store provider must be able to convert OLE object data stored in the message into an active OLE object when a client opens the object.</span></span> 
  
<span data-ttu-id="ba8f0-124">Se incluyen vínculos en dos tipos: vínculos a archivos y vínculos a otros mensajes.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-124">Links come in two types: links to files and links to other messages.</span></span> <span data-ttu-id="ba8f0-125">Vínculos a archivos utilice el valor ATTACH_BY_REF_ONLY para la propiedad **PR_ATTACH_METHOD** junto con **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) o **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) para especificar la ubicación de un archivo.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-125">Links to files use the ATTACH_BY_REF_ONLY value for the **PR_ATTACH_METHOD** property along with **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) or **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) to specify the location of a file.</span></span>
  
<span data-ttu-id="ba8f0-126">Cómo uno implementa vínculos a los mensajes puede depender de aspectos del sistema de mensajería local y, por lo tanto, no se han documentado completamente aquí.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-126">How one implements links to messages may depend on aspects of the local messaging system and, as such, cannot be fully documented here.</span></span> <span data-ttu-id="ba8f0-127">Por ejemplo, enviar un vínculo a un mensaje que se almacena en un almacén de mensajes basado en servidor normalmente es simplemente una cuestión de enviar el identificador de entrada del mensaje vinculado, siempre que el remitente y el destinatario tengan acceso a ese servidor.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-127">For example, sending a link to a message that is stored on a server-based message store is typically just a matter of sending the entry identifier of the linked message, providing that both the sender and recipient have access to that server.</span></span> <span data-ttu-id="ba8f0-128">Otros valores de configuración del sistema mensajería presentan desafíos para la implementación de vínculos a los mensajes y otros requisitos.</span><span class="sxs-lookup"><span data-stu-id="ba8f0-128">Other messaging system configurations present other requirements and challenges for implementing links to messages.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="ba8f0-129">Vea también</span><span class="sxs-lookup"><span data-stu-id="ba8f0-129">See also</span></span>



[<span data-ttu-id="ba8f0-130">Caracter�sticas de almac�n de mensajes</span><span class="sxs-lookup"><span data-stu-id="ba8f0-130">Message Store Features</span></span>](message-store-features.md)

