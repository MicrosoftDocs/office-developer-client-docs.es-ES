---
title: Compatibilidad de datos adJuntos de mensajes para proveedores de almacenamiento de mensajes
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d5fabc40-71e8-4afa-9846-533da605ce6c
description: '�ltima modificaci�n: lunes, 7 de diciembre de 2015'
ms.openlocfilehash: 69d1df5bf206cddd0d25698665c9fd87b81e4ea5
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412138"
---
# <a name="supporting-message-attachments-for-message-store-providers"></a><span data-ttu-id="25964-103">Compatibilidad de datos adJuntos de mensajes para proveedores de almacenamiento de mensajes</span><span class="sxs-lookup"><span data-stu-id="25964-103">Supporting Message Attachments for Message Store Providers</span></span>

 
  
<span data-ttu-id="25964-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="25964-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="25964-105">Su proveedor de almacenamiento de mensajes no necesita admitir datos adjuntos de mensajes.</span><span class="sxs-lookup"><span data-stu-id="25964-105">Your message store provider does not need to support message attachments.</span></span> <span data-ttu-id="25964-106">Sin embargo, muchas aplicaciones cliente esperan poder agregar datos adjuntos a los mensajes.</span><span class="sxs-lookup"><span data-stu-id="25964-106">However, many client applications expect to be able to add attachments to messages.</span></span> <span data-ttu-id="25964-107">Si el almacén de mensajes se va a usar para crear o almacenar IPM. Los mensajes de nota, debe admitir datos adjuntos de mensajes.</span><span class="sxs-lookup"><span data-stu-id="25964-107">If your message store will be used to create or store IPM.Note messages, then you should support message attachments.</span></span> <span data-ttu-id="25964-108">Los proveedores de almacenamiento de mensajes preDeterminados también deben admitir datos adjuntos de mensajes.</span><span class="sxs-lookup"><span data-stu-id="25964-108">Default message store providers should also support message attachments.</span></span> <span data-ttu-id="25964-109">Para obtener más información, consulte [clases de mensajes MAPI](mapi-message-classes.md)y [almacenes de mensajes](default-message-stores.md)predeterminados.</span><span class="sxs-lookup"><span data-stu-id="25964-109">For more information, see [MAPI Message Classes](mapi-message-classes.md), and [Default Message Stores](default-message-stores.md).</span></span>
  
<span data-ttu-id="25964-110">Hay cinco tipos de datos adjuntos compatibles con MAPI: archivos adjuntos, datos adjuntos, datos adjuntos de mensajes, datos adjuntos de objetos OLE y vínculos.</span><span class="sxs-lookup"><span data-stu-id="25964-110">There are five types of attachments that MAPI supports: file attachments, data attachments, message attachments, OLE object attachments, and links.</span></span> <span data-ttu-id="25964-111">Los requisitos para admitir cada tipo son distintos.</span><span class="sxs-lookup"><span data-stu-id="25964-111">The requirements for supporting each type are different.</span></span> <span data-ttu-id="25964-112">Los clientes diferencian entre los dos tipos de datos adjuntos por medio de la propiedad **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) en objetos Attachment.</span><span class="sxs-lookup"><span data-stu-id="25964-112">Clients differentiate between the two types of attachments by means of the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property on attachment objects.</span></span>
  
<span data-ttu-id="25964-113">Los datos adjuntos auxiliares implican la implementación de la interfaz [IAttach: IMAPIProp](iattachimapiprop.md) .</span><span class="sxs-lookup"><span data-stu-id="25964-113">Supporting attachments means implementing the [IAttach : IMAPIProp](iattachimapiprop.md) interface.</span></span> <span data-ttu-id="25964-114">La interfaz **IAttach** no tiene ningún método propio; solo tiene métodos que se heredan de la interfaz [IMAPIProp](imapipropiunknown.md) .</span><span class="sxs-lookup"><span data-stu-id="25964-114">The **IAttach** interface has no methods of its own; it has only methods that are inherited from the [IMAPIProp](imapipropiunknown.md) interface.</span></span> <span data-ttu-id="25964-115">Dado que el proveedor de almacenamiento de mensajes ya debe implementar las propiedades de los objetos de mensaje, esto simplifica enormemente la tarea de admitir datos adjuntos.</span><span class="sxs-lookup"><span data-stu-id="25964-115">Because your message store provider must already implement properties for message objects, this greatly simplifies the task of supporting attachments.</span></span> <span data-ttu-id="25964-116">La implementación de **IAttach** básicamente significa ofrecer una manera de que los clientes tengan acceso a una tabla de propiedades para datos adjuntos concretos de los mensajes.</span><span class="sxs-lookup"><span data-stu-id="25964-116">Implementing **IAttach** basically means providing a way for clients to access a table of properties for particular attachments on messages.</span></span> 
  
<span data-ttu-id="25964-117">Los datos adjuntos son simplemente archivos adjuntos en los que el contenido de los datos adjuntos se almacena directamente en la propiedad **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) de los datos adjuntos.</span><span class="sxs-lookup"><span data-stu-id="25964-117">Data attachments are simply attachments for which the contents of the attachment are stored directly in an attachment's **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) property.</span></span> <span data-ttu-id="25964-118">Los datos adjuntos existen principalmente para permitir que los clientes adjunten archivos a un mensaje cuando el remitente y el destinatario del mensaje no tienen acceso a un servidor de archivos común.</span><span class="sxs-lookup"><span data-stu-id="25964-118">Data attachments exist primarily to allow clients to attach files to a message when the sender and the recipient of the message do not have access to a common file server.</span></span> <span data-ttu-id="25964-119">Para obtener más información, vea la propiedad **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="25964-119">For more information, see the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="25964-120">Los datos adjuntos de mensajes son datos adjuntos para los que el subobjeto Attachment es otro objeto [IMessage: MAPIProp](imessageimapiprop.md) .</span><span class="sxs-lookup"><span data-stu-id="25964-120">Message attachments are attachments for which the attachment subobject is another [IMessage : MAPIProp](imessageimapiprop.md) object.</span></span> <span data-ttu-id="25964-121">Como los proveedores de almacenamiento de mensajes ya admiten la interfaz **IMessage** , la compatibilidad con datos adjuntos de mensajes no es difícil.</span><span class="sxs-lookup"><span data-stu-id="25964-121">Because message store providers already support the **IMessage** interface, supporting message attachments is not difficult.</span></span> 
  
<span data-ttu-id="25964-122">La compatibilidad con datos adjuntos de objetos OLE significa implementar las interfaces OLE **IStorage**, **IStream**y **IStreamDocfile** .</span><span class="sxs-lookup"><span data-stu-id="25964-122">Supporting OLE object attachments means implementing the OLE **IStorage**, **IStream**, and **IStreamDocfile** interfaces.</span></span> <span data-ttu-id="25964-123">El proveedor de almacenamiento de mensajes debe poder convertir los datos de objeto OLE almacenados en el mensaje en un objeto OLE activo cuando un cliente abre el objeto.</span><span class="sxs-lookup"><span data-stu-id="25964-123">Your message store provider must be able to convert OLE object data stored in the message into an active OLE object when a client opens the object.</span></span> 
  
<span data-ttu-id="25964-124">Los vínculos vienen en dos tipos: vínculos a archivos y vínculos a otros mensajes.</span><span class="sxs-lookup"><span data-stu-id="25964-124">Links come in two types: links to files and links to other messages.</span></span> <span data-ttu-id="25964-125">Vínculos a archivos use el valor ATTACH_BY_REF_ONLY de la propiedad **PR_ATTACH_METHOD** junto con **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) o **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) para especificar la ubicación de un archivo.</span><span class="sxs-lookup"><span data-stu-id="25964-125">Links to files use the ATTACH_BY_REF_ONLY value for the **PR_ATTACH_METHOD** property along with **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) or **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) to specify the location of a file.</span></span>
  
<span data-ttu-id="25964-126">La forma en que implementan los vínculos a los mensajes puede depender de aspectos del sistema de mensajería local y, como tal, no se puede documentar completamente aquí.</span><span class="sxs-lookup"><span data-stu-id="25964-126">How one implements links to messages may depend on aspects of the local messaging system and, as such, cannot be fully documented here.</span></span> <span data-ttu-id="25964-127">Por ejemplo, el envío de un vínculo a un mensaje que se almacena en un almacén de mensajes basado en servidor suele ser sólo cuestión de enviar el identificador de entrada del mensaje vinculado, siempre que tanto el remitente como el destinatario tengan acceso a ese servidor.</span><span class="sxs-lookup"><span data-stu-id="25964-127">For example, sending a link to a message that is stored on a server-based message store is typically just a matter of sending the entry identifier of the linked message, providing that both the sender and recipient have access to that server.</span></span> <span data-ttu-id="25964-128">Otras configuraciones del sistema de mensajería presentan otros requisitos y desafíos para implementar vínculos a los mensajes.</span><span class="sxs-lookup"><span data-stu-id="25964-128">Other messaging system configurations present other requirements and challenges for implementing links to messages.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="25964-129">Ver también</span><span class="sxs-lookup"><span data-stu-id="25964-129">See also</span></span>



[<span data-ttu-id="25964-130">Caracter�sticas de almac�n de mensajes</span><span class="sxs-lookup"><span data-stu-id="25964-130">Message Store Features</span></span>](message-store-features.md)

