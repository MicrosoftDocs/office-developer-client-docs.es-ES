---
title: Servidores de formulario MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 855292b8-028e-4c1e-87ed-3f20b9ba584a
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: 3c95f6a1d4d50dd6552c6e786d17c40da14f3f3c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419110"
---
# <a name="mapi-form-servers"></a><span data-ttu-id="8a51a-103">Servidores de formulario MAPI</span><span class="sxs-lookup"><span data-stu-id="8a51a-103">MAPI Form Servers</span></span>

  
  
<span data-ttu-id="8a51a-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="8a51a-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="8a51a-105">Desde la perspectiva del usuario, un formulario suele ser una hoja de propiedades de un mensaje o un formulario de entrada de datos que permite a los usuarios escribir información estructurada.</span><span class="sxs-lookup"><span data-stu-id="8a51a-105">From the user's perspective, a form is usually a property sheet for a message or a data-entry form that enables users to enter structured information.</span></span> <span data-ttu-id="8a51a-106">Sin embargo, puede ser cualquier interfaz de usuario asociada a una clase de mensaje.</span><span class="sxs-lookup"><span data-stu-id="8a51a-106">However, it can be any user interface that is associated with a message class.</span></span> <span data-ttu-id="8a51a-107">Desde el punto de vista de un programador, un formulario consta de:</span><span class="sxs-lookup"><span data-stu-id="8a51a-107">From a programmer's point of view, a form consists of:</span></span>
  
- <span data-ttu-id="8a51a-108">Un tipo de mensaje MAPI con su propia clase de mensaje e identificador OLE.</span><span class="sxs-lookup"><span data-stu-id="8a51a-108">A type of MAPI message with its own message class and OLE identifier.</span></span>
    
- <span data-ttu-id="8a51a-109">Archivo ejecutable que implementa el servidor de formularios.</span><span class="sxs-lookup"><span data-stu-id="8a51a-109">The executable file that implements the form server.</span></span>
    
- <span data-ttu-id="8a51a-110">Una colección de propiedades MAPI, personalizadas o de otro tipo, que usa el servidor de formularios.</span><span class="sxs-lookup"><span data-stu-id="8a51a-110">A collection of MAPI properties — custom or otherwise — that the form server uses.</span></span> <span data-ttu-id="8a51a-111">Algunos o todos pueden estar disponibles para que los clientes de mensajería puedan usarlos.</span><span class="sxs-lookup"><span data-stu-id="8a51a-111">Some or all of these may be available to messaging clients for use.</span></span>
    
- <span data-ttu-id="8a51a-112">Archivo de configuración que describe el formulario y que usa el administrador de formularios.</span><span class="sxs-lookup"><span data-stu-id="8a51a-112">The configuration file that describes the form and is used by the form manager.</span></span>
    
<span data-ttu-id="8a51a-113">Dado que los formularios [son objetos IMessage,](imessageimapiprop.md) presentan propiedades y comportamiento coherentes con los objetos de mensaje MAPI.</span><span class="sxs-lookup"><span data-stu-id="8a51a-113">Because forms are [IMessage](imessageimapiprop.md) objects, they exhibit properties and behavior that is consistent with MAPI message objects.</span></span> <span data-ttu-id="8a51a-114">Sin embargo, dado que los formularios pueden tener propiedades personalizadas, controles y una representación de presentación específica de la aplicación, las interfaces MAPI que usan los formularios son lo suficientemente genéricas como para permitir cualquier tipo de interfaz necesaria.</span><span class="sxs-lookup"><span data-stu-id="8a51a-114">However, because forms can have custom properties, controls, and a display rendering that is application-specific, the MAPI interfaces that forms use are generic enough to permit any sort of interface that is needed.</span></span> <span data-ttu-id="8a51a-115">La definición real de un formulario se almacena en una biblioteca de formularios, que se describe más adelante en esta sección.</span><span class="sxs-lookup"><span data-stu-id="8a51a-115">The actual definition of a form is stored in a form library, which is discussed later in this section.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="8a51a-116">De forma más precisa, todos los mensajes son instancias de formularios MAPI.</span><span class="sxs-lookup"><span data-stu-id="8a51a-116">More accurately, all messages are instances of MAPI forms.</span></span> <span data-ttu-id="8a51a-117">Sin embargo, suele ser más fácil pensar en formularios personalizados como casos especiales de mensajes, ya que los formularios para redactar y leer mensajes de correo electrónico típicos son los formularios más usados.</span><span class="sxs-lookup"><span data-stu-id="8a51a-117">However, it is usually easier to think of custom forms as special cases of messages, since forms for composing and reading typical email messages are the most commonly used forms.</span></span> <span data-ttu-id="8a51a-118">El hecho de que todos los mensajes sean simplemente formularios proporciona a los formularios personalizados el mismo estado que cualquier otro mensaje en el sistema MAPI.</span><span class="sxs-lookup"><span data-stu-id="8a51a-118">The fact that all messages are really just forms gives custom forms the same status as any other message in the MAPI system.</span></span> 
  
<span data-ttu-id="8a51a-119">Cada formulario tiene un conjunto de propiedades, algunas de las cuales son visibles en la interfaz de usuario del formulario.</span><span class="sxs-lookup"><span data-stu-id="8a51a-119">Every form has a set of properties, some of which are visible in the form's user interface.</span></span> <span data-ttu-id="8a51a-120">Normalmente, las propiedades coinciden con los campos de la interfaz de usuario del formulario.</span><span class="sxs-lookup"><span data-stu-id="8a51a-120">Usually, properties are matched to fields in the form's user interface.</span></span> <span data-ttu-id="8a51a-121">Por ejemplo, un formulario de pedido de compra puede tener los campos Item, Description, Price, Tax y Subtotal.</span><span class="sxs-lookup"><span data-stu-id="8a51a-121">For example, a purchase order form might have the fields Item, Description, Price, Tax, and Subtotal.</span></span> <span data-ttu-id="8a51a-122">Estos campos son simplemente representaciones visuales de propiedades de formulario con los mismos nombres.</span><span class="sxs-lookup"><span data-stu-id="8a51a-122">These fields are simply visual renderings of form properties of the same names.</span></span> <span data-ttu-id="8a51a-123">Los clientes comprueban qué propiedades son compatibles con una clase de mensaje determinada mediante el método [IMAPIFormInfo::CalcFormPropSet,](imapiforminfo-calcformpropset.md) que implementa el administrador de formularios MAPI.</span><span class="sxs-lookup"><span data-stu-id="8a51a-123">Clients ascertain which properties are supported by a particular message class through the [IMAPIFormInfo::CalcFormPropSet](imapiforminfo-calcformpropset.md) method, which is implemented by the MAPI form manager.</span></span> 
  
<span data-ttu-id="8a51a-124">Al igual que los mensajes básicos, los formularios MAPI pueden contener todas las propiedades de mensaje estándar, como el remitente, el destinatario previsto y cuándo se envió el mensaje.</span><span class="sxs-lookup"><span data-stu-id="8a51a-124">Like basic messages, MAPI forms can contain all the standard message properties such as the sender, the intended recipient, and when the message was sent.</span></span> <span data-ttu-id="8a51a-125">Los formularios también pueden contener cualquier número de propiedades personalizadas específicas del formulario.</span><span class="sxs-lookup"><span data-stu-id="8a51a-125">Forms can also contain any number of custom properties that are specific to the form.</span></span> <span data-ttu-id="8a51a-126">Por ejemplo, un formulario "Informe de errores" puede contener propiedades personalizadas para tipo de error, gravedad de error y versión del producto.</span><span class="sxs-lookup"><span data-stu-id="8a51a-126">For example a "Bug Report" form might contain custom properties for Bug Type, Bug Severity, and Product Version.</span></span>
  
<span data-ttu-id="8a51a-127">Para crear un formulario, debe implementar un servidor de formularios.</span><span class="sxs-lookup"><span data-stu-id="8a51a-127">To create a form you must implement a form server.</span></span> <span data-ttu-id="8a51a-128">El servidor de formulario es el archivo ejecutable que se carga cuando un cliente de mensajería necesita mostrar un mensaje que es el tipo admitido por el servidor de formularios.</span><span class="sxs-lookup"><span data-stu-id="8a51a-128">The form server is the executable file that is loaded when a messaging client needs to display a message that is the type supported by the form server.</span></span> <span data-ttu-id="8a51a-129">A su vez, el servidor de formularios crea objetos de formulario según sea necesario para mostrar mensajes específicos y controlar las interacciones del usuario con esos mensajes.</span><span class="sxs-lookup"><span data-stu-id="8a51a-129">The form server in turn creates form objects as necessary to display specific messages and handle user interactions with those messages.</span></span>
  
<span data-ttu-id="8a51a-130">Cada servidor de formulario tiene asociado un archivo de configuración.</span><span class="sxs-lookup"><span data-stu-id="8a51a-130">Every form server has a configuration file associated with it.</span></span> <span data-ttu-id="8a51a-131">Este archivo contiene información que describe el servidor de formularios para beneficio del administrador de formularios.</span><span class="sxs-lookup"><span data-stu-id="8a51a-131">This file contains information that describes the form server for the benefit of the form manager.</span></span> <span data-ttu-id="8a51a-132">El administrador de formularios usa esta información al instalar el servidor de formularios en una biblioteca de formularios.</span><span class="sxs-lookup"><span data-stu-id="8a51a-132">The form manager uses this information when installing the form server into a form library.</span></span>
  
<span data-ttu-id="8a51a-133">Para obtener información detallada sobre cómo crear las partes de un formulario, vea [Desarrollar servidores de formulario MAPI.](developing-mapi-form-servers.md)</span><span class="sxs-lookup"><span data-stu-id="8a51a-133">For details on creating the parts of a form, see [Developing MAPI Form Servers](developing-mapi-form-servers.md).</span></span>
  
<span data-ttu-id="8a51a-134">Los servidores de formulario cumplen con el modelo de objetos componentes (COM).</span><span class="sxs-lookup"><span data-stu-id="8a51a-134">Form servers adhere to the Component Object Model (COM).</span></span> <span data-ttu-id="8a51a-135">Los servidores de formulario se ejecutan como ejecutables independientes, no como servidores en proceso.</span><span class="sxs-lookup"><span data-stu-id="8a51a-135">Form servers run as standalone executables, not as in-proc servers.</span></span> <span data-ttu-id="8a51a-136">Para obtener más información, consulta la sección COM ActiveX Object Services en Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="8a51a-136">For more information, see the COM and ActiveX Object Services section in the Windows SDK.</span></span>
  
<span data-ttu-id="8a51a-137">Un identificador de clase único (CLSID) identifica cada servidor de formulario.</span><span class="sxs-lookup"><span data-stu-id="8a51a-137">A unique class identifier (CLSID) identifies each form server.</span></span> <span data-ttu-id="8a51a-138">Siempre hay una asignación uno a uno entre un identificador de clase y su clase de mensaje.</span><span class="sxs-lookup"><span data-stu-id="8a51a-138">There is always a one-to-one mapping between a class identifier and its message class.</span></span> <span data-ttu-id="8a51a-139">Sin embargo, esto no significa que un servidor de formularios solo pueda trabajar con mensajes de una clase de mensaje.</span><span class="sxs-lookup"><span data-stu-id="8a51a-139">This does not mean, however, that a form server can only work with messages of one message class.</span></span> <span data-ttu-id="8a51a-140">Si no hay ningún servidor de formulario disponible para dar servicio a un mensaje de una clase determinada, el administrador de formularios que se está utilizando debe intentar buscar un servidor de formulario para una clase de mensaje superior en la jerarquía de clases de mensaje; El administrador de formularios predeterminado suministrado con Windows SDK hace esto.</span><span class="sxs-lookup"><span data-stu-id="8a51a-140">If no form server is available to service a message of a particular class, the form manager being used should attempt to find a form server for a message class higher in the message class hierarchy; the default form manager supplied with the Windows SDK does this.</span></span> <span data-ttu-id="8a51a-141">Este servidor de formulario probablemente podrá representar solo un subconjunto de las propiedades del mensaje (las admitidas por la superclase), pero será mejor que nada.</span><span class="sxs-lookup"><span data-stu-id="8a51a-141">Such a form server will probably be able to render only a subset of the message's properties (the ones supported by the superclass), but it will be better than nothing.</span></span> <span data-ttu-id="8a51a-142">Lo que sucede cuando no se encuentra ningún servidor de formulario que coincida es un detalle de implementación específico del administrador de formularios que se está utilizando; Cuando esto sucede, el administrador de formularios predeterminado no abre mensajes.</span><span class="sxs-lookup"><span data-stu-id="8a51a-142">What happens when no matching form server is found at all is an implementation detail specific to the form manager being used; the default form manager does not open messages when this happens.</span></span>
  
<span data-ttu-id="8a51a-143">Para obtener más información, vea [clases de mensajes MAPI](mapi-message-classes.md).</span><span class="sxs-lookup"><span data-stu-id="8a51a-143">For more information, see [MAPI Message Classes](mapi-message-classes.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="8a51a-144">Consulte también</span><span class="sxs-lookup"><span data-stu-id="8a51a-144">See also</span></span>



[<span data-ttu-id="8a51a-145">Formularios MAPI</span><span class="sxs-lookup"><span data-stu-id="8a51a-145">MAPI Forms</span></span>](mapi-forms.md)

