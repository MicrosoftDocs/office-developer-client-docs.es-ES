---
title: Implementación de resolución de nombres
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a4c71b08-c47a-4421-8603-d5356d32dca9
description: '�ltima modificaci�n: s�bado, 23 de julio de 2011'
ms.openlocfilehash: 4d55404149baca07a64b75d460bdfb2a8c541725
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19817690"
---
# <a name="implementing-name-resolution"></a><span data-ttu-id="0ac97-103">Implementación de resolución de nombres</span><span class="sxs-lookup"><span data-stu-id="0ac97-103">Implementing Name Resolution</span></span>

  
  
<span data-ttu-id="0ac97-104">**Se aplica a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="0ac97-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="0ac97-105">Los proveedores de la libreta de direcciones son responsables de admitir la resolución de nombres, el proceso de asociar un identificador de entrada con un nombre para mostrar.</span><span class="sxs-lookup"><span data-stu-id="0ac97-105">Address book providers are responsible for supporting name resolution — the process of associating an entry identifier with a display name.</span></span> <span data-ttu-id="0ac97-106">Los clientes iniciar la resolución de nombres cuando llama a [IAddrBook::ResolveName](iaddrbook-resolvename.md) para asegurarse de que cada miembro de la lista de destinatarios de un mensaje saliente corresponde a una dirección válida.</span><span class="sxs-lookup"><span data-stu-id="0ac97-106">Clients initiate name resolution when they call [IAddrBook::ResolveName](iaddrbook-resolvename.md) to ensure that each member of an outgoing message's recipient list corresponds to a valid address.</span></span> 
  
<span data-ttu-id="0ac97-107">Su proveedor puede admitir la resolución de nombres:</span><span class="sxs-lookup"><span data-stu-id="0ac97-107">Your provider can support name resolution by:</span></span>
  
- <span data-ttu-id="0ac97-108">Compatibilidad con la restricción de propiedad **PR_ANR** ([PidTagAnr](pidtaganr-canonical-property.md)), un requisito para todos los contenedores de la libreta de direcciones.</span><span class="sxs-lookup"><span data-stu-id="0ac97-108">Supporting the **PR_ANR** ([PidTagAnr](pidtaganr-canonical-property.md)) property restriction, a requirement for all address book containers.</span></span>
    
- <span data-ttu-id="0ac97-109">Implementación del método [IABContainer:: ResolveNames](iabcontainer-resolvenames.md) , una opción para todos los contenedores de la libreta de direcciones.</span><span class="sxs-lookup"><span data-stu-id="0ac97-109">Implementing the [IABContainer::ResolveNames](iabcontainer-resolvenames.md) method, an option for all address book containers.</span></span> 
    
<span data-ttu-id="0ac97-110">Si decide admitir **IABContainer:: ResolveNames**, intenta localizar a una coincidencia exacta para cada nombre para mostrar sin resolver en la estructura [ADRLIST](adrlist.md) pasada con el parámetro _lpAdrList_ .</span><span class="sxs-lookup"><span data-stu-id="0ac97-110">If you choose to support **IABContainer::ResolveNames**, attempt to locate an exact match for each unresolved display name in the [ADRLIST](adrlist.md) structure passed in with the  _lpAdrList_ parameter.</span></span> <span data-ttu-id="0ac97-111">Puede identifiy un nombre para mostrar sin resolver porque falta la propiedad de **entrada del objeto** ([PidTagEntryId](pidtagentryid-canonical-property.md)) en la matriz de valores de propiedad en su miembro **aEntries** de la estructura **ADRLIST** .</span><span class="sxs-lookup"><span data-stu-id="0ac97-111">You can identifiy an unresolved display name because it is missing the **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) property in the property value array in its **aEntries** member of the **ADRLIST** structure.</span></span> <span data-ttu-id="0ac97-112">Omitir las entradas que tienen cero propiedades asociadas a ellos.</span><span class="sxs-lookup"><span data-stu-id="0ac97-112">Ignore any entries that have zero properties associated with them.</span></span> 
  
<span data-ttu-id="0ac97-113">Notificar el resultado de su intento de resolución en el parámetro _lpFlagList_ , una matriz de marcadores que corresponde a la matriz de nombres para mostrar en _lpAdrList_.</span><span class="sxs-lookup"><span data-stu-id="0ac97-113">Report the result of your attempt at resolution in the  _lpFlagList_ parameter, an array of flags that corresponds to the array of display names in  _lpAdrList_.</span></span> <span data-ttu-id="0ac97-114">Los marcadores son posicionales tal que la primera marca corresponde al primer miembro de **aEntries** en la estructura **ADRLIST** , el segundo indicador se corresponde con el segundo miembro de **aEntries** y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="0ac97-114">The flags are positional such that the first flag corresponds to the first **aEntries** member in the **ADRLIST** structure, the second flag corresponds to the second **aEntries** member, and so on.</span></span> 
  
<span data-ttu-id="0ac97-115">Existen tres resultados posibles para cada entrada sin resolver:</span><span class="sxs-lookup"><span data-stu-id="0ac97-115">There are three possible results for each unresolved entry:</span></span>
  
- <span data-ttu-id="0ac97-116">Se encontró ninguna coincidencia, lo que significa que ninguna de las entradas en las entradas de contenedor coinciden con la entrada en la estructura **ADRLIST** .</span><span class="sxs-lookup"><span data-stu-id="0ac97-116">No match was found, meaning that none of the entries in your container entries match the entry in the **ADRLIST** structure.</span></span> <span data-ttu-id="0ac97-117">Establezca la entrada correspondiente en el parámetro _lpFlagList_ a MAPI_UNRESOLVED.</span><span class="sxs-lookup"><span data-stu-id="0ac97-117">Set the corresponding entry in the  _lpFlagList_ parameter to MAPI_UNRESOLVED.</span></span> 
    
- <span data-ttu-id="0ac97-118">Se encontraron varias coincidencias, lo que significa que no hay varias entradas de contenedor que coinciden con la entrada en la estructura **ADRLIST** .</span><span class="sxs-lookup"><span data-stu-id="0ac97-118">Several matches can be found, meaning that there are multiple container entries that match the entry in the **ADRLIST** structure.</span></span> <span data-ttu-id="0ac97-119">Establezca la entrada correspondiente en el parámetro _lpFlagList_ a MAPI_AMBIGUOUS.</span><span class="sxs-lookup"><span data-stu-id="0ac97-119">Set the corresponding entry in the  _lpFlagList_ parameter to MAPI_AMBIGUOUS.</span></span> <span data-ttu-id="0ac97-120">No cambie el número de entradas en la estructura **ADRLIST** .</span><span class="sxs-lookup"><span data-stu-id="0ac97-120">Do not change the number of entries in the **ADRLIST** structure.</span></span> 
    
- <span data-ttu-id="0ac97-121">Puede encontrar una coincidencia exacta, lo que significa que no hay entrada sólo un contenedor que coincida con la entrada en la estructura **ADRLIST** .</span><span class="sxs-lookup"><span data-stu-id="0ac97-121">An exact match can be found, meaning that there is only one container entry that matches the entry in the **ADRLIST** structure.</span></span> <span data-ttu-id="0ac97-122">Establecer al miembro correspondiente en el parámetro _lpFlagList_ a MAPI_RESOLVED y agregue el identificador de entrada a la matriz de las propiedades asociadas con la entrada **ADRLIST** .</span><span class="sxs-lookup"><span data-stu-id="0ac97-122">Set the corresponding member in the  _lpFlagList_ parameter to MAPI_RESOLVED and add the entry identifier to the array of properties associated with the **ADRLIST** entry.</span></span> 
    
<span data-ttu-id="0ac97-123">Si decide no admitir **IABContainer:: ResolveNames**, devolver MAPI_E_NO_SUPPORT de su implementación.</span><span class="sxs-lookup"><span data-stu-id="0ac97-123">If you choose not to support **IABContainer::ResolveNames**, return MAPI_E_NO_SUPPORT from your implementation.</span></span>
  
<span data-ttu-id="0ac97-124">Todos los proveedores de libreta de direcciones son necesarios para admitir la resolución de nombres ambiguos: la restricción de propiedad **PR_ANR** : en las tablas de contenido de sus contenedores.</span><span class="sxs-lookup"><span data-stu-id="0ac97-124">All address book providers are required to support ambiguous name resolution — the **PR_ANR** property restriction — on their containers' contents tables.</span></span> <span data-ttu-id="0ac97-125">Para proporcionar este soporte técnico, controlar la restricción de PR_ANR en su implementación de [IMAPITable:: Restrict](imapitable-restrict.md) mediante la realización de un tipo "mejor adivinar" de búsqueda, comparación con una o más propiedades determinadas que tiene sentido para su proveedor.</span><span class="sxs-lookup"><span data-stu-id="0ac97-125">To provide this support, handle the PR_ANR restriction in your implementation of [IMAPITable::Restrict](imapitable-restrict.md) by performing a "best guess" type of search, matching against one or more particular properties that make sense for your provider.</span></span> <span data-ttu-id="0ac97-126">Puede usar la misma propiedad o las propiedades de cada vez, como **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) o **PR_ACCOUNT** ([PidTagAccount](pidtagaccount-canonical-property.md)), o permitir que un administrador elegir de una lista de propiedades aceptables.</span><span class="sxs-lookup"><span data-stu-id="0ac97-126">You can choose to use the same property or properties every time, such as **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) or **PR_ACCOUNT** ([PidTagAccount](pidtagaccount-canonical-property.md)), or allow an administrator to choose from a list of acceptable properties.</span></span> 
  
<span data-ttu-id="0ac97-127">Aunque la mayoría de los proveedores proporciona su propia implementación de la tabla de contenido, puede personalizar la implementación proporcionada por MAPI a través de la función [CreateTable](createtable.md) .</span><span class="sxs-lookup"><span data-stu-id="0ac97-127">Although most providers supply their own contents table implementation, you can customize the implementation supplied by MAPI through the [CreateTable](createtable.md) function.</span></span> <span data-ttu-id="0ac97-128">Sin embargo, debido a que la implementación de MAPI no admite restricciones de ningún tipo, debe crear un objeto contenedor para incluir una versión personalizada de **Restrict** que intercepta la llamada.</span><span class="sxs-lookup"><span data-stu-id="0ac97-128">However, because the MAPI implementation does not support restrictions of any kind, you must create a wrapper object to include a customized version of **Restrict** that intercepts the call.</span></span> 
  

