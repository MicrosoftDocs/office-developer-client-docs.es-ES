---
title: Abrir un almacén de mensajes
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 43b23fd7-999a-42c0-8f4d-47f5de266bdb
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: 39d6df6db329abf7509f816165341ea0eda8331b
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19818426"
---
# <a name="opening-a-message-store"></a><span data-ttu-id="e9f4d-103">Abrir un almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="e9f4d-103">Opening a message store</span></span>

<span data-ttu-id="e9f4d-104">**Hace referencia a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="e9f4d-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="e9f4d-105">Dependiendo del perfil, un cliente tendrá que abrir uno o más almacenes de mensaje durante una sesión típica.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-105">Depending on the profile, a client will need to open one or more message stores during a typical session.</span></span> <span data-ttu-id="e9f4d-106">Abrir un almacén de mensajes significa para obtener acceso a un puntero a su [IMsgStore: IMAPIProp](imsgstoreimapiprop.md) implementación.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-106">Opening a message store means gaining access to a pointer to its [IMsgStore : IMAPIProp](imsgstoreimapiprop.md) implementation.</span></span> <span data-ttu-id="e9f4d-107">La interfaz de **IMsgStore** proporciona los métodos de notificación, hacer que las asignaciones de carpetas y obtener acceso a carpetas y mensajes.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-107">The **IMsgStore** interface provides methods for notification, making folder assignments, and accessing folders and messages.</span></span> 
  
<span data-ttu-id="e9f4d-108">Los clientes abren los almacenes de mensajes en el inicio de sesión y cuando se modifica un perfil.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-108">Clients open message stores at logon and when a profile is being modified.</span></span> <span data-ttu-id="e9f4d-109">Si el cliente permite a los usuarios agregar almacenes de mensajes para el perfil durante una sesión activa, puede abrirlos inmediatamente u omitirlos hasta la siguiente sesión.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-109">If your client allows users to add message stores to the profile during an active session, you can either open them immediately or ignore them until the next session.</span></span> <span data-ttu-id="e9f4d-110">Si se registra para recibir notificaciones en la tabla de almacenamiento de mensajes, se le avisará a la disponibilidad de un nuevo almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-110">By registering for notifications on the message store table, you will be alerted to the availability of a new message store.</span></span>
  
<span data-ttu-id="e9f4d-111">Para abrir un almacén de mensajes, debe tener su identificador de entrada disponible.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-111">To open a message store, you must have its entry identifier available.</span></span> <span data-ttu-id="e9f4d-112">La mayoría de los clientes tener acceso a los identificadores de entrada de los almacenes de mensajes que desean abrir a través de la tabla de almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-112">Most clients access the entry identifiers for the message stores they wish to open through the message store table.</span></span> <span data-ttu-id="e9f4d-113">Sin embargo, algunos mensajes almacena el formato de sus identificadores de entrada, lo que permite a los clientes el desvío de la tabla de almacén de mensajes y construir el identificador de entrada necesario del documento.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-113">However, some message stores document the format of their entry identifiers, thereby enabling clients to bypass the message store table and construct the necessary entry identifier.</span></span> <span data-ttu-id="e9f4d-114">Este identificador de entrada puede pasar directamente a [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md) y MAPI crea automáticamente una sección de perfil para el proveedor sin asociarla con cualquier servicio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-114">They can pass this entry identifier directly to [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md) and MAPI automatically creates a profile section for the provider without associating it with any message service.</span></span> 
  
## <a name="retrieve-an-entry-identifier-from-the-message-store-table"></a><span data-ttu-id="e9f4d-115">Recuperar un identificador de entrada de la tabla de almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="e9f4d-115">Retrieve an entry identifier from the message store table</span></span>
  
1. <span data-ttu-id="e9f4d-116">Llame a [IMAPISession::GetMsgStoresTable](imapisession-getmsgstorestable.md) para abrir la tabla de almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-116">Call [IMAPISession::GetMsgStoresTable](imapisession-getmsgstorestable.md) to open the message store table.</span></span> 
    
2. <span data-ttu-id="e9f4d-117">Llame a **IMAPITable::SetColumns** para limitar la tabla a un conjunto de columna pequeña que incluye las siguientes columnas:</span><span class="sxs-lookup"><span data-stu-id="e9f4d-117">Call **IMAPITable::SetColumns** to limit the table to a small column set that includes the following columns:</span></span> 
    
   - <span data-ttu-id="e9f4d-118">**PR_PROVIDER_DISPLAY** o **PR_DISPLAY_NAME**</span><span class="sxs-lookup"><span data-stu-id="e9f4d-118">**PR_PROVIDER_DISPLAY** or **PR_DISPLAY_NAME**</span></span>
   - <span data-ttu-id="e9f4d-119">Propiedades de **entrada del objeto**</span><span class="sxs-lookup"><span data-stu-id="e9f4d-119">**PR_ENTRYID** properties</span></span> 
   - <span data-ttu-id="e9f4d-120">**PR_MDB_PROVIDER**</span><span class="sxs-lookup"><span data-stu-id="e9f4d-120">**PR_MDB_PROVIDER**</span></span>
   - <span data-ttu-id="e9f4d-121">**PR_RESOURCE_FLAGS**</span><span class="sxs-lookup"><span data-stu-id="e9f4d-121">**PR_RESOURCE_FLAGS**</span></span>
    
3. <span data-ttu-id="e9f4d-122">Crear una restricción para filtrar la fila que representa el almacén de mensajes que se va a abrir.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-122">Build a restriction to filter out the row that represents the message store to be opened.</span></span> <span data-ttu-id="e9f4d-123">Para obtener más información acerca de buscando el almacén de mensajes de forma predeterminada, vea [Abrir el almacén de mensajes predeterminado](opening-the-default-message-store.md).</span><span class="sxs-lookup"><span data-stu-id="e9f4d-123">For more information about looking for the default message store, see [Opening the Default Message Store](opening-the-default-message-store.md).</span></span> <span data-ttu-id="e9f4d-124">Para buscar un almacén de mensajes por su nombre, aplicar cualquiera de las restricciones de propiedad siguientes:</span><span class="sxs-lookup"><span data-stu-id="e9f4d-124">To look for a message store by name, apply any of the following property restrictions:</span></span>
    
   - <span data-ttu-id="e9f4d-125">Coincidencia de **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)) con el nombre general para este tipo de almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-125">Match **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)) with the general name for this type of message store.</span></span> <span data-ttu-id="e9f4d-126">Por ejemplo, se puede establecer PR_PROVIDER_DISPLAY en "Carpetas personales".</span><span class="sxs-lookup"><span data-stu-id="e9f4d-126">For example, PR_PROVIDER_DISPLAY might be set to "Personal Folders".</span></span>
    
   - <span data-ttu-id="e9f4d-127">Coincidencia **PR_MDB_PROVIDER** ([PidTagStoreProvider](pidtagstoreprovider-canonical-property.md)) con la específica **MAPIUID** para este tipo de almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-127">Match **PR_MDB_PROVIDER** ([PidTagStoreProvider](pidtagstoreprovider-canonical-property.md)) with the specific **MAPIUID** for this type of message store.</span></span> 
    
   - <span data-ttu-id="e9f4d-128">Coincidencia **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) con el nombre para este almacén de mensajes determinado.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-128">Match **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) with the name for this particular message store.</span></span> <span data-ttu-id="e9f4d-129">Por ejemplo, **PR_DISPLAY_NAME** puede estar establecido en "Mis mensajes para el año Fiscal 2010".</span><span class="sxs-lookup"><span data-stu-id="e9f4d-129">For example, **PR_DISPLAY_NAME** might be set to "My Messages for Fiscal Year 2010."</span></span> 
    
4. <span data-ttu-id="e9f4d-130">Llame a [HrQueryAllRows](hrqueryallrows.md) para recuperar la fila correspondiente de la tabla de almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-130">Call [HrQueryAllRows](hrqueryallrows.md) to retrieve the appropriate row from the message store table.</span></span> <span data-ttu-id="e9f4d-131">El identificador de entrada de la fila se incluirá en la matriz de valores de propiedad para el miembro **aRow** del conjunto de filas que apunta el parámetro _pprows_ .</span><span class="sxs-lookup"><span data-stu-id="e9f4d-131">The entry identifier for the row will be included in the property value array for the **aRow** member of the row set pointed to by the  _pprows_ parameter.</span></span> 
    
5. <span data-ttu-id="e9f4d-132">Llame a [FreeProws](freeprows.md) para liberar el conjunto de filas que apunta _pprows_.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-132">Call [FreeProws](freeprows.md) to free the row set pointed to by  _pprows_.</span></span>
    
6. <span data-ttu-id="e9f4d-133">Versión en la tabla de almacenamiento de mensaje mediante una llamada a su método **IUnknown:: Release** .</span><span class="sxs-lookup"><span data-stu-id="e9f4d-133">Release the message store table by calling its **IUnknown::Release** method.</span></span> 
    
<span data-ttu-id="e9f4d-134">Si ha creado un identificador de entrada personalizado para el almacén de mensajes que se abrirá, llame a la función [WrapStoreEntryID](wrapstoreentryid.md) para convertir a un identificador de entrada estándar.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-134">If you have created a custom entry identifier for the message store to be opened, call the [WrapStoreEntryID](wrapstoreentryid.md) function to convert it to a standard entry identifier.</span></span> 
  
<span data-ttu-id="e9f4d-135">Una vez que tenga el identificador de entrada de un almacén de mensajes, llame a uno de los métodos siguientes para abrirlo:</span><span class="sxs-lookup"><span data-stu-id="e9f4d-135">After you have a message store's entry identifier, call one of the following methods to open it:</span></span>
  
- [<span data-ttu-id="e9f4d-136">IMAPISession::OpenMsgStore</span><span class="sxs-lookup"><span data-stu-id="e9f4d-136">IMAPISession::OpenMsgStore</span></span>](imapisession-openmsgstore.md)
- [<span data-ttu-id="e9f4d-137">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="e9f4d-137">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md)
    
<span data-ttu-id="e9f4d-138">Llamar a **OpenMsgStore** si necesita especificar una amplia variedad de opciones especiales para el almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-138">Call **OpenMsgStore** if you need to specify a variety of special options for the message store.</span></span> <span data-ttu-id="e9f4d-139">**OpenMsgStore** le permite suprimir la visualización de cuadros de diálogo, identificar el almacén de mensajes como temporal o como un almacén nonmessaging, establecer niveles de acceso y para aplazar errores.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-139">**OpenMsgStore** allows you to suppress the display of dialog boxes, identify the message store as temporary or as a nonmessaging store, set access levels, and to defer errors.</span></span> <span data-ttu-id="e9f4d-140">**OpenEntry** , sólo puede establecer niveles de acceso y aplazar errores.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-140">**OpenEntry** allows you only to set access levels and defer errors.</span></span> 
  
<span data-ttu-id="e9f4d-141">Establecer el MDB_NO_MAIL marca indica a MAPI que no se utilizará el almacén de mensajes para enviar o recibir mensajes.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-141">Setting the MDB_NO_MAIL flag indicates to MAPI that the message store will not be used for sending or receiving messages.</span></span> <span data-ttu-id="e9f4d-142">MAPI no comunicar a la cola MAPI sobre la existencia de este almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-142">MAPI does not inform the MAPI spooler about the existence of this message store.</span></span> <span data-ttu-id="e9f4d-143">El indicador MDB_TEMPORARY designa un almacén de mensajes como temporal, lo que implica que no puede usarse para almacenar información permanente.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-143">The MDB_TEMPORARY flag designates a message store as temporary, implying that it cannot be used to store permanent information.</span></span> <span data-ttu-id="e9f4d-144">Almacenes de mensaje temporal no aparecen en la tabla de almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e9f4d-144">Temporary message stores do not appear in the message store table.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="e9f4d-145">Vea también</span><span class="sxs-lookup"><span data-stu-id="e9f4d-145">See also</span></span>

- [<span data-ttu-id="e9f4d-146">IMAPITable::SetColumns</span><span class="sxs-lookup"><span data-stu-id="e9f4d-146">IMAPITable::SetColumns</span></span>](imapitable-setcolumns.md)

