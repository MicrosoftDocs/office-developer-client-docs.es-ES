---
title: Desarrollo de un proveedor TNEF-Enabled transporte de contenido
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7525eee1-4016-49b8-9509-5ebbe1db819f
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: 282b1866699b695c647caedd130ce5abc1bcbc2c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33439005"
---
# <a name="developing-a-tnef-enabled-transport-provider"></a><span data-ttu-id="d12d5-103">Desarrollo de un proveedor TNEF-Enabled transporte de contenido</span><span class="sxs-lookup"><span data-stu-id="d12d5-103">Developing a TNEF-Enabled Transport Provider</span></span>

  
  
<span data-ttu-id="d12d5-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="d12d5-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="d12d5-105">Para promover la interoperabilidad entre sistemas de mensajería que admiten diferentes conjuntos de características MAPI, MAPI proporciona el formato de encapsulamiento neutro para el transporte (TNEF) como una forma estándar de transferir datos.</span><span class="sxs-lookup"><span data-stu-id="d12d5-105">To promote interoperability between messaging systems that support different sets of MAPI features, MAPI provides the Transport Neutral Encapsulation Format (TNEF) as a standard way to transfer data.</span></span> <span data-ttu-id="d12d5-106">Este formato encapsula las propiedades MAPI no admitidas por un sistema de mensajería subyacente en una secuencia binaria que se puede transferir junto con el mensaje cuando un proveedor de transporte lo envía.</span><span class="sxs-lookup"><span data-stu-id="d12d5-106">This format encapsulates MAPI properties not supported by an underlying messaging system into a binary stream that can be transferred along with the message when a transport provider sends it.</span></span> <span data-ttu-id="d12d5-107">A continuación, el proveedor de transporte que recibe el mensaje puede descodificar la secuencia binaria para recuperar todas las propiedades del mensaje original y hacer que estén disponibles para las aplicaciones cliente.</span><span class="sxs-lookup"><span data-stu-id="d12d5-107">The transport provider that receives the message can then decode the binary stream to retrieve all the properties of the original message and make them available to client applications.</span></span> <span data-ttu-id="d12d5-108">El modelo operativo para TNEF es:</span><span class="sxs-lookup"><span data-stu-id="d12d5-108">The operational model for TNEF is:</span></span>
  
- <span data-ttu-id="d12d5-109">Los clientes de mensajería envían y reciben mensajes a un transporte TNEF de forma normal.</span><span class="sxs-lookup"><span data-stu-id="d12d5-109">Messaging clients submit and receive messages to a TNEF transport as normal.</span></span>
    
- <span data-ttu-id="d12d5-110">El transporte separa las propiedades de los mensajes salientes en dos categorías: las que admite el sistema de mensajes subyacente y las que no.</span><span class="sxs-lookup"><span data-stu-id="d12d5-110">The transport separates the properties on outgoing messages into two categories: those that the underlying message system supports and those that it does not.</span></span> <span data-ttu-id="d12d5-111">Los valores de las propiedades admitidas por el sistema de mensajería subyacente se traducen al formato requerido.</span><span class="sxs-lookup"><span data-stu-id="d12d5-111">The values of the properties that are supported by the underlying messaging system are translated into the required format.</span></span>
    
- <span data-ttu-id="d12d5-112">El transporte usa los métodos TNEF de MAPI para codificar las propiedades no admitidas en una única secuencia de datos.</span><span class="sxs-lookup"><span data-stu-id="d12d5-112">The transport uses the MAPI TNEF methods to encode any unsupported properties into a single data stream.</span></span> <span data-ttu-id="d12d5-113">A continuación, el transporte convierte esa secuencia de datos en un archivo adjunto especial en el mensaje saliente, mediante el modelo de datos adjuntos del sistema de mensajería subyacente, antes de enviar el mensaje.</span><span class="sxs-lookup"><span data-stu-id="d12d5-113">The transport then turns that data stream into a special attachment on the outgoing message, using the underlying messaging system's attachment model, before sending the message.</span></span>
    
- <span data-ttu-id="d12d5-114">Un transporte habilitado para TNEF que recibe un mensaje de este tipo hace dos cosas.</span><span class="sxs-lookup"><span data-stu-id="d12d5-114">A TNEF enabled transport that receives such a message does two things.</span></span> <span data-ttu-id="d12d5-115">En primer lugar, convierte las propiedades del mensaje entrante (las que admite el sistema de mensajes subyacente) en propiedades MAPI.</span><span class="sxs-lookup"><span data-stu-id="d12d5-115">First, it translates the incoming message's properties — the ones supported by the underlying message system — into MAPI properties.</span></span> <span data-ttu-id="d12d5-116">En segundo lugar, si los datos adjuntos especiales están presentes, usa los métodos MAPI TNEF para recuperar propiedades MAPI adicionales de los datos adjuntos antes de entregar el mensaje a una aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="d12d5-116">Second, if the special attachment is present, it uses the MAPI TNEF methods to retrieve additional MAPI properties from the attachment before delivering the message to a client application.</span></span>
    
<span data-ttu-id="d12d5-117">MAPI proporciona una implementación de la **interfaz ITnef** para su uso por parte de los proveedores de transporte MAPI al trabajar con objetos TNEF.</span><span class="sxs-lookup"><span data-stu-id="d12d5-117">MAPI supplies an implementation of the **ITnef** interface for use by MAPI transport providers when working with TNEF objects.</span></span> <span data-ttu-id="d12d5-118">La [función OpenTnefStreamEx](opentnefstreamex.md) se usa para crear objetos TNEF y asociarlos con un mensaje.</span><span class="sxs-lookup"><span data-stu-id="d12d5-118">The [OpenTnefStreamEx](opentnefstreamex.md) function is used to create TNEF objects and associate them with a message.</span></span> <span data-ttu-id="d12d5-119">Las secuencias TNEF se construyen sobre la interfaz OLE **IStream**</span><span class="sxs-lookup"><span data-stu-id="d12d5-119">TNEF streams are built on top of the OLE **IStream** interface</span></span> 
  
> [!NOTE]
> <span data-ttu-id="d12d5-120">Se usa **OpenTnefStreamEx para** crear objetos TNEF.</span><span class="sxs-lookup"><span data-stu-id="d12d5-120">You use **OpenTnefStreamEx** to create TNEF objects.</span></span> <span data-ttu-id="d12d5-121">La antigua **función OpenTnefStream** aún existe por compatibilidad con código fuente antiguo y no debe usarse en nada nuevo.</span><span class="sxs-lookup"><span data-stu-id="d12d5-121">The old **OpenTnefStream** function still exists for compatibility with old source code and should not be used in anything new.</span></span> 
  
<span data-ttu-id="d12d5-122">La **interfaz ITnef** proporciona los métodos siguientes:</span><span class="sxs-lookup"><span data-stu-id="d12d5-122">The **ITnef** interface provides the following methods:</span></span> 
  
- [<span data-ttu-id="d12d5-123">AddProps</span><span class="sxs-lookup"><span data-stu-id="d12d5-123">AddProps</span></span>](itnef-addprops.md)
    
- [<span data-ttu-id="d12d5-124">EncodeRecips</span><span class="sxs-lookup"><span data-stu-id="d12d5-124">EncodeRecips</span></span>](itnef-encoderecips.md)
    
- [<span data-ttu-id="d12d5-125">ExtractProps</span><span class="sxs-lookup"><span data-stu-id="d12d5-125">ExtractProps</span></span>](itnef-extractprops.md)
    
- [<span data-ttu-id="d12d5-126">Finish</span><span class="sxs-lookup"><span data-stu-id="d12d5-126">Finish</span></span>](itnef-finish.md)
    
- [<span data-ttu-id="d12d5-127">FinishComponent</span><span class="sxs-lookup"><span data-stu-id="d12d5-127">FinishComponent</span></span>](itnef-finishcomponent.md)
    
- [<span data-ttu-id="d12d5-128">OpenTaggedBody</span><span class="sxs-lookup"><span data-stu-id="d12d5-128">OpenTaggedBody</span></span>](itnef-opentaggedbody.md)
    
- [<span data-ttu-id="d12d5-129">SetProps</span><span class="sxs-lookup"><span data-stu-id="d12d5-129">SetProps</span></span>](itnef-setprops.md)
    
<span data-ttu-id="d12d5-130">El modelo de implementación de MAPI TNEF admite:</span><span class="sxs-lookup"><span data-stu-id="d12d5-130">The MAPI TNEF implementation model supports:</span></span>
  
- <span data-ttu-id="d12d5-131">Todas las propiedades MAPI sin afectar a otras propiedades de mensaje.</span><span class="sxs-lookup"><span data-stu-id="d12d5-131">All MAPI properties without affecting other message properties.</span></span> <span data-ttu-id="d12d5-132">Para que los mensajes MAPI sobresalan en el transporte a través de un sistema de mensajería, se deben encapsular todas las propiedades que no se pueden codificar como propiedades del sistema de mensajería.</span><span class="sxs-lookup"><span data-stu-id="d12d5-132">In order for MAPI messages to survive transport through a messaging system, all properties that cannot be encoded as properties of the messaging system must be encapsulated.</span></span> <span data-ttu-id="d12d5-133">Dado que casi nunca se sabe en el momento en que se envía un mensaje si un cliente compatible con MAPI recibirá o no el mensaje, el esquema de encapsulación permite a un proveedor de transporte codificar solo las propiedades de mensaje MAPI que el sistema de mensajería no admite de forma nativa.</span><span class="sxs-lookup"><span data-stu-id="d12d5-133">Because it is almost never known at the time a message is sent whether or not a MAPI-compliant client will receive the message, the encapsulation scheme allows a transport provider to encode only those MAPI message properties that the messaging system does not natively support.</span></span> <span data-ttu-id="d12d5-134">Esto significa que los mensajes que usan TNEF no son "opacos" para los sistemas de mensajería que no se basan en MAPI, como los sistemas de mensajería basados en SMTP UNIX smtp.</span><span class="sxs-lookup"><span data-stu-id="d12d5-134">This means that messages which use TNEF are not "opaque" to messaging systems that are not based on MAPI such as SMTP-based UNIX messaging systems.</span></span> <span data-ttu-id="d12d5-135">Estos sistemas reciben las propiedades que admiten de cualquier manera que sea habitual para ellos y otras propiedades se reciben como una secuencia de datos TNEF codificada.</span><span class="sxs-lookup"><span data-stu-id="d12d5-135">These systems receive the properties they support in whatever manner is typical for them, and other properties are received as an encoded TNEF data stream.</span></span> <span data-ttu-id="d12d5-136">El proveedor de transporte TNEF es responsable de diferenciar entre estos dos conjuntos de propiedades y enviar el conjunto admitido de la manera adecuada para el sistema de mensajería.</span><span class="sxs-lookup"><span data-stu-id="d12d5-136">The TNEF transport provider is responsible for differentiating between these two sets of properties and sending the supported set in the proper manner for the messaging system.</span></span> <span data-ttu-id="d12d5-137">TNEF no presuposición sobre el nivel de compatibilidad proporcionado por un sistema de mensajería.</span><span class="sxs-lookup"><span data-stu-id="d12d5-137">TNEF makes no assumptions as to the level of support provided by a messaging system.</span></span> <span data-ttu-id="d12d5-138">Sin embargo, en los ejemplos de uso de TNEF incluidos en esta sección, se supone que el sistema de mensajería admite al menos un solo dato adjunto aparte del mensaje.</span><span class="sxs-lookup"><span data-stu-id="d12d5-138">However, in the examples of TNEF usage included in this section, the assumption is made that the messaging system supports at least one single attachment aside from the message.</span></span> <span data-ttu-id="d12d5-139">En algunos casos, los datos adjuntos solo pueden ser compatibles a través de una secuencia uuencoded y transmitirse como parte del texto del mensaje.</span><span class="sxs-lookup"><span data-stu-id="d12d5-139">In some cases, the attachment can only be supported through a uuencoded stream and transmitted as part of the message text.</span></span> <span data-ttu-id="d12d5-140">Solo en circunstancias muy raras el sistema de mensajería tendrá tan poca compatibilidad con las propiedades del mensaje que sea necesaria la codificación TNEF completa de todas las propiedades.</span><span class="sxs-lookup"><span data-stu-id="d12d5-140">Only in very rare circumstances will the messaging system have so little support for message properties that full TNEF encoding of all properties is necessary.</span></span>
    
- <span data-ttu-id="d12d5-141">Un mecanismo para determinar si una secuencia TNEF en un mensaje entrante pertenece al mensaje, basado en la propiedad MAPI **PR_TNEF_CORRELATION_KEY** ([PidTagTnefCorrelationKey](pidtagtnefcorrelationkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="d12d5-141">A mechanism for determining whether a TNEF stream on an incoming message belongs to the message, based on the MAPI property **PR_TNEF_CORRELATION_KEY** ([PidTagTnefCorrelationKey](pidtagtnefcorrelationkey-canonical-property.md)).</span></span> <span data-ttu-id="d12d5-142">Esta propiedad debe encontrarse tanto en la secuencia TNEF como en un encabezado de mensaje adecuado.</span><span class="sxs-lookup"><span data-stu-id="d12d5-142">This property should be found both in the TNEF stream and in an appropriate message header.</span></span> <span data-ttu-id="d12d5-143">Si la propiedad tiene el mismo valor en ambos lugares o falta en cualquier lugar, se supone que la secuencia TNEF pertenece al mensaje.</span><span class="sxs-lookup"><span data-stu-id="d12d5-143">If the property has the same value in both places, or is missing in either place, the TNEF stream is assumed to belong to the message.</span></span> <span data-ttu-id="d12d5-144">De lo contrario, se omite la secuencia TNEF.</span><span class="sxs-lookup"><span data-stu-id="d12d5-144">Otherwise, the TNEF stream is ignored.</span></span> <span data-ttu-id="d12d5-145">Los transportes habilitados para TNEF son responsables de elegir un valor para esta propiedad en los mensajes salientes y codificarlo en un encabezado de mensaje adecuado (por ejemplo, el encabezado Message-ID: para los mensajes SMTP) y en la secuencia TNEF.</span><span class="sxs-lookup"><span data-stu-id="d12d5-145">TNEF enabled transports are responsible for choosing a value for this property on outbound messages and encoding it in an appropriate message header (for example, the Message-ID: header for SMTP messages) and in the TNEF stream.</span></span>
    

