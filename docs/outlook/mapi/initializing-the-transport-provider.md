---
title: Inicializar el proveedor de transporte
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 977c18ce-ece5-4ad1-ac97-5a680846ab83
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: 3b369e20101bbaba5e246b2ef9f6ab3ed1771ef6
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/23/2018
ms.locfileid: "22563558"
---
# <a name="initializing-the-transport-provider"></a><span data-ttu-id="46e3f-103">Inicializar el proveedor de transporte</span><span class="sxs-lookup"><span data-stu-id="46e3f-103">Initializing the Transport Provider</span></span>

  
  
<span data-ttu-id="46e3f-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="46e3f-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="46e3f-105">La interfaz de transporte y cola de impresión define las llamadas que realiza la cola MAPI a un proveedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="46e3f-105">The transport-spooler interface defines calls the MAPI spooler makes to a transport provider.</span></span> <span data-ttu-id="46e3f-106">Los proveedores de transporte implementan estas rutinas en una biblioteca de vínculos dinámicos (DLL).</span><span class="sxs-lookup"><span data-stu-id="46e3f-106">Transport providers implement these routines in a dynamic-link library (DLL).</span></span> <span data-ttu-id="46e3f-107">El primer punto de entrada directa en el archivo DLL utilizado por la cola MAPI debe ser la función de inicialización del proveedor de transporte [XPProviderInit](xpproviderinit.md).</span><span class="sxs-lookup"><span data-stu-id="46e3f-107">The first direct entry point into the DLL used by the MAPI spooler must be the transport provider initialization function [XPProviderInit](xpproviderinit.md).</span></span>
  
<span data-ttu-id="46e3f-108">MAPI utiliza la rutina **GetProcAddress** para obtener la dirección de la rutina de inicialización del proveedor de servicios y, a continuación, llama a esa rutina.</span><span class="sxs-lookup"><span data-stu-id="46e3f-108">MAPI uses the routine **GetProcAddress** to get the address of the service provider's initialization routine and then calls that routine.</span></span> <span data-ttu-id="46e3f-109">El nombre de la rutina de inicialización es **XPProviderInit** para los proveedores de transporte.</span><span class="sxs-lookup"><span data-stu-id="46e3f-109">The name of the initialization routine is **XPProviderInit** for transport providers.</span></span> <span data-ttu-id="46e3f-110">Es diferente de otros tipos de proveedores de servicios de MAPI para que una DLL puede contener cualquier combinación de tipos de proveedor de servicio, pero sólo un proveedor de servicios de un tipo determinado.</span><span class="sxs-lookup"><span data-stu-id="46e3f-110">It is different for other types of MAPI service providers so that one DLL can contain any combination of service provider types, but only one service provider of a particular type.</span></span> <span data-ttu-id="46e3f-111">Sin embargo, un proveedor de servicios de un determinado tipo puede implementar varios servicios de su tipo.</span><span class="sxs-lookup"><span data-stu-id="46e3f-111">However, one service provider of a given type can implement multiple services of its type.</span></span> <span data-ttu-id="46e3f-112">Por ejemplo, un proveedor de transporte puede implementar la funcionalidad de transporte de mensajes a varios servicios de mensaje.</span><span class="sxs-lookup"><span data-stu-id="46e3f-112">For example, one transport provider can implement message transport functionality to multiple message services.</span></span> 
  
<span data-ttu-id="46e3f-113">El archivo de encabezado mapispi.h tiene una definición de tipo para el prototipo de función de la función de inicialización del proveedor de transporte y un nombre de procedimiento predefinidos para él.</span><span class="sxs-lookup"><span data-stu-id="46e3f-113">The mapispi.h header file has a type definition for the function prototype of the transport provider initialization function, and a predefined procedure name for it.</span></span> <span data-ttu-id="46e3f-114">Exportar declaración en el archivo DLL de las rutinas de inicialización en los archivos de C y C++ de nomenclatura con los mismos nombres utilizados por **GetProcAddress** y mediante el uso de un sencillo. Archivo de definición, obtener automáticamente la comprobación de los parámetros en la rutina de inicialización de tipos.</span><span class="sxs-lookup"><span data-stu-id="46e3f-114">By naming the initialization routines in your C and C++ files with the same names used by **GetProcAddress** and by using a straightforward export declaration in your DLL.DEF file, you automatically get type checking of the parameters on your initialization routine.</span></span> <span data-ttu-id="46e3f-115">Vea el código de origen de proveedor de transporte de ejemplo para obtener ejemplos.</span><span class="sxs-lookup"><span data-stu-id="46e3f-115">See the sample transport provider source code for examples.</span></span> <span data-ttu-id="46e3f-116">Para obtener más información, vea [Ejemplo de proveedor de transporte](transport-provider-sample.md).</span><span class="sxs-lookup"><span data-stu-id="46e3f-116">For more information, see [Transport Provider Sample](transport-provider-sample.md).</span></span>
  
<span data-ttu-id="46e3f-117">Si la llamada de inicialización de un proveedor de servicios se realiza correctamente pero no devuelve a un proveedor de servicios número de versión de la interfaz demasiado pequeño para MAPI controlar, MAPI inmediatamente llama al método de la **versión** del objeto de proveedor de servicio y continúa como si la inicialización de llamadas no se pudo tenía con MAPI_E_VERSION.</span><span class="sxs-lookup"><span data-stu-id="46e3f-117">If a service provider's initialization call succeeds but returns a service provider interface version number too small for MAPI to handle, MAPI immediately calls the **Release** method of the service provider object and proceeds as if the initialization call had failed with MAPI_E_VERSION.</span></span> <span data-ttu-id="46e3f-118">De este modo MAPI y el proveedor de servicios conjuntamente definen el intervalo de números de versión del interfaz de proveedor de servicio que pueden controlar y, si nada coincide con, a continuación, cargar el proveedor de servicios se produce un error con un MAPI_E_VERSION devuelve valor.</span><span class="sxs-lookup"><span data-stu-id="46e3f-118">This way MAPI and the service provider jointly define the range of service provider interface version numbers they can handle, and if nothing matches then service provider loading fails with a MAPI_E_VERSION return value.</span></span> 
  
<span data-ttu-id="46e3f-119">El último paso para la cola MAPI al obtener acceso a los recursos del proveedor de servicio es para iniciar sesión en el proveedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="46e3f-119">The last step for the MAPI spooler in getting access to service provider resources is to log on to the transport provider.</span></span> <span data-ttu-id="46e3f-120">La cola MAPI llama al método [IXPProvider::TransportLogon](ixpprovider-transportlogon.md) de la [IXPProvider: IUnknown](ixpprovideriunknown.md) objeto devuelto desde **XPProviderInit**.</span><span class="sxs-lookup"><span data-stu-id="46e3f-120">The MAPI spooler calls the [IXPProvider::TransportLogon](ixpprovider-transportlogon.md) method of the [IXPProvider : IUnknown](ixpprovideriunknown.md) object returned from **XPProviderInit**.</span></span> <span data-ttu-id="46e3f-121">Se trata de la llamada donde se comprueban las credenciales, si se usa, y se permiten los cuadros de diálogo.</span><span class="sxs-lookup"><span data-stu-id="46e3f-121">This is the call where credentials, if used, are checked and dialog boxes can be allowed.</span></span>
  
<span data-ttu-id="46e3f-122">Si un proceso abre una segunda sesión de transporte en el mismo proveedor de transporte y la sesión MAPI, el archivo DLL del proveedor de transporte no debe crear un segundo objeto de proveedor.</span><span class="sxs-lookup"><span data-stu-id="46e3f-122">If a process opens a second transport session on the same transport provider and MAPI session, the transport provider DLL should not create a second provider object.</span></span> <span data-ttu-id="46e3f-123">El primer objeto de proveedor debe usarse para iniciar sesión en la segunda sesión de transporte.</span><span class="sxs-lookup"><span data-stu-id="46e3f-123">The first provider object should be used to log on to the second transport session.</span></span> <span data-ttu-id="46e3f-124">Un proveedor de transporte debe programarse para admitir varias sesiones de transporte en un objeto de proveedor único.</span><span class="sxs-lookup"><span data-stu-id="46e3f-124">A transport provider should be programmed to support multiple transport sessions in a single provider object.</span></span> <span data-ttu-id="46e3f-125">Sólo se debe crear un segundo objeto de proveedor si se usan diferentes sesiones MAPI en el mismo proceso.</span><span class="sxs-lookup"><span data-stu-id="46e3f-125">A second provider object should only be created if different MAPI sessions are used in the same process.</span></span>
  

