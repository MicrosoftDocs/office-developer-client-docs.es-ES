---
title: Inicialización del proveedor de transporte
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 977c18ce-ece5-4ad1-ac97-5a680846ab83
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: 474a8085ca8b82d11efd68c9fd4d8719fe239207
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33416604"
---
# <a name="initializing-the-transport-provider"></a><span data-ttu-id="d6bfd-103">Inicialización del proveedor de transporte</span><span class="sxs-lookup"><span data-stu-id="d6bfd-103">Initializing the Transport Provider</span></span>

  
  
<span data-ttu-id="d6bfd-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="d6bfd-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="d6bfd-105">La interfaz de la cola de transporte define las llamadas que la cola MAPI realiza a un proveedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-105">The transport-spooler interface defines calls the MAPI spooler makes to a transport provider.</span></span> <span data-ttu-id="d6bfd-106">Los proveedores de transporte implementan estas rutinas en una biblioteca de vínculos dinámicos (DLL).</span><span class="sxs-lookup"><span data-stu-id="d6bfd-106">Transport providers implement these routines in a dynamic-link library (DLL).</span></span> <span data-ttu-id="d6bfd-107">El primer punto de entrada directo en la DLL usada por la cola MAPI debe ser la función de inicialización del proveedor de transporte [XPProviderInit](xpproviderinit.md).</span><span class="sxs-lookup"><span data-stu-id="d6bfd-107">The first direct entry point into the DLL used by the MAPI spooler must be the transport provider initialization function [XPProviderInit](xpproviderinit.md).</span></span>
  
<span data-ttu-id="d6bfd-108">MAPI usa la rutina **GetProcAddress para** obtener la dirección de la rutina de inicialización del proveedor de servicios y, a continuación, llama a esa rutina.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-108">MAPI uses the routine **GetProcAddress** to get the address of the service provider's initialization routine and then calls that routine.</span></span> <span data-ttu-id="d6bfd-109">El nombre de la rutina de inicialización **es XPProviderInit para** proveedores de transporte.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-109">The name of the initialization routine is **XPProviderInit** for transport providers.</span></span> <span data-ttu-id="d6bfd-110">Es diferente para otros tipos de proveedores de servicios MAPI, por lo que una DLL puede contener cualquier combinación de tipos de proveedor de servicios, pero solo un proveedor de servicios de un tipo determinado.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-110">It is different for other types of MAPI service providers so that one DLL can contain any combination of service provider types, but only one service provider of a particular type.</span></span> <span data-ttu-id="d6bfd-111">Sin embargo, un proveedor de servicios de un tipo determinado puede implementar varios servicios de su tipo.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-111">However, one service provider of a given type can implement multiple services of its type.</span></span> <span data-ttu-id="d6bfd-112">Por ejemplo, un proveedor de transporte puede implementar la funcionalidad de transporte de mensajes en varios servicios de mensajes.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-112">For example, one transport provider can implement message transport functionality to multiple message services.</span></span> 
  
<span data-ttu-id="d6bfd-113">El archivo de encabezado mapispi.h tiene una definición de tipo para el prototipo de función de la función de inicialización del proveedor de transporte y un nombre de procedimiento predefinido.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-113">The mapispi.h header file has a type definition for the function prototype of the transport provider initialization function, and a predefined procedure name for it.</span></span> <span data-ttu-id="d6bfd-114">Al asignar un nombre a las rutinas de inicialización de los archivos C y C++ con los mismos nombres usados por **GetProcAddress** y al usar una declaración de exportación sencilla en el archivo DLL.DEF, se obtiene automáticamente la comprobación de tipos de los parámetros en la rutina de inicialización.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-114">By naming the initialization routines in your C and C++ files with the same names used by **GetProcAddress** and by using a straightforward export declaration in your DLL.DEF file, you automatically get type checking of the parameters on your initialization routine.</span></span> <span data-ttu-id="d6bfd-115">Vea el código fuente del proveedor de transporte de ejemplo para obtener ejemplos.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-115">See the sample transport provider source code for examples.</span></span> <span data-ttu-id="d6bfd-116">Para obtener más información, vea [Ejemplo de proveedor de transporte.](transport-provider-sample.md)</span><span class="sxs-lookup"><span data-stu-id="d6bfd-116">For more information, see [Transport Provider Sample](transport-provider-sample.md).</span></span>
  
<span data-ttu-id="d6bfd-117">Si la llamada de inicialización de un proveedor de servicios se realiza correctamente pero devuelve un número de versión de la interfaz del proveedor de servicios demasiado pequeño para que MAPI lo controle, MAPI llama inmediatamente al método **Release** del objeto del proveedor de servicios y continúa como si la llamada de inicialización hubiera fallado con MAPI_E_VERSION.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-117">If a service provider's initialization call succeeds but returns a service provider interface version number too small for MAPI to handle, MAPI immediately calls the **Release** method of the service provider object and proceeds as if the initialization call had failed with MAPI_E_VERSION.</span></span> <span data-ttu-id="d6bfd-118">De esta forma, MAPI y el proveedor de servicios definen conjuntamente el intervalo de números de versión de la interfaz del proveedor de servicios que pueden controlar y, si no hay ninguna coincidencia, se produce un error en la carga del proveedor de servicios con un MAPI_E_VERSION valor devuelto.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-118">This way MAPI and the service provider jointly define the range of service provider interface version numbers they can handle, and if nothing matches then service provider loading fails with a MAPI_E_VERSION return value.</span></span> 
  
<span data-ttu-id="d6bfd-119">El último paso para que la cola MAPI obtenga acceso a los recursos del proveedor de servicios es iniciar sesión en el proveedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-119">The last step for the MAPI spooler in getting access to service provider resources is to log on to the transport provider.</span></span> <span data-ttu-id="d6bfd-120">La cola MAPI llama al método [IXPProvider::TransportLogon](ixpprovider-transportlogon.md) del [objeto IXPProvider : IUnknown](ixpprovideriunknown.md) devuelto de **XPProviderInit**.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-120">The MAPI spooler calls the [IXPProvider::TransportLogon](ixpprovider-transportlogon.md) method of the [IXPProvider : IUnknown](ixpprovideriunknown.md) object returned from **XPProviderInit**.</span></span> <span data-ttu-id="d6bfd-121">Esta es la llamada en la que se comprueban las credenciales, si se usan, y se pueden permitir cuadros de diálogo.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-121">This is the call where credentials, if used, are checked and dialog boxes can be allowed.</span></span>
  
<span data-ttu-id="d6bfd-122">Si un proceso abre una segunda sesión de transporte en el mismo proveedor de transporte y sesión MAPI, la DLL del proveedor de transporte no debe crear un segundo objeto de proveedor.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-122">If a process opens a second transport session on the same transport provider and MAPI session, the transport provider DLL should not create a second provider object.</span></span> <span data-ttu-id="d6bfd-123">El primer objeto de proveedor debe usarse para iniciar sesión en la segunda sesión de transporte.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-123">The first provider object should be used to log on to the second transport session.</span></span> <span data-ttu-id="d6bfd-124">Se debe programar un proveedor de transporte para admitir varias sesiones de transporte en un único objeto de proveedor.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-124">A transport provider should be programmed to support multiple transport sessions in a single provider object.</span></span> <span data-ttu-id="d6bfd-125">Solo se debe crear un segundo objeto de proveedor si se usan sesiones MAPI diferentes en el mismo proceso.</span><span class="sxs-lookup"><span data-stu-id="d6bfd-125">A second provider object should only be created if different MAPI sessions are used in the same process.</span></span>
  

