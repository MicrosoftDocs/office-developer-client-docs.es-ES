---
title: Obtener acceso a objetos mediante el uso de la sesión
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ecada707-2960-41ec-be7e-619cad257c57
description: '�ltima modificaci�n: lunes, 9 de marzo de 2015'
ms.openlocfilehash: ee20e73e5bc7bb6854b956da541d3a318a267d0f
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19816394"
---
# <a name="accessing-objects-by-using-the-session"></a><span data-ttu-id="82d9f-103">Obtener acceso a objetos mediante el uso de la sesión</span><span class="sxs-lookup"><span data-stu-id="82d9f-103">Accessing Objects by Using the Session</span></span>

  
  
<span data-ttu-id="82d9f-104">**Se aplica a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="82d9f-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="82d9f-105">El puntero de sesión que recibe de la llamada a [MAPILogonEx](mapilogonex.md) puede utilizarse para tener acceso a una amplia variedad de objetos.</span><span class="sxs-lookup"><span data-stu-id="82d9f-105">The session pointer that you receive from your call to [MAPILogonEx](mapilogonex.md) can be used to access a wide variety of objects.</span></span> <span data-ttu-id="82d9f-106">En la siguiente tabla se enumera los métodos que se usan para tener acceso a varios objetos:</span><span class="sxs-lookup"><span data-stu-id="82d9f-106">The following table lists the methods that are used to access various objects:</span></span> 
  
|<span data-ttu-id="82d9f-107">**Object**</span><span class="sxs-lookup"><span data-stu-id="82d9f-107">**Object**</span></span>|<span data-ttu-id="82d9f-108">**Método de sesión**</span><span class="sxs-lookup"><span data-stu-id="82d9f-108">**Session method**</span></span>|
|:-----|:-----|
|<span data-ttu-id="82d9f-109">Sección de perfil</span><span class="sxs-lookup"><span data-stu-id="82d9f-109">Profile section</span></span>  <br/> |[<span data-ttu-id="82d9f-110">IMAPISession::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="82d9f-110">IMAPISession::OpenProfileSection</span></span>](imapisession-openprofilesection.md) <br/> |
|<span data-ttu-id="82d9f-111">Almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="82d9f-111">Message store</span></span>  <br/> |[<span data-ttu-id="82d9f-112">IMAPISession::OpenMsgStore</span><span class="sxs-lookup"><span data-stu-id="82d9f-112">IMAPISession::OpenMsgStore</span></span>](imapisession-openmsgstore.md) <br/> |
|<span data-ttu-id="82d9f-113">Libreta de direcciones</span><span class="sxs-lookup"><span data-stu-id="82d9f-113">Address book</span></span>  <br/> |[<span data-ttu-id="82d9f-114">IMAPISession::OpenAddressBook</span><span class="sxs-lookup"><span data-stu-id="82d9f-114">IMAPISession::OpenAddressBook</span></span>](imapisession-openaddressbook.md) <br/> |
|<span data-ttu-id="82d9f-115">Objeto de administración del servicio de mensajes</span><span class="sxs-lookup"><span data-stu-id="82d9f-115">Message service administration object</span></span>  <br/> |[<span data-ttu-id="82d9f-116">IMAPISession::AdminServices</span><span class="sxs-lookup"><span data-stu-id="82d9f-116">IMAPISession::AdminServices</span></span>](imapisession-adminservices.md) <br/> |
|<span data-ttu-id="82d9f-117">Carpeta, mensaje, el contenedor de la libreta de direcciones, lista de distribución o usuario de mensajería</span><span class="sxs-lookup"><span data-stu-id="82d9f-117">Folder, message, address book container, distribution list, or messaging user</span></span>  <br/> |[<span data-ttu-id="82d9f-118">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="82d9f-118">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md) <br/> |
   
<span data-ttu-id="82d9f-119">Con el método **OpenEntry** y un identificador de entrada válido, puede abrir cualquier objeto dirección proveedor de almacén de libro o un mensaje.</span><span class="sxs-lookup"><span data-stu-id="82d9f-119">With the **OpenEntry** method and a valid entry identifier, you can open any address book or message store provider object.</span></span> <span data-ttu-id="82d9f-120">Hay otros métodos de **OpenEntry** en MAPI, además del método **IMAPISession** .</span><span class="sxs-lookup"><span data-stu-id="82d9f-120">There are other **OpenEntry** methods in MAPI, in addition to the **IMAPISession** method.</span></span> <span data-ttu-id="82d9f-121">**OpenEntry** se implementa en los objetos siguientes:</span><span class="sxs-lookup"><span data-stu-id="82d9f-121">**OpenEntry** is implemented in the following objects:</span></span> 
  
|<span data-ttu-id="82d9f-122">**Object**</span><span class="sxs-lookup"><span data-stu-id="82d9f-122">**Object**</span></span>|<span data-ttu-id="82d9f-123">**M?todo**</span><span class="sxs-lookup"><span data-stu-id="82d9f-123">**Method**</span></span>|
|:-----|:-----|
|<span data-ttu-id="82d9f-124">Objeto de inicio de sesión del proveedor de la libreta de direcciones</span><span class="sxs-lookup"><span data-stu-id="82d9f-124">Address book provider's logon object</span></span>  <br/> |[<span data-ttu-id="82d9f-125">IABLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="82d9f-125">IABLogon::OpenEntry</span></span>](iablogon-openentry.md) <br/> |
|<span data-ttu-id="82d9f-126">Libreta de direcciones</span><span class="sxs-lookup"><span data-stu-id="82d9f-126">Address book</span></span>  <br/> |[<span data-ttu-id="82d9f-127">IAddrBook::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="82d9f-127">IAddrBook::OpenEntry</span></span>](iaddrbook-openentry.md) <br/> |
|<span data-ttu-id="82d9f-128">Contenedor de la libreta de direcciones</span><span class="sxs-lookup"><span data-stu-id="82d9f-128">Address book container</span></span>  <br/> |[<span data-ttu-id="82d9f-129">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="82d9f-129">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md) <br/> |
|<span data-ttu-id="82d9f-130">Sesión</span><span class="sxs-lookup"><span data-stu-id="82d9f-130">Session</span></span>  <br/> |[<span data-ttu-id="82d9f-131">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="82d9f-131">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md) <br/> |
|<span data-ttu-id="82d9f-132">Almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="82d9f-132">Message store</span></span>  <br/> |[<span data-ttu-id="82d9f-133">IMsgStore::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="82d9f-133">IMsgStore::OpenEntry</span></span>](imsgstore-openentry.md) <br/> |
|<span data-ttu-id="82d9f-134">Objeto de inicio de sesión del proveedor de almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="82d9f-134">Message store provider's logon object</span></span>  <br/> |[<span data-ttu-id="82d9f-135">IMSLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="82d9f-135">IMSLogon::OpenEntry</span></span>](imslogon-openentry.md) <br/> |
|<span data-ttu-id="82d9f-136">Carpeta</span><span class="sxs-lookup"><span data-stu-id="82d9f-136">Folder</span></span>  <br/> |[<span data-ttu-id="82d9f-137">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="82d9f-137">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md) <br/> |
|<span data-ttu-id="82d9f-138">Objeto de soporte técnico</span><span class="sxs-lookup"><span data-stu-id="82d9f-138">Support object</span></span>  <br/> |[<span data-ttu-id="82d9f-139">IMAPISupport::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="82d9f-139">IMAPISupport::OpenEntry</span></span>](imapisupport-openentry.md) <br/> |
   
<span data-ttu-id="82d9f-140">Algunos métodos de **OpenEntry** requieren un identificador de entrada del objeto que se va a abrir, al igual que **IMAPISession::OpenEntry**; otros métodos que permiten NULL que se especifique.</span><span class="sxs-lookup"><span data-stu-id="82d9f-140">Some **OpenEntry** methods require an entry identifier of the object to be opened, as does **IMAPISession::OpenEntry**; other methods allow NULL to be specified.</span></span> <span data-ttu-id="82d9f-141">Un identificador de entrada NULL se interpreta de forma diferente dependiendo del objeto.</span><span class="sxs-lookup"><span data-stu-id="82d9f-141">A NULL entry identifier is interpreted differently depending on the object.</span></span> <span data-ttu-id="82d9f-142">Por ejemplo, cuando se llama a **IAddrBook::OpenEntry** con un identificador de entrada NULL, MAPI abre el contenedor de raíz de la libreta de direcciones.</span><span class="sxs-lookup"><span data-stu-id="82d9f-142">For example, when you call **IAddrBook::OpenEntry** with a NULL entry identifier, MAPI opens the root container of the address book.</span></span> <span data-ttu-id="82d9f-143">Método de **OpenEntry** del almacén de mensajes se comporta de forma similar; se abre la carpeta raíz del almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="82d9f-143">The message store's **OpenEntry** method behaves similarly; it opens the root folder of the message store.</span></span> <span data-ttu-id="82d9f-144">**IMAPIContainer::OpenEntry**, implementada por las carpetas y los contenedores de la libreta de direcciones, puede devolver MAPI_E_INVALID_PARAMETER o el contenedor raíz, dependiendo del implementador.</span><span class="sxs-lookup"><span data-stu-id="82d9f-144">**IMAPIContainer::OpenEntry**, implemented by both folders and address book containers, might return MAPI_E_INVALID_PARAMETER or the root container, depending on the implementer.</span></span> 
  
<span data-ttu-id="82d9f-145">Además de no permitir un valor NULL para el identificador de entrada, **OpenEntry** método la sesión difiere otros métodos **OpenEntry** debido a que su trabajo no es abrir objetos.</span><span class="sxs-lookup"><span data-stu-id="82d9f-145">In addition to disallowing a NULL value for the entry identifier, the session's **OpenEntry** method differs from other **OpenEntry** methods because its job is not to open objects.</span></span> <span data-ttu-id="82d9f-146">En su lugar, se examina el identificador de entrada y reenvía la llamada a otro método **OpenEntry** implementada por el proveedor de servicios adecuado.</span><span class="sxs-lookup"><span data-stu-id="82d9f-146">Instead, it examines the entry identifier and forwards the call to another **OpenEntry** method implemented by the appropriate service provider.</span></span> <span data-ttu-id="82d9f-147">Por ejemplo, si se llama a **IMAPISession::OpenEntry** con el identificador de entrada de un mensaje, MAPI llama al método **IMSLogon::OpenEntry** del almacén de mensajes responsable del mensaje.</span><span class="sxs-lookup"><span data-stu-id="82d9f-147">For example, if you call **IMAPISession::OpenEntry** with the entry identifier of a message, MAPI calls the **IMSLogon::OpenEntry** method of the message store responsible for the message.</span></span> 
  
<span data-ttu-id="82d9f-148">Además de usar la sesión para abrir los objetos, los clientes use para compararlos.</span><span class="sxs-lookup"><span data-stu-id="82d9f-148">In addition to using the session to open objects, clients use it to compare them.</span></span> <span data-ttu-id="82d9f-149">El método [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md) compara objetos mediante la comparación de sus identificadores de entrada.</span><span class="sxs-lookup"><span data-stu-id="82d9f-149">The [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md) method compares objects by comparing their entry identifiers.</span></span> <span data-ttu-id="82d9f-150">Si las estructuras [MAPIUID](mapiuid.md) dentro de los identificadores de entrada pertenecen al mismo proveedor de servicios, MAPI reenvía la llamada a ese proveedor.</span><span class="sxs-lookup"><span data-stu-id="82d9f-150">If the [MAPIUID](mapiuid.md) structures contained within the entry identifiers belong to the same service provider, MAPI forwards the call to that provider.</span></span> <span data-ttu-id="82d9f-151">**CompareEntryIDs** devuelve un valor de error cuando no coinciden con los identificadores de dos entrada.</span><span class="sxs-lookup"><span data-stu-id="82d9f-151">**CompareEntryIDs** returns an error value when the two entry identifiers do not match.</span></span> <span data-ttu-id="82d9f-152">Aunque este método puede comparar los identificadores de entrada que pertenecen a cualquier tipo de objeto, **CompareEntryIDs** funciona mejor para objetos de nivel superior, como los almacenes de mensajes y los contenedores de la libreta de direcciones.</span><span class="sxs-lookup"><span data-stu-id="82d9f-152">Although this method can compare entry identifiers that belong to any type of object, **CompareEntryIDs** works best for higher level objects such as message stores and address book containers.</span></span> <span data-ttu-id="82d9f-153">Para comparar los objetos de nivel inferiores, compare directamente las claves de búsqueda de los objetos (**PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md))) o claves de registro (**PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md))).</span><span class="sxs-lookup"><span data-stu-id="82d9f-153">To compare lower level objects, compare directly the objects' search keys (**PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md))) or record keys (**PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md))).</span></span> 
  
<span data-ttu-id="82d9f-154">Al igual que **OpenEntry**, **CompareEntryIDs** se implementa mediante varios objetos.</span><span class="sxs-lookup"><span data-stu-id="82d9f-154">Like **OpenEntry**, **CompareEntryIDs** is implemented by multiple objects.</span></span> <span data-ttu-id="82d9f-155">Elija qué método **OpenEntry** y **CompareEntryID** a usar según la cantidad de información que tiene sobre el objeto o los objetos que se abre o en comparación.</span><span class="sxs-lookup"><span data-stu-id="82d9f-155">Choose which **OpenEntry** and **CompareEntryID** method to use according to the amount of information that you have about the object or objects to be opened or compared.</span></span> <span data-ttu-id="82d9f-156">Use las siguientes instrucciones al decidir qué método de interfaz para llamar a:</span><span class="sxs-lookup"><span data-stu-id="82d9f-156">Use the following guidelines when deciding which interface method to call:</span></span> 
  
- <span data-ttu-id="82d9f-157">Si no tiene ninguna información acerca de los objetos de destino, llame a [IMAPISession::OpenEntry](imapisession-openentry.md) o [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md).</span><span class="sxs-lookup"><span data-stu-id="82d9f-157">If you have no information about the target objects, call [IMAPISession::OpenEntry](imapisession-openentry.md) or [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md).</span></span> <span data-ttu-id="82d9f-158">Este enfoque permite el acceso a cualquier objeto, pero es la más lenta de las tres.</span><span class="sxs-lookup"><span data-stu-id="82d9f-158">This approach enables access to any object, but is the slowest of the three.</span></span>
    
- <span data-ttu-id="82d9f-159">Si sabe que los objetos de destino son entradas de la libreta de direcciones en lugar de, por ejemplo, las carpetas, llame al método [IAddrBook::OpenEntry](iaddrbook-openentry.md) o [IAddrBook::CompareEntryIDs](iaddrbook-compareentryids.md) .</span><span class="sxs-lookup"><span data-stu-id="82d9f-159">If you know that the target objects are address book entries rather than, for example, folders, call the [IAddrBook::OpenEntry](iaddrbook-openentry.md) or [IAddrBook::CompareEntryIDs](iaddrbook-compareentryids.md) method.</span></span> <span data-ttu-id="82d9f-160">**IAddrBook::OpenEntry** abre el contenedor de raíz de la libreta de direcciones cuando se especifica NULL como el objeto de destino.</span><span class="sxs-lookup"><span data-stu-id="82d9f-160">**IAddrBook::OpenEntry** opens the root container of the address book when NULL is specified as the target object.</span></span> <span data-ttu-id="82d9f-161">Este enfoque permite el acceso a cualquier objeto de la libreta de direcciones y es más rápido que utilizar **IMAPISession**, pero es más lento que utilizar **IMAPIContainer**.</span><span class="sxs-lookup"><span data-stu-id="82d9f-161">This approach enables access to any address book object and is faster than using **IMAPISession**, but slower than using **IMAPIContainer**.</span></span>
    
- <span data-ttu-id="82d9f-162">Si el identificador de entrada que se utiliza es un identificador de entrada a corto plazo o si sabe que los objetos de destino pertenecen a un contenedor de la libreta de direcciones concreto o una carpeta, llame al método [IMAPIContainer::OpenEntry](imapicontainer-openentry.md) .</span><span class="sxs-lookup"><span data-stu-id="82d9f-162">If the entry identifier being used is a short-term entry identifier or if you know that the target objects belong to a particular address book container or folder, call the [IMAPIContainer::OpenEntry](imapicontainer-openentry.md) method.</span></span> <span data-ttu-id="82d9f-163">Este enfoque proporciona el rendimiento más rápido, pero permite el acceso sólo a los objetos de un contenedor específico o una carpeta.</span><span class="sxs-lookup"><span data-stu-id="82d9f-163">This approach yields the fastest performance, but enables access only to objects in a specific container or folder.</span></span> 
    

