---
title: Acceso a objetos mediante el uso de la sesión
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ecada707-2960-41ec-be7e-619cad257c57
description: 'Última modificación: 09 de marzo de 2015'
ms.openlocfilehash: a76397b74642aedf9ad5c9704735d869f61db7e3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33410542"
---
# <a name="accessing-objects-by-using-the-session"></a><span data-ttu-id="b6a6b-103">Acceso a objetos mediante el uso de la sesión</span><span class="sxs-lookup"><span data-stu-id="b6a6b-103">Accessing Objects by Using the Session</span></span>

  
  
<span data-ttu-id="b6a6b-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="b6a6b-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="b6a6b-105">El puntero de sesión que recibe de la llamada a [MAPILogonEx](mapilogonex.md) se puede usar para obtener acceso a una amplia variedad de objetos.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-105">The session pointer that you receive from your call to [MAPILogonEx](mapilogonex.md) can be used to access a wide variety of objects.</span></span> <span data-ttu-id="b6a6b-106">En la tabla siguiente se enumeran los métodos que se usan para obtener acceso a varios objetos:</span><span class="sxs-lookup"><span data-stu-id="b6a6b-106">The following table lists the methods that are used to access various objects:</span></span> 
  
|<span data-ttu-id="b6a6b-107">**Objeto**</span><span class="sxs-lookup"><span data-stu-id="b6a6b-107">**Object**</span></span>|<span data-ttu-id="b6a6b-108">**Método Session**</span><span class="sxs-lookup"><span data-stu-id="b6a6b-108">**Session method**</span></span>|
|:-----|:-----|
|<span data-ttu-id="b6a6b-109">Sección Perfil</span><span class="sxs-lookup"><span data-stu-id="b6a6b-109">Profile section</span></span>  <br/> |[<span data-ttu-id="b6a6b-110">IMAPISession::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="b6a6b-110">IMAPISession::OpenProfileSection</span></span>](imapisession-openprofilesection.md) <br/> |
|<span data-ttu-id="b6a6b-111">Almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="b6a6b-111">Message store</span></span>  <br/> |[<span data-ttu-id="b6a6b-112">IMAPISession::OpenMsgStore</span><span class="sxs-lookup"><span data-stu-id="b6a6b-112">IMAPISession::OpenMsgStore</span></span>](imapisession-openmsgstore.md) <br/> |
|<span data-ttu-id="b6a6b-113">Libreta de direcciones</span><span class="sxs-lookup"><span data-stu-id="b6a6b-113">Address book</span></span>  <br/> |[<span data-ttu-id="b6a6b-114">IMAPISession::OpenAddressBook</span><span class="sxs-lookup"><span data-stu-id="b6a6b-114">IMAPISession::OpenAddressBook</span></span>](imapisession-openaddressbook.md) <br/> |
|<span data-ttu-id="b6a6b-115">Objeto de administración del servicio de mensajes</span><span class="sxs-lookup"><span data-stu-id="b6a6b-115">Message service administration object</span></span>  <br/> |[<span data-ttu-id="b6a6b-116">IMAPISession::AdminServices</span><span class="sxs-lookup"><span data-stu-id="b6a6b-116">IMAPISession::AdminServices</span></span>](imapisession-adminservices.md) <br/> |
|<span data-ttu-id="b6a6b-117">Carpeta, mensaje, contenedor de libreta de direcciones, lista de distribución o usuario de mensajería</span><span class="sxs-lookup"><span data-stu-id="b6a6b-117">Folder, message, address book container, distribution list, or messaging user</span></span>  <br/> |[<span data-ttu-id="b6a6b-118">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="b6a6b-118">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md) <br/> |
   
<span data-ttu-id="b6a6b-119">Con el **método OpenEntry** y un identificador de entrada válido, puede abrir cualquier objeto de proveedor de libreta de direcciones o almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-119">With the **OpenEntry** method and a valid entry identifier, you can open any address book or message store provider object.</span></span> <span data-ttu-id="b6a6b-120">Hay otros **métodos OpenEntry** en MAPI, además del **método IMAPISession.**</span><span class="sxs-lookup"><span data-stu-id="b6a6b-120">There are other **OpenEntry** methods in MAPI, in addition to the **IMAPISession** method.</span></span> <span data-ttu-id="b6a6b-121">**OpenEntry** se implementa en los siguientes objetos:</span><span class="sxs-lookup"><span data-stu-id="b6a6b-121">**OpenEntry** is implemented in the following objects:</span></span> 
  
|<span data-ttu-id="b6a6b-122">**Objeto**</span><span class="sxs-lookup"><span data-stu-id="b6a6b-122">**Object**</span></span>|<span data-ttu-id="b6a6b-123">**Método**</span><span class="sxs-lookup"><span data-stu-id="b6a6b-123">**Method**</span></span>|
|:-----|:-----|
|<span data-ttu-id="b6a6b-124">Objeto de inicio de sesión del proveedor de libreta de direcciones</span><span class="sxs-lookup"><span data-stu-id="b6a6b-124">Address book provider's logon object</span></span>  <br/> |[<span data-ttu-id="b6a6b-125">IABLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="b6a6b-125">IABLogon::OpenEntry</span></span>](iablogon-openentry.md) <br/> |
|<span data-ttu-id="b6a6b-126">Libreta de direcciones</span><span class="sxs-lookup"><span data-stu-id="b6a6b-126">Address book</span></span>  <br/> |[<span data-ttu-id="b6a6b-127">IAddrBook::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="b6a6b-127">IAddrBook::OpenEntry</span></span>](iaddrbook-openentry.md) <br/> |
|<span data-ttu-id="b6a6b-128">Contenedor de libreta de direcciones</span><span class="sxs-lookup"><span data-stu-id="b6a6b-128">Address book container</span></span>  <br/> |[<span data-ttu-id="b6a6b-129">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="b6a6b-129">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md) <br/> |
|<span data-ttu-id="b6a6b-130">Sesión</span><span class="sxs-lookup"><span data-stu-id="b6a6b-130">Session</span></span>  <br/> |[<span data-ttu-id="b6a6b-131">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="b6a6b-131">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md) <br/> |
|<span data-ttu-id="b6a6b-132">Almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="b6a6b-132">Message store</span></span>  <br/> |[<span data-ttu-id="b6a6b-133">IMsgStore::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="b6a6b-133">IMsgStore::OpenEntry</span></span>](imsgstore-openentry.md) <br/> |
|<span data-ttu-id="b6a6b-134">Objeto de inicio de sesión del proveedor del almacén de mensajes</span><span class="sxs-lookup"><span data-stu-id="b6a6b-134">Message store provider's logon object</span></span>  <br/> |[<span data-ttu-id="b6a6b-135">IMSLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="b6a6b-135">IMSLogon::OpenEntry</span></span>](imslogon-openentry.md) <br/> |
|<span data-ttu-id="b6a6b-136">Carpeta</span><span class="sxs-lookup"><span data-stu-id="b6a6b-136">Folder</span></span>  <br/> |[<span data-ttu-id="b6a6b-137">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="b6a6b-137">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md) <br/> |
|<span data-ttu-id="b6a6b-138">Objeto Support</span><span class="sxs-lookup"><span data-stu-id="b6a6b-138">Support object</span></span>  <br/> |[<span data-ttu-id="b6a6b-139">IMAPISupport::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="b6a6b-139">IMAPISupport::OpenEntry</span></span>](imapisupport-openentry.md) <br/> |
   
<span data-ttu-id="b6a6b-140">Algunos **métodos OpenEntry** requieren un identificador de entrada del objeto que se va a abrir, al igual que **IMAPISession::OpenEntry**; otros métodos permiten que se especifique NULL.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-140">Some **OpenEntry** methods require an entry identifier of the object to be opened, as does **IMAPISession::OpenEntry**; other methods allow NULL to be specified.</span></span> <span data-ttu-id="b6a6b-141">Un identificador de entrada NULL se interpreta de forma diferente en función del objeto.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-141">A NULL entry identifier is interpreted differently depending on the object.</span></span> <span data-ttu-id="b6a6b-142">Por ejemplo, cuando se llama a **IAddrBook::OpenEntry** con un identificador de entrada NULL, MAPI abre el contenedor raíz de la libreta de direcciones.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-142">For example, when you call **IAddrBook::OpenEntry** with a NULL entry identifier, MAPI opens the root container of the address book.</span></span> <span data-ttu-id="b6a6b-143">El método **OpenEntry** del almacén de mensajes se comporta de forma similar; abre la carpeta raíz del almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-143">The message store's **OpenEntry** method behaves similarly; it opens the root folder of the message store.</span></span> <span data-ttu-id="b6a6b-144">**IMAPIContainer::OpenEntry**, implementado por carpetas y contenedores de libreta de direcciones, puede devolver MAPI_E_INVALID_PARAMETER o el contenedor raíz, según el implementador.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-144">**IMAPIContainer::OpenEntry**, implemented by both folders and address book containers, might return MAPI_E_INVALID_PARAMETER or the root container, depending on the implementer.</span></span> 
  
<span data-ttu-id="b6a6b-145">Además de permitir un valor NULL para el identificador de entrada, el método **OpenEntry** de la sesión difiere de otros métodos **OpenEntry** porque su trabajo no es abrir objetos.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-145">In addition to disallowing a NULL value for the entry identifier, the session's **OpenEntry** method differs from other **OpenEntry** methods because its job is not to open objects.</span></span> <span data-ttu-id="b6a6b-146">En su lugar, examina el identificador de entrada y reenvía la llamada a otro método **OpenEntry** implementado por el proveedor de servicios adecuado.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-146">Instead, it examines the entry identifier and forwards the call to another **OpenEntry** method implemented by the appropriate service provider.</span></span> <span data-ttu-id="b6a6b-147">Por ejemplo, si llama a **IMAPISession::OpenEntry con** el identificador de entrada de un mensaje, MAPI llama al método **IMSLogon::OpenEntry** del almacén de mensajes responsable del mensaje.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-147">For example, if you call **IMAPISession::OpenEntry** with the entry identifier of a message, MAPI calls the **IMSLogon::OpenEntry** method of the message store responsible for the message.</span></span> 
  
<span data-ttu-id="b6a6b-148">Además de usar la sesión para abrir objetos, los clientes la usan para compararlos.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-148">In addition to using the session to open objects, clients use it to compare them.</span></span> <span data-ttu-id="b6a6b-149">El [método IMAPISession::CompareEntryIDs](imapisession-compareentryids.md) compara objetos comparando sus identificadores de entrada.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-149">The [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md) method compares objects by comparing their entry identifiers.</span></span> <span data-ttu-id="b6a6b-150">Si las [estructuras MAPIUID](mapiuid.md) contenidas en los identificadores de entrada pertenecen al mismo proveedor de servicios, MAPI reenvía la llamada a ese proveedor.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-150">If the [MAPIUID](mapiuid.md) structures contained within the entry identifiers belong to the same service provider, MAPI forwards the call to that provider.</span></span> <span data-ttu-id="b6a6b-151">**CompareEntryIDs** devuelve un valor de error cuando los dos identificadores de entrada no coinciden.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-151">**CompareEntryIDs** returns an error value when the two entry identifiers do not match.</span></span> <span data-ttu-id="b6a6b-152">Aunque este método puede comparar los identificadores de entrada que pertenecen a cualquier tipo de objeto, **CompareEntryIDs** funciona mejor para objetos de nivel superior, como almacenes de mensajes y contenedores de libreta de direcciones.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-152">Although this method can compare entry identifiers that belong to any type of object, **CompareEntryIDs** works best for higher level objects such as message stores and address book containers.</span></span> <span data-ttu-id="b6a6b-153">Para comparar objetos de nivel inferior, compare directamente las claves de búsqueda de los objetos (**PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md))) o las claves de registro (**PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md))).</span><span class="sxs-lookup"><span data-stu-id="b6a6b-153">To compare lower level objects, compare directly the objects' search keys (**PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md))) or record keys (**PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md))).</span></span> 
  
<span data-ttu-id="b6a6b-154">Al **igual que OpenEntry,** **CompareEntryIDs** se implementa mediante varios objetos.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-154">Like **OpenEntry**, **CompareEntryIDs** is implemented by multiple objects.</span></span> <span data-ttu-id="b6a6b-155">Elija el **método OpenEntry** y **CompareEntryID** que se va a usar según la cantidad de información que tenga sobre el objeto u objetos que se abrirán o compararán.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-155">Choose which **OpenEntry** and **CompareEntryID** method to use according to the amount of information that you have about the object or objects to be opened or compared.</span></span> <span data-ttu-id="b6a6b-156">Use las siguientes directrices al decidir qué método de interfaz llamar:</span><span class="sxs-lookup"><span data-stu-id="b6a6b-156">Use the following guidelines when deciding which interface method to call:</span></span> 
  
- <span data-ttu-id="b6a6b-157">Si no tiene información sobre los objetos de destino, llame a [IMAPISession::OpenEntry](imapisession-openentry.md) o [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md).</span><span class="sxs-lookup"><span data-stu-id="b6a6b-157">If you have no information about the target objects, call [IMAPISession::OpenEntry](imapisession-openentry.md) or [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md).</span></span> <span data-ttu-id="b6a6b-158">Este enfoque permite el acceso a cualquier objeto, pero es el más lento de los tres.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-158">This approach enables access to any object, but is the slowest of the three.</span></span>
    
- <span data-ttu-id="b6a6b-159">Si sabe que los objetos de destino son entradas de libreta de direcciones en lugar de, por ejemplo, carpetas, llame al método [IAddrBook::OpenEntry](iaddrbook-openentry.md) o [IAddrBook::CompareEntryIDs.](iaddrbook-compareentryids.md)</span><span class="sxs-lookup"><span data-stu-id="b6a6b-159">If you know that the target objects are address book entries rather than, for example, folders, call the [IAddrBook::OpenEntry](iaddrbook-openentry.md) or [IAddrBook::CompareEntryIDs](iaddrbook-compareentryids.md) method.</span></span> <span data-ttu-id="b6a6b-160">**IAddrBook::OpenEntry** abre el contenedor raíz de la libreta de direcciones cuando se especifica NULL como objeto de destino.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-160">**IAddrBook::OpenEntry** opens the root container of the address book when NULL is specified as the target object.</span></span> <span data-ttu-id="b6a6b-161">Este enfoque permite el acceso a cualquier objeto de libreta de direcciones y es más rápido que **usar IMAPISession**, pero más lento que **usar IMAPIContainer**.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-161">This approach enables access to any address book object and is faster than using **IMAPISession**, but slower than using **IMAPIContainer**.</span></span>
    
- <span data-ttu-id="b6a6b-162">Si el identificador de entrada que se usa es un identificador de entrada a corto plazo o si sabe que los objetos de destino pertenecen a un contenedor o carpeta de libreta de direcciones en particular, llame al método [IMAPIContainer::OpenEntry.](imapicontainer-openentry.md)</span><span class="sxs-lookup"><span data-stu-id="b6a6b-162">If the entry identifier being used is a short-term entry identifier or if you know that the target objects belong to a particular address book container or folder, call the [IMAPIContainer::OpenEntry](imapicontainer-openentry.md) method.</span></span> <span data-ttu-id="b6a6b-163">Este enfoque proporciona el rendimiento más rápido, pero solo permite el acceso a objetos de un contenedor o carpeta específico.</span><span class="sxs-lookup"><span data-stu-id="b6a6b-163">This approach yields the fastest performance, but enables access only to objects in a specific container or folder.</span></span> 
    

