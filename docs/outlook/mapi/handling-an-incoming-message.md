---
title: Controlar los mensajes entrantes
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d45d5ed9-41cd-4aaf-91d2-1e4a27bb16d4
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: f3fbe34793e3520b26b984f4bd6b14fbcab7a951
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33438984"
---
# <a name="handling-an-incoming-message"></a><span data-ttu-id="274f4-103">Controlar los mensajes entrantes</span><span class="sxs-lookup"><span data-stu-id="274f4-103">Handling an incoming message</span></span>

<span data-ttu-id="274f4-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="274f4-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="274f4-105">Un mensaje entrante es un mensaje que se ha enviado a través de uno o varios sistemas de mensajería.</span><span class="sxs-lookup"><span data-stu-id="274f4-105">An incoming message is a message that has been sent across one or more messaging systems.</span></span> <span data-ttu-id="274f4-106">Puede que se le haya enviado solo a usted o a muchos otros destinatarios.</span><span class="sxs-lookup"><span data-stu-id="274f4-106">It may have been sent only to you or to many other recipients.</span></span> <span data-ttu-id="274f4-107">Los mensajes entrantes se colocan en una carpeta de recepción designada para contener mensajes de una clase determinada.</span><span class="sxs-lookup"><span data-stu-id="274f4-107">Incoming messages are placed in a receive folder designated to hold messages of a particular class.</span></span> <span data-ttu-id="274f4-108">Puede configurar una carpeta de recepción diferente para cada clase de mensaje que controle o use una carpeta para todas las clases.</span><span class="sxs-lookup"><span data-stu-id="274f4-108">You can set up a different receive folder for each message class that you handle or use one folder for all of the classes.</span></span>
  
<span data-ttu-id="274f4-109">Si se ha registrado para recibir notificaciones de correo nuevo con el almacén de mensajes, recibirá una notificación cada vez que se coloque un mensaje en una carpeta de recepción.</span><span class="sxs-lookup"><span data-stu-id="274f4-109">If you have registered for new mail notifications with the message store, you will be notified whenever a message is placed in a receive folder.</span></span> <span data-ttu-id="274f4-110">Si no se ha registrado para recibir notificaciones de correo nuevo, debe abrir la carpeta de recepción correspondiente periódicamente para comprobar de forma manual la llegada de mensajes nuevos.</span><span class="sxs-lookup"><span data-stu-id="274f4-110">If you have not registered for new mail notifications, you must open the appropriate receive folder periodically to manually check for the arrival of new messages.</span></span>
  
<span data-ttu-id="274f4-111">Los clientes se registran para notificaciones de correo nuevo mediante la configuración de los parámetros en [IMsgStore:: Advise](imsgstore-advise.md) de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="274f4-111">Clients register for new mail notifications by setting the parameters to [IMsgStore::Advise](imsgstore-advise.md) as follows:</span></span> 
  
- <span data-ttu-id="274f4-112">Establezca _cbEntryID_ en 0.</span><span class="sxs-lookup"><span data-stu-id="274f4-112">Set  _cbEntryID_ to 0.</span></span> 
    
- <span data-ttu-id="274f4-113">Establezca _lpEntryID_ en NULL.</span><span class="sxs-lookup"><span data-stu-id="274f4-113">Set  _lpEntryID_ to NULL.</span></span> 
    
- <span data-ttu-id="274f4-114">Establezca _ulEventMask_ en fnevNewMail.</span><span class="sxs-lookup"><span data-stu-id="274f4-114">Set  _ulEventMask_ to fnevNewMail.</span></span> 
    
<span data-ttu-id="274f4-115">El parámetro _lpNotifications_ en la llamada a su método **IMAPIAdviseSink:: BENOTIFY** apunta a una estructura de **notificación NEWMAIL\_** que contiene información sobre el mensaje entrante, como su clase de mensaje, su entrada identificador, el identificador de entrada de su carpeta principal y el contenido de su propiedad **PR_MESSAGE_FLAGS** .</span><span class="sxs-lookup"><span data-stu-id="274f4-115">The  _lpNotifications_ parameter in the call to your **IMAPIAdviseSink::OnNotify** method points to a **NEWMAIL\_NOTIFICATION** structure that contains information about the incoming message, such as its message class, its entry identifier, the entry identifier of its parent folder, and the contents of its **PR_MESSAGE_FLAGS** property.</span></span> <span data-ttu-id="274f4-116">Para obtener más información sobre cómo registrar y controlar las notificaciones, vea [IMAPIAdviseSink::](imapiadvisesink-onnotify.md)NEWMAIL_NOTIFICATION, [](newmail_notification.md) **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) y [controlar](handling-notifications.md)las notificaciones.</span><span class="sxs-lookup"><span data-stu-id="274f4-116">For more information about registering for and handling notifications, see [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md), [NEWMAIL_NOTIFICATION](newmail_notification.md), **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)), and [Handling Notifications](handling-notifications.md).</span></span> 
  
<span data-ttu-id="274f4-117">Antes de mostrar un mensaje entrante a un usuario, determine si su clase de mensaje es una clase que admite su cliente.</span><span class="sxs-lookup"><span data-stu-id="274f4-117">Before displaying an incoming message to a user, determine if its message class is a class that your client supports.</span></span> <span data-ttu-id="274f4-118">Si no es así, ignore el mensaje.</span><span class="sxs-lookup"><span data-stu-id="274f4-118">If not, ignore the message.</span></span> <span data-ttu-id="274f4-119">Si la clase es una que admite, puede abrir y mostrar el mensaje con un formulario que sea adecuado para la clase de mensaje del mensaje.</span><span class="sxs-lookup"><span data-stu-id="274f4-119">If the class is one that you support, you can open and display the message with a form that is appropriate for the message class of the message.</span></span> <span data-ttu-id="274f4-120">La elección de los formularios se basa en la clase Message.</span><span class="sxs-lookup"><span data-stu-id="274f4-120">The choice of forms is based on message class.</span></span> <span data-ttu-id="274f4-121">Los mensajes que pertenecen a la clase IPM usan un formulario predeterminado implementado por MAPI.</span><span class="sxs-lookup"><span data-stu-id="274f4-121">Messages that belong to the IPM class use a default form implemented by MAPI.</span></span> <span data-ttu-id="274f4-122">Los mensajes que pertenecen a las clases personalizadas definidas por los clientes pueden usar formularios especializados definidos por el cliente o el formulario predeterminado de MAPI.</span><span class="sxs-lookup"><span data-stu-id="274f4-122">Messages that belong to custom classes defined by clients can use either client-defined specialized forms or the MAPI default form.</span></span>
  
## <a name="open-and-display-an-incoming-message"></a><span data-ttu-id="274f4-123">Abrir y mostrar un mensaje entrante</span><span class="sxs-lookup"><span data-stu-id="274f4-123">Open and display an incoming message</span></span>
  
1. <span data-ttu-id="274f4-124">Llame a **IMsgStore:: GetReceiveFolder** para recuperar el identificador de entrada de la carpeta de recepción para la clase de mensaje del mensaje y pase este identificador de entrada a **IMsgStore:: OpenEntry** para abrir la carpeta.</span><span class="sxs-lookup"><span data-stu-id="274f4-124">Call **IMsgStore::GetReceiveFolder** to retrieve the entry identifier of the receive folder for the message class of the message and pass this entry identifier to **IMsgStore::OpenEntry** to open the folder.</span></span> <span data-ttu-id="274f4-125">Para obtener más información, vea [IMsgStore:: GetReceiveFolder](imsgstore-getreceivefolder.md), [IMsgStore:: OpenEntry](imsgstore-openentry.md)y [abrir una carpeta de almacén de mensajes](opening-a-message-store-folder.md).</span><span class="sxs-lookup"><span data-stu-id="274f4-125">For more information, see [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md), [IMsgStore::OpenEntry](imsgstore-openentry.md), and [Opening a Message Store Folder](opening-a-message-store-folder.md).</span></span>
    
2. <span data-ttu-id="274f4-126">Llame al método **IMAPIContainer:: GetContentsTable** de la carpeta de recepción para recuperar su tabla de contenido.</span><span class="sxs-lookup"><span data-stu-id="274f4-126">Call the receive folder's **IMAPIContainer::GetContentsTable** method to retrieve its contents table.</span></span> <span data-ttu-id="274f4-127">Para obtener más información, vea [IMAPIContainer:: GetContentsTable](imapicontainer-getcontentstable.md).</span><span class="sxs-lookup"><span data-stu-id="274f4-127">For more information, see [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md).</span></span> <span data-ttu-id="274f4-128">Llame al método **IMAPITable:: QueryRows** de la tabla para recuperar todas las filas de la tabla.</span><span class="sxs-lookup"><span data-stu-id="274f4-128">Call the table's **IMAPITable::QueryRows** method to retrieve all the rows in the table.</span></span> <span data-ttu-id="274f4-129">Para obtener más información, consulte [IMAPITable:: QueryRows](imapitable-queryrows.md) y [tablas de contenido](contents-tables.md).</span><span class="sxs-lookup"><span data-stu-id="274f4-129">For more information see [IMAPITable::QueryRows](imapitable-queryrows.md) and [Contents Tables](contents-tables.md).</span></span> <span data-ttu-id="274f4-130">Para obtener más información sobre cómo mostrar una tabla de contenido, vea [Mostrar una tabla de contenido de una carpeta](displaying-a-folder-contents-table.md).</span><span class="sxs-lookup"><span data-stu-id="274f4-130">For more information about displaying a contents table, see [Displaying a Folder Contents Table](displaying-a-folder-contents-table.md).</span></span>
    
3. <span data-ttu-id="274f4-131">Si el cliente es interactivo, permita al usuario seleccionar un mensaje de la tabla y determinar el formulario que se va a usar para mostrar el mensaje.</span><span class="sxs-lookup"><span data-stu-id="274f4-131">If your client is interactive, allow the user to select a message from the table and determine the form to be used to display that message.</span></span> <span data-ttu-id="274f4-132">Los clientes pueden usar el formulario predeterminado proporcionado por MAPI o un formulario personalizado.</span><span class="sxs-lookup"><span data-stu-id="274f4-132">Clients can use the default form provided by MAPI or a custom form.</span></span> <span data-ttu-id="274f4-133">Para obtener más información, consulte [Handling MAPI Forms](handling-mapi-forms.md).</span><span class="sxs-lookup"><span data-stu-id="274f4-133">For more information, see [Handling MAPI Forms](handling-mapi-forms.md).</span></span>
    
4. <span data-ttu-id="274f4-134">Llame a **IMsgStore:: OpenEntry** para abrir el mensaje.</span><span class="sxs-lookup"><span data-stu-id="274f4-134">Call **IMsgStore::OpenEntry** to open the message.</span></span> <span data-ttu-id="274f4-135">Para obtener más información, vea [abrir un mensaje](opening-a-message.md).</span><span class="sxs-lookup"><span data-stu-id="274f4-135">For more information, see [Opening a Message](opening-a-message.md).</span></span>
    
5. <span data-ttu-id="274f4-136">Procesar el texto del mensaje.</span><span class="sxs-lookup"><span data-stu-id="274f4-136">Process the message text.</span></span> <span data-ttu-id="274f4-137">Para obtener más información, vea [abrir texto de mensaje](opening-message-text.md).</span><span class="sxs-lookup"><span data-stu-id="274f4-137">For more information, see [Opening Message Text](opening-message-text.md).</span></span>
    
6. <span data-ttu-id="274f4-138">RePresente cada uno de los datos adjuntos del mensaje.</span><span class="sxs-lookup"><span data-stu-id="274f4-138">Render each of the message attachments.</span></span> <span data-ttu-id="274f4-139">Para obtener más información, vea [representar datos adjuntos en texto sin formato](rendering-an-attachment-in-plain-text.md) o [representar datos adjuntos en texto RTF](rendering-an-attachment-in-rtf-text.md).</span><span class="sxs-lookup"><span data-stu-id="274f4-139">For more information, see [Rendering an Attachment in Plain Text](rendering-an-attachment-in-plain-text.md) or [Rendering an Attachment in RTF Text](rendering-an-attachment-in-rtf-text.md).</span></span>
    
7. <span data-ttu-id="274f4-140">Abra un archivo de datos adjuntos si lo desea.</span><span class="sxs-lookup"><span data-stu-id="274f4-140">Open an attachment if desired.</span></span> <span data-ttu-id="274f4-141">Para obtener más información, consulte [apertura de datos](opening-an-attachment.md)adjuntos.</span><span class="sxs-lookup"><span data-stu-id="274f4-141">For more information see [Opening an Attachment](opening-an-attachment.md).</span></span>
    
## <a name="in-this-section"></a><span data-ttu-id="274f4-142">En esta sección</span><span class="sxs-lookup"><span data-stu-id="274f4-142">In this section</span></span>

- <span data-ttu-id="274f4-143">[Texto del mensaje de apertura](opening-message-text.md): describe cómo abrir el texto del mensaje.</span><span class="sxs-lookup"><span data-stu-id="274f4-143">[Opening Message Text](opening-message-text.md): Describes how to open the message text.</span></span>
    
- <span data-ttu-id="274f4-144">[Representar datos adjuntos en texto sin formato](rendering-an-attachment-in-plain-text.md): describe cómo representar datos adjuntos en texto sin formato.</span><span class="sxs-lookup"><span data-stu-id="274f4-144">[Rendering an Attachment in Plain Text](rendering-an-attachment-in-plain-text.md): Describes how to render an attachment in plain text.</span></span>
    
- <span data-ttu-id="274f4-145">[Representar datos adjuntos en texto RTF](rendering-an-attachment-in-rtf-text.md): describe cómo representar datos adjuntos en texto con formato.</span><span class="sxs-lookup"><span data-stu-id="274f4-145">[Rendering an Attachment in RTF Text](rendering-an-attachment-in-rtf-text.md): Describes how to render an attachment in formatted text.</span></span>
    
- <span data-ttu-id="274f4-146">[Apertura de datos](opening-an-attachment.md)adjuntos: describe cómo abrir datos adjuntos.</span><span class="sxs-lookup"><span data-stu-id="274f4-146">[Opening an Attachment](opening-an-attachment.md): Describes how to open an attachment.</span></span>
    

