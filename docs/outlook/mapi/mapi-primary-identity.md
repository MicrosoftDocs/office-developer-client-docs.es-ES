---
title: Identidad principal MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 8787a873-6752-4b17-8ea3-8fed793e1371
description: 'Última modificación: 09 de marzo de 2015'
ms.openlocfilehash: 5bf88de280b012c54d4caaac6bdfe877f476ac37
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "33404725"
---
# <a name="mapi-primary-identity"></a><span data-ttu-id="b37eb-103">Identidad principal MAPI</span><span class="sxs-lookup"><span data-stu-id="b37eb-103">MAPI Primary Identity</span></span>

  
  
<span data-ttu-id="b37eb-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="b37eb-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="b37eb-105">La mayoría de las sesiones MAPI tienen un proveedor de servicios concreto que proporciona la identidad principal para la sesión.</span><span class="sxs-lookup"><span data-stu-id="b37eb-105">Most MAPI sessions have a particular service provider that supplies the primary identity for the session.</span></span> <span data-ttu-id="b37eb-106">Normalmente, es un proveedor de libreta de direcciones, que proporciona identidad a través de uno de sus objetos de usuario de mensajería o listas de distribución.</span><span class="sxs-lookup"><span data-stu-id="b37eb-106">Typically, it is an address book provider, which supplies identity through one of its messaging user objects or distribution lists.</span></span> <span data-ttu-id="b37eb-107">De hecho, MAPI recomienda que los servicios de mensaje que incluyan un proveedor de libreta de direcciones usen uno de sus objetos para la identidad principal.</span><span class="sxs-lookup"><span data-stu-id="b37eb-107">In fact, MAPI recommends that message services that include an address book provider use one of its objects for the primary identity.</span></span> <span data-ttu-id="b37eb-108">Cuando un proveedor de servicios que pertenece a un servicio de mensajes proporciona la identidad principal, todos los demás proveedores de servicios del servicio de mensajes comparten esta identidad.</span><span class="sxs-lookup"><span data-stu-id="b37eb-108">When a service provider that belongs to a message service supplies the primary identity, all of the other service providers in the message service share this identity.</span></span>
  
<span data-ttu-id="b37eb-109">El MAPISVC. El archivo de configuración INF tiene entradas relacionadas con la identidad en el nivel de servicio de mensajes y proveedor de servicios.</span><span class="sxs-lookup"><span data-stu-id="b37eb-109">The MAPISVC.INF configuration file has entries relating to identity at both the message service and service provider level.</span></span> <span data-ttu-id="b37eb-110">Las secciones de servicio de mensajes deben incluir una entrada que indique si el servicio puede o no proporcionar la identidad principal; las secciones de proveedores de servicios incluyen una entrada similar solo cuando el proveedor puede proporcionar una identidad.</span><span class="sxs-lookup"><span data-stu-id="b37eb-110">Message service sections must include an entry that states whether or not the service can supply the primary identity; service provider sections include a similar entry only when the provider can supply an identity.</span></span>
  
<span data-ttu-id="b37eb-111">En la siguiente tabla se enumeran las entradas que aparecen en las secciones servicio de mensajes y proveedor de servicios del MAPISVC. Archivo INF.</span><span class="sxs-lookup"><span data-stu-id="b37eb-111">The following table lists the entries that appear in the message service and service provider sections in the MAPISVC.INF file.</span></span>
  
|<span data-ttu-id="b37eb-112">**Proveedor de identidad principal**</span><span class="sxs-lookup"><span data-stu-id="b37eb-112">**Primary identity supplier**</span></span>|<span data-ttu-id="b37eb-113">**Configuración de PR_RESOURCE_FLAGS**</span><span class="sxs-lookup"><span data-stu-id="b37eb-113">**PR_RESOURCE_FLAGS setting**</span></span>|
|:-----|:-----|
|<span data-ttu-id="b37eb-114">Servicio de mensajes</span><span class="sxs-lookup"><span data-stu-id="b37eb-114">Message service</span></span>  <br/> | `SERVICE_PRIMARY_IDENTITY` <br/> |
|<span data-ttu-id="b37eb-115">No es el servicio de mensajes</span><span class="sxs-lookup"><span data-stu-id="b37eb-115">Not the message service</span></span>  <br/> | `SERVICE_NO_PRIMARY_IDENTITY` <br/> |
|<span data-ttu-id="b37eb-116">Proveedor de servicios</span><span class="sxs-lookup"><span data-stu-id="b37eb-116">Service provider</span></span>  <br/> | `STATUS_PRIMARY_IDENTITY` <br/> |
   
<span data-ttu-id="b37eb-117">Aunque varios servicios de mensajes pueden declarar su capacidad para proporcionar la identidad principal de una sesión, solo se selecciona un servicio de mensajes para hacerlo.</span><span class="sxs-lookup"><span data-stu-id="b37eb-117">Although multiple message services can declare their ability to provide a session's primary identity, only one message service is selected to do so.</span></span> <span data-ttu-id="b37eb-118">Esta selección puede producirse:</span><span class="sxs-lookup"><span data-stu-id="b37eb-118">This selection can occur:</span></span>
  
- <span data-ttu-id="b37eb-119">Cuando se crea un perfil.</span><span class="sxs-lookup"><span data-stu-id="b37eb-119">When a profile is created.</span></span>
    
- <span data-ttu-id="b37eb-120">Cuando un cliente llama a **IMsgServiceAdmin:: SetPrimaryIdentity** para establecer explícitamente un servicio de mensajes determinado como proveedor de la identidad de la sesión.</span><span class="sxs-lookup"><span data-stu-id="b37eb-120">When a client calls **IMsgServiceAdmin::SetPrimaryIdentity** to explicitly establish a particular message service as the provider of the session identity.</span></span> <span data-ttu-id="b37eb-121">Para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="b37eb-121">For more information.</span></span> <span data-ttu-id="b37eb-122">Vea [IMsgServiceAdmin:: SetPrimaryIdentity](imsgserviceadmin-setprimaryidentity.md).</span><span class="sxs-lookup"><span data-stu-id="b37eb-122">See [IMsgServiceAdmin::SetPrimaryIdentity](imsgserviceadmin-setprimaryidentity.md).</span></span>
    
<span data-ttu-id="b37eb-123">Cuando se crea un perfil, MAPI designa el primer servicio de mensajes que se va a configurar, que incluye un proveedor con la marca STATUS_PRIMARY_IDENTITY establecida en su propiedad **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) para proporcionar la identidad principal .</span><span class="sxs-lookup"><span data-stu-id="b37eb-123">When a profile is created, MAPI designates the first message service to be configured that includes a provider with the STATUS_PRIMARY_IDENTITY flag set in its **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) property to supply the primary identity.</span></span> <span data-ttu-id="b37eb-124">Dentro del servicio de mensajes designado, se elige el primer proveedor que se va a configurar con este conjunto de marcas de recursos para proporcionar la identidad del servicio.</span><span class="sxs-lookup"><span data-stu-id="b37eb-124">Within the designated message service, the first provider to be configured with this resource flag set is chosen to provide the identity for the service.</span></span> <span data-ttu-id="b37eb-125">La marca STATUS_PRIMARY_IDENTITY se borra para todos los demás proveedores del servicio designado y otros servicios de mensajes del perfil.</span><span class="sxs-lookup"><span data-stu-id="b37eb-125">The STATUS_PRIMARY_IDENTITY flag is cleared for all other providers in the designated service and other message services in the profile.</span></span> <span data-ttu-id="b37eb-126">Si, en cualquier momento, el proveedor que proporciona la identidad principal se quita del perfil, MAPI asigna el rol al siguiente proveedor que se configure y que puede proporcionar una identidad.</span><span class="sxs-lookup"><span data-stu-id="b37eb-126">If at any time the provider supplying primary identity is removed from the profile, MAPI assigns the role to the next provider to be configured that can supply identity.</span></span> <span data-ttu-id="b37eb-127">Esto se determina por la apariencia de la `PR_RESOURCE_FLAGS=STATUS_PRIMARY_IDENTITY` entrada en la sección del proveedor en MAPISVC. inf.</span><span class="sxs-lookup"><span data-stu-id="b37eb-127">This is determined by the appearance of the  `PR_RESOURCE_FLAGS=STATUS_PRIMARY_IDENTITY` entry in the provider's section in MAPISVC.INF.</span></span> 
  
<span data-ttu-id="b37eb-128">Cuando un cliente llama al método **IMsgServiceAdmin:: SetPrimaryIdentity** del servicio de mensajería, especifica la MAPIUID para un proveedor de servicios dentro del servicio de destino.</span><span class="sxs-lookup"><span data-stu-id="b37eb-128">When a client calls a message service's **IMsgServiceAdmin::SetPrimaryIdentity** method, it specifies the MAPIUID for a service provider within the target service.</span></span> <span data-ttu-id="b37eb-129">Para obtener más información, vea [MAPIUID](mapiuid.md).</span><span class="sxs-lookup"><span data-stu-id="b37eb-129">For more information, see [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="b37eb-130">El proveedor de servicios representado por **MAPIUID** se asigna para suministrar la identidad principal del servicio de mensajes y de la sesión, y todos los demás proveedores del servicio compartirán esta identidad.</span><span class="sxs-lookup"><span data-stu-id="b37eb-130">The service provider represented by the **MAPIUID** is assigned to supply the primary identity for the message service and for the session, and all of the other providers in the service will share this identity.</span></span> 
  
<span data-ttu-id="b37eb-131">Cada proveedor del servicio de mensajes responsable de proporcionar la identidad principal actualiza su fila en la tabla de estado para incluir las siguientes propiedades.</span><span class="sxs-lookup"><span data-stu-id="b37eb-131">Every provider in the message service responsible for supplying the primary identity updates its row in the status table to include the following properties.</span></span>
  
|<span data-ttu-id="b37eb-132">**Propiedad de identidad principal**</span><span class="sxs-lookup"><span data-stu-id="b37eb-132">**Primary identity property**</span></span>|<span data-ttu-id="b37eb-133">**Establecer como**</span><span class="sxs-lookup"><span data-stu-id="b37eb-133">**Set to**</span></span>|
|:-----|:-----|
|<span data-ttu-id="b37eb-134">**PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b37eb-134">**PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b37eb-135">Nombre para mostrar del objeto que proporciona la identidad principal.</span><span class="sxs-lookup"><span data-stu-id="b37eb-135">Display name of the object supplying the primary identity.</span></span>  <br/> |
|<span data-ttu-id="b37eb-136">**PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b37eb-136">**PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b37eb-137">Clave de búsqueda del objeto que proporciona la identidad principal.</span><span class="sxs-lookup"><span data-stu-id="b37eb-137">Search key for the object supplying the primary identity.</span></span>  <br/> |
|<span data-ttu-id="b37eb-138">**PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b37eb-138">**PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b37eb-139">Identificador de entrada del objeto que proporciona la identidad principal.</span><span class="sxs-lookup"><span data-stu-id="b37eb-139">Entry identifier for the object supplying the primary identity.</span></span>  <br/> |
   
 <span data-ttu-id="b37eb-140">**Para recuperar el identificador de entrada para el objeto que proporciona la identidad principal**</span><span class="sxs-lookup"><span data-stu-id="b37eb-140">**To retrieve the entry identifier for the object supplying the primary identity**</span></span>
  
- <span data-ttu-id="b37eb-141">Llame al método **IMAPISession:: QueryIdentity** .</span><span class="sxs-lookup"><span data-stu-id="b37eb-141">Call the **IMAPISession::QueryIdentity** method.</span></span> <span data-ttu-id="b37eb-142">Para obtener más información, vea [IMAPISession:: QueryIdentity](imapisession-queryidentity.md).</span><span class="sxs-lookup"><span data-stu-id="b37eb-142">For more information, see [IMAPISession::QueryIdentity](imapisession-queryidentity.md).</span></span> <span data-ttu-id="b37eb-143">**QueryIdentity** busca en la tabla de estado de la fila que contiene el valor STATUS_PRIMARY_IDENTITY en su columna **PR_RESOURCE_FLAGS** y devuelve el **PR_IDENTITY_ENTRYID** correspondiente como el identificador de entrada del principal. identifica.</span><span class="sxs-lookup"><span data-stu-id="b37eb-143">**QueryIdentity** searches the status table for the row that contains the value STATUS_PRIMARY_IDENTITY in its **PR_RESOURCE_FLAGS** column and returns the corresponding **PR_IDENTITY_ENTRYID** as the entry identifier for the primary identity.</span></span> 
    

