---
title: Enviar mensajes usando proveedores de almacenamiento de mensajes
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7632d784-00d8-48fd-a73b-73778efbef7f
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: e29b909e90d2767bcf1bb9382a46e6f2c1cd9f2a
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/23/2018
ms.locfileid: "22569802"
---
# <a name="sending-messages-by-using-message-store-providers"></a><span data-ttu-id="88aee-103">Enviar mensajes usando proveedores de almacenamiento de mensajes</span><span class="sxs-lookup"><span data-stu-id="88aee-103">Sending messages by using message store providers</span></span>

<span data-ttu-id="88aee-104">**Hace referencia a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="88aee-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="88aee-105">Los proveedores de almacén de mensajes no son necesarios para admitir los envíos de mensajes salientes (es decir, la capacidad para las aplicaciones de cliente usar el proveedor de almacenamiento de mensajes para enviar mensajes).</span><span class="sxs-lookup"><span data-stu-id="88aee-105">Message store providers are not required to support outgoing message submissions (that is, the ability for client applications to use the message store provider to send messages).</span></span> <span data-ttu-id="88aee-106">Las aplicaciones cliente que necesite utilizar un almacén de mensajes, mientras que el envío de mensajes, debido a que los datos del mensaje deben ser almacenados en algún lugar entre el momento en que el usuario haya terminado de redactar y la hora en que la cola MAPI proporciona el mensaje a un proveedor de transporte para envío al sistema de mensajería subyacente.</span><span class="sxs-lookup"><span data-stu-id="88aee-106">Client applications need to use a message store while sending messages, because the message's data must be stored somewhere between the time that the user is finished composing it and the time that the MAPI spooler gives the message to a transport provider for submission to the underlying messaging system.</span></span> <span data-ttu-id="88aee-107">Si su proveedor de almacén de mensajes no es compatible con los envíos de mensajes salientes, no se utiliza como almacén de mensajes predeterminado.</span><span class="sxs-lookup"><span data-stu-id="88aee-107">If your message store provider does not support outgoing message submissions, it cannot be used as the default message store.</span></span>
  
<span data-ttu-id="88aee-108">Para admitir el envío de mensajes, el proveedor de almacén de mensajes debe hacer lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="88aee-108">To support sending messages, your message store provider must do the following:</span></span>
  
- <span data-ttu-id="88aee-109">Implementar una cola de mensajes salientes.</span><span class="sxs-lookup"><span data-stu-id="88aee-109">Implement an outgoing message queue.</span></span>
    
- <span data-ttu-id="88aee-110">Admite el método [IMessage::SubmitMessage](imessage-submitmessage.md) en los objetos de mensajes creados en el almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="88aee-110">Support the [IMessage::SubmitMessage](imessage-submitmessage.md) method on message objects created in the message store.</span></span> 
    
- <span data-ttu-id="88aee-111">Compatible con los métodos **IMsgStore** que son específicos de la cola MAPI: [IMsgStore::FinishedMsg](imsgstore-finishedmsg.md), [IMsgStore::GetOutgoingQueue](imsgstore-getoutgoingqueue.md), [IMsgStore::NotifyNewMail](imsgstore-notifynewmail.md)y [IMsgStore::SetLockState](imsgstore-setlockstate.md).</span><span class="sxs-lookup"><span data-stu-id="88aee-111">Support the **IMsgStore** methods that are specific to the MAPI spooler: [IMsgStore::FinishedMsg](imsgstore-finishedmsg.md), [IMsgStore::GetOutgoingQueue](imsgstore-getoutgoingqueue.md), [IMsgStore::NotifyNewMail](imsgstore-notifynewmail.md), and [IMsgStore::SetLockState](imsgstore-setlockstate.md).</span></span>
    
<span data-ttu-id="88aee-112">El método **SetLockState** es importante para la interoperación adecuado entre los clientes y la cola de MAPI.</span><span class="sxs-lookup"><span data-stu-id="88aee-112">The **SetLockState** method is important for proper interoperation between the MAPI spooler and clients.</span></span> <span data-ttu-id="88aee-113">Cuando la cola MAPI llama a **SetLockState** en un mensaje saliente, el proveedor de almacén de mensajes no debe permitir a los clientes abra el mensaje.</span><span class="sxs-lookup"><span data-stu-id="88aee-113">When the MAPI spooler calls **SetLockState** on an outgoing message, the message store provider must not let clients open the message.</span></span> <span data-ttu-id="88aee-114">Si un cliente intenta abrir un mensaje que está bloqueado por la cola MAPI, el proveedor de almacén de mensajes debe devolver MAPI_E_NO_ACCESS.</span><span class="sxs-lookup"><span data-stu-id="88aee-114">If a client does try to open a message that is locked by the MAPI spooler, the message store provider should return MAPI_E_NO_ACCESS.</span></span> <span data-ttu-id="88aee-115">El estado bloqueado de un mensaje no tiene que ser persistente en caso de que el almacén se cierra mientras el mensaje está bloqueado por la cola de MAPI.</span><span class="sxs-lookup"><span data-stu-id="88aee-115">The locked state of a message does not have to be persistent in case the store is shut down while the message is locked by the MAPI spooler.</span></span> 
  
<span data-ttu-id="88aee-116">Independientemente de si la cola MAPI ha bloqueado un mensaje saliente, el proveedor de almacén de mensajes no debe permitir un mensaje en la cola de mensajes salientes que se abrirá para escribir en él.</span><span class="sxs-lookup"><span data-stu-id="88aee-116">Regardless of whether the MAPI spooler has locked an outgoing message, the message store provider should not allow a message in the outgoing message queue to be opened for writing.</span></span> <span data-ttu-id="88aee-117">Si un cliente, llama al método [IMSgStore::OpenEntry](imsgstore-openentry.md) en un mensaje saliente con la marca MAPI_MODIFY, la llamada debe producir un error y devolver MAPI_E_SUBMITTED.</span><span class="sxs-lookup"><span data-stu-id="88aee-117">If a client calls the [IMSgStore::OpenEntry](imsgstore-openentry.md) method on an outgoing message with the MAPI_MODIFY flag, the call should fail and return MAPI_E_SUBMITTED.</span></span> <span data-ttu-id="88aee-118">Si una aplicación cliente llama **OpenEntry** en un mensaje saliente con la marca MAPI_BEST_ACCESS, el proveedor de almacenamiento de mensaje debe permitir acceso de sólo lectura para el mensaje.</span><span class="sxs-lookup"><span data-stu-id="88aee-118">If a client application calls **OpenEntry** on an outgoing message with the MAPI_BEST_ACCESS flag, the message store provider should allow read-only access to the message.</span></span> 
  
<span data-ttu-id="88aee-119">Cuando un mensaje se gestione la cola MAPI, el proveedor de almacén de mensajes establece la propiedad del mensaje **PR_SUBMIT_FLAGS** ([PidTagSubmitFlags](pidtagsubmitflags-canonical-property.md)) en SUBMITFLAG_LOCKED.</span><span class="sxs-lookup"><span data-stu-id="88aee-119">When a message is to be handled by the MAPI spooler, the message store provider sets the message's **PR_SUBMIT_FLAGS** ([PidTagSubmitFlags](pidtagsubmitflags-canonical-property.md)) property to SUBMITFLAG_LOCKED.</span></span> <span data-ttu-id="88aee-120">El valor SUBMITFLAG_LOCKED indica que la cola MAPI ha bloqueado el mensaje para su uso exclusivo.</span><span class="sxs-lookup"><span data-stu-id="88aee-120">The SUBMITFLAG_LOCKED value indicates that the MAPI spooler has locked the message for its exclusive use.</span></span> <span data-ttu-id="88aee-121">El otro valor para **PR_SUBMIT_FLAGS**, SUBMITFLAG_PREPROCESS, se establece cuando el mensaje requiere preprocesamiento por una o más funciones del preprocesador registradas por un proveedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="88aee-121">The other value for **PR_SUBMIT_FLAGS**, SUBMITFLAG_PREPROCESS, is set when the message requires preprocessing by one or more preprocessor functions registered by a transport provider.</span></span>
  
<span data-ttu-id="88aee-122">Los procedimientos siguientes describen cómo interactúan el almacén de mensajes, el transporte y la cola MAPI para enviar un mensaje desde un cliente a uno o más destinatarios.</span><span class="sxs-lookup"><span data-stu-id="88aee-122">The following procedures describe how the message store, transport, and MAPI spooler interact to send a message from a client to one or more recipients.</span></span> 
  
<span data-ttu-id="88aee-123">La aplicación cliente llama al método de [IMessage::SubmitMessage](imessage-submitmessage.md) .</span><span class="sxs-lookup"><span data-stu-id="88aee-123">The client application calls the [IMessage::SubmitMessage](imessage-submitmessage.md) method.</span></span> <span data-ttu-id="88aee-124">En **SubmitMessage**, el proveedor de almacén de mensajes hace lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="88aee-124">In **SubmitMessage**, the message store provider does the following:</span></span>
  
1. <span data-ttu-id="88aee-125">Llama a [IMAPISupport::PrepareSubmit](imapisupport-preparesubmit.md).</span><span class="sxs-lookup"><span data-stu-id="88aee-125">Calls [IMAPISupport::PrepareSubmit](imapisupport-preparesubmit.md).</span></span> <span data-ttu-id="88aee-126">Si MAPI devuelve un error, el proveedor de almacenamiento de mensaje devuelve ese error al cliente.</span><span class="sxs-lookup"><span data-stu-id="88aee-126">If MAPI returns an error, the message store provider returns that error to the client.</span></span>
    
2. <span data-ttu-id="88aee-127">Establece el bit en la propiedad **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) del mensaje MSGFLAG_SUBMIT.</span><span class="sxs-lookup"><span data-stu-id="88aee-127">Sets the MSGFLAG_SUBMIT bit in the **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) property of the message.</span></span>
    
3. <span data-ttu-id="88aee-128">Se asegura de que hay una columna para la propiedad **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) en la tabla de destinatarios y establece en FALSE para indicar que no hay transporte aún ha asumido la responsabilidad para transmitir el mensaje.</span><span class="sxs-lookup"><span data-stu-id="88aee-128">Ensures that there is a column for the **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) property in the recipient table and sets it to FALSE to indicate that no transport has yet assumed responsibility for transmitting the message.</span></span>
    
4. <span data-ttu-id="88aee-129">Establece la fecha y hora de origen en la propiedad **PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="88aee-129">Sets the date and time of origination in the **PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)) property.</span></span>
    
5. <span data-ttu-id="88aee-130">Llama a [IMAPISupport::ExpandRecips](imapisupport-expandrecips.md) para hacer lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="88aee-130">Calls [IMAPISupport::ExpandRecips](imapisupport-expandrecips.md) to do the following:</span></span> 
    
    1. <span data-ttu-id="88aee-131">Expanda todas las listas de distribuci�n personal y destinatarios personalizados y reemplace todos los nombres de presentaci�n que ha cambiado con sus nombres originales.</span><span class="sxs-lookup"><span data-stu-id="88aee-131">Expand all personal distribution lists and custom recipients and replace all changed display names with their original names.</span></span>
        
    2. <span data-ttu-id="88aee-132">Quite los nombres duplicados.</span><span class="sxs-lookup"><span data-stu-id="88aee-132">Remove duplicate names.</span></span>
        
    3. <span data-ttu-id="88aee-133">Compruebe para cualquier preprocesamiento necesarios y, si es necesario preprocesamiento, establecer la marca NEEDS_PREPROCESSING y la propiedad **PR_PREPROCESS** ([PidTagPreprocess](pidtagpreprocess-canonical-property.md)), que está reservada para MAPI.</span><span class="sxs-lookup"><span data-stu-id="88aee-133">Check for any required preprocessing and, if preprocessing is required, set the NEEDS_PREPROCESSING flag and the **PR_PREPROCESS** ([PidTagPreprocess](pidtagpreprocess-canonical-property.md)) property, which is reserved for MAPI.</span></span> 
        
    4. <span data-ttu-id="88aee-134">Establecer el indicador NEEDS_SPOOLER si el almac�n de mensajes se complementa con un transporte y no puede controlar todos los destinatarios.</span><span class="sxs-lookup"><span data-stu-id="88aee-134">Set the NEEDS_SPOOLER flag if the message store is tightly coupled with a transport and it cannot handle all of the recipients.</span></span> 
    
6. <span data-ttu-id="88aee-135">Si se establece la marca de mensaje NEEDS_PREPROCESSING, realiza las tareas siguientes:</span><span class="sxs-lookup"><span data-stu-id="88aee-135">Performs the following tasks if the NEEDS_PREPROCESSING message flag is set:</span></span>
    
    1. <span data-ttu-id="88aee-136">Coloca el mensaje en la cola de salida con el bit SUBMITFLAG_PREPROCESS establecido en la propiedad **PR_SUBMIT_FLAGS** .</span><span class="sxs-lookup"><span data-stu-id="88aee-136">Puts the message in the outgoing queue with the SUBMITFLAG_PREPROCESS bit set in the **PR_SUBMIT_FLAGS** property.</span></span> 
        
    2. <span data-ttu-id="88aee-137">Notifica a la cola MAPI que ha cambiado la cola.</span><span class="sxs-lookup"><span data-stu-id="88aee-137">Notifies the MAPI spooler that the queue has changed.</span></span>
        
    3. <span data-ttu-id="88aee-138">Devuelve el control al cliente y contin�a el flujo de mensajes en la cola MAPI.</span><span class="sxs-lookup"><span data-stu-id="88aee-138">Returns control to the client, and message flow continues in the MAPI spooler.</span></span> <span data-ttu-id="88aee-139">La cola MAPI realiza las tareas siguientes:</span><span class="sxs-lookup"><span data-stu-id="88aee-139">The MAPI spooler performs the following tasks:</span></span> 
    
       1. <span data-ttu-id="88aee-140">Bloquea el mensaje mediante una llamada a [IMsgStore::SetLockState](imsgstore-setlockstate.md).</span><span class="sxs-lookup"><span data-stu-id="88aee-140">Locks the message by calling [IMsgStore::SetLockState](imsgstore-setlockstate.md).</span></span>
            
       2. <span data-ttu-id="88aee-141">Lleva a cabo el preprocesamiento necesarias mediante una llamada a todas las funciones de preprocesamiento en el orden de registro.</span><span class="sxs-lookup"><span data-stu-id="88aee-141">Performs the needed preprocessing by calling all of the preprocessing functions in the order of registration.</span></span> <span data-ttu-id="88aee-142">Los proveedores de transporte llame a [IMAPISupport::RegisterPreprocessor](imapisupport-registerpreprocessor.md) para registrar las funciones de preprocesamiento.</span><span class="sxs-lookup"><span data-stu-id="88aee-142">Transport providers call [IMAPISupport::RegisterPreprocessor](imapisupport-registerpreprocessor.md) to register preprocessing functions.</span></span> 
            
       3. <span data-ttu-id="88aee-143">Las llamadas [IMessage::SubmitMessage](imessage-submitmessage.md) en el mensaje abierto para indicar al mensaje almacenar esa preprocesamiento está completa.</span><span class="sxs-lookup"><span data-stu-id="88aee-143">Calls [IMessage::SubmitMessage](imessage-submitmessage.md) on the open message to indicate to the message store that preprocessing is complete.</span></span> 
    
<span data-ttu-id="88aee-144">Si se ha producido ningún preprocesamiento o hubo preprocesamiento y la cola MAPI llamado **SubmitMessage**, el proveedor de almacén de mensajes hace lo siguiente en el proceso de cliente:</span><span class="sxs-lookup"><span data-stu-id="88aee-144">If there was no preprocessing, or there was preprocessing and the MAPI spooler called **SubmitMessage**, the message store provider does the following in the client process:</span></span> 
  
- <span data-ttu-id="88aee-145">Performs the following tasks if the message store is tightly coupled to a transport and the NEEDS_SPOOLER flag was returned from [IMAPISupport::ExpandRecips](imapisupport-expandrecips.md):</span><span class="sxs-lookup"><span data-stu-id="88aee-145">Performs the following tasks if the message store is tightly coupled to a transport and the NEEDS_SPOOLER flag was returned from [IMAPISupport::ExpandRecips](imapisupport-expandrecips.md):</span></span>
    
   - <span data-ttu-id="88aee-146">Administra a todos los destinatarios que pueden administrar.</span><span class="sxs-lookup"><span data-stu-id="88aee-146">Handles any recipients that it can handle.</span></span>
    
   - <span data-ttu-id="88aee-147">Establece la propiedad **PR_RESPONSIBILITY** en TRUE para todos los destinatarios que administra.</span><span class="sxs-lookup"><span data-stu-id="88aee-147">Sets the **PR_RESPONSIBILITY** property to TRUE for any recipients that it handles.</span></span> 
    
   - <span data-ttu-id="88aee-148">Si todos los destinatarios se conocen en este almac�n de acoplamiento ajustado y transporte, realiza las tareas siguientes:</span><span class="sxs-lookup"><span data-stu-id="88aee-148">Performs the following tasks if all recipients are known to this tightly coupled store and transport:</span></span> 
    
     - <span data-ttu-id="88aee-149">Llama a [IMAPISupport::CompleteMsg](imapisupport-completemsg.md) si el mensaje se preprocesa o el proveedor de almacén de mensajes que desea a la cola MAPI para procesar el mensaje completo.</span><span class="sxs-lookup"><span data-stu-id="88aee-149">Calls [IMAPISupport::CompleteMsg](imapisupport-completemsg.md) if the message was preprocessed or the message store provider wants the MAPI spooler to complete message processing.</span></span> <span data-ttu-id="88aee-150">Flujo de mensajes continúa con la cola de MAPI.</span><span class="sxs-lookup"><span data-stu-id="88aee-150">Message flow continues with the MAPI spooler.</span></span> 
    
     - <span data-ttu-id="88aee-151">Si el mensaje no se preprocesa o el proveedor de almacén de mensajes no desea que la cola MAPI para llevar a cabo el procesamiento de mensajes, realiza las tareas siguientes:</span><span class="sxs-lookup"><span data-stu-id="88aee-151">Performs the following tasks if the message was not preprocessed or the message store provider does not want the MAPI spooler to complete message processing:</span></span>
    
       1. <span data-ttu-id="88aee-152">Copia el mensaje a la carpeta identificado por el identificador de entrada en la propiedad **PR_SENTMAIL_ENTRYID** ([PidTagSentMailEntryId](pidtagsentmailentryid-canonical-property.md)), si establece.</span><span class="sxs-lookup"><span data-stu-id="88aee-152">Copies the message to the folder identified by the entry identifier in the **PR_SENTMAIL_ENTRYID** ([PidTagSentMailEntryId](pidtagsentmailentryid-canonical-property.md)) property, if set.</span></span>
            
       2. <span data-ttu-id="88aee-153">Elimina el mensaje si la propiedad **PR_DELETE_AFTER_SUBMIT** ([PidTagDeleteAfterSubmit](pidtagdeleteaftersubmit-canonical-property.md)) se ha establecido en TRUE.</span><span class="sxs-lookup"><span data-stu-id="88aee-153">Deletes the message if the **PR_DELETE_AFTER_SUBMIT** ([PidTagDeleteAfterSubmit](pidtagdeleteaftersubmit-canonical-property.md)) property has been set to TRUE.</span></span>
            
       3. <span data-ttu-id="88aee-154">Desbloquea el mensaje si está bloqueada.</span><span class="sxs-lookup"><span data-stu-id="88aee-154">Unlocks the message if it is locked.</span></span>
            
       4. <span data-ttu-id="88aee-155">Devuelve al cliente.</span><span class="sxs-lookup"><span data-stu-id="88aee-155">Returns to the client.</span></span> <span data-ttu-id="88aee-156">Flujo de mensajes está completado.</span><span class="sxs-lookup"><span data-stu-id="88aee-156">Message flow is complete.</span></span>
    
  - <span data-ttu-id="88aee-157">Si el mensaje se preprocesa o el proveedor que desea la cola MAPI para llevar a cabo el procesamiento de mensajes, realiza las tareas siguientes:</span><span class="sxs-lookup"><span data-stu-id="88aee-157">Performs the following tasks if the message was preprocessed or the provider wants the MAPI spooler to complete message processing:</span></span>
    
    1. <span data-ttu-id="88aee-158">Llama a [IMAPISupport::CompleteMsg](imapisupport-completemsg.md).</span><span class="sxs-lookup"><span data-stu-id="88aee-158">Calls [IMAPISupport::CompleteMsg](imapisupport-completemsg.md).</span></span> 
          
    2. <span data-ttu-id="88aee-159">Sigue el flujo de mensajes con la cola de MAPI.</span><span class="sxs-lookup"><span data-stu-id="88aee-159">Continues message flow with the MAPI spooler.</span></span> <span data-ttu-id="88aee-160">Para obtener más información, vea [enviar mensajes: tareas de cola de impresión de MAPI](sending-messages-mapi-spooler-tasks.md).</span><span class="sxs-lookup"><span data-stu-id="88aee-160">For more information, see [Sending Messages: MAPI Spooler Tasks](sending-messages-mapi-spooler-tasks.md).</span></span>
    
  - <span data-ttu-id="88aee-161">Si el mensaje no se preprocesa o el proveedor no desea que la cola de impresión para llevar a cabo el procesamiento de mensajes, realiza las tareas siguientes:</span><span class="sxs-lookup"><span data-stu-id="88aee-161">Performs the following tasks if the message was not preprocessed or the provider does not want the spooler to complete message processing:</span></span>
    
    1. <span data-ttu-id="88aee-162">Copia el mensaje a la carpeta identificada por el identificador de entrada en la propiedad **PR_SENTMAIL_ENTRYID** , si establece.</span><span class="sxs-lookup"><span data-stu-id="88aee-162">Copies the message to the folder identified by the entry identifier in the **PR_SENTMAIL_ENTRYID** property, if set.</span></span> 
        
    2. <span data-ttu-id="88aee-163">Elimina el mensaje si la propiedad **PR_DELETE_AFTER_SUBMIT** se ha establecido en TRUE.</span><span class="sxs-lookup"><span data-stu-id="88aee-163">Deletes the message if the **PR_DELETE_AFTER_SUBMIT** property has been set to TRUE.</span></span> 
        
    3. <span data-ttu-id="88aee-164">Desbloquea el mensaje si está bloqueada.</span><span class="sxs-lookup"><span data-stu-id="88aee-164">Unlocks the message if it is locked.</span></span> 
        
    4. <span data-ttu-id="88aee-165">Devuelve al autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="88aee-165">Returns to the caller.</span></span> <span data-ttu-id="88aee-166">Flujo de mensajes está completado.</span><span class="sxs-lookup"><span data-stu-id="88aee-166">Message flow is complete.</span></span>
    
- <span data-ttu-id="88aee-167">Si el almac�n de mensajes no est� estrechamente asociado a un transporte, no todos los destinatarios eran conocidos para el almac�n de mensajes o se establece la marca NEEDS_SPOOLER, realiza las tareas siguientes:</span><span class="sxs-lookup"><span data-stu-id="88aee-167">Performs the following tasks if the message store is not tightly coupled to a transport, not all of the recipients were known to the message store, or the NEEDS_SPOOLER flag is set:</span></span>
    
  1. <span data-ttu-id="88aee-168">Coloca el mensaje en la cola de salida sin establecer el bit SUBMITFLAG_PREPROCESS en la propiedad **PR_SUBMIT_FLAGS**.</span><span class="sxs-lookup"><span data-stu-id="88aee-168">Puts the message in the outgoing queue without setting the SUBMITFLAG_PREPROCESS bit in the **PR_SUBMIT_FLAGS** property.</span></span> 
    
  2. <span data-ttu-id="88aee-169">Notifica a la cola MAPI que ha cambiado la cola de salida al generar una notificaci�n de la tabla.</span><span class="sxs-lookup"><span data-stu-id="88aee-169">Notifies the MAPI spooler that the outgoing queue has changed by generating a table notification.</span></span> 
    
  3. <span data-ttu-id="88aee-170">Devuelve al cliente y el flujo de mensajes contin�a con un conjunto de tareas que se realizan por la cola MAPI.</span><span class="sxs-lookup"><span data-stu-id="88aee-170">Returns to the client, and message flow continues with a set of tasks performed by the MAPI spooler.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="88aee-171">Vea también</span><span class="sxs-lookup"><span data-stu-id="88aee-171">See also</span></span>

- [<span data-ttu-id="88aee-172">Caracter�sticas de almac�n de mensajes</span><span class="sxs-lookup"><span data-stu-id="88aee-172">Message Store Features</span></span>](message-store-features.md)

