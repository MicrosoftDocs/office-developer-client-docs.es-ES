---
title: Rol de proveedor de transporte en el subsistema MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7659369a-0952-4f5a-a86b-91958c4c1a3f
description: '�ltima modificaci�n: s�bado, 23 de julio de 2011'
ms.openlocfilehash: 7ea60b73fb1abe32b6db5e3c73d6ef3fac53d35d
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19820885"
---
# <a name="transport-provider-role-in-the-mapi-subsystem"></a><span data-ttu-id="a1443-103">Rol de proveedor de transporte en el subsistema MAPI</span><span class="sxs-lookup"><span data-stu-id="a1443-103">Transport provider role in the MAPI subsystem</span></span>
  
<span data-ttu-id="a1443-104">**Se aplica a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="a1443-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="a1443-105">Bibliotecas de vínculos dinámicos del proveedor de transporte (DLL) proporcionan la interfaz entre la cola MAPI y la parte de un sistema de mensajería responsable de enviar y recibir mensajes.</span><span class="sxs-lookup"><span data-stu-id="a1443-105">Transport provider dynamic-link libraries (DLLs) provide the interface between the MAPI spooler and the part of a messaging system responsible for message sending and receiving.</span></span> <span data-ttu-id="a1443-106">La cola MAPI y el proveedor de transporte funcionan conjuntamente para controlar las responsabilidades de enviar un mensaje o recibir un mensaje.</span><span class="sxs-lookup"><span data-stu-id="a1443-106">The MAPI spooler and the transport provider work together to handle the responsibilities of sending a message or receiving a message.</span></span> <span data-ttu-id="a1443-107">La cola MAPI carga el archivo DLL del proveedor de transporte cuando se utiliza en primer lugar y lo libera cuando ya no sea necesaria.</span><span class="sxs-lookup"><span data-stu-id="a1443-107">The MAPI spooler loads the transport provider DLL when it is first used and releases it when it is no longer needed.</span></span> <span data-ttu-id="a1443-108">Se pueden instalar varios proveedores de transporte en el mismo sistema, pero MAPI proporciona la cola de uno impresión necesario.</span><span class="sxs-lookup"><span data-stu-id="a1443-108">Multiple transport providers can be installed on the same system, but MAPI supplies the one spooler required.</span></span>
  
<span data-ttu-id="a1443-109">Las aplicaciones cliente no suele comunicarse directamente con el proveedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="a1443-109">Client applications do not typically communicate directly with the transport provider.</span></span> <span data-ttu-id="a1443-110">En su lugar, los clientes de enviar mensajes a través de un proveedor de almacén de y la cola MAPI envía los mensajes salientes para el proveedor de transporte adecuados y entrega los mensajes entrantes en el almacén de mensaje adecuado.</span><span class="sxs-lookup"><span data-stu-id="a1443-110">Rather, clients submit messages through a store provider and the MAPI spooler sends outgoing messages to the appropriate transport provider and delivers incoming messages to the appropriate message store.</span></span> <span data-ttu-id="a1443-111">La cola MAPI realiza su trabajo y realiza sus llamadas a los proveedores de transporte cuando las aplicaciones de primer plano inactivo.</span><span class="sxs-lookup"><span data-stu-id="a1443-111">The MAPI spooler does its work and makes its calls to transport providers when foreground applications are idle.</span></span> <span data-ttu-id="a1443-112">Una vez, opcionalmente, mostrar cuadros de diálogo cuando el proveedor de transporte es el primero iniciado sesión, los proveedores de transporte operan en segundo plano a menos que llame por el cliente para enviar y recibir las colas de vaciado.</span><span class="sxs-lookup"><span data-stu-id="a1443-112">After optionally displaying dialog boxes when the transport provider is first logged on, transport providers operate in the background unless called by the client to flush send and receive queues.</span></span> 
  
<span data-ttu-id="a1443-113">Los proveedores de transporte tienen las siguientes responsabilidades en un sistema de mensajería MAPI:</span><span class="sxs-lookup"><span data-stu-id="a1443-113">Transport providers have the following responsibilities in a MAPI messaging system:</span></span>
  
- <span data-ttu-id="a1443-114">Registre los tipos de direcciones que pueden aceptar con la cola de MAPI para que la cola MAPI puede enviar mensajes al proveedor de transporte adecuados según la dirección de destino de los mensajes.</span><span class="sxs-lookup"><span data-stu-id="a1443-114">Register the address types they can accept with the MAPI spooler so the MAPI spooler can submit messages to the appropriate transport provider depending on the destination address of the messages.</span></span> <span data-ttu-id="a1443-115">Un proveedor de transporte puede registrar más de un tipo de dirección.</span><span class="sxs-lookup"><span data-stu-id="a1443-115">One transport provider can register more than one address type.</span></span> <span data-ttu-id="a1443-116">Los proveedores de transporte también pueden registrar las direcciones de destinatarios específicos con la cola de MAPI.</span><span class="sxs-lookup"><span data-stu-id="a1443-116">Transport providers can also register specific recipients' addresses with the MAPI spooler.</span></span> <span data-ttu-id="a1443-117">Los mensajes dirigidos a una de estas direcciones se enviará al proveedor de transporte que se ha registrado la dirección con la cola de MAPI.</span><span class="sxs-lookup"><span data-stu-id="a1443-117">Messages addressed to one of these addresses will be submitted to the transport provider that registered the address with the MAPI spooler.</span></span> <span data-ttu-id="a1443-118">Para obtener más información, vea [proveedor de transporte y el modelo operacional de cola de impresión de MAPI](transport-provider-and-mapi-spooler-operational-model.md).</span><span class="sxs-lookup"><span data-stu-id="a1443-118">For more information, see [Transport Provider and MAPI Spooler Operational Model](transport-provider-and-mapi-spooler-operational-model.md).</span></span>
    
- <span data-ttu-id="a1443-119">Entregar los mensajes entrantes a la cola de MAPI.</span><span class="sxs-lookup"><span data-stu-id="a1443-119">Deliver incoming messages to the MAPI spooler.</span></span> <span data-ttu-id="a1443-120">Dependiendo de la naturaleza del sistema de mensajería, un proveedor de transporte puede ya sea directamente notificar a la cola MAPI cuando llega un nuevo mensaje, o puede solicitar que la cola MAPI sondear al proveedor de transporte periódicamente para comprobar si hay mensajes nuevos.</span><span class="sxs-lookup"><span data-stu-id="a1443-120">Depending on the nature of the messaging system, a transport provider can either directly notify the MAPI spooler when a new message arrives, or it can request that the MAPI spooler poll the transport provider periodically to check for new messages.</span></span>
    
- <span data-ttu-id="a1443-121">Convertir las propiedades de mensaje MAPI a y desde las propiedades del mensaje nativas para el sistema de mensajería.</span><span class="sxs-lookup"><span data-stu-id="a1443-121">Convert MAPI message properties to and from message properties native to the messaging system.</span></span> <span data-ttu-id="a1443-122">Por ejemplo, es posible que el proveedor de transporte debe convertir las direcciones de la dirección del remitente y del destinatario de un mensaje saliente a un formulario que es aceptable para el sistema de mensajería.</span><span class="sxs-lookup"><span data-stu-id="a1443-122">For example, the transport provider might have to convert the sender's and recipient's addresses in an outgoing message to a form that is acceptable to the messaging system.</span></span> <span data-ttu-id="a1443-123">Algunos sistemas de mensajería no admiten todas las propiedades de mensaje MAPI.</span><span class="sxs-lookup"><span data-stu-id="a1443-123">Some messaging systems do not support all of the MAPI message properties.</span></span> <span data-ttu-id="a1443-124">Para obtener más información acerca de la conservación de las propiedades de mensaje MAPI para entregar mensajes a un sistema de mensajería, vea [desarrollar un proveedor de transporte TNEF-Enabled](developing-a-tnef-enabled-transport-provider.md).</span><span class="sxs-lookup"><span data-stu-id="a1443-124">For more information about preserving MAPI message properties when delivering messages to a messaging system, see [Developing a TNEF-Enabled Transport Provider](developing-a-tnef-enabled-transport-provider.md).</span></span>
    
- <span data-ttu-id="a1443-125">Registrar el mensaje y el destinatario opciones específicas del proveedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="a1443-125">Register message and recipient options specific to the transport provider.</span></span>
    
- <span data-ttu-id="a1443-126">Lleve a cabo cualquier comprobación de credenciales requeridos por el sistema de mensajería.</span><span class="sxs-lookup"><span data-stu-id="a1443-126">Perform any verification of credentials required by the messaging system.</span></span>
    
- <span data-ttu-id="a1443-127">Acceso a los mensajes salientes mediante el objeto message pasan por la cola de MAPI.</span><span class="sxs-lookup"><span data-stu-id="a1443-127">Access outbound messages using the message object passed to it by the MAPI spooler.</span></span>
    
- <span data-ttu-id="a1443-128">Convertir el formato de mensaje según sea necesario por el sistema de mensajería subyacente.</span><span class="sxs-lookup"><span data-stu-id="a1443-128">Translate message format as required by the underlying messaging system.</span></span>
    
- <span data-ttu-id="a1443-129">Notificar a los destinatarios de un mensaje saliente, el proveedor de transporte ha aceptado la responsabilidad de tratamiento estableciendo la propiedad **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) para los destinatarios de la cola de MAPI.</span><span class="sxs-lookup"><span data-stu-id="a1443-129">Notify the MAPI spooler which recipients of an outgoing message the transport provider has accepted responsibility for handling by setting the **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) property for those recipients.</span></span>
    
- <span data-ttu-id="a1443-130">Comunicar a la cola MAPI cuando es necesario manipular un mensaje entrante.</span><span class="sxs-lookup"><span data-stu-id="a1443-130">Inform the MAPI spooler when an incoming message needs to be handled.</span></span>
    
- <span data-ttu-id="a1443-131">Pasar datos del mensaje entrante a la cola MAPI mediante el uso de objetos de mensaje.</span><span class="sxs-lookup"><span data-stu-id="a1443-131">Pass incoming message data to the MAPI spooler by using message objects.</span></span>
    
- <span data-ttu-id="a1443-132">Asigne valores a todas las propiedades del mensaje MAPI necesarias en los mensajes entrantes.</span><span class="sxs-lookup"><span data-stu-id="a1443-132">Assign values to all required MAPI message properties on incoming messages.</span></span>
    
- <span data-ttu-id="a1443-133">Eliminar el mensaje del sistema de mensajería subyacente después de la entrega, si es necesario.</span><span class="sxs-lookup"><span data-stu-id="a1443-133">Delete the message from the underlying messaging system after delivery, if necessary.</span></span>
    
- <span data-ttu-id="a1443-134">Proporcionar información de estado para las aplicaciones de cliente y de la cola de impresión MAPI.</span><span class="sxs-lookup"><span data-stu-id="a1443-134">Provide status information for the MAPI spooler and client applications.</span></span>
    
<span data-ttu-id="a1443-135">La siguiente ilustración muestra la función del proveedor de transporte con respecto a los demás componentes de la arquitectura MAPI.</span><span class="sxs-lookup"><span data-stu-id="a1443-135">The following illustration shows a transport provider's role with respect to the other components of the MAPI architecture.</span></span>
  
<span data-ttu-id="a1443-136">**Rol de proveedor de transporte en un sistema de mensajería**</span><span class="sxs-lookup"><span data-stu-id="a1443-136">**Transport provider role in a messaging system**</span></span>
  
<span data-ttu-id="a1443-137">![Rol de proveedor de transporte en un sistema de mensajería] (media/xp01.gif "Rol de proveedor de transporte en un sistema de mensajería")</span><span class="sxs-lookup"><span data-stu-id="a1443-137">![Transport provider role in a messaging system](media/xp01.gif "Transport provider role in a messaging system")</span></span>
  

