---
title: Claves de búsqueda y registro MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: caa7b7f3-a5a1-4f07-98c9-22652ecd5d21
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: b1b4c0087cecd9164fc96ce7c5b5415f75dbfb03
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/23/2019
ms.locfileid: "32328137"
---
# <a name="mapi-record-and-search-keys"></a><span data-ttu-id="e0e22-103">Claves de búsqueda y registro MAPI</span><span class="sxs-lookup"><span data-stu-id="e0e22-103">MAPI Record and Search Keys</span></span>

  
  
<span data-ttu-id="e0e22-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="e0e22-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="e0e22-105">Las claves de registro y las claves de búsqueda son identificadores binarios que se asignan a muchos objetos MAPI.</span><span class="sxs-lookup"><span data-stu-id="e0e22-105">Record keys and search keys are binary identifiers that are assigned to many MAPI objects.</span></span> <span data-ttu-id="e0e22-106">A diferencia del identificador de entrada de un objeto, su registro o clave de búsqueda es directamente comparable y transmite.</span><span class="sxs-lookup"><span data-stu-id="e0e22-106">Unlike an object's entry identifier, its record or search key is directly comparable as well as transmittable.</span></span> 
  
## <a name="record-keys"></a><span data-ttu-id="e0e22-107">Claves de registro</span><span class="sxs-lookup"><span data-stu-id="e0e22-107">Record Keys</span></span>

<span data-ttu-id="e0e22-108">Una clave de registro se usa para comparar dos objetos.</span><span class="sxs-lookup"><span data-stu-id="e0e22-108">A record key is used to compare two objects.</span></span> <span data-ttu-id="e0e22-109">Los objetos del almacén de mensajes y la libreta de direcciones deben tener claves de registro, que se almacenan en su propiedad **PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="e0e22-109">Message store and address book objects must have record keys, which are stored in their **PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md)) property.</span></span> <span data-ttu-id="e0e22-110">Debido a que una clave de registro identifica un objeto y no sus datos, cada instancia de un objeto tiene una clave de registro única.</span><span class="sxs-lookup"><span data-stu-id="e0e22-110">Because a record key identifies an object and not its data, every instance of an object has a unique record key.</span></span> <span data-ttu-id="e0e22-111">El ámbito de una clave de registro para carpetas y mensajes es el almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e0e22-111">The scope of a record key for folders and messages is the message store.</span></span> <span data-ttu-id="e0e22-112">El ámbito de los contenedores de la libreta de direcciones, los usuarios de mensajería y las listas de distribución es el conjunto de contenedores de nivel superior proporcionados por MAPI para su uso en la libreta de direcciones integrada.</span><span class="sxs-lookup"><span data-stu-id="e0e22-112">The scope for address book containers, messaging users, and distribution lists is the set of top-level containers provided by MAPI for use in the integrated address book.</span></span>
  
<span data-ttu-id="e0e22-113">Las claves de registro se pueden duplicar en otro recurso.</span><span class="sxs-lookup"><span data-stu-id="e0e22-113">Record keys can be duplicated in another resource.</span></span> <span data-ttu-id="e0e22-114">Por ejemplo, diferentes mensajes en dos almacenes de mensajes diferentes pueden tener la misma clave de registro.</span><span class="sxs-lookup"><span data-stu-id="e0e22-114">For example, different messages in two different message stores can have the same record key.</span></span> <span data-ttu-id="e0e22-115">Esto es diferente de los identificadores de entrada a largo plazo; como los identificadores de entrada a largo plazo contienen una referencia al proveedor de servicios, tienen un ámbito más amplio.</span><span class="sxs-lookup"><span data-stu-id="e0e22-115">This is different from long-term entry identifiers; because long-term entry identifiers contain a reference to the service provider, they have a wider scope.</span></span> <span data-ttu-id="e0e22-116">La clave de registro de un almacén de mensajes es similar en el ámbito a un identificador de entrada a largo plazo; debe ser único en todos los proveedores de almacenamiento de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e0e22-116">A message store's record key is similar in scope to a long-term entry identifier; it should be unique across all message store providers.</span></span> <span data-ttu-id="e0e22-117">Para garantizar esta exclusividad, los proveedores de almacenamiento de mensajes normalmente establecen su clave de registro en un valor que es la combinación de su propiedad **PR_MDB_PROVIDER** ([PidTagStoreProvider](pidtagstoreprovider-canonical-property.md)) y un identificador que es único para el almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e0e22-117">To ensure this uniqueness, message store providers typically set their record key to a value that is the combination of their **PR_MDB_PROVIDER** ([PidTagStoreProvider](pidtagstoreprovider-canonical-property.md)) property and an identifier that is unique to the message store.</span></span>
  
## <a name="search-keys"></a><span data-ttu-id="e0e22-118">Teclas de búsqueda</span><span class="sxs-lookup"><span data-stu-id="e0e22-118">Search Keys</span></span>

<span data-ttu-id="e0e22-119">Se usa una clave de búsqueda para comparar los datos de dos objetos.</span><span class="sxs-lookup"><span data-stu-id="e0e22-119">A search key is used to compare the data in two objects.</span></span> <span data-ttu-id="e0e22-120">La clave de búsqueda de un objeto se almacena en su propiedad **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="e0e22-120">An object's search key is stored in its **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) property.</span></span> <span data-ttu-id="e0e22-121">Dado que una clave de búsqueda representa los datos de un objeto y no el propio objeto, dos objetos distintos con los mismos datos pueden tener la misma clave de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="e0e22-121">Because a search key represents an object's data and not the object itself, two different objects with the same data can have the same search key.</span></span> <span data-ttu-id="e0e22-122">Cuando se copia un objeto, por ejemplo, tanto el objeto original como su copia tienen los mismos datos y la misma clave de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="e0e22-122">When an object is copied, for example, both the original object and its copy have the same data and the same search key.</span></span>
  
<span data-ttu-id="e0e22-123">Los usuarios de mensajes y mensajería tienen claves de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="e0e22-123">Messages and messaging users have search keys.</span></span> <span data-ttu-id="e0e22-124">La clave de búsqueda de un mensaje es un identificador único de los datos del mensaje.</span><span class="sxs-lookup"><span data-stu-id="e0e22-124">The search key of a message is a unique identifier of the message's data.</span></span> <span data-ttu-id="e0e22-125">Los proveedores de almacenamiento de mensajes suministran la propiedad **PR_SEARCH_KEY** de un mensaje en el momento de crear el mensaje.</span><span class="sxs-lookup"><span data-stu-id="e0e22-125">Message store providers furnish a message's **PR_SEARCH_KEY** property at message creation time.</span></span> <span data-ttu-id="e0e22-126">La clave de búsqueda de una entrada de la libreta de direcciones se calcula a partir de su tipo de dirección (**PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))) y dirección (**PR_EMAIL_ADDRESS** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md))).</span><span class="sxs-lookup"><span data-stu-id="e0e22-126">The search key of an address book entry is computed from its address type (**PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))) and address (**PR_EMAIL_ADDRESS** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md))).</span></span> <span data-ttu-id="e0e22-127">Si la entrada de la libreta de direcciones es grabable, es posible que su clave de búsqueda no esté disponible hasta que se establezca el tipo de dirección y la dirección mediante el método [IMAPIProp:: SetProps](imapiprop-setprops.md) y se haya guardado la entrada con el método [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) .</span><span class="sxs-lookup"><span data-stu-id="e0e22-127">If the address book entry is writeable, its search key might not be available until the address type and address have been set by using the [IMAPIProp::SetProps](imapiprop-setprops.md) method and the entry has been saved by using the [IMAPIProp::SaveChanges](imapiprop-savechanges.md) method.</span></span> <span data-ttu-id="e0e22-128">Cuando estas propiedades de dirección cambian, es posible que la clave de búsqueda correspondiente no se sincronice con los nuevos valores hasta que los cambios se hayan confirmado con una llamada de **SaveChanges** .</span><span class="sxs-lookup"><span data-stu-id="e0e22-128">When these address properties change, it is possible for the corresponding search key not to be synchronized with the new values until the changes have been committed with a **SaveChanges** call.</span></span> 
  
<span data-ttu-id="e0e22-129">El valor de la clave de registro de un objeto puede ser el mismo o diferente que el valor de la clave de búsqueda, según el proveedor de servicios.</span><span class="sxs-lookup"><span data-stu-id="e0e22-129">The value of an object's record key can be the same as or different than the value of its search key, depending on the service provider.</span></span> <span data-ttu-id="e0e22-130">Algunos proveedores de servicios usan el mismo valor para la clave de búsqueda, la clave de registro y el identificador de entrada de un objeto.</span><span class="sxs-lookup"><span data-stu-id="e0e22-130">Some service providers use the same value for an object's search key, record key, and entry identifier.</span></span> <span data-ttu-id="e0e22-131">Otros proveedores de servicios asignan valores únicos para cada uno de los identificadores de los objetos.</span><span class="sxs-lookup"><span data-stu-id="e0e22-131">Other service providers assign unique values for each of its objects' identifiers.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="e0e22-132">Vea también</span><span class="sxs-lookup"><span data-stu-id="e0e22-132">See also</span></span>



[<span data-ttu-id="e0e22-133">Desarrollo de aplicaciones de MAPI</span><span class="sxs-lookup"><span data-stu-id="e0e22-133">MAPI Application Development</span></span>](mapi-application-development.md)

