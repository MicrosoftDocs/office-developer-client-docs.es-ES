---
title: Registro MAPI y las claves de búsqueda
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: caa7b7f3-a5a1-4f07-98c9-22652ecd5d21
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: 4aa641ad0a41ff8015d2ece717d5a4cb3a7c4edf
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/23/2018
ms.locfileid: "22587316"
---
# <a name="mapi-record-and-search-keys"></a><span data-ttu-id="bb2e3-103">Registro MAPI y las claves de búsqueda</span><span class="sxs-lookup"><span data-stu-id="bb2e3-103">MAPI Record and Search Keys</span></span>

  
  
<span data-ttu-id="bb2e3-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="bb2e3-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="bb2e3-105">Claves de registro y las claves de búsqueda son identificadores binarios que se asignan a muchos objetos MAPI.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-105">Record keys and search keys are binary identifiers that are assigned to many MAPI objects.</span></span> <span data-ttu-id="bb2e3-106">A diferencia de identificador de entrada de un objeto, su clave de registro o búsqueda es directamente comparable, así como transmisible.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-106">Unlike an object's entry identifier, its record or search key is directly comparable as well as transmittable.</span></span> 
  
## <a name="record-keys"></a><span data-ttu-id="bb2e3-107">Claves de registro</span><span class="sxs-lookup"><span data-stu-id="bb2e3-107">Record Keys</span></span>

<span data-ttu-id="bb2e3-108">Una clave de registro se usa para comparar dos objetos.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-108">A record key is used to compare two objects.</span></span> <span data-ttu-id="bb2e3-109">Almacén de mensajes y dirección de objetos book deben tener las claves de registro, que se almacenan en su propiedad **PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="bb2e3-109">Message store and address book objects must have record keys, which are stored in their **PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md)) property.</span></span> <span data-ttu-id="bb2e3-110">Debido a que una clave de registro identifica un objeto y no sus datos, cada instancia de un objeto tiene una clave de registro único.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-110">Because a record key identifies an object and not its data, every instance of an object has a unique record key.</span></span> <span data-ttu-id="bb2e3-111">El ámbito de una clave de registro para las carpetas y los mensajes es el almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-111">The scope of a record key for folders and messages is the message store.</span></span> <span data-ttu-id="bb2e3-112">El ámbito de los contenedores de la libreta de direcciones, los usuarios de mensajería y listas de distribución es el conjunto de contenedores de nivel superior proporcionado por MAPI para su uso en la libreta de direcciones integrada.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-112">The scope for address book containers, messaging users, and distribution lists is the set of top-level containers provided by MAPI for use in the integrated address book.</span></span>
  
<span data-ttu-id="bb2e3-113">Claves de registro se pueden duplicar en otro recurso.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-113">Record keys can be duplicated in another resource.</span></span> <span data-ttu-id="bb2e3-114">Por ejemplo, distintos de los mensajes en dos almacenes de mensaje distinto pueden tener la misma clave de registro.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-114">For example, different messages in two different message stores can have the same record key.</span></span> <span data-ttu-id="bb2e3-115">Esto es diferente de los identificadores de entrada a largo plazo; debido a que los identificadores de entrada a largo plazo contienen una referencia al proveedor de servicios, que tienen un ámbito más amplio.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-115">This is different from long-term entry identifiers; because long-term entry identifiers contain a reference to the service provider, they have a wider scope.</span></span> <span data-ttu-id="bb2e3-116">Clave de registro de un almacén de mensajes es similar en el ámbito a un identificador de entrada a largo plazo; debe ser único entre todos los proveedores de almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-116">A message store's record key is similar in scope to a long-term entry identifier; it should be unique across all message store providers.</span></span> <span data-ttu-id="bb2e3-117">Para garantizar esta exclusividad, los proveedores de almacén de mensajes normalmente establecen su clave de registro en un valor que es la combinación de su propiedad **PR_MDB_PROVIDER** ([PidTagStoreProvider](pidtagstoreprovider-canonical-property.md)) y un identificador único para el almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-117">To ensure this uniqueness, message store providers typically set their record key to a value that is the combination of their **PR_MDB_PROVIDER** ([PidTagStoreProvider](pidtagstoreprovider-canonical-property.md)) property and an identifier that is unique to the message store.</span></span>
  
## <a name="search-keys"></a><span data-ttu-id="bb2e3-118">Claves de búsqueda</span><span class="sxs-lookup"><span data-stu-id="bb2e3-118">Search Keys</span></span>

<span data-ttu-id="bb2e3-119">Una clave de búsqueda se usa para comparar los datos en dos objetos.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-119">A search key is used to compare the data in two objects.</span></span> <span data-ttu-id="bb2e3-120">Clave de búsqueda de un objeto se almacena en su propiedad **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="bb2e3-120">An object's search key is stored in its **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) property.</span></span> <span data-ttu-id="bb2e3-121">Debido a que una clave de búsqueda representa los datos de un objeto y no el propio objeto, dos objetos diferentes con los mismos datos pueden tener la misma clave de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-121">Because a search key represents an object's data and not the object itself, two different objects with the same data can have the same search key.</span></span> <span data-ttu-id="bb2e3-122">Cuando se copia un objeto, por ejemplo, el objeto original y su copia tienen los mismos datos y la misma clave de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-122">When an object is copied, for example, both the original object and its copy have the same data and the same search key.</span></span>
  
<span data-ttu-id="bb2e3-123">Los mensajes y los usuarios de mensajería tienen claves de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-123">Messages and messaging users have search keys.</span></span> <span data-ttu-id="bb2e3-124">La clave de búsqueda de un mensaje es un identificador único de los datos del mensaje.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-124">The search key of a message is a unique identifier of the message's data.</span></span> <span data-ttu-id="bb2e3-125">Los proveedores de almacén de mensajes presentar la propiedad **PR_SEARCH_KEY** de un mensaje a la hora de creación del mensaje.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-125">Message store providers furnish a message's **PR_SEARCH_KEY** property at message creation time.</span></span> <span data-ttu-id="bb2e3-126">La clave de búsqueda de una entrada de la libreta de direcciones se calcula a partir de su tipo de dirección (**PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))) y dirección (**PR_EMAIL_ADDRESS** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md))).</span><span class="sxs-lookup"><span data-stu-id="bb2e3-126">The search key of an address book entry is computed from its address type (**PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))) and address (**PR_EMAIL_ADDRESS** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md))).</span></span> <span data-ttu-id="bb2e3-127">Si la entrada de la libreta de direcciones es grabable, su clave de búsqueda puede no estar disponible hasta que se han establecido mediante el método [IMAPIProp::SetProps](imapiprop-setprops.md) el tipo de dirección y la dirección y la entrada se ha guardado mediante el método [IMAPIProp::SaveChanges](imapiprop-savechanges.md) .</span><span class="sxs-lookup"><span data-stu-id="bb2e3-127">If the address book entry is writeable, its search key might not be available until the address type and address have been set by using the [IMAPIProp::SetProps](imapiprop-setprops.md) method and the entry has been saved by using the [IMAPIProp::SaveChanges](imapiprop-savechanges.md) method.</span></span> <span data-ttu-id="bb2e3-128">Al cambian estas propiedades de dirección, es posible que la clave de búsqueda correspondiente no que se sincronizará con los nuevos valores hasta que los cambios se han confirmado con una llamada de **SaveChanges** .</span><span class="sxs-lookup"><span data-stu-id="bb2e3-128">When these address properties change, it is possible for the corresponding search key not to be synchronized with the new values until the changes have been committed with a **SaveChanges** call.</span></span> 
  
<span data-ttu-id="bb2e3-129">El valor de la clave de registro de un objeto puede ser igual o diferente que el valor de su clave de búsqueda, según el proveedor de servicio.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-129">The value of an object's record key can be the same as or different than the value of its search key, depending on the service provider.</span></span> <span data-ttu-id="bb2e3-130">Algunos proveedores de servicios de usan el mismo valor de clave de búsqueda de un objeto, la clave de registro y el identificador de entrada.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-130">Some service providers use the same value for an object's search key, record key, and entry identifier.</span></span> <span data-ttu-id="bb2e3-131">Otros proveedores de servicios de asignan valores únicos para cada uno de los identificadores de sus objetos.</span><span class="sxs-lookup"><span data-stu-id="bb2e3-131">Other service providers assign unique values for each of its objects' identifiers.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="bb2e3-132">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="bb2e3-132">See also</span></span>



[<span data-ttu-id="bb2e3-133">Desarrollo de aplicaciones de MAPI</span><span class="sxs-lookup"><span data-stu-id="bb2e3-133">MAPI Application Development</span></span>](mapi-application-development.md)

