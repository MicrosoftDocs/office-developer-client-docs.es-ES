---
title: Información general del objeto de soporte técnico
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 5b062891-39ab-4334-9706-5b376719d5e4
description: 'Última modificación: 23 de julio de 2011'
ms.openlocfilehash: ecc5439b4abbbfd920fba5456db7462f7967388f
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19820776"
---
# <a name="support-object-overview"></a><span data-ttu-id="2da9a-103">Información general del objeto de soporte técnico</span><span class="sxs-lookup"><span data-stu-id="2da9a-103">Support Object Overview</span></span>

  
  
<span data-ttu-id="2da9a-104">**Hace referencia a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="2da9a-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="2da9a-105">MAPI proporciona un objeto de soporte técnico, un objeto que implementa el [IMAPISupport: IUnknown](imapisupportiunknown.md) interfaz, para todos los proveedores de servicio durante el inicio de sesión y para todos los servicios de mensaje durante la configuración.</span><span class="sxs-lookup"><span data-stu-id="2da9a-105">MAPI furnishes a support object, an object that implements the [IMAPISupport : IUnknown](imapisupportiunknown.md) interface, for all service providers during logon and for all message services during configuration.</span></span> 
  
<span data-ttu-id="2da9a-106">Compatibilidad con objetos no son accesibles para los clientes; se implementan mediante MAPI y llamados sólo por los proveedores de servicios.</span><span class="sxs-lookup"><span data-stu-id="2da9a-106">Support objects are not accessible by clients; they are implemented by MAPI and called only by service providers.</span></span> <span data-ttu-id="2da9a-107">La interfaz **IMAPISupport** se especifica en el archivo de encabezado Mapispi.h.</span><span class="sxs-lookup"><span data-stu-id="2da9a-107">The **IMAPISupport** interface is specified in the Mapispi.h header file.</span></span> <span data-ttu-id="2da9a-108">Su identificador es IID_IMAPISup y su tipo de puntero es LPMAPISUP.</span><span class="sxs-lookup"><span data-stu-id="2da9a-108">Its identifier is IID_IMAPISup and its pointer type is LPMAPISUP.</span></span> <span data-ttu-id="2da9a-109">Se exponen propiedades MAPI por compatibilidad con objetos.</span><span class="sxs-lookup"><span data-stu-id="2da9a-109">No MAPI properties are exposed by support objects.</span></span> 
  
<span data-ttu-id="2da9a-110">Un proveedor puede tener uno o más objetos de soporte técnico, según el número de veces que el proveedor de los registros de MAPI en o el número de veces que se denomina función de entrada de servicio de mensajes del proveedor.</span><span class="sxs-lookup"><span data-stu-id="2da9a-110">A provider can be given one or more support objects, depending on the number of times MAPI logs the provider on or the number of times the provider's message service entry function is called.</span></span> <span data-ttu-id="2da9a-111">Normalmente, un proveedor se registrarán al menos una vez por sesión.</span><span class="sxs-lookup"><span data-stu-id="2da9a-111">Typically, a provider will be logged on at least once per session.</span></span> <span data-ttu-id="2da9a-112">Los proveedores de transporte y de la libreta de direcciones se registran cada vez que un cliente inicia una sesión con una entrada de perfil que solicita de ellos.</span><span class="sxs-lookup"><span data-stu-id="2da9a-112">Address book and transport providers are logged on every time a client starts a session with a profile entry that requests them.</span></span> <span data-ttu-id="2da9a-113">Los proveedores de almacén de mensajes se registran cada vez que un cliente llama al método [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md) .</span><span class="sxs-lookup"><span data-stu-id="2da9a-113">Message store providers are logged on every time a client calls the [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md) method.</span></span> 
  
<span data-ttu-id="2da9a-114">En el caso de múltiples inicios de sesión en una sesión, puede elegir a conservar y utilizar cada objeto de soporte técnico por separado o a conservar y utilizar sólo la primera, descartar cada objeto de soporte técnico posteriores.</span><span class="sxs-lookup"><span data-stu-id="2da9a-114">In the case of multiple logons in a session, you can choose either to retain and use each support object separately or to retain and use only the first, discarding each subsequent support object.</span></span> <span data-ttu-id="2da9a-115">Para conservar un objeto de soporte técnico, llame al método **IUnknown:: AddRef** .</span><span class="sxs-lookup"><span data-stu-id="2da9a-115">To retain a support object, call its **IUnknown::AddRef** method.</span></span> <span data-ttu-id="2da9a-116">Una llamada a **AddRef** en un objeto de soporte técnico que desea conservar a lo largo de una sesión es extremadamente importante; Si no se realiza la llamada, MAPI libera el objeto de soporte técnico y libera su memoria.</span><span class="sxs-lookup"><span data-stu-id="2da9a-116">Calling **AddRef** on a support object that you want to retain throughout a session is extremely important; if the call is not made, MAPI releases the support object and frees its memory.</span></span> 
  
<span data-ttu-id="2da9a-117">El propósito del objeto de soporte consiste en proporcionar implementaciones para un número bastante grande de métodos utilizadas frecuentemente por los proveedores.</span><span class="sxs-lookup"><span data-stu-id="2da9a-117">The purpose of the support object is to provide implementations for a fairly large number of methods commonly used by the providers.</span></span> <span data-ttu-id="2da9a-118">Cada objeto de soporte técnico también contiene datos contextuales específicos de su propia instancia, como la sesión que se está ejecutando el proveedor en la sección de perfil que se está usando el proveedor y la información de error de la sesión.</span><span class="sxs-lookup"><span data-stu-id="2da9a-118">Each support object also contains contextual data specific to its own instance, such as the session the provider is running in, the profile section the provider is using, and error information for the session.</span></span> 
  
<span data-ttu-id="2da9a-119">Hay cuatro tipos diferentes de objetos de soporte técnico: uno para cada tipo de proveedor principales (la libreta de direcciones, almacén de mensajes y transporte) y otro para la compatibilidad con la configuración.</span><span class="sxs-lookup"><span data-stu-id="2da9a-119">There are four different types of support objects: one for each major provider type (address book, message store, and transport) and one for configuration support.</span></span> 
  
<span data-ttu-id="2da9a-120">MAPI personaliza cada objeto de soporte técnico mediante la inclusión de las implementaciones de métodos que son relevantes para su uso.</span><span class="sxs-lookup"><span data-stu-id="2da9a-120">MAPI customizes each support object by including implementations of methods that are relevant for its usage.</span></span> <span data-ttu-id="2da9a-121">Las implementaciones de algunos métodos, como [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md), se incluyen en todos los objetos de soporte técnico.</span><span class="sxs-lookup"><span data-stu-id="2da9a-121">Implementations of some methods, such as [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md), are included in all support objects.</span></span> <span data-ttu-id="2da9a-122">Las implementaciones de otros métodos, como [SpoolerNotify](imapisupport-spoolernotify.md), se aplican únicamente a objetos de asistencia determinado.</span><span class="sxs-lookup"><span data-stu-id="2da9a-122">Implementations of other methods, such as [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md), apply only to particular support objects.</span></span> <span data-ttu-id="2da9a-123">Almacén de mensajes sólo y los proveedores de transporte pueden usar este método; Cuando un proveedor de la libreta de direcciones o un servicio de mensajes intenta llamar a él, MAPI devuelve MAPI_E_NO_SUPPORT.</span><span class="sxs-lookup"><span data-stu-id="2da9a-123">Only message store and transport providers can use this method; when an address book provider or a message service try to call it, MAPI returns MAPI_E_NO_SUPPORT.</span></span>
  
<span data-ttu-id="2da9a-124">Compatibilidad con objetos se pueden usar para realizar muchas tareas, como las siguientes:</span><span class="sxs-lookup"><span data-stu-id="2da9a-124">Support objects can be used to accomplish many tasks, such as the following:</span></span>
  
- <span data-ttu-id="2da9a-125">Obtener acceso a una sección de perfil.</span><span class="sxs-lookup"><span data-stu-id="2da9a-125">Accessing a profile section.</span></span>
    
- <span data-ttu-id="2da9a-126">Copiar carpetas o mensajes.</span><span class="sxs-lookup"><span data-stu-id="2da9a-126">Copying folders or messages.</span></span> <span data-ttu-id="2da9a-127">Para obtener más información, vea [Copiar o mover un mensaje o una carpeta](copying-or-moving-a-message-or-a-folder.md).</span><span class="sxs-lookup"><span data-stu-id="2da9a-127">For more information, see [Copying or Moving a Message or a Folder](copying-or-moving-a-message-or-a-folder.md).</span></span>
    
- <span data-ttu-id="2da9a-128">Obtener acceso a los objetos que pertenecen a otros proveedores.</span><span class="sxs-lookup"><span data-stu-id="2da9a-128">Accessing objects that belong to other providers.</span></span> <span data-ttu-id="2da9a-129">Para obtener más información, vea [compatibilidad con el acceso a objetos y comparación](supporting-object-access-and-comparison.md).</span><span class="sxs-lookup"><span data-stu-id="2da9a-129">For more information, see [Supporting Object Access and Comparison](supporting-object-access-and-comparison.md).</span></span> 
    
- <span data-ttu-id="2da9a-130">Controlar la notificación de evento.</span><span class="sxs-lookup"><span data-stu-id="2da9a-130">Handling event notification.</span></span> <span data-ttu-id="2da9a-131">Para obtener más información, vea [Compatibilidad con notificación de evento](supporting-event-notification.md).</span><span class="sxs-lookup"><span data-stu-id="2da9a-131">For more information, see [Supporting Event Notification](supporting-event-notification.md).</span></span>
    
- <span data-ttu-id="2da9a-132">Asignar y liberar memoria.</span><span class="sxs-lookup"><span data-stu-id="2da9a-132">Allocating and freeing memory.</span></span>
    
- <span data-ttu-id="2da9a-133">Obtención de un identificador único.</span><span class="sxs-lookup"><span data-stu-id="2da9a-133">Obtaining a unique identifier.</span></span>
    
- <span data-ttu-id="2da9a-134">La invalidación de objetos.</span><span class="sxs-lookup"><span data-stu-id="2da9a-134">Invalidating objects.</span></span>
    
- <span data-ttu-id="2da9a-135">Tratamiento de errores.</span><span class="sxs-lookup"><span data-stu-id="2da9a-135">Handling errors.</span></span>
    
- <span data-ttu-id="2da9a-136">Registrar preprocessors de mensaje.</span><span class="sxs-lookup"><span data-stu-id="2da9a-136">Registering message preprocessors.</span></span> 
    
- <span data-ttu-id="2da9a-137">Preparación de los informes de entrega de mensajes.</span><span class="sxs-lookup"><span data-stu-id="2da9a-137">Preparing message delivery reports.</span></span> 
    
<span data-ttu-id="2da9a-138">En tiempo de inicio de sesión, MAPI llama al método de inicio de sesión del objeto de proveedor de cada proveedor de servicios.</span><span class="sxs-lookup"><span data-stu-id="2da9a-138">At logon time, MAPI calls the logon method of each service provider's provider object.</span></span> <span data-ttu-id="2da9a-139">Para los proveedores de la libreta de direcciones, MAPI llama a [IABProvider::Logon](iabprovider-logon.md).</span><span class="sxs-lookup"><span data-stu-id="2da9a-139">For address book providers, MAPI calls [IABProvider::Logon](iabprovider-logon.md).</span></span> <span data-ttu-id="2da9a-140">Para los proveedores de almacén de mensajes, MAPI llama a [IMSProvider::Logon](imsprovider-logon.md).</span><span class="sxs-lookup"><span data-stu-id="2da9a-140">For message store providers, MAPI calls [IMSProvider::Logon](imsprovider-logon.md).</span></span> <span data-ttu-id="2da9a-141">Para los proveedores de transporte, MAPI llama a [IXPProvider::TransportLogon](ixpprovider-transportlogon.md).</span><span class="sxs-lookup"><span data-stu-id="2da9a-141">For transport providers, MAPI calls [IXPProvider::TransportLogon](ixpprovider-transportlogon.md).</span></span> <span data-ttu-id="2da9a-142">MAPI pasa un puntero al objeto de soporte adecuado en uno de los parámetros a este método.</span><span class="sxs-lookup"><span data-stu-id="2da9a-142">MAPI passes a pointer to the appropriate support object in one of the parameters to this method.</span></span> <span data-ttu-id="2da9a-143">El método de inicio de sesión a su vez crea una instancia de un objeto de inicio de sesión, pasando el puntero del objeto de soporte técnico.</span><span class="sxs-lookup"><span data-stu-id="2da9a-143">The logon method in turn instantiates a logon object, passing it the support object pointer.</span></span> <span data-ttu-id="2da9a-144">El objeto de inicio de sesión llama al método **IUnknown:: AddRef** del objeto de soporte técnico para conservar, si es necesario.</span><span class="sxs-lookup"><span data-stu-id="2da9a-144">The logon object calls the support object's **IUnknown::AddRef** method to retain it, if necessary.</span></span> <span data-ttu-id="2da9a-145">Para obtener más información acerca del proceso de inicio de sesión para proveedores de servicios, vea [iniciar un proveedor de servicios](starting-a-service-provider.md).</span><span class="sxs-lookup"><span data-stu-id="2da9a-145">For more information about the logon process for service providers, see [Starting a Service Provider](starting-a-service-provider.md).</span></span>
  
<span data-ttu-id="2da9a-146">Cuando un cliente cierra la sesión, llamadas a método de cierre de sesión del objeto de inicio de sesión MAPI.</span><span class="sxs-lookup"><span data-stu-id="2da9a-146">When a client logs off, MAPI calls the logon object's logoff method.</span></span> <span data-ttu-id="2da9a-147">El método de cierre de sesión llama a **IUnknown:: Release** (método) del objeto de soporte técnico para indicar que el proveedor ya no tiene intención de llamar a cualquiera de los métodos de soporte técnico.</span><span class="sxs-lookup"><span data-stu-id="2da9a-147">The logoff method calls the support object's **IUnknown::Release** method to indicate that the provider no longer intends to call any of the support methods.</span></span> <span data-ttu-id="2da9a-148">Al igual que con inicio de sesión, los métodos de cierre de sesión tienen nombres ligeramente diferentes.</span><span class="sxs-lookup"><span data-stu-id="2da9a-148">As with logon, the logoff methods have slightly different names.</span></span> <span data-ttu-id="2da9a-149">Las interfaces [IABLogon](iablogoniunknown.md) y [IMSLogon](imslogoniunknown.md) tienen métodos de **cierre de sesión** ; la interfaz [IXPLogon](ixplogoniunknown.md) tiene un método [TransportLogoff](ixplogon-transportlogoff.md) .</span><span class="sxs-lookup"><span data-stu-id="2da9a-149">The [IABLogon](iablogoniunknown.md) and [IMSLogon](imslogoniunknown.md) interfaces have **Logoff** methods; the [IXPLogon](ixplogoniunknown.md) interface has a [TransportLogoff](ixplogon-transportlogoff.md) method.</span></span> 
  
<span data-ttu-id="2da9a-150">Funciones de punto de entrada de servicio de mensajes se llama cuando se produce un error en un intento de inicio de sesión con el error MAPI_E_UNCONFIGURED o cuando un cliente inicia una solicitud de configuración.</span><span class="sxs-lookup"><span data-stu-id="2da9a-150">Message service entry point functions are called when a logon attempt fails with the error MAPI_E_UNCONFIGURED or when a client initiates a configuration request.</span></span> <span data-ttu-id="2da9a-151">MAPI crea una instancia de un objeto de configuración de soporte técnico y llama a la función de punto de entrada de servicio de mensaje para el proveedor no configurado o el proveedor de cuya configuración va a cambiar.</span><span class="sxs-lookup"><span data-stu-id="2da9a-151">MAPI instantiates a configuration support object and calls the message service entry point function for either the unconfigured provider or the provider whose configuration is about to change.</span></span> <span data-ttu-id="2da9a-152">A diferencia de los objetos de soporte técnico, objetos de configuración de soporte técnico son válidos sólo hasta que el punto de entrada función devuelve; Servicios de mensajes no llamar a métodos de estos objetos **AddRef** para mantenerlas.</span><span class="sxs-lookup"><span data-stu-id="2da9a-152">Unlike the other support objects, configuration support objects are valid only until the entry point function returns; message services do not call these objects' **AddRef** methods to retain them.</span></span> 
  
<span data-ttu-id="2da9a-153">Normalmente, MAPI realiza llamadas a la función de punto de entrada de servicio de un proveedor mensaje, pero a veces se solicita un proveedor para realizar la llamada.</span><span class="sxs-lookup"><span data-stu-id="2da9a-153">Typically, MAPI makes calls to a provider's message service entry point function, but sometimes a provider is asked to make the call.</span></span> <span data-ttu-id="2da9a-154">Esto puede ocurrir cuando un cliente llama el método [SettingsDialog](imapistatus-settingsdialog.md) de un proveedor para solicitar el proveedor para mostrar su hoja de propiedades de configuración.</span><span class="sxs-lookup"><span data-stu-id="2da9a-154">This can occur when a client calls a provider's [IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md) method to prompt the provider to display its configuration property sheet.</span></span> <span data-ttu-id="2da9a-155">**Diálogo Configuración** debe llamar a [IMAPISupport::GetSvcConfigSupportObj](imapisupport-getsvcconfigsupportobj.md) para obtener un objeto de soporte técnico de configuración que pueden pasar a la función de punto de entrada de servicio de mensaje.</span><span class="sxs-lookup"><span data-stu-id="2da9a-155">**SettingsDialog** should call [IMAPISupport::GetSvcConfigSupportObj](imapisupport-getsvcconfigsupportobj.md) to obtain a configuration support object that it can pass to the message service entry point function.</span></span> 
  
<span data-ttu-id="2da9a-156">El método [IMAPISupport::GetMemAllocRoutines](imapisupport-getmemallocroutines.md) está disponible para determinar las direcciones de las funciones de asignación y cancelación de asignación de memoria sin tener que volver a vincular con MAPI.</span><span class="sxs-lookup"><span data-stu-id="2da9a-156">The [IMAPISupport::GetMemAllocRoutines](imapisupport-getmemallocroutines.md) method is available for determining the addresses of the memory allocation and deallocation functions without having to link with MAPI.</span></span> <span data-ttu-id="2da9a-157">Uso **GetMemAllocRoutines** también hace que sea más fácil para el seguimiento de pérdidas de memoria rodeando las llamadas de función de asignación con código de depuración.</span><span class="sxs-lookup"><span data-stu-id="2da9a-157">Using **GetMemAllocRoutines** also makes it easier to trace memory leaks by surrounding the allocation function calls with debugging code.</span></span> <span data-ttu-id="2da9a-158">Si se llama **GetMemAllocRoutines**, tal y como se recomienda, debe hacerlo antes de llamar a la función [CreateIProp](createiprop.md) , que requiere que las direcciones de la función de asignación como parámetros.</span><span class="sxs-lookup"><span data-stu-id="2da9a-158">If you call **GetMemAllocRoutines**, as is recommended, do so before calling the [CreateIProp](createiprop.md) function, which requires the allocation function addresses as parameters.</span></span> 
  
<span data-ttu-id="2da9a-159">Cuando se necesita para crear una nueva libreta de direcciones o un mensaje almacena el objeto, crear y establecer una clave de búsqueda para el objeto en su propiedad **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="2da9a-159">When you need to create a new address book or message store object, create and set a search key for the object in its **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) property.</span></span> <span data-ttu-id="2da9a-160">Llame a [IMAPISupport::NewUID](imapisupport-newuid.md) para obtener un identificador único para usar en la creación de una clave de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="2da9a-160">Call [IMAPISupport::NewUID](imapisupport-newuid.md) to obtain a unique identifier to use in building a search key.</span></span> <span data-ttu-id="2da9a-161">No use su propio codificado de forma rígida [MAPIUID](mapiuid.md).</span><span class="sxs-lookup"><span data-stu-id="2da9a-161">Do not use your own hard-coded [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="2da9a-162">Un proveedor **MAPIUID** se debe usar solo para los identificadores de entrada.</span><span class="sxs-lookup"><span data-stu-id="2da9a-162">A provider's **MAPIUID** should be used only for entry identifiers.</span></span> <span data-ttu-id="2da9a-163">Para obtener más información acerca de la creación de las claves de búsqueda, vea el [registro de MAPI y las claves de búsqueda](mapi-record-and-search-keys.md).</span><span class="sxs-lookup"><span data-stu-id="2da9a-163">For more information about constructing search keys, see [MAPI Record and Search Keys](mapi-record-and-search-keys.md).</span></span>
  
<span data-ttu-id="2da9a-164">A veces, una aplicación cliente puede liberar un objeto sin liberar uno o varios de sus objetos afiliados.</span><span class="sxs-lookup"><span data-stu-id="2da9a-164">A client application can sometimes release an object without releasing one or more of its affiliated objects.</span></span> <span data-ttu-id="2da9a-165">En tal caso, un proveedor puede requerir representar un objeto no publicado no se puede utilizar.</span><span class="sxs-lookup"><span data-stu-id="2da9a-165">In such a case, a provider may need to render an unreleased object unusable.</span></span> <span data-ttu-id="2da9a-166">Para ello, el proveedor libera todos los recursos relacionados con el objeto y, a continuación, llama a [IMAPISupport::MakeInvalid](imapisupport-makeinvalid.md) para invalidar vtable del objeto.</span><span class="sxs-lookup"><span data-stu-id="2da9a-166">To do this, the provider frees all of the resources connected with the object and then calls [IMAPISupport::MakeInvalid](imapisupport-makeinvalid.md) to invalidate the object's vtable.</span></span> <span data-ttu-id="2da9a-167">**MakeInvalid** reemplaza los métodos de **IUnknown** del vtable (**QueryInterface**, **AddRef**y **Release**) con implementaciones estándar de MAPI y hace que todos los otros métodos devolver MAPI_E_INVALID_OBJECT.</span><span class="sxs-lookup"><span data-stu-id="2da9a-167">**MakeInvalid** replaces the vtable's **IUnknown** methods (**QueryInterface**, **AddRef**, and **Release**) with standard MAPI implementations and causes all other methods to return MAPI_E_INVALID_OBJECT.</span></span> <span data-ttu-id="2da9a-168">**MakeInvalid** también libera memoria de todos los objetos que no sea la tabla vtable.</span><span class="sxs-lookup"><span data-stu-id="2da9a-168">**MakeInvalid** also frees all the object's memory other than the vtable.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="2da9a-169">Vea también</span><span class="sxs-lookup"><span data-stu-id="2da9a-169">See also</span></span>



[<span data-ttu-id="2da9a-170">Proveedores de servicios de MAPI</span><span class="sxs-lookup"><span data-stu-id="2da9a-170">MAPI Service Providers</span></span>](mapi-service-providers.md)

