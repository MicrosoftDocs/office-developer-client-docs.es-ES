---
title: Destinatarios MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 88a4360d-6ab8-466e-8ebd-af80227ee00a
description: '�ltima modificaci�n: s�bado, 23 de julio de 2011'
ms.openlocfilehash: 6af54b773b875531437a275f14c961a06ef799ff
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/23/2018
ms.locfileid: "22569522"
---
# <a name="mapi-recipients"></a><span data-ttu-id="65b8f-103">Destinatarios MAPI</span><span class="sxs-lookup"><span data-stu-id="65b8f-103">MAPI Recipients</span></span>

  
  
<span data-ttu-id="65b8f-104">**Hace referencia a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="65b8f-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="65b8f-p101">Every message to be transmitted has one or more recipients, or a set of properties that describe where the message is to be delivered. Because recipients are used only in the context of a message, they are considered subobjects of a message instead of separate MAPI objects. Clients and providers work with recipients using the **IMessage** interface. For more information, see [IMessage: IMAPIProp](imessageimapiprop.md).</span><span class="sxs-lookup"><span data-stu-id="65b8f-p101">Every message to be transmitted has one or more recipients, or a set of properties that describe where the message is to be delivered. Because recipients are used only in the context of a message, they are considered subobjects of a message instead of separate MAPI objects. Clients and providers work with recipients using the **IMessage** interface. For more information, see [IMessage : IMAPIProp](imessageimapiprop.md).</span></span>
  
<span data-ttu-id="65b8f-p102">Los clientes de tener acceso a los destinatarios de un mensaje a trav�s de su tabla de destinatarios. Cada mensaje tiene una tabla de destinatarios que contiene informaci�n resumida sobre cada uno de sus destinatarios. Las columnas que se incluyen en la tabla dependen del estado del mensaje. Cuando est� redactando un mensaje, los destinatarios pueden tener solo tres columnas en la tabla:</span><span class="sxs-lookup"><span data-stu-id="65b8f-p102">Clients access a message's recipients through its recipient table. Every message has a recipient table that contains summary information about each of its recipients. The columns included in the table depend on the state of the message. When a message is under composition, its recipients might have only three columns in the table:</span></span>
  
- <span data-ttu-id="65b8f-113">Nombre para mostrar o **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="65b8f-113">Display name, or **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>
    
- <span data-ttu-id="65b8f-114">Tipo de destinatario, o **PR_RECIPIENT_TYPE** ([PidTagRecipientType](pidtagrecipienttype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="65b8f-114">Recipient type, or **PR_RECIPIENT_TYPE** ([PidTagRecipientType](pidtagrecipienttype-canonical-property.md))</span></span>
    
- <span data-ttu-id="65b8f-115">Identificador de fila o **PR_ROWID** ([PidTagRowid](pidtagrowid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="65b8f-115">Row identifier, or **PR_ROWID** ([PidTagRowid](pidtagrowid-canonical-property.md))</span></span>
    
<span data-ttu-id="65b8f-116">Después de que el mensaje ha sufrido el proceso de resolución de nombres, cada destinatario también tendrá un identificador de entrada o la columna de **entrada del objeto** ([PidTagEntryId](pidtagentryid-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="65b8f-116">After the message has undergone the name resolution process, each recipient will also have an entry identifier, or **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) column.</span></span> <span data-ttu-id="65b8f-117">Y cuando se ha enviado el mensaje, las filas de la tabla de destinatarios agregar� dos columnas m�s:</span><span class="sxs-lookup"><span data-stu-id="65b8f-117">And when the message has been submitted, the rows in the recipient table will add two more columns:</span></span>
  
- <span data-ttu-id="65b8f-118">Tipo de dirección o **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="65b8f-118">Address type, or **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))</span></span>
    
- <span data-ttu-id="65b8f-119">Responsabilidad de transporte o **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="65b8f-119">Transport responsibility, or **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md))</span></span>
    
<span data-ttu-id="65b8f-120">Clients can retrieve a message's recipient table by calling its **IMessage::GetRecipientTable** method or its **IMAPIProp::OpenProperty** method.</span><span class="sxs-lookup"><span data-stu-id="65b8f-120">Clients can retrieve a message's recipient table by calling its **IMessage::GetRecipientTable** method or its **IMAPIProp::OpenProperty** method.</span></span> <span data-ttu-id="65b8f-121">For more information, see [IMessage::GetRecipientTable](imessage-getrecipienttable.md) and [IMAPIProp::OpenProperty](imapiprop-openproperty.md).</span><span class="sxs-lookup"><span data-stu-id="65b8f-121">For more information, see [IMessage::GetRecipientTable](imessage-getrecipienttable.md) and [IMAPIProp::OpenProperty](imapiprop-openproperty.md).</span></span> <span data-ttu-id="65b8f-122">Message store providers are expected to support both of these approaches.</span><span class="sxs-lookup"><span data-stu-id="65b8f-122">Message store providers are expected to support both of these approaches.</span></span> <span data-ttu-id="65b8f-123">The **OpenProperty** approach requires that the client specify IID_IMAPITable as the interface identifier and **PR_MESSAGE_RECIPIENTS** as the property tag.</span><span class="sxs-lookup"><span data-stu-id="65b8f-123">The **OpenProperty** approach requires that the client specify IID_IMAPITable as the interface identifier and **PR_MESSAGE_RECIPIENTS** as the property tag.</span></span> <span data-ttu-id="65b8f-124">**PR_MESSAGE_RECIPIENTS** ([PidTagMessageRecipients](pidtagmessagerecipients-canonical-property.md)) es una propiedad de objeto table que representa la tabla de destinatarios de un mensaje.</span><span class="sxs-lookup"><span data-stu-id="65b8f-124">**PR_MESSAGE_RECIPIENTS** ([PidTagMessageRecipients](pidtagmessagerecipients-canonical-property.md)) is a table object property that represents a message's recipient table.</span></span> <span data-ttu-id="65b8f-125">Message store providers are required to set **PR_MESSAGE_RECIPIENTS** for each message and include it in the array of property tags returned from the **IMAPIProp::GetPropList** method.</span><span class="sxs-lookup"><span data-stu-id="65b8f-125">Message store providers are required to set **PR_MESSAGE_RECIPIENTS** for each message and include it in the array of property tags returned from the **IMAPIProp::GetPropList** method.</span></span> <span data-ttu-id="65b8f-126">For more information, see [IMAPIProp::GetPropList](imapiprop-getproplist.md).</span><span class="sxs-lookup"><span data-stu-id="65b8f-126">For more information, see [IMAPIProp::GetPropList](imapiprop-getproplist.md).</span></span>
  
<span data-ttu-id="65b8f-127">For more information about how to work with a recipient table, see [Tablas de destinatarios](recipient-tables.md).</span><span class="sxs-lookup"><span data-stu-id="65b8f-127">For more information about how to work with a recipient table, see [Recipient Tables](recipient-tables.md).</span></span>
  
<span data-ttu-id="65b8f-128">Adem�s de que se usa para tener acceso a una tabla de destinatario, se pueden usar **PR_MESSAGE_RECIPIENTS**:</span><span class="sxs-lookup"><span data-stu-id="65b8f-128">In addition to being used to access a recipient table, **PR_MESSAGE_RECIPIENTS** can be used:</span></span> 
  
- <span data-ttu-id="65b8f-p105">With **IMAPIProp::CopyTo** or **IMAPIProp::CopyProps** to exclude or include recipients when copying. For more information see, [IMAPIProp::CopyTo](imapiprop-copyto.md) and [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span><span class="sxs-lookup"><span data-stu-id="65b8f-p105">With **IMAPIProp::CopyTo** or **IMAPIProp::CopyProps** to exclude or include recipients when copying. For more information see, [IMAPIProp::CopyTo](imapiprop-copyto.md) and [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span>
    
- <span data-ttu-id="65b8f-131">En una restricci�n de subobjetos para indicar que la seg�n el elemento secundario se aplique a los destinatarios.</span><span class="sxs-lookup"><span data-stu-id="65b8f-131">In a subobject restriction to indicate that the child restiction should apply to recipients.</span></span>
    
<span data-ttu-id="65b8f-p106">Los clientes pueden agregar a destinatarios a un mensaje mediante la copia de las entradas de la libreta de direcciones MAPI o mediante la creaci�n de nuevas entradas. Estas nuevas entradas, denominadas uso �nico, pueden existir temporalmente o guardarse permanentemente en un contenedor modificable. Mientras que los destinatarios que se toman de la libreta de direcciones tienen identificadores de entrada asociados con su proveedor de libreta de direcciones, los destinatarios tienen identificadores de entrada que se ha dado formato mediante MAPI. Transporte proveedores y los identificadores de entrada �nico asociar de clientes con diversos tipos de direcciones.</span><span class="sxs-lookup"><span data-stu-id="65b8f-p106">Clients can add recipients to a message by copying entries from the MAPI address book or by creating new entries. These new entries, called one-offs, can exist temporarily or be saved permanently in a modifiable container. Whereas recipients that are taken from the address book have entry identifiers associated with their address book provider, one-off recipients have entry identifiers that are formatted by MAPI. Transport providers and clients associate one-off entry identifiers with various types of addresses.</span></span> 
  
<span data-ttu-id="65b8f-136">**IMAPISupport::CreateOneOff** para crear un identificador de entrada �nico para una direcci�n en una salida de llamadas de los proveedores de transporte de mensajes cuando:</span><span class="sxs-lookup"><span data-stu-id="65b8f-136">Transport providers call **IMAPISupport::CreateOneOff** to create a one-off entry identifier for an address on an outgoing message when:</span></span> 
  
- <span data-ttu-id="65b8f-137">La direcci�n pertenece a una puerta de enlace.</span><span class="sxs-lookup"><span data-stu-id="65b8f-137">The address belongs to a gateway.</span></span>
    
- <span data-ttu-id="65b8f-138">No se puede controlar la direcci�n por un proveedor de libreta de direcciones en el perfil actual.</span><span class="sxs-lookup"><span data-stu-id="65b8f-138">The address cannot be handled by an address book provider in the current profile.</span></span>
    
<span data-ttu-id="65b8f-139">For more information, see [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md).</span><span class="sxs-lookup"><span data-stu-id="65b8f-139">For more information, see [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md).</span></span>
  
<span data-ttu-id="65b8f-140">Los clientes llaman a **IAddrBook::CreateOneOff** para crear un identificador de entrada �nico para una direcci�n en un entrante aparece un mensaje cuando:</span><span class="sxs-lookup"><span data-stu-id="65b8f-140">Clients call **IAddrBook::CreateOneOff** to create a one-off entry identifier for an address on an incoming message when:</span></span> 
  
- <span data-ttu-id="65b8f-141">La direcci�n tiene el formato de una direcci�n de uso �nico.</span><span class="sxs-lookup"><span data-stu-id="65b8f-141">The address is formatted as a one-off address.</span></span>
    
- <span data-ttu-id="65b8f-142">La direcci�n tiene el formato de una direcci�n de Internet.</span><span class="sxs-lookup"><span data-stu-id="65b8f-142">The address is formatted as an Internet address.</span></span>
    
<span data-ttu-id="65b8f-143">For more information, see [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md).</span><span class="sxs-lookup"><span data-stu-id="65b8f-143">For more information, see [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md).</span></span>
  
<span data-ttu-id="65b8f-144">For more information about one-off entry identifiers and addresses, see [Identificadores de entrada �nico](one-off-entry-identifiers.md) and [Direcciones de uso �nico](one-off-addresses.md).</span><span class="sxs-lookup"><span data-stu-id="65b8f-144">For more information about one-off entry identifiers and addresses, see [One-Off Entry Identifiers](one-off-entry-identifiers.md) and [One-Off Addresses](one-off-addresses.md).</span></span>
  
<span data-ttu-id="65b8f-p107">Las propiedades de un destinatario son una combinaci�n de propiedades de la libreta de direcciones y propiedades espec�ficas de los destinatarios. Todos los destinatarios tienen las propiedades de la direcci�n base, asignadas por los proveedores de libreta de direcciones. Cuando se usa una entrada como un destinatario de un mensaje saliente, se copian las propiedades de la direcci�n base en la estructura **ADRLIST** que contiene las propiedades de todos los destinatarios de un mensaje.</span><span class="sxs-lookup"><span data-stu-id="65b8f-p107">The properties of a recipient are a combination of address book properties and properties specific to recipients. All recipients have the base address properties, assigned by address book providers. When an entry is used as a recipient for an outgoing message, the base address properties are copied to the **ADRLIST** structure that holds the properties for all of a message's recipients.</span></span> 
  
<span data-ttu-id="65b8f-p108">Dos propiedades que se establecen espec�ficamente para los destinatarios son **PR_RECIPIENT_TYPE** y **PR_RESPONSIBILITY**. **PR_RECIPIENT_TYPE** indica si un destinatario es un destinatario de reenv�o, copia, copia oculta o principal. Los primeros tres tipos se asignan a los destinatarios en los mensajes que se env�an por primera vez.</span><span class="sxs-lookup"><span data-stu-id="65b8f-p108">Two properties that are set specifically for recipients are **PR_RECIPIENT_TYPE** and **PR_RESPONSIBILITY**. **PR_RECIPIENT_TYPE** indicates whether a recipient is a primary, carbon copy, blind carbon copy, or a resend recipient. The first three types are assigned to recipients on messages that are being sent for the first time.</span></span> 
  
<span data-ttu-id="65b8f-p109">Si un destinatario no recibe el mensaje y se realiza un intento para enviarlo, el destinatario se copia y se establece su tipo en MAPI_P1 para indicar que se trata de un destinatario de reenv�o. Si s�lo algunos de los destinatarios reciben un mensaje, sus propiedades **PR_RECIPIENT_TYPE** se marcan con la incorporaci�n de la marca MAPI_SUBMITTED cuando se vuelve a enviar el mensaje. Los clientes son necesarios para administrar a destinatarios principales, o los destinatarios con sus **PR_RECIPIENT_TYPE** establecido en MAPI_TO. Todos los dem�s tipos son opcionales.</span><span class="sxs-lookup"><span data-stu-id="65b8f-p109">If a recipient does not receive the message and an attempt is made to resend it, the recipient is copied and its type is set to MAPI_P1 to indicate that it is a resend recipient. If only some of the recipients receive a message, their **PR_RECIPIENT_TYPE** properties are marked with the addition of the MAPI_SUBMITTED flag when the message is resent. Clients are required to handle primary recipients, or recipients with their **PR_RECIPIENT_TYPE** set to MAPI_TO. All other types are optional.</span></span> 
  
 <span data-ttu-id="65b8f-p110">**PR_RESPONSIBILITY** se establece para indicar que el proveedor de transporte o no deben administrar Enviar al destinatario. Cuando un mensaje saliente se env�a primero, todos los destinatarios establece **PR_RESPONSIBILITY** en FALSE. Como un proveedor de transporte responsable de enviar a uno o varios de los destinatarios de notificaciones, sus propiedades **PR_RESPONSIBILITY** est�n establecidas en TRUE.</span><span class="sxs-lookup"><span data-stu-id="65b8f-p110">**PR_RESPONSIBILITY** is set to indicate to the transport provider whether or not it should handle sending to the recipient. When an outgoing message is first sent, all of the recipients set **PR_RESPONSIBILITY** to FALSE. As a transport provider claims responsibility for sending to one or more of the recipients, their **PR_RESPONSIBILITY** properties are set to TRUE.</span></span> 
  

