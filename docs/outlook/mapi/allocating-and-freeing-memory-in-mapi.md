---
title: Asignar y liberar memoria en MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e238f6bc-e9f6-4ea4-a2e4-ff5da2a04bd5
description: 'Última modificación: 09 de marzo de 2015'
ms.openlocfilehash: 68250c5cbeaa366ed4555bb469c4e68d62302f28
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/23/2019
ms.locfileid: "32281588"
---
# <a name="allocating-and-freeing-memory-in-mapi"></a><span data-ttu-id="d31f5-103">Asignar y liberar memoria en MAPI</span><span class="sxs-lookup"><span data-stu-id="d31f5-103">Allocating and Freeing Memory in MAPI</span></span>

  
  
<span data-ttu-id="d31f5-104">**Se aplica a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="d31f5-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="d31f5-105">Además de especificar cómo asignar y liberar memoria, MAPI define un modelo para saber cuándo se debe liberar la memoria que entre el método de interfaz pública y las llamadas de función de la API.</span><span class="sxs-lookup"><span data-stu-id="d31f5-105">In addition to specifying how to allocate and free memory, MAPI defines a model for knowing when memory passed between public interface method and API function calls should be freed.</span></span> <span data-ttu-id="d31f5-106">El modelo se aplica únicamente a la memoria asignada para los parámetros que no son punteros a las interfaces, como cadenas y punteros a estructuras.</span><span class="sxs-lookup"><span data-stu-id="d31f5-106">The model applies only to memory allocated for parameters that are not pointers to interfaces, such as strings and pointers to structures.</span></span> <span data-ttu-id="d31f5-107">Los punteros de interfaz usan el mecanismo de recuento de referencias implementado a través de **IUnknown**.</span><span class="sxs-lookup"><span data-stu-id="d31f5-107">Interface pointers use the reference counting mechanism implemented through **IUnknown**.</span></span> <span data-ttu-id="d31f5-108">Al asignar y liberar internamente memoria no relacionada con MAPI dentro de una aplicación cliente o un proveedor de servicios, use cualquier mecanismo que tenga sentido.</span><span class="sxs-lookup"><span data-stu-id="d31f5-108">When allocating and freeing non-MAPI related memory internally within a client application or service provider, use whatever mechanism makes sense.</span></span> 
  
<span data-ttu-id="d31f5-109">El modelo define los parámetros como uno de estos tres tipos.</span><span class="sxs-lookup"><span data-stu-id="d31f5-109">The model defines parameters as one of three types.</span></span> <span data-ttu-id="d31f5-110">Pueden ser parámetros de entrada, establecidos por el autor de la llamada con información que va a usar la función o el método al que se ha llamado, los parámetros de salida, establecidos por la función o el método con el que se ha devuelto la llamada, o los parámetros de entrada-salida, una combinación de ambos tipos.</span><span class="sxs-lookup"><span data-stu-id="d31f5-110">They can be input parameters, set by the caller with information to be used by the called function or method, output parameters, set by the called function or method and returned to the caller, or input-output parameters, a combination of the two types.</span></span> <span data-ttu-id="d31f5-111">Los parámetros de salida son punteros frecuentes a datos o punteros a punteros a datos.</span><span class="sxs-lookup"><span data-stu-id="d31f5-111">Output parameters are frequently pointers to data or pointers to pointers to data.</span></span> <span data-ttu-id="d31f5-112">Aunque la función llamada es responsable de asignar los datos para los parámetros de salida, el autor de la llamada asigna la memoria del puntero.</span><span class="sxs-lookup"><span data-stu-id="d31f5-112">Although the called function is responsible for allocating the data for output parameters, the caller allocates the memory for the pointer.</span></span> 
  
<span data-ttu-id="d31f5-113">En la tabla siguiente se explican las reglas para asignar y liberar memoria para estos tipos de parámetros.</span><span class="sxs-lookup"><span data-stu-id="d31f5-113">The rules for allocating and releasing memory for these types of parameters are explained in the following table.</span></span>
  
|<span data-ttu-id="d31f5-114">**Type**</span><span class="sxs-lookup"><span data-stu-id="d31f5-114">**Type**</span></span>|<span data-ttu-id="d31f5-115">**Asignación de memoria**</span><span class="sxs-lookup"><span data-stu-id="d31f5-115">**Memory allocation**</span></span>|<span data-ttu-id="d31f5-116">**Liberar memoria**</span><span class="sxs-lookup"><span data-stu-id="d31f5-116">**Memory release**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="d31f5-117">Input</span><span class="sxs-lookup"><span data-stu-id="d31f5-117">Input</span></span>  <br/> |<span data-ttu-id="d31f5-118">El autor de la llamada es responsable y puede usar cualquier mecanismo.</span><span class="sxs-lookup"><span data-stu-id="d31f5-118">Caller is responsible and can use any mechanism.</span></span>  <br/> |<span data-ttu-id="d31f5-119">El autor de la llamada es responsable y puede usar cualquier mecanismo.</span><span class="sxs-lookup"><span data-stu-id="d31f5-119">Caller is responsible and can use any mechanism.</span></span>  <br/> |
|<span data-ttu-id="d31f5-120">Output</span><span class="sxs-lookup"><span data-stu-id="d31f5-120">Output</span></span>  <br/> |<span data-ttu-id="d31f5-121">La función llamada es responsable y debe usar **MAPIAllocateBuffer**.</span><span class="sxs-lookup"><span data-stu-id="d31f5-121">Called function is responsible and must use **MAPIAllocateBuffer**.</span></span> <span data-ttu-id="d31f5-122">Para obtener más información, vea [MAPIAllocateBuffer](mapiallocatebuffer.md).</span><span class="sxs-lookup"><span data-stu-id="d31f5-122">For more information, see [MAPIAllocateBuffer](mapiallocatebuffer.md).</span></span>  <br/> |<span data-ttu-id="d31f5-123">El autor de la llamada es responsable y debe usar **MAPIFreeBuffer**.</span><span class="sxs-lookup"><span data-stu-id="d31f5-123">Caller is responsible and must use **MAPIFreeBuffer**.</span></span> <span data-ttu-id="d31f5-124">Para obtener más información, vea [MAPIFreeBuffer](mapifreebuffer.md).</span><span class="sxs-lookup"><span data-stu-id="d31f5-124">For more information, see [MAPIFreeBuffer](mapifreebuffer.md).</span></span>  <br/> |
|<span data-ttu-id="d31f5-125">Input-Output</span><span class="sxs-lookup"><span data-stu-id="d31f5-125">Input-output</span></span>  <br/> |<span data-ttu-id="d31f5-126">El autor de la llamada es responsable de la asignación inicial y la función a la que se llama puede reasignar si es necesario usando **MAPIAllocateBuffer**.</span><span class="sxs-lookup"><span data-stu-id="d31f5-126">Caller is responsible for the initial allocation and called function can reallocate if necessary using **MAPIAllocateBuffer**.</span></span>  <br/> |<span data-ttu-id="d31f5-127">La función llamada es responsable de la liberación inicial si es necesaria la reasignación.</span><span class="sxs-lookup"><span data-stu-id="d31f5-127">Called function is responsible for initial freeing if reallocation is necessary.</span></span> <span data-ttu-id="d31f5-128">El autor de la llamada debe liberar el valor devuelto final.</span><span class="sxs-lookup"><span data-stu-id="d31f5-128">Caller must free the final return value.</span></span>  <br/> |
   
<span data-ttu-id="d31f5-129">En las condiciones de error, los implementadores de los métodos de interfaz necesitan prestar atención a los parámetros de salida y de salida de entrada, ya que el autor de la llamada no suele tener forma de limpiarlos.</span><span class="sxs-lookup"><span data-stu-id="d31f5-129">During failure conditions, implementers of interface methods need to pay attention to output and input-output parameters because the caller generally has no way to clean them up.</span></span> <span data-ttu-id="d31f5-130">Si se devuelve un error, cada parámetro de salida o entrada-salida debe dejarse en el valor inicializado por el autor de la llamada o establecerse en un valor que se puede limpiar sin realizar ninguna acción por parte del autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="d31f5-130">If an error is returned, then each output or input-output parameter must either be left at the value initialized by the caller or set to a value that can be cleaned up without any action on the part of the caller.</span></span> <span data-ttu-id="d31f5-131">Por ejemplo, un parámetro de salida de puntero `void ** ppv` -parámetro de debe dejarse como estaba en la entrada o puede establecerse `*ppv = NULL`en null ().</span><span class="sxs-lookup"><span data-stu-id="d31f5-131">For example, an output pointer-parameter of  `void ** ppv` must be left as it was on input or can be set to NULL (  `*ppv = NULL`).</span></span>
  

