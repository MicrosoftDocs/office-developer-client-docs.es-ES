---
title: Escribir código de servidor de formulario
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ff33badc-ceed-4364-b99c-8af3af83ceb6
description: 'Última modificación: 09 de marzo de 2015'
ms.openlocfilehash: 860b0150fd1ec66fa8fee387d8d4a96e8bb79761
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/11/2018
ms.locfileid: "19820986"
---
# <a name="writing-form-server-code"></a><span data-ttu-id="e0152-103">Escribir código de servidor de formulario</span><span class="sxs-lookup"><span data-stu-id="e0152-103">Writing Form Server Code</span></span>

  
  
<span data-ttu-id="e0152-104">**Hace referencia a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="e0152-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="e0152-105">Puede considerar un servidor de formulario como el siguiente:</span><span class="sxs-lookup"><span data-stu-id="e0152-105">You can think of a form server as the following:</span></span> 
  
- <span data-ttu-id="e0152-106">Un programa Win32 que muestra una interfaz y se encarga de los mensajes de windows mediante los mecanismos de suministro de mensajes de Windows estándares.</span><span class="sxs-lookup"><span data-stu-id="e0152-106">A Win32 program that displays an interface and handles windows messages by way of the standard Windows message pump mechanisms.</span></span>
    
- <span data-ttu-id="e0152-107">Un objeto que registra el generador de clases con OLE y se activa por métodos de automatización OLE.</span><span class="sxs-lookup"><span data-stu-id="e0152-107">An object that registers its class factory with OLE and is activated by OLE automation methods.</span></span>
    
- <span data-ttu-id="e0152-108">Un objeto MAPI que sigue las reglas MAPI para las interacciones con otros componentes MAPI.</span><span class="sxs-lookup"><span data-stu-id="e0152-108">A MAPI object that follows the MAPI rules for interactions with other MAPI components.</span></span>
    
 <span data-ttu-id="e0152-109">El código tiene que controlar las tres de esos requisitos amplia simultáneamente.</span><span class="sxs-lookup"><span data-stu-id="e0152-109">Your code has to handle all three of those broad requirements simultaneously.</span></span> 
  
<span data-ttu-id="e0152-110">Vea la sección Servicios de objeto de ActiveX y COM en el SDK de Windows para obtener información detallada acerca de cómo registrar el generador de clases del servidor de su formulario.</span><span class="sxs-lookup"><span data-stu-id="e0152-110">See the COM and ActiveX Object Services section in the Windows SDK for details about registering your form server's class factory.</span></span> <span data-ttu-id="e0152-111">Tratamiento de mensajes de windows y mostrar una interfaz son estándares técnicas de programación de Windows que no tengan requisitos especiales con respecto a los formularios MAPI.</span><span class="sxs-lookup"><span data-stu-id="e0152-111">Handling windows messages and displaying an interface are standard Windows programming techniques that do not have any special requirements with respect to MAPI forms.</span></span> <span data-ttu-id="e0152-112">Una vez más, el SDK de Windows con información detallada acerca de las ventanas de programación.</span><span class="sxs-lookup"><span data-stu-id="e0152-112">Again, the Windows SDK has details about Windows programming.</span></span> <span data-ttu-id="e0152-113">Este documento contiene lo que necesita saber para implementar las interfaces de formulario MAPI opcionales y obligatorios para que cumplan las reglas MAPI para las interacciones con otros componentes MAPI: principalmente la MAPI de formulario manager y aplicaciones cliente de mensajería.</span><span class="sxs-lookup"><span data-stu-id="e0152-113">This document contains what you need to know to implement the required and optional MAPI form interfaces so that they follow the MAPI rules for interactions with other MAPI components — primarily the MAPI form manager and messaging client applications.</span></span>
  
<span data-ttu-id="e0152-114">Todas las interfaces que se pueden usar al implementar los servidores de formulario se derivan, directa o indirectamente, de OLE [IUnknown](http://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx)de la clase base.</span><span class="sxs-lookup"><span data-stu-id="e0152-114">All of the interfaces that you can use when you implement form servers are derived — either directly or indirectly — from the OLE base class [IUnknown](http://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx).</span></span> <span data-ttu-id="e0152-115">Esto significa que todas las implementaciones de estas interfaces tendrá que tienen métodos **QueryInterface**, **AddRef**y **Release** .</span><span class="sxs-lookup"><span data-stu-id="e0152-115">This means that all your implementations of these interfaces will need to have **QueryInterface**, **AddRef**, and **Release** methods.</span></span> <span data-ttu-id="e0152-116">Se puede ahorrar una gran cantidad de trabajo si utiliza herencia múltiple para implementar todas las interfaces necesarias en una nueva clase de su elección, de forma que todas las interfaces que use pueden compartir una única implementación de los métodos de **IUnknown** necesarios.</span><span class="sxs-lookup"><span data-stu-id="e0152-116">You can save yourself a lot of work if you use multiple inheritance to implement all of the required interfaces in one new class of your own, so that all the interfaces you use can share a single implementation of the required **IUnknown** methods.</span></span> <span data-ttu-id="e0152-117">Para obtener más información, vea los métodos de [IUnknown:: AddRef](http://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx), [IUnknown:: QueryInterface](http://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx)e [IUnknown:: Release](http://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="e0152-117">For more information, see the [IUnknown::AddRef](http://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx), [IUnknown::QueryInterface](http://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx), and [IUnknown::Release](http://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) methods.</span></span> <span data-ttu-id="e0152-118">No hay ninguna consideración especial con respecto a los servidores de formulario MAPI para estos métodos.</span><span class="sxs-lookup"><span data-stu-id="e0152-118">There are no special considerations with respect to MAPI form servers for these methods.</span></span> 
  
<span data-ttu-id="e0152-119">Mientras no todas las interfaces de formulario MAPI son obligatorios para todos los servidores de formulario, los métodos de cualquier interfaz determinado son obligatorios.</span><span class="sxs-lookup"><span data-stu-id="e0152-119">While not all of the MAPI form interfaces are mandatory for all form servers, the methods in any given interface are mandatory.</span></span> <span data-ttu-id="e0152-120">Es decir, si decide implementar una interfaz determinada, debe implementar todos los métodos en la interfaz.</span><span class="sxs-lookup"><span data-stu-id="e0152-120">That is, if you choose to implement a particular interface, you must implement all of the methods in the interface.</span></span> <span data-ttu-id="e0152-121">Esto es diferente de la situación con algunos otros componentes MAPI, como los transportes de mensaje.</span><span class="sxs-lookup"><span data-stu-id="e0152-121">This is different from the situation with some other MAPI components, such as message transports.</span></span> <span data-ttu-id="e0152-122">Afortunadamente, los métodos de las interfaces de formulario MAPI son relativamente sencillos, por lo que la implementación de todos ellos no colocar una gran carga en los desarrolladores.</span><span class="sxs-lookup"><span data-stu-id="e0152-122">Fortunately, the methods in the MAPI form interfaces are relatively straightforward, so implementing all of them does not put a great burden on developers.</span></span>
  
<span data-ttu-id="e0152-123">Las interfaces de formulario MAPI son independientes del tipo de herramienta de desarrollo que se usa para crear un servidor de formulario.</span><span class="sxs-lookup"><span data-stu-id="e0152-123">The MAPI form interfaces are independent of the type of development tool used to create a form server.</span></span> <span data-ttu-id="e0152-124">Esto permite que los formularios que se creará mediante las herramientas de desarrollo diferentes.</span><span class="sxs-lookup"><span data-stu-id="e0152-124">This allows forms to be created by using different development tools.</span></span> <span data-ttu-id="e0152-125">El único requisito es que todos los servidores de formulario deben admitir las interfaces necesarias de formulario MAPI.</span><span class="sxs-lookup"><span data-stu-id="e0152-125">The only requirement is that all form servers must support the required MAPI form interfaces.</span></span>
  
<span data-ttu-id="e0152-126">No todas las interfaces MAPI que se relacionan con formularios son necesarios para todos los servidores de formulario.</span><span class="sxs-lookup"><span data-stu-id="e0152-126">Not all of the MAPI interfaces that relate to forms are required by all form servers.</span></span> <span data-ttu-id="e0152-127">Las interfaces opcionales permiten implementar algunas funciones avanzadas de formulario que no son necesarios por la mayoría de los servidores de formulario.</span><span class="sxs-lookup"><span data-stu-id="e0152-127">The optional interfaces allow you to implement some advanced form functions that are not needed by most form servers.</span></span> <span data-ttu-id="e0152-128">En la siguiente tabla se enumera las interfaces, ¿qué son y si se debe implementar.</span><span class="sxs-lookup"><span data-stu-id="e0152-128">The following table lists the interfaces, what they are for, and whether you must implement them.</span></span>
  
|<span data-ttu-id="e0152-129">**Interfaz**</span><span class="sxs-lookup"><span data-stu-id="e0152-129">**Interface**</span></span>|<span data-ttu-id="e0152-130">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="e0152-130">**Description**</span></span>|<span data-ttu-id="e0152-131">**Status**</span><span class="sxs-lookup"><span data-stu-id="e0152-131">**Status**</span></span>|
|:-----|:-----|:-----|
|[<span data-ttu-id="e0152-132">IMAPIForm : IUnknown</span><span class="sxs-lookup"><span data-stu-id="e0152-132">IMAPIForm : IUnknown</span></span>](imapiformiunknown.md) <br/> |<span data-ttu-id="e0152-133">La interfaz principal que utilizan los clientes para cargar los servidores de formulario, ejecutar verbos de formulario y apagar servidores de formulario.</span><span class="sxs-lookup"><span data-stu-id="e0152-133">The primary interface that clients use to load form servers, execute form verbs, and shut down form servers.</span></span> <span data-ttu-id="e0152-134">También es la interfaz que se deriva el OLE **IUnknown** que se usa para informar a otros componentes OLE con respecto a qué interfaces implementa un objeto de formulario.</span><span class="sxs-lookup"><span data-stu-id="e0152-134">This is also the interface derived from the OLE **IUnknown** that is used to inform other OLE components regarding what interfaces a form object implements.</span></span>  <br/> |<span data-ttu-id="e0152-135">Obligatorio</span><span class="sxs-lookup"><span data-stu-id="e0152-135">Required</span></span>  <br/> |
|[<span data-ttu-id="e0152-136">IPersistMessage : IUnknown</span><span class="sxs-lookup"><span data-stu-id="e0152-136">IPersistMessage : IUnknown</span></span>](ipersistmessageiunknown.md) <br/> |<span data-ttu-id="e0152-137">Se utiliza cuando se cargan los mensajes en y guardar los mensajes de los objetos de formulario.</span><span class="sxs-lookup"><span data-stu-id="e0152-137">Used when loading messages into and saving messages from form objects.</span></span>  <br/> |<span data-ttu-id="e0152-138">Obligatorio</span><span class="sxs-lookup"><span data-stu-id="e0152-138">Required</span></span>  <br/> |
|[<span data-ttu-id="e0152-139">IMAPIFormAdviseSink : IUnknown</span><span class="sxs-lookup"><span data-stu-id="e0152-139">IMAPIFormAdviseSink : IUnknown</span></span>](imapiformadvisesinkiunknown.md) <br/> |<span data-ttu-id="e0152-140">Utilizar objetos de formulario para realizar un seguimiento de estado de cliente de mensajería y para averiguar si el objeto de formulario es capaz de mostrar el mensaje siguiente o anterior en una carpeta.</span><span class="sxs-lookup"><span data-stu-id="e0152-140">Used by form objects to keep track of messaging client status and to find out whether the form object is capable of displaying the next or previous message in a folder.</span></span>  <br/> |<span data-ttu-id="e0152-141">Opcional</span><span class="sxs-lookup"><span data-stu-id="e0152-141">Optional</span></span>  <br/> |
|[<span data-ttu-id="e0152-142">IClassFactory</span><span class="sxs-lookup"><span data-stu-id="e0152-142">IClassFactory</span></span>](http://msdn.microsoft.com/library/f624f833-2b69-43bc-92cd-c4ecbe6051c5%28Office.15%29.aspx) <br/> |<span data-ttu-id="e0152-143">La interfaz de fábrica de clase OLE utilizada por los objetos de formulario para el cumplimiento con el mecanismo de fábrica de clase OLE.</span><span class="sxs-lookup"><span data-stu-id="e0152-143">The OLE class factory interface used by form objects for compliance with the OLE class factory mechanism.</span></span>  <br/> |<span data-ttu-id="e0152-144">Obligatorio</span><span class="sxs-lookup"><span data-stu-id="e0152-144">Required</span></span>  <br/> |
|[<span data-ttu-id="e0152-145">IMAPIFormFactory : IUnknown</span><span class="sxs-lookup"><span data-stu-id="e0152-145">IMAPIFormFactory : IUnknown</span></span>](imapiformfactoryiunknown.md) <br/> |<span data-ttu-id="e0152-146">Se usa si su servidor de formulario es compatible con más de un tipo de formulario.</span><span class="sxs-lookup"><span data-stu-id="e0152-146">Used if your form server supports more than one type of form.</span></span> <span data-ttu-id="e0152-147">En este caso, la interfaz de **IMAPIFormFactory** permite a las aplicaciones de cliente para tener acceso a las interfaces **IClassFactory** varias (uno por cada tipo de formulario compatible con el servidor de formulario) que también debe implementar el servidor de formulario.</span><span class="sxs-lookup"><span data-stu-id="e0152-147">In this case, the **IMAPIFormFactory** interface allows client applications to access the multiple **IClassFactory** interfaces (one per type of form that your form server supports) that your form server must also implement.</span></span>  <br/> |<span data-ttu-id="e0152-148">Opcional</span><span class="sxs-lookup"><span data-stu-id="e0152-148">Optional</span></span>  <br/> |
   
## <a name="see-also"></a><span data-ttu-id="e0152-149">Vea también</span><span class="sxs-lookup"><span data-stu-id="e0152-149">See also</span></span>



[<span data-ttu-id="e0152-150">Desarrollar servidores de formulario MAPI</span><span class="sxs-lookup"><span data-stu-id="e0152-150">Developing MAPI Form Servers</span></span>](developing-mapi-form-servers.md)

