---
title: Liberar objetos sistemáticamente
TOCTitle: Systematically releasing objects
ms:assetid: d4cd1d8e-aae6-483b-a4d8-1656171e838d
ms:mtpsurl: https://msdn.microsoft.com/library/Bb623945(v=office.15)
ms:contentKeyID: 55119785
ms.date: 07/24/2014
mtps_version: v=office.15
ms.openlocfilehash: 812f720b3ebab1100040802d7593548063497297
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 10/04/2018
ms.locfileid: "25406837"
---
# <a name="systematically-releasing-objects"></a><span data-ttu-id="18c1e-102">Liberar objetos sistemáticamente</span><span class="sxs-lookup"><span data-stu-id="18c1e-102">Systematically Releasing Objects</span></span>

<span data-ttu-id="18c1e-103">En este tema se resumen las recomendaciones sobre el cierre de complementos para los programadores de complementos y administradores de TI que utilizan Outlook.</span><span class="sxs-lookup"><span data-stu-id="18c1e-103">This topic summarizes add-in shutdown recommendations for add-in developers and IT administrators that use ol14long. For more information, see Shutdown Changes for Outlook 2010.</span></span> <span data-ttu-id="18c1e-104">Para obtener más información, vea [Cambios en el cierre de Outlook 2010](https://msdn.microsoft.com/library/ee720183\(v=office.15\)).</span><span class="sxs-lookup"><span data-stu-id="18c1e-104">For more information, see [Shutdown Changes for Outlook 2010](https://msdn.microsoft.com/library/ee720183\(v=office.15\)).</span></span>

## <a name="add-in-shutdown-changes-in-outlook"></a><span data-ttu-id="18c1e-105">Cambios en el cierre de complementos de Outlook</span><span class="sxs-lookup"><span data-stu-id="18c1e-105">Add-in shutdown changes in Outlook</span></span>

<span data-ttu-id="18c1e-106">Desde Outlook 2010, Outlook, de forma predeterminada, no indica a los complementos que se está cerrando.</span><span class="sxs-lookup"><span data-stu-id="18c1e-106">Starting in Outlook 2010, Outlook, by default, does not signal add-ins that it is shutting down.</span></span> <span data-ttu-id="18c1e-107">En concreto, Outlook ya no llama a los métodos **OnBeginShutdown(Array)** y **OnDisconnection (ext\_DisconnectMode, Array)** de la interfaz **IDTExtensibility2** durante el apagado rápido.</span><span class="sxs-lookup"><span data-stu-id="18c1e-107">Specifically, Outlook no longer calls the **OnBeginShutdown(Array)** and **OnDisconnection(ext\_DisconnectMode, Array)** methods of the **IDTExtensibility2** interface during fast shutdown.</span></span> <span data-ttu-id="18c1e-108">De forma similar, un complemento de Outlook, escrito con las herramientas de desarrollo de Office en Visual Studio 2010 o una versión posterior, ya no llama al método ThisAddin\_Shutdown cuando se cierra Outlook.</span><span class="sxs-lookup"><span data-stu-id="18c1e-108">Similarly, an Outlook add-in, written with Office development tools in Visual Studio 2010 or a later version, no longer calls the ThisAddin\_Shutdown method when Outlook is shutting down.</span></span> 

<span data-ttu-id="18c1e-109">La razón para dejar de llamar a estos métodos es que aunque la mayoría de los complementos realizan tareas sencillas como publicar referencias, algunos complementos realizan llamadas de servicio Web u otras operaciones de ejecución prolongada de forma sincrónica durante estos eventos, lo que retrasa significativamente el cierre de Outlook.</span><span class="sxs-lookup"><span data-stu-id="18c1e-109">The reason to stop calling these methods is that while a majority of add-ins perform simple tasks like releasing references, some add-ins make Web service calls or other long-running operations synchronously during these events, significantly delaying Outlook from shutting down.</span></span> <span data-ttu-id="18c1e-110">Como resultado de este cambio, Outlook funciona mejor durante el cierre que como lo hacía anteriormente.</span><span class="sxs-lookup"><span data-stu-id="18c1e-110">As a result of this change, Outlook works better than it has in the past when shutting down.</span></span>

## <a name="recommendations-for-add-in-shutdown-for-developers"></a><span data-ttu-id="18c1e-111">Recomendaciones sobre el cierre de complementos para programadores</span><span class="sxs-lookup"><span data-stu-id="18c1e-111">Recommendations for Add-in Shutdown for Developers</span></span>

<span data-ttu-id="18c1e-112">Es importante que los programadores respeten las siguientes recomendaciones para el cierre de complementos con el fin de garantizar que los usuarios finales continúen beneficiándose de una experiencia de cierre de Outlook rápida y receptiva. </span><span class="sxs-lookup"><span data-stu-id="18c1e-112">It is important that developers observe the following recommendations for add-in shutdown to ensure that end users continue to benefit from a fast and responsive Outlook shutdown experience.</span></span>

- <span data-ttu-id="18c1e-113">Los complementos deben continuar implementando los métodos OnBeginShutdown y OnDisconnection o ThisAddin\_Shutdown para liberar las referencias y la memoria asignada. Esto se debe a que existen escenarios en los que los administradores podrían volver al cierre lento a través de una directiva de grupo o el usuario podría desconectar manualmente el complemento a través del cuadro de diálogo **Complementos COM**.</span><span class="sxs-lookup"><span data-stu-id="18c1e-113">Add-ins should continue to implement the OnBeginShutdown and OnDisconnection methods or ThisAddin_Shutdown to release references and allocated memory, because there are scenarios in which administrators might revert to slow shutdown through group policy, or the user might manually disconnect your add-in through the COM Add-ins dialog box.</span></span>

- <span data-ttu-id="18c1e-114">Los desarrolladores de complementos solo deben realizar tareas que requieran tener lugar durante el cierre.</span><span class="sxs-lookup"><span data-stu-id="18c1e-114">Add-in developers should only perform tasks that absolutely must take place during shutdown.</span></span>

- <span data-ttu-id="18c1e-115">Los programadores de complementos deben evaluar el rendimiento de sus complementos en diversos escenarios y en diferentes configuraciones del Registro de Windows que controlan el cierre de Outlook y modificar, de forma activa, los complementos para que funcionen con Outlook.</span><span class="sxs-lookup"><span data-stu-id="18c1e-115">Add-in developers should evaluate the performance of their add-ins in various scenarios and under different Windows registry settings that control Outlook shutdown, and proactively modify their add-ins to work with Outlook.</span></span>

## <a name="recommendations-for-add-in-shutdown-for-it-administrators"></a><span data-ttu-id="18c1e-116">Recomendaciones sobre el cierre de complementos para programadores de TI</span><span class="sxs-lookup"><span data-stu-id="18c1e-116">Recommendations for Add-in Shutdown for IT Administrators</span></span>

<span data-ttu-id="18c1e-117">Para los administradores de TI, si hay complementos que ya se han implementado en una empresa y no se puede actualizar para ser compatibles con el nuevo mecanismo de cierre de Outlook, los administradores de TI pueden recurrir a un par de opciones de configuración del Registro de Windows para volver al comportamiento de cierre lento.</span><span class="sxs-lookup"><span data-stu-id="18c1e-117">For IT administrators, if there are add-ins that are already deployed in an enterprise and cannot be upgraded to become compatible with the new shutdown Outlook mechanism, IT administrators can resort to a couple of new Windows registry settings to revert to the slow shutdown behavior.</span></span>

### <a name="individual-add-in-setting"></a><span data-ttu-id="18c1e-118">Configuración de un complemento individual</span><span class="sxs-lookup"><span data-stu-id="18c1e-118">Individual Add-in Setting</span></span>

<span data-ttu-id="18c1e-p104">Los administradores de TI pueden habilitar notificaciones de cierre para complementos individuales de Outlook como parte de la implementación del complemento. Aunque no puede hacerlo a través de una directiva de grupo, es útil si tiene requisitos de compatibilidad con versiones anteriores para complementos específicos.</span><span class="sxs-lookup"><span data-stu-id="18c1e-p104">IT administrators can enable shutdown notifications to individual Outlook add-ins as part of the add-in deployment. Although you cannot do this through group policy, it is useful if you have backward-compatibility requirements for specific add-ins.</span></span>

<span data-ttu-id="18c1e-p105">Configure este valor para cada complemento mediante el registro de complementos en los subárboles del Registro HKCU o HKLM, agregando un valor adicional al registro del complemento. Escriba el texto siguiente como una sola línea:</span><span class="sxs-lookup"><span data-stu-id="18c1e-p105">Configure this setting for each add-in through the add-in registration in the HKCU or the HKLM registry hives, by adding an additional value to the add-in registration. Type the following text as a single line:</span></span>

`HKCU\Software\Microsoft\Office\Outlook\Add-ins\<ProgID>[RequireShutdownNotification]=dword:0x1`

<span data-ttu-id="18c1e-123">Establecer este valor en 0x1 habilita el complemento para recibir callbacks bloqueadas durante el cierre de Outlook.</span><span class="sxs-lookup"><span data-stu-id="18c1e-123">Setting this value to 0x1 enables the add-in to receive blocked callbacks during Outlook shutdown.</span></span> <span data-ttu-id="18c1e-124">Esto influye en el rendimiento del cierre de Outlook y se debe evaluar como parte de una implementación.</span><span class="sxs-lookup"><span data-stu-id="18c1e-124">This has an impact on the performance of Outlook shutdown and should be evaluated as part of a deployment.</span></span> <span data-ttu-id="18c1e-125">Esta configuración solo debería usarse si un complemento tiene problemas de compatibilidad importantes con el nuevo mecanismo de cierre.</span><span class="sxs-lookup"><span data-stu-id="18c1e-125">This setting should be used only if an add-in has significant compatibility issues with the new shutdown mechanism.</span></span> <span data-ttu-id="18c1e-126">Si se establece este valor en 0x0, se usa el comportamiento predeterminado de Outlook.</span><span class="sxs-lookup"><span data-stu-id="18c1e-126">Setting AddinFastShutdownBehavior to 0x1 enables shutdown notifications for all add-ins. Setting the value to 0x0 uses the default behavior of ol14short.</span></span>

### <a name="global-setting"></a><span data-ttu-id="18c1e-127">Configuración global</span><span class="sxs-lookup"><span data-stu-id="18c1e-127">Global setting</span></span>

<span data-ttu-id="18c1e-128">Los administradores de TI pueden habilitar las notificaciones de cierre globalmente para todos los complementos mediante las directivas de grupo.</span><span class="sxs-lookup"><span data-stu-id="18c1e-128">IT administrators can enable shutdown notifications globally for all add-ins through group policy.</span></span> <span data-ttu-id="18c1e-129">Se recomienda para las organizaciones que tienen un gran número de soluciones internas o escritorios que necesitan implementar esta configuración para garantizar la compatibilidad durante una ejecución de Outlook.</span><span class="sxs-lookup"><span data-stu-id="18c1e-129">IT administrators can enable shutdown notifications globally for all add-ins through group policy. This is recommended for organizations that have a large number of internal solutions or desktops that need to deploy this setting to ensure compatibility during a rollout of ol14short.</span></span>

<span data-ttu-id="18c1e-130">Use esta opción para cambiar el mecanismo de cierre para que coincida con el usado en Outlook 2007.</span><span class="sxs-lookup"><span data-stu-id="18c1e-130">Use this setting to change the shutdown mechanism to match that used by Outlook 2007.</span></span> <span data-ttu-id="18c1e-131">Puede implementar la configuración mediante directivas de grupo, ya sea por usuario o por equipo.</span><span class="sxs-lookup"><span data-stu-id="18c1e-131">You can deploy the setting through group policy, either per user or per computer.</span></span> <span data-ttu-id="18c1e-132">Escriba lo siguiente en una sola línea:</span><span class="sxs-lookup"><span data-stu-id="18c1e-132">Type the following text as a single line:</span></span>

`HKCU\Policies\Microsoft\Office\Outlook\15.0\Options\Shutdown[AddinFastShutdownBehavior]=dword:0x1`

<span data-ttu-id="18c1e-133">Al establecer AddinFastShutdownBehavior en 0x1, se habilitan las notificaciones de cierre para todos los complementos. Si se establece el valor en 0x0, se usa el comportamiento predeterminado de Outlook.</span><span class="sxs-lookup"><span data-stu-id="18c1e-133">Setting AddinFastShutdownBehavior to 0x1 enables shutdown notifications for all add-ins. Setting the value to 0x0 uses the default behavior of ol14short.</span></span>

