---
title: Usar un dominio de aplicación independiente para evitar el bloqueo
TOCTitle: Using a separate application domain to avoid crashing
ms:assetid: 7fc6d1e5-7032-47a9-826f-6b5d3b43fef9
ms:mtpsurl: https://msdn.microsoft.com/library/office/bb623114(v=office.15)
ms:contentKeyID: 55119786
ms.date: 07/24/2014
mtps_version: v=office.15
ms.openlocfilehash: b397fa2ad37102e12a3a0cf569e74323391b8e86
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 10/04/2018
ms.locfileid: "25407257"
---
# <a name="using-a-separate-application-domain-to-avoid-crashing"></a><span data-ttu-id="348e3-102">Usar un dominio de aplicación independiente para evitar el bloqueo</span><span class="sxs-lookup"><span data-stu-id="348e3-102">Using a Separate Application Domain to Avoid Crashing</span></span>

<span data-ttu-id="348e3-p101">Los complementos administrados que implementan la interfaz **IDTExtensibility2** se cargan en el mismo dominio de aplicación predeterminado. Cuando se bloquea un complemento en el dominio de aplicación, puede provocar errores en otros complementos del mismo dominio de aplicación.</span><span class="sxs-lookup"><span data-stu-id="348e3-p101">Managed add-ins that implement the **IDTExtensibility2** interface are loaded into the same default application domain. When an add-in in the application domain crashes, it can cause other add-ins in the same application domain to fail as well.</span></span>

<span data-ttu-id="348e3-105">Para solucionar este problema, puede crear una corrección de compatibilidad (shim) para el complemento, para que el complemento pueda cargarse en su propio dominio de aplicación.</span><span class="sxs-lookup"><span data-stu-id="348e3-105">To work around this problem, you can create a shim for the add-in, so that the add-in can be loaded in its own application domain.</span></span> <span data-ttu-id="348e3-106">Una corrección de compatibilidad (shim) es una biblioteca de vínculos dinámicos no administrada escrita en C++.</span><span class="sxs-lookup"><span data-stu-id="348e3-106">A shim is an unmanaged dynamic link library written in C++.</span></span> <span data-ttu-id="348e3-107">Al usar una corrección de compatibilidad (shim), se registra la corrección de compatibilidad en lugar del complemento.</span><span class="sxs-lookup"><span data-stu-id="348e3-107">When you use a shim, you register the shim instead of the add-in.</span></span> <span data-ttu-id="348e3-108">Outlook carga la corrección de compatibilidad, y la corrección de compatibilidad carga el complemento para el cual se creó.</span><span class="sxs-lookup"><span data-stu-id="348e3-108">Outlook loads the shim, and the shim loads the add-in for which it was built.</span></span> <span data-ttu-id="348e3-109">Debe compilar y registrar una corrección de compatibilidad independiente para cada complemento.</span><span class="sxs-lookup"><span data-stu-id="348e3-109">You must build and register a separate shim for each add-in.</span></span> <span data-ttu-id="348e3-110">Para obtener más información sobre el desarrollo de correcciones de compatibilidad para complementos administrados, consulte [Isolating Office Extensions with the COM Shim Wizard](https://go.microsoft.com/fwlink/?linkid=89109) (Aislar extensiones de Office con el asistente COM Shim).</span><span class="sxs-lookup"><span data-stu-id="348e3-110">For more information about developing shims for managed add-ins, see [Isolating Office Extensions with the COM Shim Wizard](https://go.microsoft.com/fwlink/?linkid=89109).</span></span>

<span data-ttu-id="348e3-111">Otra alternativa para cargar el complemento en otro dominio de aplicación es desarrollar el complemento con Herramientas de desarrollo de Office en Visual Studio 2010, o una versión posterior de Developer Tools para Visual Studio</span><span class="sxs-lookup"><span data-stu-id="348e3-111">Another alternative to load your add-in into a separate application domain is to develop your add-in using Office development tools in Visual Studio 2010, or a later release of Office Developer Tools for Visual Studio.</span></span> <span data-ttu-id="348e3-112">Los complementos desarrollados por estas versiones de Office Developer Tools para Visual Studio no implementan la interfaz IDTExtensibility2, sino que usan la interfaz **IStartup**.</span><span class="sxs-lookup"><span data-stu-id="348e3-112">Add-ins developed by these versions of Office Developer Tools for Visual Studio do not implement the IDTExtensibility2 interface but use the **IStartup** interface.</span></span> <span data-ttu-id="348e3-113">Usan un cargador proporcionado por Visual Studio, AddinLoader.dll, que actúa como una corrección de compatibilidad genérica.</span><span class="sxs-lookup"><span data-stu-id="348e3-113">They use a loader provided by Visual Studio, AddinLoader.dll, which acts like a generic shim.</span></span> <span data-ttu-id="348e3-114">Outlook busca en el registro los complementos creados con Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="348e3-114">Outlook looks in the registry for add-ins created with Visual Studio.</span></span> 

<span data-ttu-id="348e3-115">Si Outlook encuentra estos complementos, Outlook inicia AddinLoader.dll, que a su vez inicia Visual Studio Tools para Office Runtime y transmite el manifiesto de aplicación a Visual Studio Tools para Office Runtime.</span><span class="sxs-lookup"><span data-stu-id="348e3-115">If Outlook finds such add-ins, Outlook starts AddinLoader.dll, which then starts the Visual Studio Tools for Office Runtime and relays the application manifest to the Visual Studio Tools for Office Runtime.</span></span> <span data-ttu-id="348e3-116">Después, Visual Studio Tools para Office Runtime carga cada complemento en un dominio de aplicación independiente.</span><span class="sxs-lookup"><span data-stu-id="348e3-116">The Visual Studio Tools for Office Runtime then loads each such add-in in a separate application domain.</span></span> <span data-ttu-id="348e3-117">Para obtener más información sobre cómo Visual Studio carga un complemento, vea [Architecture of Application-Level Add-Ins](https://msdn.microsoft.com/library/bb386298\(v=office.15\)) (Arquitectura de complementos del nivel de la aplicación).</span><span class="sxs-lookup"><span data-stu-id="348e3-117">For more information about how Visual Studio loads an add-in, see [Architecture of Application-Level Add-Ins](https://msdn.microsoft.com/library/bb386298\(v=office.15\)).</span></span>

