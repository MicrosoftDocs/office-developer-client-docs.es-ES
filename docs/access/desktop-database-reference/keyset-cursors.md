---
title: Cursores con conjunto de claves (referencia de escritorio de la base de datos de Access)
TOCTitle: Keyset Cursors
ms:assetid: 4b6e5f90-4413-4fb3-0a08-2cb89d3c61f7
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249236(v=office.15)
ms:contentKeyID: 48544690
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 7bdb03b4a205e1b4954e86368c3af4aa62f773b2
ms.sourcegitcommit: 19aca09c5812cfb98b68b5d4604dcaa814479df7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/09/2018
ms.locfileid: "25483302"
---
# <a name="keyset-cursors"></a><span data-ttu-id="9aedc-102">Cursores con conjunto de claves</span><span class="sxs-lookup"><span data-stu-id="9aedc-102">Keyset Cursors</span></span>


<span data-ttu-id="9aedc-103">**Se aplica a**: Access 2013 | Office 2013</span><span class="sxs-lookup"><span data-stu-id="9aedc-103">**Applies to**: Access 2013 | Office 2013</span></span>

<span data-ttu-id="9aedc-p101">El cursor con conjunto de claves proporciona una funcionalidad intermedia entre un cursor estático y uno dinámico en cuanto a su capacidad para detectar cambios. Del mismo modo que un cursor estático, no siempre detecta los cambios en la pertenencia y el orden del conjunto de resultados. Como un cursor dinámico, detecta cambios en los valores de filas del conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="9aedc-p101">The keyset cursor provides functionality between a static and a dynamic cursor in its ability to detect changes. Like a static cursor, it does not always detect changes to the membership and order of the result set. Like a dynamic cursor, it does detect changes to the values of rows in the result set.</span></span>

<span data-ttu-id="9aedc-p102">Los cursores controlados por conjuntos de claves se controlan mediante un conjunto de identificadores únicos (claves), que se conocen como el conjunto de claves. Las claves se generan a partir de un conjunto de columnas que identifican las filas del conjunto de resultados de manera exclusiva. El conjunto de claves es el conjunto de valores de clave de todas las filas devueltas por la instrucción de consulta.</span><span class="sxs-lookup"><span data-stu-id="9aedc-p102">Keyset-driven cursors are controlled by a set of unique identifiers (keys) known as the keyset. The keys are built from a set of columns that uniquely identify the rows in the result set. The keyset is the set of key values from all the rows returned by the query statement.</span></span>

<span data-ttu-id="9aedc-p103">Con cursores controlados por conjuntos de claves, se genera y se guarda una clave para cada fila del cursor, y se almacena en la estación de trabajo cliente o en el servidor. Cuando se obtiene acceso a cada fila, la clave almacenada se utiliza para recuperar los valores de datos actuales desde el origen de datos. En un cursor controlado por conjuntos de claves, la pertenencia al conjunto de resultados se paraliza cuando el conjunto de claves se llena completamente. Por lo tanto, las incorporaciones o actualizaciones que afectan a la pertenencia no forman parte del conjunto de resultados hasta que se vuelve a abrir.</span><span class="sxs-lookup"><span data-stu-id="9aedc-p103">With keyset-driven cursors, a key is built and saved for each row in the cursor and stored either on the client workstation or on the server. When you access each row, the stored key is used to fetch the current data values from the data source. In a keyset-driven cursor, result set membership is frozen when the keyset is fully populated. Thereafter, additions or updates that affect membership are not a part of the result set until it is reopened.</span></span>

<span data-ttu-id="9aedc-p104">Los cambios en valores de datos (realizados por el propietario del conjunto de claves o mediante otros procesos) se van haciendo visibles a medida que el usuario se desplaza por el conjunto de resultados. Las inserciones efectuadas fuera del cursor (mediante otros procesos) sólo se hacen visibles si se cierra el cursor y se vuelve a abrir. Las inserciones realizadas desde dentro del cursor están visibles al final del conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="9aedc-p104">Changes to data values (made either by the keyset owner or other processes) are visible as the user scrolls through the result set. Inserts made outside the cursor (by other processes) are visible only if the cursor is closed and reopened. Inserts made from inside the cursor are visible at the end of the result set.</span></span>

<span data-ttu-id="9aedc-p105">Cuando un cursor controlado por conjunto de claves intenta recuperar una fila que se ha eliminado, la fila aparece como un "hueco" en el conjunto de resultados. La clave para la fila existe en el conjunto de claves, pero la fila ya no existe en el conjunto de resultados. Si se actualizan los valores de clave de una fila, la fila se considera como eliminada y luego insertada, de forma que dichas filas también aparecen como huecos en el conjunto de resultados. Mientras que un cursor controlado por conjunto de claves siempre puede detectar filas eliminadas por otros procesos, puede quitar opcionalmente las claves correspondientes a las filas que elimina. Los cursores controlados por conjuntos de claves que actúan así no pueden detectar sus propias eliminaciones porque se ha borrado la prueba.</span><span class="sxs-lookup"><span data-stu-id="9aedc-p105">When a keyset-driven cursor attempts to retrieve a row that has been deleted, the row appears as a "hole" in the result set. The key for the row exists in the keyset, but the row no longer exists in the result set. If the key values in a row are updated, the row is considered to have been deleted and then inserted, so such rows also appear as holes in the result set. While a keyset-driven cursor can always detect rows deleted by other processes, it can optionally remove the keys for rows it deletes itself. Keyset-driven cursors that do this cannot detect their own deletes because the evidence has been removed.</span></span>

<span data-ttu-id="9aedc-p106">Una actualización de una columna de clave funciona como una eliminación de la clave antigua seguida de una inserción de la clave nueva. El nuevo valor de clave no está visible si la actualización no se ha realizado a través del cursor. Si la actualización se efectuó a través del cursor, el nuevo valor de clave aparece visible al final del conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="9aedc-p106">An update to a key column operates like a delete of the old key followed by an insert of the new key. The new key value is not visible if the update was not made through the cursor. If the update was made through the cursor, the new key value is visible at the end of the result set.</span></span>

<span data-ttu-id="9aedc-p107">Hay una variación de los cursores controlados por conjuntos de claves, que son los denominados cursores estándar controlados por conjuntos de claves. En un cursor estándar controlado por conjunto de claves, la pertenencia de filas al conjunto de resultados y el orden de las filas son fijos en el momento de abrirse el cursor, pero los cambios en valores que realiza el propietario del cursor y los cambios confirmados realizados por otros procesos están visibles. Si un cambio descalifica a una fila para la pertenencia o si afecta al orden de una fila, la fila no desaparece ni se mueve a menos que se cierre el cursor y se vuelva a abrir. Los datos insertados no aparecen, pero los cambios en datos existentes sí que aparecen cuando se recuperan las filas.</span><span class="sxs-lookup"><span data-stu-id="9aedc-p107">There is a variation on keyset-driven cursors called keyset-driven standard cursors. In a keyset-driven standard cursor, the membership of rows in the result set and the order of the rows are fixed at cursor open time, but changes to values that are made by the cursor owner and committed changes made by other processes are visible. If a change disqualifies a row for membership or affects the order of a row, the row does not disappear or move unless the cursor is closed and reopened. Inserted data does not appear, but changes to existing data do appear as the rows are fetched.</span></span>

<span data-ttu-id="9aedc-p108">Es difícil utilizar correctamente el cursor controlado por conjunto de claves, puesto que la sensibilidad a los cambios en los datos depende de muchas circunstancias diferentes, como se ha indicado anteriormente. Sin embargo, si a una aplicación no le afectan las actualizaciones simultáneas, si puede controlar claves incorrectas mediante programación y si debe obtener acceso directamente a ciertas filas con clave, el cursor controlado por conjunto de claves podría funcionar. Utilice el valor **adOpenKeyset** de **CursorTypeEnum** para indicar que desea utilizar un cursor con conjunto de claves en ADO.</span><span class="sxs-lookup"><span data-stu-id="9aedc-p108">The keyset-driven cursor is difficult to use correctly because the sensitivity to data changes depends on many differing circumstances, as described above. However, if your application is not concerned with concurrent updates, can programmatically handle bad keys, and must directly access certain keyed rows, the keyset-driven cursor might work for you. Use the **adOpenKeyset** **CursorTypeEnum** to indicate that you want to use a keyset cursor in ADO.</span></span>

