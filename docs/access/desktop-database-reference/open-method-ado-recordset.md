---
title: Open (método, Recordset de ADO)
TOCTitle: Open method (ADO Recordset)
ms:assetid: 87ef19a4-28e1-dec7-ed33-4ae500b9c460
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249591(v=office.15)
ms:contentKeyID: 48546119
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: e5f8dbdfa61a671e2efb9aac2596cfda5cd1727b
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: Auto
ms.contentlocale: es-ES
ms.lasthandoff: 01/17/2019
ms.locfileid: "28701833"
---
# <a name="open-method-ado-recordset"></a><span data-ttu-id="cac5e-102">Open (método, Recordset de ADO)</span><span class="sxs-lookup"><span data-stu-id="cac5e-102">Open method (ADO Recordset)</span></span>

<span data-ttu-id="cac5e-103">**Se aplica a**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="cac5e-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="cac5e-104">Abre un cursor.</span><span class="sxs-lookup"><span data-stu-id="cac5e-104">Opens a cursor.</span></span>

## <a name="syntax"></a><span data-ttu-id="cac5e-105">Sintaxis</span><span class="sxs-lookup"><span data-stu-id="cac5e-105">Syntax</span></span>

<span data-ttu-id="cac5e-106">*conjunto de registros*. Abrir*origen*, *ActiveConnection*, *CursorType*, *LockType*, *Opciones*</span><span class="sxs-lookup"><span data-stu-id="cac5e-106">*recordset*.Open*Source*, *ActiveConnection*, *CursorType*, *LockType*, *Options*</span></span>

## <a name="parameters"></a><span data-ttu-id="cac5e-107">Parámetros</span><span class="sxs-lookup"><span data-stu-id="cac5e-107">Parameters</span></span>

|<span data-ttu-id="cac5e-108">Parámetro</span><span class="sxs-lookup"><span data-stu-id="cac5e-108">Parameter</span></span>|<span data-ttu-id="cac5e-109">Descripción</span><span class="sxs-lookup"><span data-stu-id="cac5e-109">Description</span></span>|
|:--------|:----------|
|<span data-ttu-id="cac5e-110">*Source*</span><span class="sxs-lookup"><span data-stu-id="cac5e-110">*Source*</span></span> |<span data-ttu-id="cac5e-p101">Es opcional. Valor de tipo **Variant** que da como resultado un objeto [Command](command-object-ado.md) válido, una instrucción SQL, un nombre de tabla, una llamada a un procedimiento almacenado, una dirección URL, o bien el nombre de un archivo u objeto [Stream](stream-object-ado.md) que contiene un objeto [Recordset](recordset-object-ado.md) almacenado de manera persistente.</span><span class="sxs-lookup"><span data-stu-id="cac5e-p101">Optional. A **Variant** that evaluates to a valid [Command](command-object-ado.md) object, an SQL statement, a table name, a stored procedure call, a URL, or the name of a file or [Stream](stream-object-ado.md) object containing a persistently stored [Recordset](recordset-object-ado.md).</span></span>|
|<span data-ttu-id="cac5e-113">*ActiveConnection*</span><span class="sxs-lookup"><span data-stu-id="cac5e-113">*ActiveConnection*</span></span> |<span data-ttu-id="cac5e-p102">Es opcional. Valor de tipo **Variant** que da como resultado una variable de objeto [Connection](connection-object-ado.md) válida o valor de tipo **String** que contiene los parámetros [ConnectionString](connectionstring-property-ado.md).</span><span class="sxs-lookup"><span data-stu-id="cac5e-p102">Optional. Either a **Variant** that evaluates to a valid [Connection](connection-object-ado.md) object variable name, or a **String** that contains [ConnectionString](connectionstring-property-ado.md) parameters.</span></span>|
|<span data-ttu-id="cac5e-116">*CursorType*</span><span class="sxs-lookup"><span data-stu-id="cac5e-116">*CursorType*</span></span> |<span data-ttu-id="cac5e-p103">Es opcional. Valor de [CursorTypeEnum](cursortypeenum.md) que determina el tipo de cursor que el proveedor debe usar cuando se abre el objeto **Recordset**. El valor predeterminado es **adOpenForwardOnly**.</span><span class="sxs-lookup"><span data-stu-id="cac5e-p103">Optional. A [CursorTypeEnum](cursortypeenum.md) value that determines the type of cursor that the provider should use when opening the **Recordset**. The default value is **adOpenForwardOnly**.</span></span>|
|<span data-ttu-id="cac5e-120">*LockType*</span><span class="sxs-lookup"><span data-stu-id="cac5e-120">*LockType*</span></span> |<span data-ttu-id="cac5e-p104">Es opcional. Valor de [LockTypeEnum](locktypeenum.md) que determina el tipo de bloqueo (concurrencia) que el proveedor debe utilizar cuando se abre el objeto **Recordset**. El valor predeterminado es **adLockReadOnly**.</span><span class="sxs-lookup"><span data-stu-id="cac5e-p104">Optional. A [LockTypeEnum](locktypeenum.md) value that determines what type of locking (concurrency) the provider should use when opening the **Recordset**. The default value is **adLockReadOnly**.</span></span>|
|<span data-ttu-id="cac5e-124">*Options*</span><span class="sxs-lookup"><span data-stu-id="cac5e-124">*Options*</span></span> |<span data-ttu-id="cac5e-125">Es opcional.</span><span class="sxs-lookup"><span data-stu-id="cac5e-125">Optional.</span></span> <span data-ttu-id="cac5e-126">Un valor de **tipo Long** que indica cómo debe evaluar el proveedor el argumento *Source* si representa algo distinto de un objeto **Command** , o que el **objeto Recordset** debe restaurarse desde un archivo donde se guardó anteriormente.</span><span class="sxs-lookup"><span data-stu-id="cac5e-126">A **Long** value that indicates how the provider should evaluate the *Source* argument if it represents something other than a **Command** object, or that the **Recordset** should be restored from a file where it was previously saved.</span></span> <span data-ttu-id="cac5e-127">Puede ser uno o varios valores de [CommandTypeEnum](commandtypeenum.md) o [ExecuteOptionEnum](executeoptionenum.md), que se pueden combinar con un operador AND bit a bit.</span><span class="sxs-lookup"><span data-stu-id="cac5e-127">Can be one or more [CommandTypeEnum](commandtypeenum.md) or [ExecuteOptionEnum](executeoptionenum.md) values, which can be combined with a bitwise AND operator.</span></span>|

> [!NOTE]
> <span data-ttu-id="cac5e-128">[!NOTA] Si abre un objeto **Recordset** de un objeto **Stream** que contiene un objeto **Recordset** almacenado, el uso del valor **adAsyncFetchNonBlocking** de **ExecuteOptionEnum** no tendrá ningún efecto; la recuperación será sincrónica y de bloqueo.</span><span class="sxs-lookup"><span data-stu-id="cac5e-128">If you open a **Recordset** from a **Stream** containing a persisted **Recordset**, using an **ExecuteOptionEnum** value of **adAsyncFetchNonBlocking** will not have an effect; the fetch will be synchronous and blocking.</span></span>

<span data-ttu-id="cac5e-129">Los valores **adExecuteNoRecords** y **adExecuteStream** de **ExecuteOpenEnum** no deben utilizarse con **Open**.</span><span class="sxs-lookup"><span data-stu-id="cac5e-129">The **ExecuteOpenEnum** values of **adExecuteNoRecords** or **adExecuteStream** should not be used with **Open**.</span></span>

## <a name="remarks"></a><span data-ttu-id="cac5e-130">Comentarios</span><span class="sxs-lookup"><span data-stu-id="cac5e-130">Remarks</span></span>

<span data-ttu-id="cac5e-131">El cursor predeterminado de un objeto **Recordset** de ADO es un cursor de sólo avance y de sólo lectura ubicado en el servidor.</span><span class="sxs-lookup"><span data-stu-id="cac5e-131">The default cursor for an ADO **Recordset** is a forward-only, read-only cursor located on the server.</span></span>

<span data-ttu-id="cac5e-132">Si se utiliza el método **Open** en un objeto **Recordset**, se abre un cursor que representa los registros de una tabla base, los resultados de una consulta o un objeto **Recordset** anteriormente guardado.</span><span class="sxs-lookup"><span data-stu-id="cac5e-132">Using the **Open** method on a **Recordset** object opens a cursor that represents records from a base table, the results of a query, or a previously saved **Recordset**.</span></span>

<span data-ttu-id="cac5e-133">Use el argumento *Source* opcional para especificar un origen de datos mediante uno de los siguientes: una variable del objeto **Command** , una instrucción SQL, un procedimiento almacenado, un nombre de tabla, una dirección URL o un nombre de ruta de acceso completa del archivo.</span><span class="sxs-lookup"><span data-stu-id="cac5e-133">Use the optional *Source* argument to specify a data source using one of the following: a **Command** object variable, an SQL statement, a stored procedure, a table name, a URL, or a complete file path name.</span></span> <span data-ttu-id="cac5e-134">Si el *origen* es un nombre de ruta de acceso de archivo, puede ser una ruta de acceso completa ("c:\\dir\\file.rst"), una ruta de acceso relativa ("... \\file.rst "), o una dirección URL ("https://files/file.rst").</span><span class="sxs-lookup"><span data-stu-id="cac5e-134">If *Source* is a file path name, it can be a full path ("c:\\dir\\file.rst"), a relative path ("..\\file.rst"), or a URL ("https://files/file.rst").</span></span>

<span data-ttu-id="cac5e-135">No es una buena idea utilizar el argumento *Source* del método **Open** para realizar una consulta de acción que no devuelve registros porque no hay ninguna forma sencilla de determinar si la llamada se ha realizado correctamente.</span><span class="sxs-lookup"><span data-stu-id="cac5e-135">It is not a good idea to use the *Source* argument of the **Open** method to perform an action query that doesnt return records because there is no easy way to determine whether the call succeeded.</span></span> <span data-ttu-id="cac5e-136">El objeto **Recordset** devuelto por esa consulta se cerrará.</span><span class="sxs-lookup"><span data-stu-id="cac5e-136">The **Recordset** returned by such a query will be closed.</span></span> <span data-ttu-id="cac5e-137">Llame al método [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) de un objeto **Command** o al método [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-connection) de un objeto **Connection** para realizar una consulta que no devuelve registros, como una instrucción SQL INSERT.</span><span class="sxs-lookup"><span data-stu-id="cac5e-137">Call the [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) method of a **Command** object or the [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-connection) method of a **Connection** object instead to perform a query that, such as a SQL INSERT statement, that doesnt return records.</span></span>

<span data-ttu-id="cac5e-138">El argumento *ActiveConnection* corresponde a la propiedad [ActiveConnection](activeconnection-property-ado.md) y especifica en qué conexión para abrir el **conjunto de registros** del objeto.</span><span class="sxs-lookup"><span data-stu-id="cac5e-138">The *ActiveConnection* argument corresponds to the [ActiveConnection](activeconnection-property-ado.md) property and specifies in which connection to open the **Recordset** object.</span></span> <span data-ttu-id="cac5e-139">Si pasa una definición de conexión para este argumento, ADO abre una conexión nueva con los parámetros especificados.</span><span class="sxs-lookup"><span data-stu-id="cac5e-139">If you pass a connection definition for this argument, ADO opens a new connection using the specified parameters.</span></span> <span data-ttu-id="cac5e-140">Después de abrir el **objeto Recordset** con un cursor de cliente (**CursorLocation** = **adUseClient**), puede cambiar el valor de esta propiedad para enviar actualizaciones a otro proveedor.</span><span class="sxs-lookup"><span data-stu-id="cac5e-140">After opening the **Recordset** with a client-side cursor (**CursorLocation** = **adUseClient**), you can change the value of this property to send updates to another provider.</span></span> <span data-ttu-id="cac5e-141">O bien, puede establecer el valor de esta propiedad en **Nothing** (en Microsoft Visual Basic) o en NULL para desconectar el objeto **Recordset** de todos los proveedores.</span><span class="sxs-lookup"><span data-stu-id="cac5e-141">Or you can set this property to **Nothing** (in Microsoft Visual Basic) or NULL to disconnect the **Recordset** from any provider.</span></span> <span data-ttu-id="cac5e-142">Sin embargo, si se cambia el valor de **ActiveConnection** en el caso de un cursor de servidor, se generará un error.</span><span class="sxs-lookup"><span data-stu-id="cac5e-142">Changing **ActiveConnection** for a server-side cursor generates an error, however.</span></span>

<span data-ttu-id="cac5e-143">Para los demás argumentos que se corresponden directamente con las propiedades de un objeto **Recordset** (*Source*, *CursorType* y *LockType*), la relación entre los argumentos y las propiedades es la siguiente:</span><span class="sxs-lookup"><span data-stu-id="cac5e-143">For the other arguments that correspond directly to properties of a **Recordset** object (*Source*, *CursorType*, and *LockType*), the relationship of the arguments to the properties is as follows:</span></span>

- <span data-ttu-id="cac5e-144">La propiedad es de lectura y de escritura antes de abrirse el objeto **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="cac5e-144">The property is read/write before the **Recordset** object is opened.</span></span>

- <span data-ttu-id="cac5e-p109">Se utilizan los valores de configuración de las propiedades, a menos que se pasen los argumentos correspondientes cuando se ejecute el método **Open**. Si se pasa un argumento, éste invalida el valor de la propiedad correspondiente y el valor de la propiedad se actualiza con el valor del argumento.</span><span class="sxs-lookup"><span data-stu-id="cac5e-p109">The property settings are used unless you pass the corresponding arguments when executing the **Open** method. If you pass an argument, it overrides the corresponding property setting, and the property setting is updated with the argument value.</span></span>

- <span data-ttu-id="cac5e-147">Una vez abierto el objeto **Recordset**, estas propiedades son de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="cac5e-147">After you open the **Recordset** object, these properties become read-only.</span></span>

> [!NOTE]
> <span data-ttu-id="cac5e-148">[!NOTA] La propiedad **ActiveConnection** es de sólo lectura para los objetos **Recordset** cuya propiedad [Source](source-property-ado-recordset.md) esté establecida en un objeto **Command** válido, incluso si no está abierto el objeto **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="cac5e-148">The **ActiveConnection** property is read only for **Recordset** objects whose [Source](source-property-ado-recordset.md) property is set to a valid **Command** object, even if the **Recordset** object isn't open.</span></span>

<span data-ttu-id="cac5e-149">Si se pasa un objeto **Command** en el argumento *Source* y también pasa un argumento *ActiveConnection* , se produce un error.</span><span class="sxs-lookup"><span data-stu-id="cac5e-149">If you pass a **Command** object in the *Source* argument and also pass an *ActiveConnection* argument, an error occurs.</span></span> <span data-ttu-id="cac5e-150">La propiedad **ActiveConnection** del objeto **Command** ya debe estar establecida en un objeto **Connection** válido o en una cadena de conexión válida.</span><span class="sxs-lookup"><span data-stu-id="cac5e-150">The **ActiveConnection** property of the **Command** object must already be set to a valid **Connection** object or connection string.</span></span>

<span data-ttu-id="cac5e-151">Si se pasa un valor distinto de un objeto **Command** en el argumento *Source* , puede usar el argumento *Options* para optimizar la evaluación del argumento *origen* .</span><span class="sxs-lookup"><span data-stu-id="cac5e-151">If you pass something other than a **Command** object in the *Source* argument, you can use the *Options* argument to optimize evaluation of the *Source* argument.</span></span> <span data-ttu-id="cac5e-152">Si no se ha definido el argumento *Options* , puede experimentar una disminución del rendimiento porque ADO debe realizar llamadas al proveedor para determinar si el argumento es una instrucción SQL, un procedimiento almacenado, una dirección URL o un nombre de tabla.</span><span class="sxs-lookup"><span data-stu-id="cac5e-152">If the *Options* argument is not defined, you may experience diminished performance because ADO must make calls to the provider to determine if the argument is an SQL statement, a stored procedure, a URL, or a table name.</span></span> <span data-ttu-id="cac5e-153">Si se conoce el tipo de *origen* , la configuración del argumento *Options* indica a ADO que salte directamente al código relevante.</span><span class="sxs-lookup"><span data-stu-id="cac5e-153">If you know what *Source* type you're using, setting the *Options* argument instructs ADO to jump directly to the relevant code.</span></span> <span data-ttu-id="cac5e-154">Si el argumento *Options* no coincide con el tipo de *origen* , se produce un error.</span><span class="sxs-lookup"><span data-stu-id="cac5e-154">If the *Options* argument does not match the *Source* type, an error occurs.</span></span>

<span data-ttu-id="cac5e-155">Si se pasa un objeto **Stream** en el argumento *Source* , no debe pasarse información en los demás argumentos.</span><span class="sxs-lookup"><span data-stu-id="cac5e-155">If you pass a **Stream** object in the *Source* argument, you should not pass information into the other arguments.</span></span> <span data-ttu-id="cac5e-156">En caso contrario, se generará un error.</span><span class="sxs-lookup"><span data-stu-id="cac5e-156">Doing so will generate an error.</span></span> <span data-ttu-id="cac5e-157">La información de **ActiveConnection** no se conserva cuando se abre un objeto **Recordset** de un objeto **Stream**.</span><span class="sxs-lookup"><span data-stu-id="cac5e-157">The **ActiveConnection** information is not retained when a **Recordset** is opened from a **Stream**.</span></span>

<span data-ttu-id="cac5e-158">**AdCmdFile** es el valor predeterminado para el argumento *Options* si no hay ninguna conexión está asociada con el **conjunto de registros**.</span><span class="sxs-lookup"><span data-stu-id="cac5e-158">The default for the *Options* argument is **adCmdFile** if no connection is associated with the **Recordset**.</span></span> <span data-ttu-id="cac5e-159">Este suele ser el caso para los objetos **Recordset** almacenados de manera persistente.</span><span class="sxs-lookup"><span data-stu-id="cac5e-159">This will typically be the case for persistently stored **Recordset** objects.</span></span>

<span data-ttu-id="cac5e-p114">Si el origen de datos no devuelve ningún registro, el proveedor establece las propiedades [BOF](bof-eof-properties-ado.md) y [EOF](bof-eof-properties-ado.md) en **True**, y la posición de registro actual está sin definir. Se pueden agregar datos nuevos a este objeto **Recordset** vacío si el tipo de cursor lo permite.</span><span class="sxs-lookup"><span data-stu-id="cac5e-p114">If the data source returns no records, the provider sets both the [BOF](bof-eof-properties-ado.md) and [EOF](bof-eof-properties-ado.md) properties to **True**, and the current record position is undefined. You can still add new data to this empty **Recordset** object if the cursor type allows it.</span></span>

<span data-ttu-id="cac5e-p115">Una vez finalizadas las operaciones en un objeto **Recordset** abierto, use el método [Close](close-method-ado.md) para liberar los recursos del sistema asociados. Cerrar un objeto no lo quita de la memoria; puede cambiar los valores de sus propiedades y volver a abrirlo más adelante mediante el método **Open**. Para eliminar completamente un objeto de la memoria, establezca el valor de la variable del objeto en *Nothing*.</span><span class="sxs-lookup"><span data-stu-id="cac5e-p115">When you have concluded your operations over an open **Recordset** object, use the [Close](close-method-ado.md) method to free any associated system resources. Closing an object does not remove it from memory; you can change its property settings and use the **Open** method to open it again later. To completely eliminate an object from memory, set the object variable to *Nothing*.</span></span>

<span data-ttu-id="cac5e-165">Antes de establece la propiedad **ActiveConnection** , llame a **Open** sin operandos para crear una instancia de un **objeto Recordset** creado anexando campos a la colección de [campos](fields-collection-ado.md) del **objeto Recordset** .</span><span class="sxs-lookup"><span data-stu-id="cac5e-165">Before the **ActiveConnection** property is set, call **Open** with no operands to create an instance of a **Recordset** created by appending fields to the **Recordset** [Fields](fields-collection-ado.md) collection.</span></span>

<span data-ttu-id="cac5e-166">Si el valor de la propiedad [CursorLocation](cursorlocation-property-ado.md) es **adUseClient**, se pueden recuperar las filas asincrónicamente de una sola manera.</span><span class="sxs-lookup"><span data-stu-id="cac5e-166">If you have set the [CursorLocation](cursorlocation-property-ado.md) property to **adUseClient**, you can retrieve rows asynchronously in one of two ways.</span></span> <span data-ttu-id="cac5e-167">Es el método recomendado establecer *las opciones* en **adAsyncFetch**.</span><span class="sxs-lookup"><span data-stu-id="cac5e-167">The recommended method is to set *Options* to **adAsyncFetch**.</span></span> <span data-ttu-id="cac5e-168">Asimismo, se puede utilizar la propiedad dinámica "Asynchronous Rowset Processing" de la colección [Properties](properties-collection-ado.md), pero se pueden perder los eventos recuperados relacionados si no se establece el valor del parámetro **Options** en **adAsyncFetch**.</span><span class="sxs-lookup"><span data-stu-id="cac5e-168">Alternatively, you can use the "Asynchronous Rowset Processing" dynamic property in the [Properties](properties-collection-ado.md) collection, but related retrieved events can be lost if you do not set the **Options** parameter to **adAsyncFetch**.</span></span>

> [!NOTE]
> <span data-ttu-id="cac5e-169">Recuperación en segundo plano en el proveedor MS Remote se admite sólo a través del parámetro *Options* del método **Open** .</span><span class="sxs-lookup"><span data-stu-id="cac5e-169">Background fetching in the MS Remote provider is supported only through the **Open** method's *Options* parameter.</span></span>

> [!NOTE]
> <span data-ttu-id="cac5e-170">[!NOTA] Las direcciones URL que utilicen el esquema http invocarán automáticamente [Microsoft OLE DB Provider for Internet Publishing](microsoft-ole-db-provider-for-internet-publishing.md).</span><span class="sxs-lookup"><span data-stu-id="cac5e-170">URLs using the http scheme will automatically invoke the [Microsoft OLE DB Provider for Internet Publishing](microsoft-ole-db-provider-for-internet-publishing.md).</span></span> <span data-ttu-id="cac5e-171">Para obtener más información, vea [direcciones URL absolutas y relativas](absolute-and-relative-urls.md).</span><span class="sxs-lookup"><span data-stu-id="cac5e-171">For more information, see [Absolute and relative URLs](absolute-and-relative-urls.md).</span></span>


