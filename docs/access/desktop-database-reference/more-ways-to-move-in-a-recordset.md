---
title: Más formas de moverse en un conjunto de registros
TOCTitle: More ways to move in a Recordset
ms:assetid: ae49b20e-0050-c44b-67e9-7e39de5098c4
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249822(v=office.15)
ms:contentKeyID: 48547067
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 2d10a493aac39934a047c6fa311233fd6c9fac4e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288865"
---
# <a name="more-ways-to-move-in-a-recordset"></a><span data-ttu-id="501bc-102">Más formas de moverse en un conjunto de registros</span><span class="sxs-lookup"><span data-stu-id="501bc-102">More ways to move in a Recordset</span></span>

<span data-ttu-id="501bc-103">**Se aplica a:** Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="501bc-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="501bc-p101">Los cuatro métodos siguientes sirven para moverse o desplazarse por el **conjunto de registros**: [MoveFirst, MoveLast, MoveNext y MovePrevious](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) (algunos de estos métodos no están disponibles con cursores de sólo avance).</span><span class="sxs-lookup"><span data-stu-id="501bc-p101">The following four methods are used to move around, or scroll, in the **Recordset**: [MoveFirst, MoveLast, MoveNext, and MovePrevious](movefirst-movelast-movenext-and-moveprevious-methods-ado.md). (Some of these methods are unavailable on forward-only cursors.)</span></span>

<span data-ttu-id="501bc-p102">**MoveFirst** cambia la posición del registro activo al primer registro del **conjunto de registros**. **MoveLast** cambia la posición del registro activo al último registro del **conjunto de registros**. Para utilizar **MoveFirst** o **MoveLast**, el objeto **Recordset** debe admitir marcadores o movimiento de cursor hacia atrás; de lo contrario, la llamada al método generará un error.</span><span class="sxs-lookup"><span data-stu-id="501bc-p102">**MoveFirst** changes the current record position to the first record in the **Recordset**. **MoveLast** changes the current record position to the last record in the **Recordset**. To use **MoveFirst** or **MoveLast**, the **Recordset** object must support bookmarks or backward cursor movement; otherwise, the method call will generate an error.</span></span>

<span data-ttu-id="501bc-p103">**MoveNext** hace avanzar una posición el registro activo. Si está en el último registro cuando llama a **MoveNext**, **EOF** se establece en **True**. **MovePrevious** hace retroceder una posición el registro activo. Si está en el primer registro cuando llama a **MovePrevious**, **BOF** se establece en **True**. Es aconsejable revisar las propiedades **EOF** y **BOF** cuando se utilizan estos métodos y devolver el cursor a una posición válida de registro activo si se sale de cualquier extremo del **conjunto de registros**, como se muestra aquí:</span><span class="sxs-lookup"><span data-stu-id="501bc-p103">**MoveNext** moves the current record position one place forward. If you are on the last record when you call **MoveNext**, **EOF** will be set to **True**. **MovePrevious** moves the current record position one place backward. If you are on the first record when you call **MovePrevious**, **BOF** will be set to **True**. It is wise to check the **EOF** and **BOF** properties when using these methods and to move the cursor back to a valid current record position if you move off either end of the **Recordset**, as shown here:</span></span>

```vb
. . . 
oRs.MoveNext 
If oRs.EOF Then oRs.MoveLast 
. . . 
```

<span data-ttu-id="501bc-114">O, en el caso del método **MovePrevious**:</span><span class="sxs-lookup"><span data-stu-id="501bc-114">Or, in the case of the **MovePrevious** method:</span></span>

```vb
. . . 
oRs.MovePrevious 
If oRs.BOF Then oRs.MoveFirst 
. . . 
```

<span data-ttu-id="501bc-115">En casos en los que se filtra u ordena el **conjunto de registros** y se cambian los datos del registro activo, es posible que también cambie la posición.</span><span class="sxs-lookup"><span data-stu-id="501bc-115">In cases where the **Recordset** has been filtered or sorted and the current record's data is changed, the position may also change.</span></span> <span data-ttu-id="501bc-116">En estos casos, el método **MoveNext** funciona normalmente, pero hay que tener en cuenta que la posición ha avanzado un registro respecto a la nueva posición, no respecto a la antigua.</span><span class="sxs-lookup"><span data-stu-id="501bc-116">In such cases the **MoveNext** method works normally, but be aware that the position is moved one record forward from the new position, not the old position.</span></span> <span data-ttu-id="501bc-117">Por ejemplo, si se cambian los datos en el registro activo, de modo que el registro se mueve al final del **objeto Recordset**ordenado, significaría que llamar a **MoveNext** da como resultado ADO el valor del registro activo en la posición posterior al último registro **del Recordset** (**EOF** = **true**).</span><span class="sxs-lookup"><span data-stu-id="501bc-117">For example, changing the data in the current record, such that the record is moved to the end of the sorted **Recordset**, would mean that calling **MoveNext** results in ADO setting the current record to the position after the last record in the **Recordset** (**EOF** = **True**).</span></span>

<span data-ttu-id="501bc-p105">El comportamiento de los diversos métodos Move del objeto **Recordset** depende, hasta cierto punto, de los datos contenidos en el **conjunto de registros**. Los nuevos registros agregados al **conjunto de registros** se agregan inicialmente en un orden determinado, que define el origen de datos y que puede depender implícita o explícitamente de los datos del nuevo registro. Por ejemplo, si se realiza una ordenación o una combinación dentro de la consulta que rellena el **conjunto de registros**, el nuevo registro se insertará en la posición apropiada en el **conjunto de registros**. Si la ordenación no se especifica explícitamente al crear el **conjunto de registros**, los cambios en la implementación del origen de datos podrían provocar que la ordenación de las filas devueltas cambiase inadvertidamente. Además, las funciones de ordenación, filtro y edición del **conjunto de registros** pueden afectar al orden y, posiblemente, a las filas del conjunto de registros que estarán visibles.</span><span class="sxs-lookup"><span data-stu-id="501bc-p105">The behavior of the various Move methods of the **Recordset** object depends, to some extent, on the data within the **Recordset**. New records added to the **Recordset** are initially added in a particular order, which is defined by the data source and may be dependent implicitly or explicitly on the data in the new record. For example, if a sort or a join is done within the query that populates the **Recordset**, the new record will be inserted in the appropriate place within the **Recordset**. If ordering is not explicitly specified when creating the **Recordset**, changes in the data source implementation may cause the ordering of the returned rows to change inadvertently. In addition, the sorting, filtering, and editing functions of the **Recordset** can affect the order and possibly which rows in the recordset will be visible.</span></span>

<span data-ttu-id="501bc-p106">Por lo tanto, a los métodos **MoveNext**, **MovePrevious**, **MoveFirst**, **MoveLast** y **Move** les afectan otras operaciones que se realicen con el mismo **conjunto de registros**. ADO siempre tratará de mantener la posición activa hasta que usted la mueva explícitamente, pero algunos cambios que se efectúen pueden hacer que resulte difícil comprender los efectos de un movimiento posterior. Por ejemplo, si se llama a **MoveFirst** para colocarse en la primera fila de un **conjunto de registros** ordenado y se cambia la ordenación de ascendente a descendente, se seguirá estando en la misma fila, pero ahora será la última del **conjunto de registros**. **MoveFirst** le llevará a otra fila (la nueva primera fila).</span><span class="sxs-lookup"><span data-stu-id="501bc-p106">Therefore, **MoveNext**, **MovePrevious**, **MoveFirst**, **MoveLast**, and **Move** are all sensitive to other operations performed on the same **Recordset**. ADO will always try to maintain your current position until you explicitly move it, but sometimes intervening changes make it difficult to understand the effects of a subsequent move. For example, if you call **MoveFirst** to position on the first row of a sorted **Recordset** and you change the sort from ascending order to descending order, you are still on the same row — but now it is the last row in the **Recordset**. **MoveFirst** will take you to a different row (the new first row).</span></span>

<span data-ttu-id="501bc-p107">Otro ejemplo: si usted se sitúa en una fila determinada en medio de un **conjunto de registros** y llama a **Delete** y, a continuación, llama a **MoveNext**, pasará a estar en el registro inmediatamente posterior al registro eliminado. Pero si llama a **MovePrevious**, el registro anterior al que se ha eliminado pasará a ser el registro activo, puesto que el registro eliminado ya no se considera perteneciente al **conjunto de registros**.</span><span class="sxs-lookup"><span data-stu-id="501bc-p107">As another example, if you are positioned on a particular row in the middle of a **Recordset** and you call **Delete** and then call **MoveNext**, you are now on the record immediately following the deleted record. But calling **MovePrevious** makes the record preceding the one you deleted the current record, because the deleted record is no longer counted in the active membership of the **Recordset**.</span></span>

<span data-ttu-id="501bc-p108">Resulta especialmente complicado definir incoherentemente la semántica de movimientos para todos los proveedores, para métodos que realizan desplazamientos respecto al registro activo (**MovePrevious**, **MoveNext** y **Move**) frente a cambiar datos del registro activo. Por ejemplo, si trabaja con un **conjunto de registros** ordenado y filtrado y cambia los datos del registro activo para que preceda a todos los demás registros, pero además, los datos modificados ya no coinciden con el filtro, no queda claro dónde le llevará una operación **MoveNext**. La conclusión más cierta es que el movimiento relativo dentro de un **conjunto de registros** es más arriesgado que el movimiento absoluto (como el uso de **MoveFirst** o **MoveLast**) cuando los datos cambian mientras se editan, agregan o eliminan registros. La ordenación y el filtrado se deberían basar en una clave principal o un identificador, ya que este tipo de valor no debería cambiar.</span><span class="sxs-lookup"><span data-stu-id="501bc-p108">It is particularly difficult to define consistent move semantics across all providers for methods that move relative to the current record — **MovePrevious**, **MoveNext**, and **Move** — in the face of changing data in the current record. For example, if you are working with a sorted, filtered **Recordset**, and you change the data in the current record so that it would precede all other records, but your changed data also no longer matches the filter, it is not clear where a **MoveNext** operation should take you. The safest conclusion is that relative movement within a **Recordset** is riskier than absolute movement (such as using **MoveFirst** or **MoveLast**) when the data is changing while records are being edited, added, or deleted. Sorting and filtering should be based on a primary key or ID, because this type of value should not change.</span></span>

