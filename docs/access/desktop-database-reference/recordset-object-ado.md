---
title: Recordset (objeto) (ADO)
TOCTitle: Recordset Object (ADO)
ms:assetid: 0f963bf8-f066-dc8a-b754-f427de712df1
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248865(v=office.15)
ms:contentKeyID: 48543267
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 26172a73f0967ef299b79e0bae30088eec0f77c9
ms.sourcegitcommit: c557bbcccf37a6011f89aae1ddd399dfe549d087
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/31/2018
ms.locfileid: "25872588"
---
# <a name="recordset-object-ado"></a><span data-ttu-id="dbab6-102">Recordset (objeto) (ADO)</span><span class="sxs-lookup"><span data-stu-id="dbab6-102">Recordset Object (ADO)</span></span>

<span data-ttu-id="dbab6-103">**Se aplica a**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="dbab6-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="dbab6-p101">Representa el conjunto completo de registros de una tabla base o los resultados de un comando ejecutado. En cualquier momento, el objeto **Recordset** hace referencia sólo a un único registro dentro del conjunto como registro actual.</span><span class="sxs-lookup"><span data-stu-id="dbab6-p101">Represents the entire set of records from a base table or the results of an executed command. At any time, the **Recordset** object refers to only a single record within the set as the current record.</span></span>

## <a name="remarks"></a><span data-ttu-id="dbab6-106">Comentarios</span><span class="sxs-lookup"><span data-stu-id="dbab6-106">Remarks</span></span>

<span data-ttu-id="dbab6-p102">Los objetos **Recordset** se usan para manipular datos de un proveedor. Cuando se usa ADO, los datos se manipulan en su práctica totalidad mediante el uso de objetos **Recordset**. Todos los objetos **Recordset** constan de registros (filas) y campos (columnas). Según la funcionalidad compatible con el proveedor, algunas propiedades o métodos de **Recordset** pueden no estar disponibles.</span><span class="sxs-lookup"><span data-stu-id="dbab6-p102">You use **Recordset** objects to manipulate data from a provider. When you use ADO, you manipulate data almost entirely using **Recordset** objects. All **Recordset** objects consist of records (rows) and fields (columns). Depending on the functionality supported by the provider, some **Recordset** methods or properties may not be available.</span></span>

<span data-ttu-id="dbab6-p103">ADODB.Recordset es el identificador de programa (ProgID) que se debe usar para crear un objeto **Recordset**. Las aplicaciones existentes que hacen referencia al identificador de programa (ProgID) ADOR.Recordset obsoleto continuarán funcionando sin recompilar, pero el nuevo desarrollo debe hacer referencia a ADODB.Recordset.</span><span class="sxs-lookup"><span data-stu-id="dbab6-p103">ADODB.Recordset is the ProgID that should be used to create a **Recordset** object. Existing applications that reference the outdated ADOR.Recordset ProgID will continue to work without recompiling, but new development should reference ADODB.Recordset.</span></span>

<span data-ttu-id="dbab6-113">Hay cuatro tipos diferentes de cursor definidos en ADO:</span><span class="sxs-lookup"><span data-stu-id="dbab6-113">There are four different cursor types defined in ADO:</span></span>

  - <span data-ttu-id="dbab6-114">**Cursor dinámico**: permite ver adiciones, modificaciones y eliminaciones efectuadas por otros usuarios; permite todos los tipos de movimiento en el objeto **Recordset** que no estén basados en marcadores y permite la presencia de marcadores si el proveedor los admite.</span><span class="sxs-lookup"><span data-stu-id="dbab6-114">**Dynamic cursor** — allows you to view additions, changes, and deletions by other users; allows all types of movement through the **Recordset** that doesn't rely on bookmarks; and allows bookmarks if the provider supports them.</span></span>

  - <span data-ttu-id="dbab6-p104">**Cursor estático de claves**: se comporta como un cursor dinámico, con la excepción de que impide ver los registros agregados por otros usuarios, así como el acceso a los registros eliminados por otros usuarios. Las modificaciones en los datos realizadas por otros usuarios seguirán siendo visibles. Siempre admite marcadores y, por lo tanto, permite todos los tipos de movimiento en el objeto **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="dbab6-p104">**Keyset cursor** — behaves like a dynamic cursor, except that it prevents you from seeing records that other users add, and prevents access to records that other users delete. Data changes by other users will still be visible. It always supports bookmarks and therefore allows all types of movement through the **Recordset**.</span></span>

  - <span data-ttu-id="dbab6-p105">**Cursor estático**: proporciona una copia estática de un conjunto de registros para su utilización con el fin de buscar datos o generar informes; siempre admite marcadores y, por lo tanto, permite todos los tipos de movimiento en el objeto **Recordset**. Las adiciones, modificaciones o eliminaciones realizadas por otros usuarios no serán visibles. Este es el único tipo de cursor permitido cuando se abre un objeto **Recordset** del cliente.</span><span class="sxs-lookup"><span data-stu-id="dbab6-p105">**Static cursor** — provides a static copy of a set of records for you to use to find data or generate reports; always allows bookmarks and therefore allows all types of movement through the **Recordset**. Additions, changes, or deletions by other users will not be visible. This is the only type of cursor allowed when you open a client-side **Recordset** object.</span></span>

  - <span data-ttu-id="dbab6-p106">**Cursor de sólo avance**: permite sólo el desplazamiento hacia delante en el objeto **Recordset**. Las adiciones, modificaciones o eliminaciones realizadas por otros usuarios no serán visibles. Este cursor mejora el rendimiento cuando sólo se necesita recorrer un objeto **Recordset** una vez.</span><span class="sxs-lookup"><span data-stu-id="dbab6-p106">**Forward-only cursor** — allows you to only scroll forward through the **Recordset**. Additions, changes, or deletions by other users will not be visible. This improves performance in situations where you need to make only a single pass through a **Recordset**.</span></span>

<span data-ttu-id="dbab6-124">Establezca la propiedad [CursorType](cursortype-property-ado.md) antes de abrir el **objeto Recordset** para elegir el tipo de cursor, o pase un argumento *CursorType* con el método [Open](open-method-ado-recordset.md) .</span><span class="sxs-lookup"><span data-stu-id="dbab6-124">Set the [CursorType](cursortype-property-ado.md) property prior to opening the **Recordset** to choose the cursor type, or pass a *CursorType* argument with the [Open](open-method-ado-recordset.md) method.</span></span> <span data-ttu-id="dbab6-125">Algunos proveedores no admiten todos los tipos de cursor.</span><span class="sxs-lookup"><span data-stu-id="dbab6-125">Some providers don't support all cursor types.</span></span> <span data-ttu-id="dbab6-126">Compruebe la documentación del proveedor.</span><span class="sxs-lookup"><span data-stu-id="dbab6-126">Check the documentation for the provider.</span></span> <span data-ttu-id="dbab6-127">Si no especifica un tipo de cursor, ADO abrirá de forma predeterminada un cursor de sólo avance.</span><span class="sxs-lookup"><span data-stu-id="dbab6-127">If you don't specify a cursor type, ADO opens a forward-only cursor by default.</span></span>

<span data-ttu-id="dbab6-p108">Si la propiedad [CursorLocation](cursorlocation-property-ado.md) se establece en **adUseClient** para abrir un objeto **Recordset**, la propiedad **UnderlyingValue** de objetos [Field](field-object-ado.md) no estará disponible en el objeto **Recordset** devuelto. Cuando se usa con algunos proveedores (como el proveedor ODBC de Microsoft para OLE DB conjuntamente con Microsoft SQL Server), se pueden crear objetos **Recordset** independientemente del objeto [Connection](connection-object-ado.md) definido anteriormente si se pasa una cadena de conexión con el método **Open**. ADO seguirá creando un objeto [Connection](connection-object-ado.md), pero no asignará ese objeto a una variable de objeto. Sin embargo, si se abren varios objetos **Recordset** con la misma conexión, se debe crear y abrir explícitamente un objeto **Connection**; de este modo, se asigna el objeto **Connection** a una variable de objeto. Si no se usa esta variable de objeto al abrir los objetos **Recordset**, ADO creará un nuevo objeto **Connection** para cada nuevo objeto **Recordset**, aunque se pase la misma cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="dbab6-p108">If the [CursorLocation](cursorlocation-property-ado.md) property is set to **adUseClient** to open a **Recordset**, the **UnderlyingValue** property on [Field](field-object-ado.md) objects is not available in the returned **Recordset** object. When used with some providers (such as the Microsoft ODBC Provider for OLE DB in conjunction with Microsoft SQL Server), you can create **Recordset** objects independently of a previously defined [Connection](connection-object-ado.md) object by passing a connection string with the **Open** method. ADO still creates a [Connection](connection-object-ado.md) object, but it doesn't assign that object to an object variable. However, if you are opening multiple **Recordset** objects over the same connection, you should explicitly create and open a **Connection** object; this assigns the **Connection** object to an object variable. If you do not use this object variable when opening your **Recordset** objects, ADO creates a new **Connection** object for each new **Recordset**, even if you pass the same connection string.</span></span>

<span data-ttu-id="dbab6-133">Puede crear todos los objetos **Recordset** que necesite.</span><span class="sxs-lookup"><span data-stu-id="dbab6-133">You can create as many **Recordset** objects as needed.</span></span>

<span data-ttu-id="dbab6-p109">Cuando se abre un objeto **Recordset**, el registro actual se coloca en el primer registro (si existe) y las propiedades [BOF](bof-eof-properties-ado.md) y [EOF](bof-eof-properties-ado.md) se establecen en **False**. Si no hay registros, los valores de las propiedades **BOF** y **EOF** son **True**.</span><span class="sxs-lookup"><span data-stu-id="dbab6-p109">When you open a **Recordset**, the current record is positioned to the first record (if any) and the [BOF](bof-eof-properties-ado.md) and [EOF](bof-eof-properties-ado.md) properties are set to **False**. If there are no records, the **BOF** and **EOF** property settings are **True**.</span></span>

<span data-ttu-id="dbab6-p110">Puede usar los métodos [MoveFirst](movefirst-movelast-movenext-and-moveprevious-methods-ado.md), **MoveLast**, **MoveNext** y **MovePrevious**; el método [Move](move-method-ado.md); y las propiedades [AbsolutePosition](absoluteposition-property-ado.md), [AbsolutePage](absolutepage-property-ado.md) y [Filter](filter-property-ado.md) para volver a colocar el registro actual, suponiendo que el proveedor admita la funcionalidad pertinente. Los objetos **Recordset** de solo avance admiten únicamente el método [MoveNext](movefirst-movelast-movenext-and-moveprevious-methods-ado.md). Cuando use los métodos **Move** para visitar cada registro (o enumerar el objeto **Recordset**), puede usar las propiedades **BOF** y **EOF** para determinar si se ha desplazado más allá del principio o el final del objeto **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="dbab6-p110">You can use the [MoveFirst](movefirst-movelast-movenext-and-moveprevious-methods-ado.md), **MoveLast**, **MoveNext**, and **MovePrevious** methods; the [Move](move-method-ado.md) method; and the [AbsolutePosition](absoluteposition-property-ado.md), [AbsolutePage](absolutepage-property-ado.md), and [Filter](filter-property-ado.md) properties to reposition the current record, assuming the provider supports the relevant functionality. Forward-only **Recordset** objects support only the [MoveNext](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) method. When you use the **Move** methods to visit each record (or enumerate the **Recordset**), you can use the **BOF** and **EOF** properties to determine if you've moved beyond the beginning or end of the **Recordset**.</span></span>

<span data-ttu-id="dbab6-p111">Los objetos **Recordset** pueden admitir dos tipos de actualizaciones: inmediata y por lotes. En la actualización inmediata, todas las modificaciones efectuadas en datos se escriben inmediatamente en el origen de datos subyacente cuando se llama al método [Update](update-method-ado.md). También se pueden pasar matrices de valores como parámetros con los métodos [AddNew](addnew-method-ado.md) y **Update**, y actualizar simultáneamente varios campos de un registro.</span><span class="sxs-lookup"><span data-stu-id="dbab6-p111">**Recordset** objects can support two types of updating: immediate and batched. In immediate updating, all changes to data are written immediately to the underlying data source once you call the [Update](update-method-ado.md) method. You can also pass arrays of values as parameters with the [AddNew](addnew-method-ado.md) and **Update** methods and simultaneously update several fields in a record.</span></span>

<span data-ttu-id="dbab6-p112">Si un proveedor admite la actualización por lotes, puede hacer que la caché del proveedor cambie a varios registros y transmitirlos a continuación en una única llamada a la base de datos con el método [UpdateBatch](updatebatch-method-ado.md). Esto es aplicable a las modificaciones efectuadas con los métodos **AddNew**, **Update** y [Delete](delete-method-ado-recordset.md). Después de llamar al método **UpdateBatch**, puede usar la propiedad [Status](status-property-ado-recordset.md) para comprobar la existencia de conflictos de datos con el fin de resolverlos.</span><span class="sxs-lookup"><span data-stu-id="dbab6-p112">If a provider supports batch updating, you can have the provider cache changes to more than one record and then transmit them in a single call to the database with the [UpdateBatch](updatebatch-method-ado.md) method. This applies to changes made with the **AddNew**, **Update**, and [Delete](delete-method-ado-recordset.md) methods. After you call the **UpdateBatch** method, you can use the [Status](status-property-ado-recordset.md) property to check for any data conflicts in order to resolve them.</span></span>

> [!NOTE]
> <span data-ttu-id="dbab6-p113">[!NOTA] Para ejecutar una consulta sin usar un objeto [Command](command-object-ado.md), pase una cadena de consulta al método **Open** de un objeto **Recordset**. Sin embargo, se requiere un objeto **Command** cuando se desea conservar el texto del comando y volver a ejecutarlo, o usar parámetros de consulta.</span><span class="sxs-lookup"><span data-stu-id="dbab6-p113">To execute a query without using a [Command](command-object-ado.md) object, pass a query string to the **Open** method of a **Recordset** object. However, a **Command** object is required when you want to persist the command text and re-execute it, or use query parameters.</span></span>

<span data-ttu-id="dbab6-147">La propiedad [Mode](mode-property-ado.md) controla los permisos de acceso.</span><span class="sxs-lookup"><span data-stu-id="dbab6-147">The [Mode](mode-property-ado.md) property governs access permissions.</span></span>

<span data-ttu-id="dbab6-p114">La colección **Fields** es el miembro predeterminado del objeto **Recordset**. Como consecuencia, las dos instrucciones de código siguientes son equivalentes.</span><span class="sxs-lookup"><span data-stu-id="dbab6-p114">The **Fields** collection is the default member of the **Recordset** object. As a result, the following two code statements are equivalent.</span></span>

```vb
    Debug.Print objRs.Fields.Item(0)  ' Both statements print 
    Debug.Print objRs(0)              '  the Value of Item(0).
```
