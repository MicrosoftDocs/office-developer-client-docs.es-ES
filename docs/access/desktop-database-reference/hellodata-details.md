---
title: Detalles sobre HelloData (referencia de escritorio de la base de datos de Access)
TOCTitle: HelloData details
ms:assetid: db51e15c-1b5b-c64a-2f84-34dd0e78c6cf
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250105(v=office.15)
ms:contentKeyID: 48548103
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 78b04b74d4e2b8d9c215235d6e7ccebed4fa2ef2
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: Auto
ms.contentlocale: es-ES
ms.lasthandoff: 01/17/2019
ms.locfileid: "28713390"
---
# <a name="hellodata-details"></a><span data-ttu-id="81149-102">Detalles de HelloData</span><span class="sxs-lookup"><span data-stu-id="81149-102">HelloData details</span></span>


<span data-ttu-id="81149-103">**Se aplica a**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="81149-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="81149-p101">La aplicación HelloData realiza las operaciones básicas de una aplicación ADO típica: obtener, examinar, editar y actualizar datos. Cuando inicie la aplicación, haga clic en el primer botón, **Obtener datos**. De esta forma, se ejecutará la subrutina GetData().</span><span class="sxs-lookup"><span data-stu-id="81149-p101">The HelloData application steps through the basic operations of a typical ADO application: getting, examining, editing, and updating data. When you start the application, click the first button, **Get Data**. This will run the GetData() subroutine.</span></span>

## <a name="getdata"></a><span data-ttu-id="81149-107">GetData</span><span class="sxs-lookup"><span data-stu-id="81149-107">GetData</span></span>

<span data-ttu-id="81149-108">GetData coloca una cadena de conexión válida en una variable de nivel de módulo, *m\_sConnStr*.</span><span class="sxs-lookup"><span data-stu-id="81149-108">GetData places a valid connection string into a module-level variable, *m\_sConnStr*.</span></span> <span data-ttu-id="81149-109">Para obtener más información sobre cadenas de conexión, vea [Crear la cadena de conexión](creating-the-connection-string.md).</span><span class="sxs-lookup"><span data-stu-id="81149-109">For more information about connection strings, see [Creating the Connection String](creating-the-connection-string.md).</span></span>

<span data-ttu-id="81149-p103">Asigne un controlador de errores mediante una instrucción **OnError** de Visual Basic. Para obtener más información acerca del tratamiento de errores en ADO, vea [Capítulo 6: Tratamiento de errores](chapter-6-error-handling.md). Se crea un nuevo objeto **Connection** y la propiedad **CursorLocation** se establece en **adUseClient**, dado que el ejemplo de HelloData crea un objeto *Recordset desconectado*. Eso significa que una vez que se han recuperado los datos del origen de datos, se rompe la conexión física con el origen de datos, aunque se puede seguir trabajando con los datos almacenados en caché de forma local en el objeto **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="81149-p103">Assign an error handler using a Visual Basic **OnError** statement. For more information about error handling in ADO, see [Chapter 6: Error Handling](chapter-6-error-handling.md). A new **Connection** object is created, and the **CursorLocation** property is set to **adUseClient** because the HelloData example creates a *disconnected Recordset*. This means that once the data has been fetched from the data source, the physical connection with the data source is broken, but you can still work with the data that is cached locally in your **Recordset** object.</span></span>

<span data-ttu-id="81149-114">Una vez establecida la conexión, asigne una cadena SQL a una variable (sSQL).</span><span class="sxs-lookup"><span data-stu-id="81149-114">After the connection has been opened, assign a SQL string to a variable (sSQL).</span></span> <span data-ttu-id="81149-115">A continuación, cree una instancia de un nuevo objeto **Recordset** , m\_oRecordset1.</span><span class="sxs-lookup"><span data-stu-id="81149-115">Then instantiate a new **Recordset** object, m\_oRecordset1 .</span></span> <span data-ttu-id="81149-116">En la siguiente línea de código, abra el **objeto Recordset** a través de la existente **conexión**, pasando.</span><span class="sxs-lookup"><span data-stu-id="81149-116">In the next line of code, open the **Recordset** over the existing **Connection**, passing in .</span></span> <span data-ttu-id="81149-117">En la siguiente línea de código, abra el **objeto Recordset** a través de la existente **conexión**, pasando sSQL como el origen del **objeto Recordset**.</span><span class="sxs-lookup"><span data-stu-id="81149-117">In the next line of code, open the **Recordset** over the existing **Connection**, passing in sSQL as the source of the **Recordset**.</span></span> <span data-ttu-id="81149-118">Ayude a ADO a tomar la determinación de que la cadena SQL que se acaba de pasar como origen del objeto **Recordset** es una definición textual de un comando al pasar **adCmdText** en el argumento al método **Open** del objeto **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="81149-118">You assist ADO in making the determination that the SQL string you have passed as the source for the **Recordset** is a textual definition of a command by passing **adCmdText** in the final argument to the **Recordset** **Open** method.</span></span> <span data-ttu-id="81149-119">Esta línea también establece las propiedades **LockType** y **CursorType** asociadas al objeto **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="81149-119">This line also sets the **LockType** and **CursorType** associated with the **Recordset**.</span></span>

<span data-ttu-id="81149-120">La siguiente línea de código establece la propiedad **MarshalOptions** en **adMarshalModifiedOnly**.</span><span class="sxs-lookup"><span data-stu-id="81149-120">The next line of code sets the **MarshalOptions** property equal to **adMarshalModifiedOnly**.</span></span> <span data-ttu-id="81149-121">**MarshalOptions** indica qué registros deben calcularse en el nivel intermedio (o el servidor web).</span><span class="sxs-lookup"><span data-stu-id="81149-121">**MarshalOptions** indicates which records should be marshaled to the middle tier (or web server).</span></span> <span data-ttu-id="81149-122">Para obtener más información acerca del cálculo de referencias, vea la documentación sobre COM.</span><span class="sxs-lookup"><span data-stu-id="81149-122">For more information about marshaling, see the COM documentation.</span></span> <span data-ttu-id="81149-123">Cuando utilice **adMarshalModifiedOnly** con un cursor de cliente ([CursorLocation](cursorlocation-property-ado.md) = **adUseClient**), sólo los registros que se han modificado en el cliente se vuelven a escribir el nivel intermedio.</span><span class="sxs-lookup"><span data-stu-id="81149-123">When using **adMarshalModifiedOnly** with a client-side cursor ([CursorLocation](cursorlocation-property-ado.md) = **adUseClient**), only records that have been modified on the client are written back to the middle tier.</span></span> <span data-ttu-id="81149-124">El establecimiento de **MarshalOptions** en **adMarshalModifiedOnly** puede mejorar el rendimiento, dado que se calculan las referencias de menos filas.</span><span class="sxs-lookup"><span data-stu-id="81149-124">Setting **MarshalOptions** to **adMarshalModifiedOnly** can improve performance because fewer rows are marshaled.</span></span>

<span data-ttu-id="81149-p106">A continuación, desconecte el objeto **Recordset** al establecer su propiedad **ActiveConnection** en **Nothing**. Para obtener más información, vea [Desconectar y volver a conectar el objeto Recordset](disconnecting-and-reconnecting-the-recordset.md) en el capítulo 5: Actualizar y almacenar datos.</span><span class="sxs-lookup"><span data-stu-id="81149-p106">Next, disconnect the **Recordset** by setting its **ActiveConnection** property equal to **Nothing**. For more information, see [Disconnecting and Reconnecting the Recordset](disconnecting-and-reconnecting-the-recordset.md) in Chapter 5: Updating and Persisting Data.</span></span>

<span data-ttu-id="81149-127">Cierre la conexión con el origen de datos y destruya el objeto **Connection** existente, con lo que se liberan los recursos que éste estaba utilizando.</span><span class="sxs-lookup"><span data-stu-id="81149-127">Close the connection to the data source and destroy the existing **Connection** object, thereby releasing the resources it consumed.</span></span>

<span data-ttu-id="81149-128">El paso final consiste en establecer el objeto **Recordset** como **DataSource** de Microsoft DataBound Grid Control en el formulario para poder mostrar fácilmente los datos del objeto **Recordset** en el formulario.</span><span class="sxs-lookup"><span data-stu-id="81149-128">The final step is to set the **Recordset** as the **DataSource** for the Microsoft DataBound Grid Control on the form so that you can easily display the data from the **Recordset** on the form.</span></span>

<span data-ttu-id="81149-p107">Haga clic en el segundo botón, **Examinar datos**. De esta forma, se ejecuta la subrutina ExamineData.</span><span class="sxs-lookup"><span data-stu-id="81149-p107">Click the second button, **Examine Data**. This runs the ExamineData subroutine.</span></span>

## <a name="examinedata"></a><span data-ttu-id="81149-131">ExamineData</span><span class="sxs-lookup"><span data-stu-id="81149-131">ExamineData</span></span>

<span data-ttu-id="81149-p108">ExamineData emplea varios métodos y propiedades del objeto **Recordset** para mostrar información acerca de los datos del objeto **Recordset**. Informa acerca del número de registros mediante la propiedad **RecordCount**. Recorre el objeto **Recordset** e imprime el valor de la propiedad **AbsolutePosition** en el cuadro de texto del formulario que aparece. Además, durante el recorrido, el valor de la propiedad **Bookmark** del tercer registro se coloca en una variable de variante, *vBookmark*, para su uso posterior.</span><span class="sxs-lookup"><span data-stu-id="81149-p108">ExamineData uses various methods and properties of the **Recordset** object to display information about the data in the **Recordset**. It reports the number of records by using the **RecordCount** property. It loops through the **Recordset** and prints the value of the **AbsolutePosition** property in the display text box on the form. Also while in the loop, the value of the **Bookmark** property for the third record is placed into a variant variable, *vBookmark*, for later use.</span></span>

<span data-ttu-id="81149-p109">La rutina navega directamente al tercer registro mediante la variable de marcador almacenada anteriormente. La rutina llama a la subrutina WalkFields, que recorre la colección **Fields** del objeto **Recordset** y muestra detalles de cada objeto **Field** de la colección.</span><span class="sxs-lookup"><span data-stu-id="81149-p109">The routine navigates directly back to the third record using the bookmark variable that it stored earlier. The routine calls the WalkFields subroutine, which loops through the **Fields** collection of the **Recordset** and displays details about each **Field** in the collection.</span></span>

<span data-ttu-id="81149-p110">Por último, ExamineData utiliza la propiedad **Filter** del objeto **Recordset** para buscar sólo aquellos registros cuyo CategoryId sea igual a 2. El resultado de la aplicación de este filtro es visible inmediatamente en la cuadrícula del formulario.</span><span class="sxs-lookup"><span data-stu-id="81149-p110">Finally, ExamineData uses the **Filter** property of the **Recordset** to screen for only those records with a CategoryId equal to 2. The result of applying this filter is immediately visible in the display grid on the form.</span></span>

<span data-ttu-id="81149-140">Para obtener más información acerca de la funcionalidad de la subrutina ExamineData, vea el [Capítulo 3: Examinar datos](chapter-3-examining-data.md).</span><span class="sxs-lookup"><span data-stu-id="81149-140">For more information about the functionality shown in the ExamineData subroutine, see [Chapter 3: Examining Data](chapter-3-examining-data.md).</span></span>

<span data-ttu-id="81149-p111">A continuación, haga clic en el tercer botón, **Modificar datos**. De esta forma, se ejecutará la subrutina EditData.</span><span class="sxs-lookup"><span data-stu-id="81149-p111">Next, click the third button, **Edit Data**. This will run the EditData subroutine.</span></span>

## <a name="editdata"></a><span data-ttu-id="81149-143">EditData</span><span class="sxs-lookup"><span data-stu-id="81149-143">EditData</span></span>

<span data-ttu-id="81149-p112">Cuando el código entra en la subrutina EditData, el objeto **Recordset** sigue estando filtrado por CategoryId igual a 2, de modo que sólo son visibles los elementos que satisfacen los criterios del filtro. En primer lugar recorre el objeto **Recordset** y aumenta el precio de cada elemento visible del objeto **Recordset** un 10 por ciento. El valor del campo **Price** cambia al establecer la propiedad **Value** de ese campo en una nueva cantidad válida.</span><span class="sxs-lookup"><span data-stu-id="81149-p112">When the code enters the EditData subroutine, the **Recordset** is still filtered on CategoryId equal to 2, so only those items that meet the filter criteria are visible. It first loops through the **Recordset** and increases the price of each visible item in the **Recordset** by 10 percent. The value of the **Price** field is changed by setting the **Value** property for that field equal to a new, valid amount.</span></span>

<span data-ttu-id="81149-p113">Recuerde que el objeto **Recordset** está desconectado del origen de datos. Los cambios realizados en EditData sólo se efectúan de forma local en la copia almacenada en caché de los datos. Para obtener más información, vea el [Capítulo 4: Modificar datos](chapter-4-editing-data.md).</span><span class="sxs-lookup"><span data-stu-id="81149-p113">Remember that the **Recordset** is disconnected from the data source. The changes made in EditData are made only to the locally cached copy of the data. For more information, see [Chapter 4: Editing Data](chapter-4-editing-data.md).</span></span>

<span data-ttu-id="81149-p114">Los cambios no se realizarán en el origen de datos hasta que no se haga clic en el cuarto botón, **Actualizar datos**. Así se ejecutará la subrutina UpdateData.</span><span class="sxs-lookup"><span data-stu-id="81149-p114">The changes will not be made on the data source until you click the fourth button, **Update Data**. This will run the UpdateData subroutine.</span></span>

## <a name="updatedata"></a><span data-ttu-id="81149-152">UpdateData</span><span class="sxs-lookup"><span data-stu-id="81149-152">UpdateData</span></span>

<span data-ttu-id="81149-153">En primer lugar, UpdateData quita el filtro aplicado al objeto **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="81149-153">UpdateData first removes the filter that has been applied to the **Recordset**.</span></span> <span data-ttu-id="81149-154">El código quita y restablece como el **DataSource** de Microsoft Bound DataGrid del formulario para que el **objeto Recordset** sin filtrar aparezca en la cuadrícula.</span><span class="sxs-lookup"><span data-stu-id="81149-154">The code removes and resets as the **DataSource** for the Microsoft Bound DataGrid on the form so that the unfiltered **Recordset** appears in the grid.</span></span>

<span data-ttu-id="81149-155">A continuación, el código comprueba si es posible volver a desplazarse por el objeto **Recordset** mediante el método **Supports** con el argumento **adMovePrevious**.</span><span class="sxs-lookup"><span data-stu-id="81149-155">The code then checks to see whether you can move backward in the **Recordset** by using the **Supports** method with the **adMovePrevious** argument.</span></span>

<span data-ttu-id="81149-p116">La rutina se desplaza al primer registro mediante el método **MoveFirst** y muestra los valores originales y actuales del campo mediante las propiedades **OriginalValue** y **Value** del objeto **Field**. Puede obtener información sobre estas propiedades, junto a la propiedad **UnderlyingValue** (que no se utiliza aquí), en el [Capítulo 5: Actualizar y almacenar datos.](chapter-5-updating-and-persisting-data.md).</span><span class="sxs-lookup"><span data-stu-id="81149-p116">The routine moves to the first record using the **MoveFirst** method and displays the field's original and current values, using the **OriginalValue** and **Value** properties of the **Field** object. These properties, along with the **UnderlyingValue** property (not used here), are discussed in [Chapter 5: Updating and Persisting Data](chapter-5-updating-and-persisting-data.md).</span></span>

<span data-ttu-id="81149-p117">Después, se crea un nuevo objeto **Connection** que se utiliza para restablecer una conexión con el origen de datos. Se vuelve a conectar el objeto **Recordset** con el origen de datos al establecer el nuevo objeto **Connection** como **ActiveConnection** del objeto **Recordset**. Para enviar las actualizaciones al servidor, el código llama al método **UpdateBatch** del objeto **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="81149-p117">Next, a new **Connection** object is created and used to reestablish a connection to the data source. You reconnect the **Recordset** to the data source by setting the new **Connection** as the **ActiveConnection** for the **Recordset**. To send the updates to the server, the code calls **UpdateBatch** on the **Recordset**.</span></span>

<span data-ttu-id="81149-161">Si la actualización por lotes se realiza correctamente, una variable de indicador de nivel de módulo, se establece en True.</span><span class="sxs-lookup"><span data-stu-id="81149-161">If the batch update succeeds, a module-level flag variable, , is set to True.</span></span> <span data-ttu-id="81149-162">Eso le recordará más tarde que debe limpiar todos los cambios realizados en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="81149-162">This will remind you later to clean up all changes made to the database.</span></span>

<span data-ttu-id="81149-p119">Finalmente, el código se desplaza al primer registro del objeto **Recordset** y muestra los valores originales y actuales. Éstos son los mismos después de la llamada al método **UpdateBatch**.</span><span class="sxs-lookup"><span data-stu-id="81149-p119">Finally, the code moves back to the first record in the **Recordset** and displays the original and current values. The values are the same after the call to **UpdateBatch**.</span></span>

<span data-ttu-id="81149-165">Para obtener información más detallada acerca de la actualización de datos, incluido qué hacer cuando los datos del servidor cambian mientras el objeto **Recordset** está desconectado, vea el [Capítulo 5: Actualizar y almacenar datos.](chapter-5-updating-and-persisting-data.md).</span><span class="sxs-lookup"><span data-stu-id="81149-165">For more detailed information about updating data, including what to do when data on the server changes while your **Recordset** is disconnected, see [Chapter 5: Updating and Persisting Data](chapter-5-updating-and-persisting-data.md).</span></span>

## <a name="formunload"></a><span data-ttu-id="81149-166">Formulario\_Unload</span><span class="sxs-lookup"><span data-stu-id="81149-166">Form\_Unload</span></span>

<span data-ttu-id="81149-167">El formulario\_subrutina Unload es importante por varias razones.</span><span class="sxs-lookup"><span data-stu-id="81149-167">The Form\_Unload subroutine is important for several reasons.</span></span> <span data-ttu-id="81149-168">Primero, puesto que se trata de una aplicación de ejemplo, formulario\_Unload limpia los cambios realizados en la base de datos antes de salir de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="81149-168">First, because this is a sample application, Form\_Unload cleans up the changes made to the database before the application exits.</span></span> <span data-ttu-id="81149-169">En segundo lugar, el código muestra cómo se puede ejecutar un comando directamente desde un objeto **Connection** abierto mediante el método **Execute**.</span><span class="sxs-lookup"><span data-stu-id="81149-169">Second, the code shows how a command can be executed directly from an open **Connection** object using the **Execute** method.</span></span> <span data-ttu-id="81149-170">Por último, se muestra un ejemplo de la ejecución de una consulta que no devuelve filas (una consulta de actualización) en el origen de datos.</span><span class="sxs-lookup"><span data-stu-id="81149-170">Finally, it shows an example of executing a non-row–returning query (an UPDATE query) against the data source.</span></span>

